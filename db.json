{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"themes/tumo-next/source/css/friends.css","path":"css/friends.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/css/tumo.css","path":"css/tumo.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/alipay.png","path":"images/alipay.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/alipay_ray.jpg","path":"images/alipay_ray.jpg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/avatar.jpg","path":"images/avatar.jpg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/favicon.ico","path":"images/favicon.ico","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/qrcode_for_gh.jpg","path":"images/qrcode_for_gh.jpg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/wechat.png","path":"images/wechat.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/images/wechat_ray.jpg","path":"images/wechat_ray.jpg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/mo.min.js","path":"js/src/mo.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-merienda.css","path":"lib/font-awesome/css/font-merienda.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/font-merienda.woff2","path":"lib/font-awesome/fonts/font-merienda.woff2","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"312af994bb9a5dcebbff167f31e49e3e743f4c6d","modified":1707290865069},{"_id":"source/_posts/Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤.md","hash":"f786a9ee87b40367fa7c99e1d698d1100adc9d20","modified":1707290865070},{"_id":"source/about/index.md","hash":"859b8e0a12de5d15957843d942dc31fd67697213","modified":1726908309565},{"_id":"source/links/index.md","hash":"e5873bd580fa699f7d3d1e91765ab5662573d63f","modified":1707290865074},{"_id":"source/_posts/Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®.md","hash":"1333dbb13c80197d6294abf7847ae9677e79769f","modified":1713338669537},{"_id":"source/_posts/Dockerå®‰è£…nacosä½¿ç”¨mysql.md","hash":"37102456ebc3da805caa08929052a8a581d0b358","modified":1748793090553},{"_id":"source/_posts/Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®.md","hash":"ae07c49e02e3cf1ffdf76324313e1918a80a84d4","modified":1707290865070},{"_id":"source/_posts/Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥.md","hash":"10fc772bbb30f1f80b066ae5bda786d4df249646","modified":1744986394478},{"_id":"source/_posts/Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“.md","hash":"c0e2a0e61552fc627e03e872f25073a3efc1a480","modified":1729058384745},{"_id":"source/_posts/Ideaå¼€å‘å¿…è£…æ’ä»¶.md","hash":"2733c25c6a73c32adb408a9f6c308a8af9554e49","modified":1746022998373},{"_id":"source/_posts/Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock.md","hash":"b401ebb87f3791cde982a03b45c5be5c7732cd40","modified":1707290865071},{"_id":"source/_posts/JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡.md","hash":"9f50aeaccd706620f6a098befd767ba62005b5d0","modified":1707290865070},{"_id":"source/_posts/Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—.md","hash":"46bc8cbf9e596e28aa7b3a8ebdb8ba27bd4502b7","modified":1707290865071},{"_id":"source/_posts/Linuxç¯å¢ƒä¸‹éƒ¨ç½²node-jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†.md","hash":"3730c45ec30be762b1c2d2a539e5dfb642002305","modified":1731568155427},{"_id":"source/_posts/Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—.md","hash":"bf48af92c57418d3e5ef097eea3731b86e891d09","modified":1707290865070},{"_id":"source/_posts/Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬.md","hash":"9d78a7144356566baab995ba8bb7e264f107e090","modified":1707290865071},{"_id":"source/_posts/Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024.md","hash":"566daf70f933ae1cc20d03d71856dd83b7a782db","modified":1736921995290},{"_id":"source/_posts/Node-jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6.md","hash":"e99ec4f6e2e32b9c0fb03348d9906b7e00aaa310","modified":1707290865071},{"_id":"source/_posts/Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm.md","hash":"f21eed643ee49c03d4854de0e546692db1e1dd23","modified":1721462733547},{"_id":"source/_posts/Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium.md","hash":"6cefe89ac1361118dc8e5ca8fc74bf1c70386afa","modified":1716800665386},{"_id":"source/_posts/Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜.md","hash":"77dc3d70709baa5f281958187b257ae1cca48ae2","modified":1726629905971},{"_id":"source/_posts/Shiroæ•´åˆRedis-ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘.md","hash":"c24df36c2f30807c0a3ad833c0bec9637e83c3aa","modified":1707290865072},{"_id":"source/_posts/Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬).md","hash":"4fd90679642ae7e5bf6b0a80c658764447bc206f","modified":1707290865072},{"_id":"source/_posts/RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£.md","hash":"6e7d1a3c9866ed284fcac533e223b9f5993e8041","modified":1738909106429},{"_id":"source/_posts/SpringBoot-Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬).md","hash":"3e7494135e030930df5c23f5d34713c2866d520f","modified":1707290865072},{"_id":"source/_posts/Linuxå®‰è£…nginxå’Œé…ç½®https.md","hash":"f0d0bddc71aa457c9ccc6a7bd06188c8928a2886","modified":1722337297409},{"_id":"source/_posts/SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜.md","hash":"b91bbbd90355648d7835a1c89f499bb92f634375","modified":1707290865072},{"_id":"source/_posts/SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º.md","hash":"de57484c9660925f96730a04a23ef78ff2aaeba3","modified":1707290865072},{"_id":"source/_posts/SpringBootæ•´åˆHibernate-Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½.md","hash":"c2a15862e572e47582332ce1bcc61267ef7ad0dd","modified":1707290865072},{"_id":"source/_posts/SpringBootæ•´åˆMailå‘é€é‚®ä»¶-å‘é€æ¨¡æ¿é‚®ä»¶.md","hash":"c2e3702e094c04aa9de00c1fc3ca9423e1f677b8","modified":1707290865073},{"_id":"source/_posts/SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½.md","hash":"948a9ae28cf919fabfd5f95671783049c3872265","modified":1707290865073},{"_id":"source/_posts/SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£.md","hash":"3b394eff1a197e856735e8a5d70398ed98d9601c","modified":1707290865073},{"_id":"source/_posts/SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘.md","hash":"6940ed7abb83e6e07e62ef79c68066d606f64799","modified":1707290865073},{"_id":"source/_posts/SpringBootç›‘å¬Redisè¿‡æœŸkey.md","hash":"9b773ba2910be529a627ce7f93fd8d88de929407","modified":1721906557727},{"_id":"source/_posts/ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿.md","hash":"cc82827daa70aceb623e8bbe0c223186f3ff7867","modified":1736922173369},{"_id":"source/_posts/ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡.md","hash":"d7f47e27ef83f17374a98b6decef5e15b2f2b04d","modified":1743517968261},{"_id":"source/_posts/å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜.md","hash":"69427231a7db880166201f7caac3d9aefa9db05b","modified":1754638022812},{"_id":"source/_posts/å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜.md","hash":"6f9af33915296b28e74f4497bcd5624a097c3b22","modified":1707290865073},{"_id":"source/_posts/ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦.md","hash":"909d117b38e02b49f69e13a9148ba0f4dc1c7d55","modified":1723439089244},{"_id":"source/_posts/å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx.md","hash":"455a2f4bc1926d3078b8d271f95d6d762938521e","modified":1707290865073},{"_id":"source/_posts/å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶.md","hash":"f17e4d998592e12ed3e96028035495babe153241","modified":1718887852123},{"_id":"source/_posts/å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬).md","hash":"d66b64a021eadf2c4998a575ed898e3a378d5dac","modified":1713338669538},{"_id":"source/_posts/åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚.md","hash":"7c41fc64de2478e4d214ccca969dd9d71a6acee5","modified":1724897487455},{"_id":"source/_posts/å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜.md","hash":"8c3b08e111a2e8eff7c1ffd369944b0fabc24a4d","modified":1748794102454},{"_id":"source/_posts/Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬).md","hash":"241e9244f8c6fcc97760cd21b41f64e2dcfef426","modified":1707290865071},{"_id":"source/_posts/å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬).md","hash":"e1608baf3be70bd578d96e28ade67e8bbcbeb095","modified":1707290865074},{"_id":"source/_posts/ç»•è¿‡Cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ.md","hash":"48cc0e3793feb01ecfc9a0f03b25438fa0240b85","modified":1739862327550},{"_id":"themes/tumo-next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1707290865104},{"_id":"themes/tumo-next/layout/_scripts/schemes/Tumo.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1707290865092},{"_id":"themes/tumo-next/source/css/_mixins/Tumo.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1707290865104},{"_id":"themes/tumo-next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1707290865087},{"_id":"themes/tumo-next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1707290865087},{"_id":"themes/tumo-next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1707290865087},{"_id":"themes/tumo-next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1707290865087},{"_id":"themes/tumo-next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1707290865087},{"_id":"themes/tumo-next/.gitignore","hash":"0b5c2ffd41f66eb1849d6426ba8cf9649eeed329","modified":1707290865087},{"_id":"themes/tumo-next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1707290865087},{"_id":"themes/tumo-next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1707290865087},{"_id":"themes/tumo-next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1707290865096},{"_id":"themes/tumo-next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1707290865096},{"_id":"themes/tumo-next/README.md","hash":"1fc857a5402622a277d95382ddcd0f159be3cd82","modified":1707290865087},{"_id":"themes/tumo-next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1707290865088},{"_id":"themes/tumo-next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1707290865096},{"_id":"themes/tumo-next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1707290865088},{"_id":"themes/tumo-next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1707290865088},{"_id":"themes/tumo-next/languages/en.yml","hash":"d8d123dc5b632577fc6be2e6d9e9e66e7bb60cde","modified":1707290865088},{"_id":"themes/tumo-next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1707290865088},{"_id":"themes/tumo-next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1707290865088},{"_id":"themes/tumo-next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1707290865088},{"_id":"themes/tumo-next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1707290865088},{"_id":"themes/tumo-next/languages/default.yml","hash":"8a34e83c494373b2736f6928cf2dbc7c9c6e7f22","modified":1707290865088},{"_id":"themes/tumo-next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1707290865089},{"_id":"themes/tumo-next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1707290865089},{"_id":"themes/tumo-next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1707290865089},{"_id":"themes/tumo-next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1707290865089},{"_id":"themes/tumo-next/_config.yml","hash":"68e63ef3871a7c1004b36b17ce080e6f076f7e49","modified":1707290865088},{"_id":"themes/tumo-next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1707290865089},{"_id":"themes/tumo-next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1707290865089},{"_id":"themes/tumo-next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1707290865089},{"_id":"themes/tumo-next/layout/archive.swig","hash":"dd1984c1d732a2271ce740ccc9d0c2324de4ae91","modified":1707290865096},{"_id":"themes/tumo-next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1707290865096},{"_id":"themes/tumo-next/layout/index.swig","hash":"ece9c6d625282fa9a8dbf13bd1f25e5005a84c88","modified":1707290865096},{"_id":"themes/tumo-next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1707290865096},{"_id":"themes/tumo-next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1707290865096},{"_id":"themes/tumo-next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1707290865089},{"_id":"themes/tumo-next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1707290865096},{"_id":"themes/tumo-next/layout/_layout.swig","hash":"c9bd8e054844252490c41530b4dd590075240dd1","modified":1707290865090},{"_id":"themes/tumo-next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1707290865089},{"_id":"themes/tumo-next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1707290865097},{"_id":"themes/tumo-next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1707290865096},{"_id":"themes/tumo-next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1707290865097},{"_id":"themes/tumo-next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1707290865089},{"_id":"themes/tumo-next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1707290865089},{"_id":"themes/tumo-next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1707290865119},{"_id":"themes/tumo-next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1707290865119},{"_id":"themes/tumo-next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1707290865097},{"_id":"themes/tumo-next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1707290865097},{"_id":"themes/tumo-next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1707290865092},{"_id":"themes/tumo-next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1707290865092},{"_id":"themes/tumo-next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1707290865119},{"_id":"themes/tumo-next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1707290865092},{"_id":"themes/tumo-next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1707290865090},{"_id":"themes/tumo-next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1707290865090},{"_id":"themes/tumo-next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1707290865090},{"_id":"themes/tumo-next/layout/_macro/post.swig","hash":"e5610129e3317f92da32ee9da2038cd160931cfd","modified":1707290865090},{"_id":"themes/tumo-next/layout/_macro/sidebar.swig","hash":"e6b4ebd47c0987b31fb9b0c856b6f73f0267a473","modified":1707290865090},{"_id":"themes/tumo-next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1707290865095},{"_id":"themes/tumo-next/source/css/friends.css","hash":"bbf274f183889af25a39ecd1450dbb53b17c94bf","modified":1707290865104},{"_id":"themes/tumo-next/source/css/main.styl","hash":"d87e9a96e749e567cb4519d79588757265001826","modified":1707290865104},{"_id":"themes/tumo-next/source/css/tumo.css","hash":"ba017f14938ed4514fa9f78e3e56b92760aeb51c","modified":1707290865104},{"_id":"themes/tumo-next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1707290865090},{"_id":"themes/tumo-next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1707290865095},{"_id":"themes/tumo-next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1707290865095},{"_id":"themes/tumo-next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1707290865095},{"_id":"themes/tumo-next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1707290865095},{"_id":"themes/tumo-next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1707290865090},{"_id":"themes/tumo-next/layout/_partials/footer.swig","hash":"9f68cea73f8df95f798b4c7beeeb16f6353eeb58","modified":1707290865090},{"_id":"themes/tumo-next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1707290865095},{"_id":"themes/tumo-next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/header.swig","hash":"385604793f64b9321fe0181b625c4821cba49fc9","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/pagination.swig","hash":"8c9e2d161bcf1fc96fb1d16e1bdb94c8417621ac","modified":1707290865091},{"_id":"themes/tumo-next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1707290865095},{"_id":"themes/tumo-next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1707290865104},{"_id":"themes/tumo-next/layout/_partials/head.swig","hash":"bff0472d9fc634987f6d6d29cb7a72c9403ba460","modified":1707290865091},{"_id":"themes/tumo-next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1707290865105},{"_id":"themes/tumo-next/source/images/alipay.png","hash":"b0074f7766dadf4b4b8792a4f41fa1ca64143668","modified":1707290865104},{"_id":"themes/tumo-next/source/images/avatar.jpg","hash":"efd2f081ff4f0db3355aecff71ff81e291839f71","modified":1707290865105},{"_id":"themes/tumo-next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1707290865105},{"_id":"themes/tumo-next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1707290865105},{"_id":"themes/tumo-next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1707290865105},{"_id":"themes/tumo-next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1707290865092},{"_id":"themes/tumo-next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1707290865103},{"_id":"themes/tumo-next/source/images/favicon.ico","hash":"efd2f081ff4f0db3355aecff71ff81e291839f71","modified":1707290865105},{"_id":"themes/tumo-next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1707290865093},{"_id":"themes/tumo-next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1707290865105},{"_id":"themes/tumo-next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1707290865093},{"_id":"themes/tumo-next/source/images/wechat.png","hash":"cc81c6a186f8546f6d54514d82297e2ca6c9492c","modified":1707290865106},{"_id":"themes/tumo-next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1707290865093},{"_id":"themes/tumo-next/source/images/qrcode_for_gh.jpg","hash":"808e5d5750699e1202b04a5007770e6183eba03b","modified":1707290865105},{"_id":"themes/tumo-next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1707290865093},{"_id":"themes/tumo-next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1707290865095},{"_id":"themes/tumo-next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1707290865094},{"_id":"themes/tumo-next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1707290865096},{"_id":"themes/tumo-next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"d6f6bbd2d56c916baf63cf2c718fc8a1ee390f1a","modified":1707290865093},{"_id":"themes/tumo-next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1707290865091},{"_id":"themes/tumo-next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1707290865103},{"_id":"themes/tumo-next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1707290865096},{"_id":"themes/tumo-next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1707290865092},{"_id":"themes/tumo-next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1707290865091},{"_id":"themes/tumo-next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1707290865092},{"_id":"themes/tumo-next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1707290865092},{"_id":"themes/tumo-next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1707290865092},{"_id":"themes/tumo-next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1707290865096},{"_id":"themes/tumo-next/source/css/_variables/Tumo.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1707290865104},{"_id":"themes/tumo-next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1707290865112},{"_id":"themes/tumo-next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1707290865104},{"_id":"themes/tumo-next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1707290865115},{"_id":"themes/tumo-next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1707290865109},{"_id":"themes/tumo-next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1707290865115},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1707290865117},{"_id":"themes/tumo-next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1707290865117},{"_id":"themes/tumo-next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1707290865117},{"_id":"themes/tumo-next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1707290865117},{"_id":"themes/tumo-next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1707290865118},{"_id":"themes/tumo-next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1707290865116},{"_id":"themes/tumo-next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1707290865117},{"_id":"themes/tumo-next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1707290865119},{"_id":"themes/tumo-next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1707290865106},{"_id":"themes/tumo-next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1707290865106},{"_id":"themes/tumo-next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1707290865119},{"_id":"themes/tumo-next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1707290865106},{"_id":"themes/tumo-next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1707290865107},{"_id":"themes/tumo-next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1707290865107},{"_id":"themes/tumo-next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1707290865106},{"_id":"themes/tumo-next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1707290865119},{"_id":"themes/tumo-next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1707290865107},{"_id":"themes/tumo-next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1707290865107},{"_id":"themes/tumo-next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1707290865107},{"_id":"themes/tumo-next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1707290865118},{"_id":"themes/tumo-next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1707290865107},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1707290865115},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1707290865115},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1707290865115},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1707290865115},{"_id":"themes/tumo-next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1707290865097},{"_id":"themes/tumo-next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1707290865097},{"_id":"themes/tumo-next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1707290865098},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1707290865115},{"_id":"themes/tumo-next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1707290865102},{"_id":"themes/tumo-next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1707290865115},{"_id":"themes/tumo-next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1707290865102},{"_id":"themes/tumo-next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1707290865095},{"_id":"themes/tumo-next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1707290865102},{"_id":"themes/tumo-next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1707290865095},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1707290865103},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1707290865103},{"_id":"themes/tumo-next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1707290865109},{"_id":"themes/tumo-next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1707290865109},{"_id":"themes/tumo-next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/font-merienda.woff2","hash":"1d66fb61c8b5a6bcc004c5d36a5ed6b36ba6377f","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-merienda.css","hash":"27da76a0357614b9fc5f0edd526b2b780dfae492","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1707290865112},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1707290865118},{"_id":"themes/tumo-next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1707290865112},{"_id":"themes/tumo-next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1707290865098},{"_id":"themes/tumo-next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1707290865107},{"_id":"themes/tumo-next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1707290865098},{"_id":"themes/tumo-next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1707290865118},{"_id":"themes/tumo-next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/pages/pages.styl","hash":"01fdaa29486e8ead332a2bf7ba1e5394a33c80bd","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1707290865098},{"_id":"themes/tumo-next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1707290865099},{"_id":"themes/tumo-next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1707290865100},{"_id":"themes/tumo-next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1707290865101},{"_id":"themes/tumo-next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1707290865098},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1707290865108},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1707290865104},{"_id":"themes/tumo-next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1707290865102},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1707290865103},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1707290865108},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1707290865111},{"_id":"themes/tumo-next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1707290865111},{"_id":"themes/tumo-next/source/images/alipay_ray.jpg","hash":"0b576d9c23d05c8496744f91b79bde4730c6bbdb","modified":1707290865105},{"_id":"themes/tumo-next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1707290865115},{"_id":"themes/tumo-next/source/images/wechat_ray.jpg","hash":"0b1dcf76a0a73c8ac0a0a984aae4a48a9198b176","modified":1707290865106},{"_id":"themes/tumo-next/source/js/src/mo.min.js","hash":"fc7ec6c51e67a25019e08d6dd5e71633b27e69ad","modified":1707290865107},{"_id":"themes/tumo-next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1707290865109},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1707290865114},{"_id":"themes/tumo-next/source/css/_schemes/Tumo/index.styl","hash":"7cc1bffaa699de8bcb303e296587a6101819ba7c","modified":1707290865103},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1707290865114},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1707290865113},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1707290865114},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1707290865114},{"_id":"themes/tumo-next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1707290865119},{"_id":"themes/tumo-next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1707290865110},{"_id":"themes/tumo-next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1707290865114},{"_id":"themes/tumo-next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1707290865118},{"_id":"public/search.xml","hash":"6f13b6ad1f2bed84f75c8512999f6690f3ffcd39","modified":1754638105739},{"_id":"public/about/index.html","hash":"22e5f0ec9c52ad0a371e70e08d4894041848256b","modified":1754638105739},{"_id":"public/links/index.html","hash":"cf49e1d0f593cea3aa28cde1d57c8f0c7e9a9ca9","modified":1754638105739},{"_id":"public/2025/08/08/å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜/index.html","hash":"b5e3ce61443e54aa8323c245c4f186bddc896621","modified":1754638105739},{"_id":"public/2025/06/01/å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜/index.html","hash":"9b8b78e6422a6d83d57afbe1758bc9bdbdfc9f21","modified":1754638105739},{"_id":"public/2025/05/08/Dockerå®‰è£…nacosä½¿ç”¨mysql/index.html","hash":"af7539f16d1a5b9d19446f6443b4f65d9716f1e5","modified":1754638105739},{"_id":"public/2025/04/18/Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥/index.html","hash":"deec8ba24a71ff9365ed7fa777dc4f4318917e01","modified":1754638105739},{"_id":"public/2025/04/01/ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡/index.html","hash":"f1dcf835977de88c7e9bfb0c32ee3c2ff38604d2","modified":1754638105739},{"_id":"public/2025/02/18/ç»•è¿‡Cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ/index.html","hash":"4f86ab1d48cb761334828bffbf85957612519953","modified":1754638105739},{"_id":"public/2025/02/07/RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£/index.html","hash":"48cd4b907cd8e36116de96e3d0c674b1111cc9bd","modified":1754638105739},{"_id":"public/2025/01/15/ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿/index.html","hash":"6704143dc73768cc0a0ed27addd9efa271828775","modified":1754638105739},{"_id":"public/2024/10/16/Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“/index.html","hash":"530a328d34db52f32d44496c553a5a5a8d95cee9","modified":1754638105739},{"_id":"public/2024/09/18/Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜/index.html","hash":"483dc736ba52062fa1e7dd2626b0f210ba749035","modified":1754638105739},{"_id":"public/2024/08/12/ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦/index.html","hash":"33899d21d405a8cda7cd0ca5402872a38b665c1a","modified":1754638105739},{"_id":"public/2024/07/25/SpringBootç›‘å¬Redisè¿‡æœŸkey/index.html","hash":"5a071fa5f8a89c190587e1fce7e6a8230e11093e","modified":1754638105739},{"_id":"public/2024/07/20/Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm/index.html","hash":"f7ecef73734f694e9fdf7c8069a25cf5f21ea3b6","modified":1754638105739},{"_id":"public/2024/06/27/Linuxå®‰è£…nginxå’Œé…ç½®https/index.html","hash":"95033708de5ccec63adb01a14a2c260620ab94e3","modified":1754638105739},{"_id":"public/2024/05/27/Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium/index.html","hash":"1a1712ac3d78544bd4ae6e91b224ca0f3457f0ed","modified":1754638105739},{"_id":"public/2024/04/17/åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚/index.html","hash":"b425c2d618087e6b36981d75af53f50fb21de56b","modified":1754638105739},{"_id":"public/2024/03/14/å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶/index.html","hash":"b38dbee4a26d489cb99054ae9b82dac4395e54ce","modified":1754638105739},{"_id":"public/2024/03/05/å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬)/index.html","hash":"8b3158b96478170a636962bc1c63c2b198d42ed1","modified":1754638105739},{"_id":"public/2024/02/07/Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024/index.html","hash":"bdc9c0eab9b6527231094f68f24cb5bec31932d6","modified":1754638105739},{"_id":"public/2024/01/31/å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜/index.html","hash":"deac7f66c8ffe658c497060099bf9a7ca0b0b1f6","modified":1754638105739},{"_id":"public/2024/01/10/Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬/index.html","hash":"1f31c789c03fc53e4a4d3ae34391f4eab0d060fa","modified":1754638105739},{"_id":"public/2024/01/04/å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)/index.html","hash":"7c87a37622692b41d5c0825a822cde05d650be2c","modified":1754638105739},{"_id":"public/2023/12/28/Node-jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6/index.html","hash":"2862ef86fd120bab95b8db5d8d9a1f6a880d1975","modified":1754638105739},{"_id":"public/2023/12/21/Linuxç¯å¢ƒä¸‹éƒ¨ç½²node-jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†/index.html","hash":"63f2a5f16df904c3cb6c5034ce5f19a4b2ae8428","modified":1754638105739},{"_id":"public/2022/07/27/Ideaå¼€å‘å¿…è£…æ’ä»¶/index.html","hash":"d8ca6e07a638daf51bd65c603a2d33bfcd9a9e3c","modified":1754638105739},{"_id":"public/2022/06/01/SpringBoot-Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬)/index.html","hash":"0a528346dcde042753865d6f1aac13d3ed31d106","modified":1754638105739},{"_id":"public/2022/06/01/SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘/index.html","hash":"eb120de1c0c380fcbc5d675037dfb48db46bd72f","modified":1754638105739},{"_id":"public/2022/06/01/SpringBootæ•´åˆMailå‘é€é‚®ä»¶-å‘é€æ¨¡æ¿é‚®ä»¶/index.html","hash":"aed8947b0048f96368075ff47737340d619cc344","modified":1754638105739},{"_id":"public/2022/06/01/SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£/index.html","hash":"d35f6f9854d15b4becbe9c32e2c066c6ad76c507","modified":1754638105739},{"_id":"public/2022/06/01/Shiroæ•´åˆRedis-ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘/index.html","hash":"55f21f17d765f397c5bf9be73eb7db84750f7bf0","modified":1754638105739},{"_id":"public/2022/06/01/SpringBootæ•´åˆHibernate-Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½/index.html","hash":"6b0ce26de5f1dc147f78dddbc51956509e593994","modified":1754638105739},{"_id":"public/2022/02/14/SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜/index.html","hash":"03917e93b0f663260e03ac733fbacdf0f341c99e","modified":1754638105739},{"_id":"public/2022/02/13/å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx/index.html","hash":"bdbd5626e7d1816246d02ec62480f21eb1f16c42","modified":1754638105739},{"_id":"public/2022/02/12/Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬)/index.html","hash":"7d7bbbe58882d1eda1867f4913eb88f0f4e01454","modified":1754638105739},{"_id":"public/2022/02/12/SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º/index.html","hash":"1f2e886c1bc8df623927f4354d7072fe27b1fbca","modified":1754638105739},{"_id":"public/2022/02/11/SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½/index.html","hash":"b082e0d739939f12c3a35097060994852d164633","modified":1754638105739},{"_id":"public/2022/02/10/Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤/index.html","hash":"a97d58fe7e127d6ee08ccaeae1cf3e1b63d621e6","modified":1754638105739},{"_id":"public/2022/02/07/Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®/index.html","hash":"d4317e5fb14d95d65efd53a1b3326c030f5f5794","modified":1754638105739},{"_id":"public/2022/02/06/Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬)/index.html","hash":"e5a683ed5024b5603ed070da438b06fd00dffdb3","modified":1754638105739},{"_id":"public/2022/02/05/Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock/index.html","hash":"2c31350d8734c40cb5b0dbeb7e0d63b36d069375","modified":1754638105739},{"_id":"public/2022/02/04/Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—/index.html","hash":"77f48d0aedd045fcfe1e63879cd0bbff8356e57b","modified":1754638105739},{"_id":"public/2022/02/03/Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—/index.html","hash":"daa7b203006d967ec0b22eab0bdff7f3141445cc","modified":1754638105739},{"_id":"public/2022/02/01/Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®/index.html","hash":"023c8587897b4cafe740f7a971bcf9ebe4160ee5","modified":1754638105739},{"_id":"public/2022/01/31/JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡/index.html","hash":"93e37908fd5a8ff4e703aba8b199dc34090d7f37","modified":1754638105739},{"_id":"public/archives/index.html","hash":"c5a5a5a819bab9073ff1dea460df621b6691be84","modified":1754638105739},{"_id":"public/archives/page/2/index.html","hash":"b1574bd6d2b456cf919a829e84f86547888da78b","modified":1754638105739},{"_id":"public/archives/page/3/index.html","hash":"eb883bcc153199ef58710924ef5680be5d392131","modified":1754638105739},{"_id":"public/archives/page/4/index.html","hash":"80ca3bc8ca902e898277ad116b5599a2824ac03e","modified":1754638105739},{"_id":"public/archives/page/5/index.html","hash":"7c2e1f3186972d3a61ad2e26134e231fbe61cbee","modified":1754638105739},{"_id":"public/archives/2022/index.html","hash":"bb22ea64b7c6363a8a62f2ee4ea370fe6cdd8644","modified":1754638105739},{"_id":"public/archives/2022/page/2/index.html","hash":"1a78285992f71fa978b0054215332ce9b04e936c","modified":1754638105739},{"_id":"public/archives/2022/01/index.html","hash":"bc40ea0af62b466fad592c564cd761ed580ab324","modified":1754638105739},{"_id":"public/archives/2022/02/index.html","hash":"e6fa77e8eaba2bbdbea7de3b8374c1d3f23b9db1","modified":1754638105739},{"_id":"public/archives/2022/02/page/2/index.html","hash":"258c462d736f4c7970e1bf60e6a529616d2fbd8f","modified":1754638105739},{"_id":"public/archives/2022/06/index.html","hash":"b4fb7080b896ff71bff35caaef2b1330ded0b40c","modified":1754638105739},{"_id":"public/archives/2022/07/index.html","hash":"98470d3e251945b092ef1166678caf13aaa92378","modified":1754638105739},{"_id":"public/archives/2023/index.html","hash":"c17d724d2a1e01877458dfe81474cc05b2030406","modified":1754638105739},{"_id":"public/archives/2023/12/index.html","hash":"464b981e5132b3188f1b1e3945037278f24f5492","modified":1754638105739},{"_id":"public/archives/2024/index.html","hash":"6bdd1049f7ef60c0fec9bebbf6006bc0acdeabe7","modified":1754638105739},{"_id":"public/archives/2024/page/2/index.html","hash":"85a5254dcdffe2ec2b38ca861cf768588fd55864","modified":1754638105739},{"_id":"public/archives/2024/01/index.html","hash":"88d47a39e9af8f1dd820e5d69e1c3c7eead4cc81","modified":1754638105739},{"_id":"public/archives/2024/02/index.html","hash":"18e9d0e6ae172033451c94021b824ac3e74ac943","modified":1754638105739},{"_id":"public/archives/2024/03/index.html","hash":"5b163dca7338f2c0cbb0b4da6380f568c86d52ea","modified":1754638105739},{"_id":"public/archives/2024/04/index.html","hash":"53357ced361c41dfef5c9af9dc08d2a39ab297fb","modified":1754638105739},{"_id":"public/archives/2024/05/index.html","hash":"3c60a58ce19c905465014a88528b78083d4109d1","modified":1754638105739},{"_id":"public/archives/2024/06/index.html","hash":"6e8b916f4902cacecd3911314f08c86cecc0266c","modified":1754638105739},{"_id":"public/archives/2024/07/index.html","hash":"9603ea429337a3df07e377ee6c56a4ec53224ed3","modified":1754638105739},{"_id":"public/archives/2024/08/index.html","hash":"e256bbc395fa25373f18fdae569309203df3ccd3","modified":1754638105739},{"_id":"public/archives/2024/09/index.html","hash":"829fbd23ad2b14ca8fd25996ee0ef5b770812bfa","modified":1754638105739},{"_id":"public/archives/2024/10/index.html","hash":"34615b31b61be315a3c98c8a38ea3a05b297a968","modified":1754638105739},{"_id":"public/archives/2025/index.html","hash":"027b1c641286214fa0629113a27e4d64239aacc1","modified":1754638105739},{"_id":"public/archives/2025/01/index.html","hash":"74a69d4b76c645c70738601c46d0186c4a496bdb","modified":1754638105739},{"_id":"public/archives/2025/02/index.html","hash":"63cd0be477e425450c227eb02306f9356bae34de","modified":1754638105739},{"_id":"public/archives/2025/04/index.html","hash":"5bb25f079bc207660a1386620bc340479866eba1","modified":1754638105739},{"_id":"public/archives/2025/05/index.html","hash":"6e3d6f4ae675396e64b250e22b2342d002947eef","modified":1754638105739},{"_id":"public/archives/2025/06/index.html","hash":"15694fd5e260087dca1bb9741e47836e79d93b25","modified":1754638105739},{"_id":"public/archives/2025/08/index.html","hash":"475cf2e084f006c48d7c30174b3d59b619560566","modified":1754638105739},{"_id":"public/index.html","hash":"437d78154ecbfd43386558da7ed5cec33af12805","modified":1754638105739},{"_id":"public/page/2/index.html","hash":"df284fbaa389ff38cff70a715d6db2c36afacd4b","modified":1754638105739},{"_id":"public/page/3/index.html","hash":"279cef7e67acad4f70924543c05bf644e367fdb7","modified":1754638105739},{"_id":"public/page/4/index.html","hash":"4372ae36e35297c72ee3cdbf1bcdfabc0761eefe","modified":1754638105739},{"_id":"public/page/5/index.html","hash":"2a750b02f3496b40c8f18705f015ed4e7beaa102","modified":1754638105739},{"_id":"public/images/alipay.png","hash":"b0074f7766dadf4b4b8792a4f41fa1ca64143668","modified":1754638105739},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1754638105739},{"_id":"public/images/favicon.ico","hash":"efd2f081ff4f0db3355aecff71ff81e291839f71","modified":1754638105739},{"_id":"public/images/avatar.jpg","hash":"efd2f081ff4f0db3355aecff71ff81e291839f71","modified":1754638105739},{"_id":"public/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1754638105739},{"_id":"public/images/qrcode_for_gh.jpg","hash":"808e5d5750699e1202b04a5007770e6183eba03b","modified":1754638105739},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1754638105739},{"_id":"public/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1754638105739},{"_id":"public/CNAME","hash":"312af994bb9a5dcebbff167f31e49e3e743f4c6d","modified":1754638105739},{"_id":"public/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1754638105739},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1754638105739},{"_id":"public/images/wechat.png","hash":"cc81c6a186f8546f6d54514d82297e2ca6c9492c","modified":1754638105739},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1754638105739},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/font-merienda.woff2","hash":"1d66fb61c8b5a6bcc004c5d36a5ed6b36ba6377f","modified":1754638105739},{"_id":"public/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1754638105739},{"_id":"public/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1754638105739},{"_id":"public/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1754638105739},{"_id":"public/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1754638105739},{"_id":"public/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1754638105739},{"_id":"public/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1754638105739},{"_id":"public/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1754638105739},{"_id":"public/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1754638105739},{"_id":"public/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1754638105739},{"_id":"public/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1754638105739},{"_id":"public/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1754638105739},{"_id":"public/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1754638105739},{"_id":"public/images/alipay_ray.jpg","hash":"0b576d9c23d05c8496744f91b79bde4730c6bbdb","modified":1754638105739},{"_id":"public/images/wechat_ray.jpg","hash":"0b1dcf76a0a73c8ac0a0a984aae4a48a9198b176","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1754638105739},{"_id":"public/css/main.css","hash":"baaf80b9edd3166f0e2e414d9d664c1f4c1e2b11","modified":1754638105739},{"_id":"public/css/tumo.css","hash":"ba017f14938ed4514fa9f78e3e56b92760aeb51c","modified":1754638105739},{"_id":"public/css/friends.css","hash":"bbf274f183889af25a39ecd1450dbb53b17c94bf","modified":1754638105739},{"_id":"public/lib/fastclick/bower.json","hash":"4dcecf83afddba148464d5339c93f6d0aa9f42e9","modified":1754638105739},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1754638105739},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1754638105739},{"_id":"public/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1754638105739},{"_id":"public/lib/fastclick/README.html","hash":"1c2cb1168e9df516e311177476e499990453965d","modified":1754638105739},{"_id":"public/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1754638105739},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1754638105739},{"_id":"public/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1754638105739},{"_id":"public/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1754638105739},{"_id":"public/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1754638105739},{"_id":"public/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1754638105739},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1754638105739},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1754638105739},{"_id":"public/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1754638105739},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1754638105739},{"_id":"public/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1754638105739},{"_id":"public/lib/velocity/bower.json","hash":"0ef14e7ccdfba5db6eb3f8fc6aa3b47282c36409","modified":1754638105739},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1754638105739},{"_id":"public/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1754638105739},{"_id":"public/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1754638105739},{"_id":"public/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1754638105739},{"_id":"public/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1754638105739},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1754638105739},{"_id":"public/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1754638105739},{"_id":"public/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1754638105739},{"_id":"public/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1754638105739},{"_id":"public/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1754638105739},{"_id":"public/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1754638105739},{"_id":"public/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1754638105739},{"_id":"public/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1754638105739},{"_id":"public/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1754638105739},{"_id":"public/lib/jquery_lazyload/CONTRIBUTING.html","hash":"bc6cf8951a99074bdc6ec9172f03fb7c0e412729","modified":1754638105739},{"_id":"public/js/src/mo.min.js","hash":"fc7ec6c51e67a25019e08d6dd5e71633b27e69ad","modified":1754638105739},{"_id":"public/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1754638105739},{"_id":"public/lib/jquery_lazyload/README.html","hash":"96a5c2cc00de5b338ae972c1e8de879d2d919608","modified":1754638105739},{"_id":"public/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1754638105739},{"_id":"public/lib/jquery_lazyload/bower.json","hash":"ae3c3b61e6e7f9e1d7e3585ad854380ecc04cf53","modified":1754638105739},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1754638105739},{"_id":"public/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1754638105739},{"_id":"public/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1754638105739},{"_id":"public/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1754638105739},{"_id":"public/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1754638105739},{"_id":"public/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1754638105739},{"_id":"public/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1754638105739},{"_id":"public/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1754638105739},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1754638105739},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1754638105739},{"_id":"public/lib/font-awesome/css/font-merienda.css","hash":"27da76a0357614b9fc5f0edd526b2b780dfae492","modified":1754638105739},{"_id":"public/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1754638105739},{"_id":"public/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1754638105739},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1754638105739},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1754638105739},{"_id":"public/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1754638105739},{"_id":"public/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1754638105739},{"_id":"public/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1754638105739},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1754638105739}],"Category":[],"Data":[],"Page":[{"title":"about","date":"2022-06-01T01:55:10.000Z","_content":"\n### ğŸ“ Worked language\n\n\n- âœ… Java /Springboot /Dubbo /...\n- âœ… Golang / Gin / ...\n- âœ… Python / Fastapi/ çˆ¬è™« / ...\n- âœ… Node.js / TypeScript/ Solidity /...\n\n### ğŸ“® Contact Me\n\n\n\n- [Email - ruiyeclub@gmail.com](ruiyeclub@gmail.com)\n\n### ğŸ¤ª Other\n\n\n\n[ğŸ“Œ My Blog](https://ruiyeclub.cn/) - ä¸ªäººåšå®¢\n\n\n\n[ğŸ“Œ ç™¾å®ç®±è´­ç‰©å¤–å–çº¿æŠ¥](https://wechat.ruiyeclub.cn/) - ä¸€ä¸ªä¸“æ³¨äºçœé’±å’Œç½‘ç»œç¾Šæ¯›ç¦åˆ©çš„å…¬ä¼—å·","source":"about/index.md","raw":"---\ntitle: about\ndate: 2022-06-01 09:55:10\n---\n\n### ğŸ“ Worked language\n\n\n- âœ… Java /Springboot /Dubbo /...\n- âœ… Golang / Gin / ...\n- âœ… Python / Fastapi/ çˆ¬è™« / ...\n- âœ… Node.js / TypeScript/ Solidity /...\n\n### ğŸ“® Contact Me\n\n\n\n- [Email - ruiyeclub@gmail.com](ruiyeclub@gmail.com)\n\n### ğŸ¤ª Other\n\n\n\n[ğŸ“Œ My Blog](https://ruiyeclub.cn/) - ä¸ªäººåšå®¢\n\n\n\n[ğŸ“Œ ç™¾å®ç®±è´­ç‰©å¤–å–çº¿æŠ¥](https://wechat.ruiyeclub.cn/) - ä¸€ä¸ªä¸“æ³¨äºçœé’±å’Œç½‘ç»œç¾Šæ¯›ç¦åˆ©çš„å…¬ä¼—å·","updated":"2024-09-21T08:45:09.565Z","path":"about/index.html","comments":1,"layout":"page","_id":"cme2i83da0000wen1cayr9kr8","content":"<h3 id=\"ğŸ“-Worked-language\"><a href=\"#ğŸ“-Worked-language\" class=\"headerlink\" title=\"ğŸ“ Worked language\"></a>ğŸ“ Worked language</h3><ul>\n<li>âœ… Java &#x2F;Springboot &#x2F;Dubbo &#x2F;â€¦</li>\n<li>âœ… Golang &#x2F; Gin &#x2F; â€¦</li>\n<li>âœ… Python &#x2F; Fastapi&#x2F; çˆ¬è™« &#x2F; â€¦</li>\n<li>âœ… Node.js &#x2F; TypeScript&#x2F; Solidity &#x2F;â€¦</li>\n</ul>\n<h3 id=\"ğŸ“®-Contact-Me\"><a href=\"#ğŸ“®-Contact-Me\" class=\"headerlink\" title=\"ğŸ“® Contact Me\"></a>ğŸ“® Contact Me</h3><ul>\n<li><a href=\"ruiyeclub@gmail.com\">Email - ruiyeclub@gmail.com</a></li>\n</ul>\n<h3 id=\"ğŸ¤ª-Other\"><a href=\"#ğŸ¤ª-Other\" class=\"headerlink\" title=\"ğŸ¤ª Other\"></a>ğŸ¤ª Other</h3><p><a href=\"https://ruiyeclub.cn/\">ğŸ“Œ My Blog</a> - ä¸ªäººåšå®¢</p>\n<p><a href=\"https://wechat.ruiyeclub.cn/\">ğŸ“Œ ç™¾å®ç®±è´­ç‰©å¤–å–çº¿æŠ¥</a> - ä¸€ä¸ªä¸“æ³¨äºçœé’±å’Œç½‘ç»œç¾Šæ¯›ç¦åˆ©çš„å…¬ä¼—å·</p>\n","excerpt":"","more":"<h3 id=\"ğŸ“-Worked-language\"><a href=\"#ğŸ“-Worked-language\" class=\"headerlink\" title=\"ğŸ“ Worked language\"></a>ğŸ“ Worked language</h3><ul>\n<li>âœ… Java &#x2F;Springboot &#x2F;Dubbo &#x2F;â€¦</li>\n<li>âœ… Golang &#x2F; Gin &#x2F; â€¦</li>\n<li>âœ… Python &#x2F; Fastapi&#x2F; çˆ¬è™« &#x2F; â€¦</li>\n<li>âœ… Node.js &#x2F; TypeScript&#x2F; Solidity &#x2F;â€¦</li>\n</ul>\n<h3 id=\"ğŸ“®-Contact-Me\"><a href=\"#ğŸ“®-Contact-Me\" class=\"headerlink\" title=\"ğŸ“® Contact Me\"></a>ğŸ“® Contact Me</h3><ul>\n<li><a href=\"ruiyeclub@gmail.com\">Email - ruiyeclub@gmail.com</a></li>\n</ul>\n<h3 id=\"ğŸ¤ª-Other\"><a href=\"#ğŸ¤ª-Other\" class=\"headerlink\" title=\"ğŸ¤ª Other\"></a>ğŸ¤ª Other</h3><p><a href=\"https://ruiyeclub.cn/\">ğŸ“Œ My Blog</a> - ä¸ªäººåšå®¢</p>\n<p><a href=\"https://wechat.ruiyeclub.cn/\">ğŸ“Œ ç™¾å®ç®±è´­ç‰©å¤–å–çº¿æŠ¥</a> - ä¸€ä¸ªä¸“æ³¨äºçœé’±å’Œç½‘ç»œç¾Šæ¯›ç¦åˆ©çš„å…¬ä¼—å·</p>\n"},{"title":"links","date":"2022-06-01T01:55:49.000Z","_content":"\n### ç”³è¯·è¦æ±‚ï¼š\n\n1ã€å†…å®¹æŒç»­æ›´æ–°ä¸”å¯ä»¥ç¨³å®šè®¿é—®\n2ã€ç½‘é¡µæ•´æ´æ— ç¹æ‚å¹¿å‘Šæ¨å¹¿\n3ã€åšå®¢ä¸»é¡µè¢«ç™¾åº¦æˆ–è°·æ­Œç­‰æœç´¢å¼•æ“æ”¶å½•\n4ã€å¤´åƒèƒ½å¤Ÿå¿«é€ŸåŠ è½½\n5ã€æ‹¥æœ‰ç‹¬ç«‹åŸŸå\n\n### å‹é“¾å£°æ˜ï¼š\n\n1ã€æœ¬ç«™ä¼šå®šæœŸæ¸…ç†æ— æ³•è®¿é—®çš„å‹é“¾ï¼Œå¦‚æœæ›´æ¢äº†é“¾æ¥ä¿¡æ¯è¯·è‡³è¯„è®ºåŒºç•™è¨€ï¼Œè°¢è°¢åˆä½œï¼\n2ã€æœ¬ç«™ä¼šå®šæœŸæŸ¥çœ‹åŒæ–¹æ˜¯å¦äº’ä¸ºå‹é“¾ï¼Œå¦‚æœå–æ¶ˆæœ¬ç«™å‹é“¾ï¼Œæœ¬ç«™ä¹Ÿä¼šå°†æ‚¨çš„å‹é“¾ç§»é™¤\n\n### ç”³è¯·æ–¹å¼ï¼š\n\nå…ˆå°†æœ¬ç«™çš„å‹é“¾æ·»åŠ åˆ°æ‚¨çš„å‹é“¾ï¼Œç›¸å…³ä¿¡æ¯å¦‚ä¸‹\nç„¶åæŒ‰ç…§ä»¥ä¸‹æ ¼å¼åœ¨æœ¬ç«™ç•™è¨€åŒºç•™è¨€ï¼Œå¾…åšä¸»ä¸ºæ‚¨æ·»ä¸Šå‹é“¾\n\n>åç§°ï¼šTiançš„æ–‡æ¡£\nå¤´åƒé“¾æ¥ï¼šhttps://ttlikeu.top/images/ico/favicon.ico\nä¸»é¡µé“¾æ¥ï¼šhttps://ttlikeu.top/\nè¯´æ˜ä¿¡æ¯ï¼šäººç”Ÿåœ¨å‹¤ï¼Œä¸ç´¢ä½•è·\n","source":"links/index.md","raw":"---\ntitle: links\ndate: 2022-06-01 09:55:49\n---\n\n### ç”³è¯·è¦æ±‚ï¼š\n\n1ã€å†…å®¹æŒç»­æ›´æ–°ä¸”å¯ä»¥ç¨³å®šè®¿é—®\n2ã€ç½‘é¡µæ•´æ´æ— ç¹æ‚å¹¿å‘Šæ¨å¹¿\n3ã€åšå®¢ä¸»é¡µè¢«ç™¾åº¦æˆ–è°·æ­Œç­‰æœç´¢å¼•æ“æ”¶å½•\n4ã€å¤´åƒèƒ½å¤Ÿå¿«é€ŸåŠ è½½\n5ã€æ‹¥æœ‰ç‹¬ç«‹åŸŸå\n\n### å‹é“¾å£°æ˜ï¼š\n\n1ã€æœ¬ç«™ä¼šå®šæœŸæ¸…ç†æ— æ³•è®¿é—®çš„å‹é“¾ï¼Œå¦‚æœæ›´æ¢äº†é“¾æ¥ä¿¡æ¯è¯·è‡³è¯„è®ºåŒºç•™è¨€ï¼Œè°¢è°¢åˆä½œï¼\n2ã€æœ¬ç«™ä¼šå®šæœŸæŸ¥çœ‹åŒæ–¹æ˜¯å¦äº’ä¸ºå‹é“¾ï¼Œå¦‚æœå–æ¶ˆæœ¬ç«™å‹é“¾ï¼Œæœ¬ç«™ä¹Ÿä¼šå°†æ‚¨çš„å‹é“¾ç§»é™¤\n\n### ç”³è¯·æ–¹å¼ï¼š\n\nå…ˆå°†æœ¬ç«™çš„å‹é“¾æ·»åŠ åˆ°æ‚¨çš„å‹é“¾ï¼Œç›¸å…³ä¿¡æ¯å¦‚ä¸‹\nç„¶åæŒ‰ç…§ä»¥ä¸‹æ ¼å¼åœ¨æœ¬ç«™ç•™è¨€åŒºç•™è¨€ï¼Œå¾…åšä¸»ä¸ºæ‚¨æ·»ä¸Šå‹é“¾\n\n>åç§°ï¼šTiançš„æ–‡æ¡£\nå¤´åƒé“¾æ¥ï¼šhttps://ttlikeu.top/images/ico/favicon.ico\nä¸»é¡µé“¾æ¥ï¼šhttps://ttlikeu.top/\nè¯´æ˜ä¿¡æ¯ï¼šäººç”Ÿåœ¨å‹¤ï¼Œä¸ç´¢ä½•è·\n","updated":"2024-02-07T07:27:45.074Z","path":"links/index.html","comments":1,"layout":"page","_id":"cme2i83df0002wen1agnn4x9x","content":"<h3 id=\"ç”³è¯·è¦æ±‚ï¼š\"><a href=\"#ç”³è¯·è¦æ±‚ï¼š\" class=\"headerlink\" title=\"ç”³è¯·è¦æ±‚ï¼š\"></a>ç”³è¯·è¦æ±‚ï¼š</h3><p>1ã€å†…å®¹æŒç»­æ›´æ–°ä¸”å¯ä»¥ç¨³å®šè®¿é—®<br>2ã€ç½‘é¡µæ•´æ´æ— ç¹æ‚å¹¿å‘Šæ¨å¹¿<br>3ã€åšå®¢ä¸»é¡µè¢«ç™¾åº¦æˆ–è°·æ­Œç­‰æœç´¢å¼•æ“æ”¶å½•<br>4ã€å¤´åƒèƒ½å¤Ÿå¿«é€ŸåŠ è½½<br>5ã€æ‹¥æœ‰ç‹¬ç«‹åŸŸå</p>\n<h3 id=\"å‹é“¾å£°æ˜ï¼š\"><a href=\"#å‹é“¾å£°æ˜ï¼š\" class=\"headerlink\" title=\"å‹é“¾å£°æ˜ï¼š\"></a>å‹é“¾å£°æ˜ï¼š</h3><p>1ã€æœ¬ç«™ä¼šå®šæœŸæ¸…ç†æ— æ³•è®¿é—®çš„å‹é“¾ï¼Œå¦‚æœæ›´æ¢äº†é“¾æ¥ä¿¡æ¯è¯·è‡³è¯„è®ºåŒºç•™è¨€ï¼Œè°¢è°¢åˆä½œï¼<br>2ã€æœ¬ç«™ä¼šå®šæœŸæŸ¥çœ‹åŒæ–¹æ˜¯å¦äº’ä¸ºå‹é“¾ï¼Œå¦‚æœå–æ¶ˆæœ¬ç«™å‹é“¾ï¼Œæœ¬ç«™ä¹Ÿä¼šå°†æ‚¨çš„å‹é“¾ç§»é™¤</p>\n<h3 id=\"ç”³è¯·æ–¹å¼ï¼š\"><a href=\"#ç”³è¯·æ–¹å¼ï¼š\" class=\"headerlink\" title=\"ç”³è¯·æ–¹å¼ï¼š\"></a>ç”³è¯·æ–¹å¼ï¼š</h3><p>å…ˆå°†æœ¬ç«™çš„å‹é“¾æ·»åŠ åˆ°æ‚¨çš„å‹é“¾ï¼Œç›¸å…³ä¿¡æ¯å¦‚ä¸‹<br>ç„¶åæŒ‰ç…§ä»¥ä¸‹æ ¼å¼åœ¨æœ¬ç«™ç•™è¨€åŒºç•™è¨€ï¼Œå¾…åšä¸»ä¸ºæ‚¨æ·»ä¸Šå‹é“¾</p>\n<blockquote>\n<p>åç§°ï¼šTiançš„æ–‡æ¡£<br>å¤´åƒé“¾æ¥ï¼š<a href=\"https://ttlikeu.top/images/ico/favicon.ico\">https://ttlikeu.top/images/ico/favicon.ico</a><br>ä¸»é¡µé“¾æ¥ï¼š<a href=\"https://ttlikeu.top/\">https://ttlikeu.top/</a><br>è¯´æ˜ä¿¡æ¯ï¼šäººç”Ÿåœ¨å‹¤ï¼Œä¸ç´¢ä½•è·</p>\n</blockquote>\n","excerpt":"","more":"<h3 id=\"ç”³è¯·è¦æ±‚ï¼š\"><a href=\"#ç”³è¯·è¦æ±‚ï¼š\" class=\"headerlink\" title=\"ç”³è¯·è¦æ±‚ï¼š\"></a>ç”³è¯·è¦æ±‚ï¼š</h3><p>1ã€å†…å®¹æŒç»­æ›´æ–°ä¸”å¯ä»¥ç¨³å®šè®¿é—®<br>2ã€ç½‘é¡µæ•´æ´æ— ç¹æ‚å¹¿å‘Šæ¨å¹¿<br>3ã€åšå®¢ä¸»é¡µè¢«ç™¾åº¦æˆ–è°·æ­Œç­‰æœç´¢å¼•æ“æ”¶å½•<br>4ã€å¤´åƒèƒ½å¤Ÿå¿«é€ŸåŠ è½½<br>5ã€æ‹¥æœ‰ç‹¬ç«‹åŸŸå</p>\n<h3 id=\"å‹é“¾å£°æ˜ï¼š\"><a href=\"#å‹é“¾å£°æ˜ï¼š\" class=\"headerlink\" title=\"å‹é“¾å£°æ˜ï¼š\"></a>å‹é“¾å£°æ˜ï¼š</h3><p>1ã€æœ¬ç«™ä¼šå®šæœŸæ¸…ç†æ— æ³•è®¿é—®çš„å‹é“¾ï¼Œå¦‚æœæ›´æ¢äº†é“¾æ¥ä¿¡æ¯è¯·è‡³è¯„è®ºåŒºç•™è¨€ï¼Œè°¢è°¢åˆä½œï¼<br>2ã€æœ¬ç«™ä¼šå®šæœŸæŸ¥çœ‹åŒæ–¹æ˜¯å¦äº’ä¸ºå‹é“¾ï¼Œå¦‚æœå–æ¶ˆæœ¬ç«™å‹é“¾ï¼Œæœ¬ç«™ä¹Ÿä¼šå°†æ‚¨çš„å‹é“¾ç§»é™¤</p>\n<h3 id=\"ç”³è¯·æ–¹å¼ï¼š\"><a href=\"#ç”³è¯·æ–¹å¼ï¼š\" class=\"headerlink\" title=\"ç”³è¯·æ–¹å¼ï¼š\"></a>ç”³è¯·æ–¹å¼ï¼š</h3><p>å…ˆå°†æœ¬ç«™çš„å‹é“¾æ·»åŠ åˆ°æ‚¨çš„å‹é“¾ï¼Œç›¸å…³ä¿¡æ¯å¦‚ä¸‹<br>ç„¶åæŒ‰ç…§ä»¥ä¸‹æ ¼å¼åœ¨æœ¬ç«™ç•™è¨€åŒºç•™è¨€ï¼Œå¾…åšä¸»ä¸ºæ‚¨æ·»ä¸Šå‹é“¾</p>\n<blockquote>\n<p>åç§°ï¼šTiançš„æ–‡æ¡£<br>å¤´åƒé“¾æ¥ï¼š<a href=\"https://ttlikeu.top/images/ico/favicon.ico\">https://ttlikeu.top/images/ico/favicon.ico</a><br>ä¸»é¡µé“¾æ¥ï¼š<a href=\"https://ttlikeu.top/\">https://ttlikeu.top/</a><br>è¯´æ˜ä¿¡æ¯ï¼šäººç”Ÿåœ¨å‹¤ï¼Œä¸ç´¢ä½•è·</p>\n</blockquote>\n"}],"Post":[{"title":"Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤","date":"2022-02-10T09:35:40.000Z","_content":"\n## ä¸€ã€Docker Composeä»‹ç»\n> https://docs.docker.com/compose/\n\nDockerå®˜æ–¹çš„ç½‘ç«™æ˜¯è¿™æ ·ä»‹ç»Docker Composeçš„ï¼š\n\n**Composeæ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä»é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚**\n\nè¿™é‡ŒDocker Composeç»™æˆ‘çš„æ„Ÿå—å°±æ˜¯ä¾¿æ·ã€å¿«é€Ÿã€‚åªéœ€ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤docker-compose up -dï¼Œè¿™é‡Œå°±å¯ä»¥æ­å»ºå¤šä¸ªæœåŠ¡èµ·æ¥ï¼Œéå¸¸é€‚åˆæ­å»ºé›†ç¾¤ç¯å¢ƒã€‚\n\n## äºŒã€å®‰è£…Docker Composeå·¥å…·\n\né€šè¿‡å‘½ä»¤å®‰è£…Composeå·¥å…·ï¼Œå®‰è£…Composeçš„å‰ææ˜¯å®‰è£…äº†Dockerç¯å¢ƒï¼Œå¦‚ä½•å®‰è£…å’Œå¿«é€Ÿä½¿ç”¨Dockerï¼Œå¯ä»¥ç¿»çœ‹æˆ‘ä¹‹å‰çš„é‚£ç¯‡åšå®¢--[](Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹æ­å»ºSpringBooté¡¹ç›®)ï¼Œè¿™é‡Œä¸åšèµ˜è¿°äº†ã€‚\n```xml\nsudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose\n```\nç»™å®‰è£…è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™\n```xml\nsudo chmod +x /usr/local/bin/docker-compose\n```\nè¿™é‡Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ\n```xml\ndocker-compose -v\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/51ea38aadbb2ff6e09252ef863d8b8ef.png)\nåˆ°è¿™é‡ŒComposeå·¥å…·å°±å®‰è£…å¥½äº†\n\n## ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\n\n**ä¸»ä»å¤åˆ¶**ï¼šä¸»èŠ‚ç‚¹è´Ÿè´£å†™æ•°æ®ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»æ•°æ®ï¼Œä¸»èŠ‚ç‚¹å®šæœŸæŠŠæ•°æ®åŒæ­¥åˆ°ä»èŠ‚ç‚¹ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚\n\nä»æ€§èƒ½æ–¹é¢ï¼Œrediså¤åˆ¶åŠŸèƒ½å¢åŠ äº†è¯»çš„æ€§èƒ½ï¼Œç†è®ºä¸Šè¯´ï¼Œæ¯å¢åŠ ä¸€å€çš„æœåŠ¡å™¨ï¼Œæ•´ä¸ªç³»ç»Ÿçš„è¯»èƒ½åŠ›å°±å¢åŠ ä¸€å€ã€‚\n\né€‰æ‹©å¥½è·¯å¾„ï¼Œé€šè¿‡å‘½ä»¤åˆ›å»ºæ–‡ä»¶å¤¹redisï¼Œç„¶åè¿›å…¥æ–‡ä»¶å¤¹åˆ›å»ºdocker-compose.ymlï¼Œæˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºï¼Œç„¶åé€šè¿‡Xftpå·¥å…·ä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚docker-compose.ymlå†™å…¥å¦‚ä¸‹å†…å®¹ã€‚\n\n```xml\nversion: '2'\nservices:\n  master:\n    image: redisã€€ã€€ã€€ã€€## é•œåƒ\n    container_name: redis-masterã€€ã€€ã€€ã€€##å®¹å™¨åˆ«å\n    command: redis-server --requirepass 123456ã€€ã€€ã€€ã€€##rediså¯†ç \n    ports:\n    - \"6379:6379\"ã€€ã€€ã€€ã€€##æš´éœ²ç«¯å£\n    networks:\n    - sentinel-master\n  slave1:\n    image: redis\n    container_name: redis-slave-1\n    ports:\n    - \"6380:6379\"\n    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456 \n    depends_on:\n    - master\n    networks:\n    - sentinel-master\n  slave2:\n    image: redis\n    container_name: redis-slave-2\n    ports:\n    - \"6381:6379\"\n    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456\n    depends_on:\n    - master\n    networks:\n    - sentinel-master\n```\nå¯åŠ¨redisé›†ç¾¤\n```xml\ndocker-compose up -d\n```\ndocker psæŸ¥çœ‹è¿è¡Œçš„å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸»èŠ‚ç‚¹çš„ipåœ°å€ï¼Œæ³¨æ„ä¸æ˜¯ç”µè„‘çš„ipå“¦ï¼Œæ˜¯èŠ‚ç‚¹çš„ipåœ°å€ã€‚\n```xml\ndocker inspect ä¸»èŠ‚ç‚¹å®¹å™¨id\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/53f49345df59e36ee71202f08c7f8d94.png)\nè¿™é‡Œå…ˆè®°ç€è¿™ä¸ªipåœ°å€ï¼Œåé¢ä½¿ç”¨åˆ°å“¨å…µéœ€è¦ç»‘å®šè¿™ä¸ªä¸»èŠ‚ç‚¹çš„ipã€‚\n\n## å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\n\nä¸Šé¢æˆ‘ä»¬å·²ç»æ­å»ºå¥½äº†ä¸»ä»æ¨¡å¼ï¼Œå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°æœåŠ¡å™¨åˆ‡æ¢æˆä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œéœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘**å“¨å…µæ¨¡å¼**ã€‚\nå“¨å…µæ˜¯redisé«˜å¯ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å°†è¯¥ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä¼˜å…ˆçš„ä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œç”±è¿™ä¸ªä¸»æœåŠ¡å™¨ä»£æ›¿å·²ä¸‹çº¿çš„ä¸»æœåŠ¡å™¨ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚\n \nå“¨å…µçš„åŠŸèƒ½ï¼š\n1.ç›‘æ§ï¼šå“¨å…µä¼šä¸æ–­åœ°ç›‘æ§æ£€æµ‹ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚\n2.è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šå½“ä¸»èŠ‚ç‚¹ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚\n3.é€šçŸ¥ï¼šå“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚\n4.é…ç½®æä¾›è€…ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚\n \nè¿™é‡Œåˆ›å»ºsentinelæ–‡ä»¶å¤¹ï¼Œç„¶ååŒæ ·ç¼–å†™docker-compose.ymlæ–‡ä»¶\n```xml\nversion: '2'\nservices:\n  sentinel1:\n    image: redis       ## é•œåƒ\n    container_name: redis-sentinel-1\n    ports:\n    - \"26379:26379\"\n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - \"./sentinel.conf:/usr/local/etc/redis/sentinel.conf\"\n  sentinel2:\n    image: redis                ## é•œåƒ\n    container_name: redis-sentinel-2\n    ports:\n    - \"26380:26379\"           \n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - \"./sentinel2.conf:/usr/local/etc/redis/sentinel.conf\"\n  sentinel3:\n    image: redis                ## é•œåƒ\n    container_name: redis-sentinel-3\n    ports:\n    - \"26381:26379\"           \n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf\nnetworks:\n  default:\n    external:\n      name: redis_sentinel-master\n```\nç»§ç»­åœ¨æ­¤ç›®å½•ç¼–å†™æ–‡ä»¶ï¼Œç¼–å†™sentinel.confæ–‡ä»¶\n```xml\nport 26379\ndir /tmp\n#172.18.0.3å¡«å†™è‡ªå·±çš„ä¸»èŠ‚ç‚¹ip\nsentinel monitor mymaster 172.18.0.3 6379 2\nsentinel auth-pass mymaster 123456 \nsentinel down-after-milliseconds mymaster 30000\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 10000  \nsentinel deny-scripts-reconfig yes\n```\nå¯¹å‘½ä»¤çš„è§£é‡Š\n\n> ç¬¬ä¸‰è¡Œè¡¨ç¤ºRedisç›‘æ§ä¸€ä¸ªå«åšmymasterçš„è¿è¡Œåœ¨172.18.0.3:6379çš„masterï¼ŒæŠ•ç¥¨è¾¾åˆ°2åˆ™è¡¨ç¤ºmasterä»¥åŠæŒ‚æ‰äº†ã€‚\nç¬¬å››è¡Œè®¾ç½®ä¸»èŠ‚ç‚¹çš„å¯†ç ã€‚\nç¬¬äº”è¡Œè¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´èŒƒå›´å†…sentinelå‘masterå‘é€çš„å¿ƒè·³PINGæ²¡æœ‰å›å¤åˆ™è®¤ä¸ºmasterä¸å¯ç”¨äº†ã€‚\nç¬¬å…­è¡Œçš„parallel-syncsè¡¨ç¤ºè®¾ç½®åœ¨æ•…éšœè½¬ç§»ä¹‹åï¼ŒåŒæ—¶å¯ä»¥é‡æ–°é…ç½®ä½¿ç”¨æ–°masterçš„slaveçš„æ•°é‡ã€‚æ•°å­—è¶Šä½ï¼Œæ›´å¤šçš„æ—¶é—´å°†ä¼šç”¨æ•…éšœè½¬ç§»å®Œæˆï¼Œä½†æ˜¯å¦‚æœslavesé…ç½®ä¸ºæœåŠ¡æ—§æ•°æ®ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›æ‰€æœ‰çš„slaveåŒæ—¶é‡æ–°åŒæ­¥masterã€‚å› ä¸ºä¸»ä»å¤åˆ¶å¯¹äºslaveæ˜¯éé˜»å¡çš„ï¼Œå½“åœæ­¢ä»masteråŠ è½½æ‰¹é‡æ•°æ®æ—¶æœ‰ä¸€ä¸ªç‰‡åˆ»å»¶è¿Ÿã€‚é€šè¿‡è®¾ç½®é€‰é¡¹ä¸º1ï¼Œç¡®ä¿¡æ¯æ¬¡åªæœ‰ä¸€ä¸ªslaveæ˜¯ä¸å¯åˆ°è¾¾çš„ã€‚\nç¬¬ä¸ƒè¡Œè¡¨ç¤º10ç§’å†…mymasterè¿˜æ²¡æ´»è¿‡æ¥ï¼Œåˆ™è®¤ä¸ºmasterå®•æœºäº†ã€‚\n\nåˆ›å»ºå¥½æ–‡ä»¶åï¼Œå¤åˆ¶å¥½ä¸‰ä»½\n```xml\ncp sentinel.conf sentinel1.conf\ncp sentinel.conf sentinel2.conf\ncp sentinel.conf sentinel3.conf\n```\nå¯åŠ¨rediså“¨å…µæ¨¡å¼\n```xml\ndocker-compose up -d\n```\n## äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\nä¸Šé¢æ—¢ç„¶è¯´åˆ°äº†å“¨å…µå¯ä»¥è‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯å½“ä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œå®ƒä»¬èƒ½é€šè¿‡é€‰ä¸¾åˆ¶åº¦ï¼Œåœ¨ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹æ¥ä»£æ›¿ä¸»èŠ‚ç‚¹ã€‚\n\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸»èŠ‚ç‚¹æ­¤æ—¶çš„ä¿¡æ¯ï¼Œè¿™é‡Œa288c55db497æ˜¯æˆ‘ä¸»èŠ‚ç‚¹å®¹å™¨çš„ipï¼Œè¿™é‡Œå…ˆæ˜¯è¿›å…¥å®¹å™¨ï¼Œå†è¿›å…¥rediså®¢æˆ·ç«¯ï¼Œå†è¾“å…¥å¯†ç ï¼Œç„¶åä½¿ç”¨infoæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/b78632e11091376763eb17eb0a456666.png)\nè¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„èº«ä»½æ˜¯masterä¹Ÿå°±æ˜¯ä¸»èŠ‚ç‚¹ï¼Œç„¶åæœ‰ä¸¤ä¸ªè¿æ¥ç€çš„ä»èŠ‚ç‚¹\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/29b59a2b56a62e32552c35bf626817e4.png)\n\nç°åœ¨æˆ‘ä»¬åœæ‰è¿™ä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å“¨å…µæ˜¯å¦å¯ä»¥å®ç°æ•…éšœè½¬ç§»\n```xml\ndocker stop a288c55db497\n```\nç„¶åé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹è¿›å…¥å®¢æˆ·ç«¯ï¼Œè¾“å…¥infoæŸ¥çœ‹ä¿¡æ¯\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/81c6dc9c59ee6ff27dd01d9aabad7827.png)\nè¿™é‡Œå‘ç°å…¶ä¸­ä¸€å°ä»èŠ‚ç‚¹å·²ç»å˜æˆä¸»èŠ‚ç‚¹äº†ï¼Œè€Œä¸”è¿æ¥çš„ä»èŠ‚ç‚¹ï¼Œä¹Ÿå˜æˆäº†ä¸€ä¸ªã€‚\n\näº†è§£Docker Composeå¯å‚è€ƒï¼šhttps://www.jianshu.com/p/658911a8cff3\n\näº†è§£Redisä¸»ä»å“¨å…µå¯å‚è€ƒï¼šhttps://www.cnblogs.com/leeSmall/p/8398401.html","source":"_posts/Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤.md","raw":"---\ntitle: Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤\ndate: 2022-02-10 17:35:40\ntags:\n---\n\n## ä¸€ã€Docker Composeä»‹ç»\n> https://docs.docker.com/compose/\n\nDockerå®˜æ–¹çš„ç½‘ç«™æ˜¯è¿™æ ·ä»‹ç»Docker Composeçš„ï¼š\n\n**Composeæ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä»é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚**\n\nè¿™é‡ŒDocker Composeç»™æˆ‘çš„æ„Ÿå—å°±æ˜¯ä¾¿æ·ã€å¿«é€Ÿã€‚åªéœ€ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤docker-compose up -dï¼Œè¿™é‡Œå°±å¯ä»¥æ­å»ºå¤šä¸ªæœåŠ¡èµ·æ¥ï¼Œéå¸¸é€‚åˆæ­å»ºé›†ç¾¤ç¯å¢ƒã€‚\n\n## äºŒã€å®‰è£…Docker Composeå·¥å…·\n\né€šè¿‡å‘½ä»¤å®‰è£…Composeå·¥å…·ï¼Œå®‰è£…Composeçš„å‰ææ˜¯å®‰è£…äº†Dockerç¯å¢ƒï¼Œå¦‚ä½•å®‰è£…å’Œå¿«é€Ÿä½¿ç”¨Dockerï¼Œå¯ä»¥ç¿»çœ‹æˆ‘ä¹‹å‰çš„é‚£ç¯‡åšå®¢--[](Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹æ­å»ºSpringBooté¡¹ç›®)ï¼Œè¿™é‡Œä¸åšèµ˜è¿°äº†ã€‚\n```xml\nsudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose\n```\nç»™å®‰è£…è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™\n```xml\nsudo chmod +x /usr/local/bin/docker-compose\n```\nè¿™é‡Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ\n```xml\ndocker-compose -v\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/51ea38aadbb2ff6e09252ef863d8b8ef.png)\nåˆ°è¿™é‡ŒComposeå·¥å…·å°±å®‰è£…å¥½äº†\n\n## ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\n\n**ä¸»ä»å¤åˆ¶**ï¼šä¸»èŠ‚ç‚¹è´Ÿè´£å†™æ•°æ®ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»æ•°æ®ï¼Œä¸»èŠ‚ç‚¹å®šæœŸæŠŠæ•°æ®åŒæ­¥åˆ°ä»èŠ‚ç‚¹ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚\n\nä»æ€§èƒ½æ–¹é¢ï¼Œrediså¤åˆ¶åŠŸèƒ½å¢åŠ äº†è¯»çš„æ€§èƒ½ï¼Œç†è®ºä¸Šè¯´ï¼Œæ¯å¢åŠ ä¸€å€çš„æœåŠ¡å™¨ï¼Œæ•´ä¸ªç³»ç»Ÿçš„è¯»èƒ½åŠ›å°±å¢åŠ ä¸€å€ã€‚\n\né€‰æ‹©å¥½è·¯å¾„ï¼Œé€šè¿‡å‘½ä»¤åˆ›å»ºæ–‡ä»¶å¤¹redisï¼Œç„¶åè¿›å…¥æ–‡ä»¶å¤¹åˆ›å»ºdocker-compose.ymlï¼Œæˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºï¼Œç„¶åé€šè¿‡Xftpå·¥å…·ä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚docker-compose.ymlå†™å…¥å¦‚ä¸‹å†…å®¹ã€‚\n\n```xml\nversion: '2'\nservices:\n  master:\n    image: redisã€€ã€€ã€€ã€€## é•œåƒ\n    container_name: redis-masterã€€ã€€ã€€ã€€##å®¹å™¨åˆ«å\n    command: redis-server --requirepass 123456ã€€ã€€ã€€ã€€##rediså¯†ç \n    ports:\n    - \"6379:6379\"ã€€ã€€ã€€ã€€##æš´éœ²ç«¯å£\n    networks:\n    - sentinel-master\n  slave1:\n    image: redis\n    container_name: redis-slave-1\n    ports:\n    - \"6380:6379\"\n    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456 \n    depends_on:\n    - master\n    networks:\n    - sentinel-master\n  slave2:\n    image: redis\n    container_name: redis-slave-2\n    ports:\n    - \"6381:6379\"\n    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456\n    depends_on:\n    - master\n    networks:\n    - sentinel-master\n```\nå¯åŠ¨redisé›†ç¾¤\n```xml\ndocker-compose up -d\n```\ndocker psæŸ¥çœ‹è¿è¡Œçš„å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸»èŠ‚ç‚¹çš„ipåœ°å€ï¼Œæ³¨æ„ä¸æ˜¯ç”µè„‘çš„ipå“¦ï¼Œæ˜¯èŠ‚ç‚¹çš„ipåœ°å€ã€‚\n```xml\ndocker inspect ä¸»èŠ‚ç‚¹å®¹å™¨id\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/53f49345df59e36ee71202f08c7f8d94.png)\nè¿™é‡Œå…ˆè®°ç€è¿™ä¸ªipåœ°å€ï¼Œåé¢ä½¿ç”¨åˆ°å“¨å…µéœ€è¦ç»‘å®šè¿™ä¸ªä¸»èŠ‚ç‚¹çš„ipã€‚\n\n## å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\n\nä¸Šé¢æˆ‘ä»¬å·²ç»æ­å»ºå¥½äº†ä¸»ä»æ¨¡å¼ï¼Œå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°æœåŠ¡å™¨åˆ‡æ¢æˆä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œéœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘**å“¨å…µæ¨¡å¼**ã€‚\nå“¨å…µæ˜¯redisé«˜å¯ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å°†è¯¥ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä¼˜å…ˆçš„ä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œç”±è¿™ä¸ªä¸»æœåŠ¡å™¨ä»£æ›¿å·²ä¸‹çº¿çš„ä¸»æœåŠ¡å™¨ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚\n \nå“¨å…µçš„åŠŸèƒ½ï¼š\n1.ç›‘æ§ï¼šå“¨å…µä¼šä¸æ–­åœ°ç›‘æ§æ£€æµ‹ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚\n2.è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šå½“ä¸»èŠ‚ç‚¹ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚\n3.é€šçŸ¥ï¼šå“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚\n4.é…ç½®æä¾›è€…ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚\n \nè¿™é‡Œåˆ›å»ºsentinelæ–‡ä»¶å¤¹ï¼Œç„¶ååŒæ ·ç¼–å†™docker-compose.ymlæ–‡ä»¶\n```xml\nversion: '2'\nservices:\n  sentinel1:\n    image: redis       ## é•œåƒ\n    container_name: redis-sentinel-1\n    ports:\n    - \"26379:26379\"\n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - \"./sentinel.conf:/usr/local/etc/redis/sentinel.conf\"\n  sentinel2:\n    image: redis                ## é•œåƒ\n    container_name: redis-sentinel-2\n    ports:\n    - \"26380:26379\"           \n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - \"./sentinel2.conf:/usr/local/etc/redis/sentinel.conf\"\n  sentinel3:\n    image: redis                ## é•œåƒ\n    container_name: redis-sentinel-3\n    ports:\n    - \"26381:26379\"           \n    command: redis-sentinel /usr/local/etc/redis/sentinel.conf\n    volumes:\n    - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf\nnetworks:\n  default:\n    external:\n      name: redis_sentinel-master\n```\nç»§ç»­åœ¨æ­¤ç›®å½•ç¼–å†™æ–‡ä»¶ï¼Œç¼–å†™sentinel.confæ–‡ä»¶\n```xml\nport 26379\ndir /tmp\n#172.18.0.3å¡«å†™è‡ªå·±çš„ä¸»èŠ‚ç‚¹ip\nsentinel monitor mymaster 172.18.0.3 6379 2\nsentinel auth-pass mymaster 123456 \nsentinel down-after-milliseconds mymaster 30000\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 10000  \nsentinel deny-scripts-reconfig yes\n```\nå¯¹å‘½ä»¤çš„è§£é‡Š\n\n> ç¬¬ä¸‰è¡Œè¡¨ç¤ºRedisç›‘æ§ä¸€ä¸ªå«åšmymasterçš„è¿è¡Œåœ¨172.18.0.3:6379çš„masterï¼ŒæŠ•ç¥¨è¾¾åˆ°2åˆ™è¡¨ç¤ºmasterä»¥åŠæŒ‚æ‰äº†ã€‚\nç¬¬å››è¡Œè®¾ç½®ä¸»èŠ‚ç‚¹çš„å¯†ç ã€‚\nç¬¬äº”è¡Œè¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´èŒƒå›´å†…sentinelå‘masterå‘é€çš„å¿ƒè·³PINGæ²¡æœ‰å›å¤åˆ™è®¤ä¸ºmasterä¸å¯ç”¨äº†ã€‚\nç¬¬å…­è¡Œçš„parallel-syncsè¡¨ç¤ºè®¾ç½®åœ¨æ•…éšœè½¬ç§»ä¹‹åï¼ŒåŒæ—¶å¯ä»¥é‡æ–°é…ç½®ä½¿ç”¨æ–°masterçš„slaveçš„æ•°é‡ã€‚æ•°å­—è¶Šä½ï¼Œæ›´å¤šçš„æ—¶é—´å°†ä¼šç”¨æ•…éšœè½¬ç§»å®Œæˆï¼Œä½†æ˜¯å¦‚æœslavesé…ç½®ä¸ºæœåŠ¡æ—§æ•°æ®ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›æ‰€æœ‰çš„slaveåŒæ—¶é‡æ–°åŒæ­¥masterã€‚å› ä¸ºä¸»ä»å¤åˆ¶å¯¹äºslaveæ˜¯éé˜»å¡çš„ï¼Œå½“åœæ­¢ä»masteråŠ è½½æ‰¹é‡æ•°æ®æ—¶æœ‰ä¸€ä¸ªç‰‡åˆ»å»¶è¿Ÿã€‚é€šè¿‡è®¾ç½®é€‰é¡¹ä¸º1ï¼Œç¡®ä¿¡æ¯æ¬¡åªæœ‰ä¸€ä¸ªslaveæ˜¯ä¸å¯åˆ°è¾¾çš„ã€‚\nç¬¬ä¸ƒè¡Œè¡¨ç¤º10ç§’å†…mymasterè¿˜æ²¡æ´»è¿‡æ¥ï¼Œåˆ™è®¤ä¸ºmasterå®•æœºäº†ã€‚\n\nåˆ›å»ºå¥½æ–‡ä»¶åï¼Œå¤åˆ¶å¥½ä¸‰ä»½\n```xml\ncp sentinel.conf sentinel1.conf\ncp sentinel.conf sentinel2.conf\ncp sentinel.conf sentinel3.conf\n```\nå¯åŠ¨rediså“¨å…µæ¨¡å¼\n```xml\ndocker-compose up -d\n```\n## äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\nä¸Šé¢æ—¢ç„¶è¯´åˆ°äº†å“¨å…µå¯ä»¥è‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯å½“ä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œå®ƒä»¬èƒ½é€šè¿‡é€‰ä¸¾åˆ¶åº¦ï¼Œåœ¨ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹æ¥ä»£æ›¿ä¸»èŠ‚ç‚¹ã€‚\n\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸»èŠ‚ç‚¹æ­¤æ—¶çš„ä¿¡æ¯ï¼Œè¿™é‡Œa288c55db497æ˜¯æˆ‘ä¸»èŠ‚ç‚¹å®¹å™¨çš„ipï¼Œè¿™é‡Œå…ˆæ˜¯è¿›å…¥å®¹å™¨ï¼Œå†è¿›å…¥rediså®¢æˆ·ç«¯ï¼Œå†è¾“å…¥å¯†ç ï¼Œç„¶åä½¿ç”¨infoæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/b78632e11091376763eb17eb0a456666.png)\nè¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„èº«ä»½æ˜¯masterä¹Ÿå°±æ˜¯ä¸»èŠ‚ç‚¹ï¼Œç„¶åæœ‰ä¸¤ä¸ªè¿æ¥ç€çš„ä»èŠ‚ç‚¹\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/29b59a2b56a62e32552c35bf626817e4.png)\n\nç°åœ¨æˆ‘ä»¬åœæ‰è¿™ä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å“¨å…µæ˜¯å¦å¯ä»¥å®ç°æ•…éšœè½¬ç§»\n```xml\ndocker stop a288c55db497\n```\nç„¶åé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹è¿›å…¥å®¢æˆ·ç«¯ï¼Œè¾“å…¥infoæŸ¥çœ‹ä¿¡æ¯\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/81c6dc9c59ee6ff27dd01d9aabad7827.png)\nè¿™é‡Œå‘ç°å…¶ä¸­ä¸€å°ä»èŠ‚ç‚¹å·²ç»å˜æˆä¸»èŠ‚ç‚¹äº†ï¼Œè€Œä¸”è¿æ¥çš„ä»èŠ‚ç‚¹ï¼Œä¹Ÿå˜æˆäº†ä¸€ä¸ªã€‚\n\näº†è§£Docker Composeå¯å‚è€ƒï¼šhttps://www.jianshu.com/p/658911a8cff3\n\näº†è§£Redisä¸»ä»å“¨å…µå¯å‚è€ƒï¼šhttps://www.cnblogs.com/leeSmall/p/8398401.html","slug":"Composeæ­å»ºRedisä¸€ä¸»äºŒä»ä¸‰å“¨å…µé«˜å¯ç”¨é›†ç¾¤","published":1,"updated":"2024-02-07T07:27:45.070Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83de0001wen1de7adccu","content":"<h2 id=\"ä¸€ã€Docker-Composeä»‹ç»\"><a href=\"#ä¸€ã€Docker-Composeä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€Docker Composeä»‹ç»\"></a>ä¸€ã€Docker Composeä»‹ç»</h2><blockquote>\n<p><a href=\"https://docs.docker.com/compose/\">https://docs.docker.com/compose/</a></p>\n</blockquote>\n<p>Dockerå®˜æ–¹çš„ç½‘ç«™æ˜¯è¿™æ ·ä»‹ç»Docker Composeçš„ï¼š</p>\n<p><strong>Composeæ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä»é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</strong></p>\n<p>è¿™é‡ŒDocker Composeç»™æˆ‘çš„æ„Ÿå—å°±æ˜¯ä¾¿æ·ã€å¿«é€Ÿã€‚åªéœ€ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤docker-compose up -dï¼Œè¿™é‡Œå°±å¯ä»¥æ­å»ºå¤šä¸ªæœåŠ¡èµ·æ¥ï¼Œéå¸¸é€‚åˆæ­å»ºé›†ç¾¤ç¯å¢ƒã€‚</p>\n<h2 id=\"äºŒã€å®‰è£…Docker-Composeå·¥å…·\"><a href=\"#äºŒã€å®‰è£…Docker-Composeå·¥å…·\" class=\"headerlink\" title=\"äºŒã€å®‰è£…Docker Composeå·¥å…·\"></a>äºŒã€å®‰è£…Docker Composeå·¥å…·</h2><p>é€šè¿‡å‘½ä»¤å®‰è£…Composeå·¥å…·ï¼Œå®‰è£…Composeçš„å‰ææ˜¯å®‰è£…äº†Dockerç¯å¢ƒï¼Œå¦‚ä½•å®‰è£…å’Œå¿«é€Ÿä½¿ç”¨Dockerï¼Œå¯ä»¥ç¿»çœ‹æˆ‘ä¹‹å‰çš„é‚£ç¯‡åšå®¢â€“<a href=\"Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E6%90%AD%E5%BB%BASpringBoot%E9%A1%B9%E7%9B%AE\"></a>ï¼Œè¿™é‡Œä¸åšèµ˜è¿°äº†ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>\n<p>ç»™å®‰è£…è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -v</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/51ea38aadbb2ff6e09252ef863d8b8ef.png\" alt=\"image.png\"><br>åˆ°è¿™é‡ŒComposeå·¥å…·å°±å®‰è£…å¥½äº†</p>\n<h2 id=\"ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\"><a href=\"#ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\" class=\"headerlink\" title=\"ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\"></a>ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨</h2><p><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šä¸»èŠ‚ç‚¹è´Ÿè´£å†™æ•°æ®ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»æ•°æ®ï¼Œä¸»èŠ‚ç‚¹å®šæœŸæŠŠæ•°æ®åŒæ­¥åˆ°ä»èŠ‚ç‚¹ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p>\n<p>ä»æ€§èƒ½æ–¹é¢ï¼Œrediså¤åˆ¶åŠŸèƒ½å¢åŠ äº†è¯»çš„æ€§èƒ½ï¼Œç†è®ºä¸Šè¯´ï¼Œæ¯å¢åŠ ä¸€å€çš„æœåŠ¡å™¨ï¼Œæ•´ä¸ªç³»ç»Ÿçš„è¯»èƒ½åŠ›å°±å¢åŠ ä¸€å€ã€‚</p>\n<p>é€‰æ‹©å¥½è·¯å¾„ï¼Œé€šè¿‡å‘½ä»¤åˆ›å»ºæ–‡ä»¶å¤¹redisï¼Œç„¶åè¿›å…¥æ–‡ä»¶å¤¹åˆ›å»ºdocker-compose.ymlï¼Œæˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºï¼Œç„¶åé€šè¿‡Xftpå·¥å…·ä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚docker-compose.ymlå†™å…¥å¦‚ä¸‹å†…å®¹ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;2&#x27;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  master:</span><br><span class=\"line\">    image: redisã€€ã€€ã€€ã€€## é•œåƒ</span><br><span class=\"line\">    container_name: redis-masterã€€ã€€ã€€ã€€##å®¹å™¨åˆ«å</span><br><span class=\"line\">    command: redis-server --requirepass 123456ã€€ã€€ã€€ã€€##rediså¯†ç </span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6379:6379&quot;ã€€ã€€ã€€ã€€##æš´éœ²ç«¯å£</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br><span class=\"line\">  slave1:</span><br><span class=\"line\">    image: redis</span><br><span class=\"line\">    container_name: redis-slave-1</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6380:6379&quot;</span><br><span class=\"line\">    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456 </span><br><span class=\"line\">    depends_on:</span><br><span class=\"line\">    - master</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br><span class=\"line\">  slave2:</span><br><span class=\"line\">    image: redis</span><br><span class=\"line\">    container_name: redis-slave-2</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6381:6379&quot;</span><br><span class=\"line\">    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456</span><br><span class=\"line\">    depends_on:</span><br><span class=\"line\">    - master</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨redisé›†ç¾¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<p>docker psæŸ¥çœ‹è¿è¡Œçš„å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸»èŠ‚ç‚¹çš„ipåœ°å€ï¼Œæ³¨æ„ä¸æ˜¯ç”µè„‘çš„ipå“¦ï¼Œæ˜¯èŠ‚ç‚¹çš„ipåœ°å€ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ä¸»èŠ‚ç‚¹å®¹å™¨id</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/53f49345df59e36ee71202f08c7f8d94.png\" alt=\"image.png\"><br>è¿™é‡Œå…ˆè®°ç€è¿™ä¸ªipåœ°å€ï¼Œåé¢ä½¿ç”¨åˆ°å“¨å…µéœ€è¦ç»‘å®šè¿™ä¸ªä¸»èŠ‚ç‚¹çš„ipã€‚</p>\n<h2 id=\"å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\"><a href=\"#å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\" class=\"headerlink\" title=\"å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\"></a>å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º</h2><p>ä¸Šé¢æˆ‘ä»¬å·²ç»æ­å»ºå¥½äº†ä¸»ä»æ¨¡å¼ï¼Œå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°æœåŠ¡å™¨åˆ‡æ¢æˆä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œéœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘<strong>å“¨å…µæ¨¡å¼</strong>ã€‚<br>å“¨å…µæ˜¯redisé«˜å¯ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å°†è¯¥ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä¼˜å…ˆçš„ä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œç”±è¿™ä¸ªä¸»æœåŠ¡å™¨ä»£æ›¿å·²ä¸‹çº¿çš„ä¸»æœåŠ¡å™¨ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚</p>\n<p>å“¨å…µçš„åŠŸèƒ½ï¼š<br>1.ç›‘æ§ï¼šå“¨å…µä¼šä¸æ–­åœ°ç›‘æ§æ£€æµ‹ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚<br>2.è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šå½“ä¸»èŠ‚ç‚¹ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚<br>3.é€šçŸ¥ï¼šå“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚<br>4.é…ç½®æä¾›è€…ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚</p>\n<p>è¿™é‡Œåˆ›å»ºsentinelæ–‡ä»¶å¤¹ï¼Œç„¶ååŒæ ·ç¼–å†™docker-compose.ymlæ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;2&#x27;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  sentinel1:</span><br><span class=\"line\">    image: redis       ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-1</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26379:26379&quot;</span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - &quot;./sentinel.conf:/usr/local/etc/redis/sentinel.conf&quot;</span><br><span class=\"line\">  sentinel2:</span><br><span class=\"line\">    image: redis                ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-2</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26380:26379&quot;           </span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - &quot;./sentinel2.conf:/usr/local/etc/redis/sentinel.conf&quot;</span><br><span class=\"line\">  sentinel3:</span><br><span class=\"line\">    image: redis                ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-3</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26381:26379&quot;           </span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">networks:</span><br><span class=\"line\">  default:</span><br><span class=\"line\">    external:</span><br><span class=\"line\">      name: redis_sentinel-master</span><br></pre></td></tr></table></figure>\n<p>ç»§ç»­åœ¨æ­¤ç›®å½•ç¼–å†™æ–‡ä»¶ï¼Œç¼–å†™sentinel.confæ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port 26379</span><br><span class=\"line\">dir /tmp</span><br><span class=\"line\">#172.18.0.3å¡«å†™è‡ªå·±çš„ä¸»èŠ‚ç‚¹ip</span><br><span class=\"line\">sentinel monitor mymaster 172.18.0.3 6379 2</span><br><span class=\"line\">sentinel auth-pass mymaster 123456 </span><br><span class=\"line\">sentinel down-after-milliseconds mymaster 30000</span><br><span class=\"line\">sentinel parallel-syncs mymaster 1</span><br><span class=\"line\">sentinel failover-timeout mymaster 10000  </span><br><span class=\"line\">sentinel deny-scripts-reconfig yes</span><br></pre></td></tr></table></figure>\n<p>å¯¹å‘½ä»¤çš„è§£é‡Š</p>\n<blockquote>\n<p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºRedisç›‘æ§ä¸€ä¸ªå«åšmymasterçš„è¿è¡Œåœ¨172.18.0.3:6379çš„masterï¼ŒæŠ•ç¥¨è¾¾åˆ°2åˆ™è¡¨ç¤ºmasterä»¥åŠæŒ‚æ‰äº†ã€‚<br>ç¬¬å››è¡Œè®¾ç½®ä¸»èŠ‚ç‚¹çš„å¯†ç ã€‚<br>ç¬¬äº”è¡Œè¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´èŒƒå›´å†…sentinelå‘masterå‘é€çš„å¿ƒè·³PINGæ²¡æœ‰å›å¤åˆ™è®¤ä¸ºmasterä¸å¯ç”¨äº†ã€‚<br>ç¬¬å…­è¡Œçš„parallel-syncsè¡¨ç¤ºè®¾ç½®åœ¨æ•…éšœè½¬ç§»ä¹‹åï¼ŒåŒæ—¶å¯ä»¥é‡æ–°é…ç½®ä½¿ç”¨æ–°masterçš„slaveçš„æ•°é‡ã€‚æ•°å­—è¶Šä½ï¼Œæ›´å¤šçš„æ—¶é—´å°†ä¼šç”¨æ•…éšœè½¬ç§»å®Œæˆï¼Œä½†æ˜¯å¦‚æœslavesé…ç½®ä¸ºæœåŠ¡æ—§æ•°æ®ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›æ‰€æœ‰çš„slaveåŒæ—¶é‡æ–°åŒæ­¥masterã€‚å› ä¸ºä¸»ä»å¤åˆ¶å¯¹äºslaveæ˜¯éé˜»å¡çš„ï¼Œå½“åœæ­¢ä»masteråŠ è½½æ‰¹é‡æ•°æ®æ—¶æœ‰ä¸€ä¸ªç‰‡åˆ»å»¶è¿Ÿã€‚é€šè¿‡è®¾ç½®é€‰é¡¹ä¸º1ï¼Œç¡®ä¿¡æ¯æ¬¡åªæœ‰ä¸€ä¸ªslaveæ˜¯ä¸å¯åˆ°è¾¾çš„ã€‚<br>ç¬¬ä¸ƒè¡Œè¡¨ç¤º10ç§’å†…mymasterè¿˜æ²¡æ´»è¿‡æ¥ï¼Œåˆ™è®¤ä¸ºmasterå®•æœºäº†ã€‚</p>\n</blockquote>\n<p>åˆ›å»ºå¥½æ–‡ä»¶åï¼Œå¤åˆ¶å¥½ä¸‰ä»½</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp sentinel.conf sentinel1.conf</span><br><span class=\"line\">cp sentinel.conf sentinel2.conf</span><br><span class=\"line\">cp sentinel.conf sentinel3.conf</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨rediså“¨å…µæ¨¡å¼</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<h2 id=\"äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\"><a href=\"#äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\" class=\"headerlink\" title=\"äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\"></a>äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•</h2><p>ä¸Šé¢æ—¢ç„¶è¯´åˆ°äº†å“¨å…µå¯ä»¥è‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯å½“ä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œå®ƒä»¬èƒ½é€šè¿‡é€‰ä¸¾åˆ¶åº¦ï¼Œåœ¨ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹æ¥ä»£æ›¿ä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸»èŠ‚ç‚¹æ­¤æ—¶çš„ä¿¡æ¯ï¼Œè¿™é‡Œa288c55db497æ˜¯æˆ‘ä¸»èŠ‚ç‚¹å®¹å™¨çš„ipï¼Œè¿™é‡Œå…ˆæ˜¯è¿›å…¥å®¹å™¨ï¼Œå†è¿›å…¥rediså®¢æˆ·ç«¯ï¼Œå†è¾“å…¥å¯†ç ï¼Œç„¶åä½¿ç”¨infoæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/b78632e11091376763eb17eb0a456666.png\" alt=\"image.png\"><br>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„èº«ä»½æ˜¯masterä¹Ÿå°±æ˜¯ä¸»èŠ‚ç‚¹ï¼Œç„¶åæœ‰ä¸¤ä¸ªè¿æ¥ç€çš„ä»èŠ‚ç‚¹<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/29b59a2b56a62e32552c35bf626817e4.png\" alt=\"image.png\"></p>\n<p>ç°åœ¨æˆ‘ä»¬åœæ‰è¿™ä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å“¨å…µæ˜¯å¦å¯ä»¥å®ç°æ•…éšœè½¬ç§»</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker stop a288c55db497</span><br></pre></td></tr></table></figure>\n<p>ç„¶åé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹è¿›å…¥å®¢æˆ·ç«¯ï¼Œè¾“å…¥infoæŸ¥çœ‹ä¿¡æ¯<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/81c6dc9c59ee6ff27dd01d9aabad7827.png\" alt=\"image.png\"><br>è¿™é‡Œå‘ç°å…¶ä¸­ä¸€å°ä»èŠ‚ç‚¹å·²ç»å˜æˆä¸»èŠ‚ç‚¹äº†ï¼Œè€Œä¸”è¿æ¥çš„ä»èŠ‚ç‚¹ï¼Œä¹Ÿå˜æˆäº†ä¸€ä¸ªã€‚</p>\n<p>äº†è§£Docker Composeå¯å‚è€ƒï¼š<a href=\"https://www.jianshu.com/p/658911a8cff3\">https://www.jianshu.com/p/658911a8cff3</a></p>\n<p>äº†è§£Redisä¸»ä»å“¨å…µå¯å‚è€ƒï¼š<a href=\"https://www.cnblogs.com/leeSmall/p/8398401.html\">https://www.cnblogs.com/leeSmall/p/8398401.html</a></p>\n","excerpt":"","more":"<h2 id=\"ä¸€ã€Docker-Composeä»‹ç»\"><a href=\"#ä¸€ã€Docker-Composeä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€Docker Composeä»‹ç»\"></a>ä¸€ã€Docker Composeä»‹ç»</h2><blockquote>\n<p><a href=\"https://docs.docker.com/compose/\">https://docs.docker.com/compose/</a></p>\n</blockquote>\n<p>Dockerå®˜æ–¹çš„ç½‘ç«™æ˜¯è¿™æ ·ä»‹ç»Docker Composeçš„ï¼š</p>\n<p><strong>Composeæ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨YAMLæ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä»é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</strong></p>\n<p>è¿™é‡ŒDocker Composeç»™æˆ‘çš„æ„Ÿå—å°±æ˜¯ä¾¿æ·ã€å¿«é€Ÿã€‚åªéœ€ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œç„¶åé€šè¿‡å‘½ä»¤docker-compose up -dï¼Œè¿™é‡Œå°±å¯ä»¥æ­å»ºå¤šä¸ªæœåŠ¡èµ·æ¥ï¼Œéå¸¸é€‚åˆæ­å»ºé›†ç¾¤ç¯å¢ƒã€‚</p>\n<h2 id=\"äºŒã€å®‰è£…Docker-Composeå·¥å…·\"><a href=\"#äºŒã€å®‰è£…Docker-Composeå·¥å…·\" class=\"headerlink\" title=\"äºŒã€å®‰è£…Docker Composeå·¥å…·\"></a>äºŒã€å®‰è£…Docker Composeå·¥å…·</h2><p>é€šè¿‡å‘½ä»¤å®‰è£…Composeå·¥å…·ï¼Œå®‰è£…Composeçš„å‰ææ˜¯å®‰è£…äº†Dockerç¯å¢ƒï¼Œå¦‚ä½•å®‰è£…å’Œå¿«é€Ÿä½¿ç”¨Dockerï¼Œå¯ä»¥ç¿»çœ‹æˆ‘ä¹‹å‰çš„é‚£ç¯‡åšå®¢â€“<a href=\"Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E6%90%AD%E5%BB%BASpringBoot%E9%A1%B9%E7%9B%AE\"></a>ï¼Œè¿™é‡Œä¸åšèµ˜è¿°äº†ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>\n<p>ç»™å®‰è£…è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -v</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/51ea38aadbb2ff6e09252ef863d8b8ef.png\" alt=\"image.png\"><br>åˆ°è¿™é‡ŒComposeå·¥å…·å°±å®‰è£…å¥½äº†</p>\n<h2 id=\"ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\"><a href=\"#ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\" class=\"headerlink\" title=\"ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨\"></a>ä¸‰ã€ä½¿ç”¨Composeæ­å»ºRedisä¸»ä»æœåŠ¡å™¨</h2><p><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šä¸»èŠ‚ç‚¹è´Ÿè´£å†™æ•°æ®ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»æ•°æ®ï¼Œä¸»èŠ‚ç‚¹å®šæœŸæŠŠæ•°æ®åŒæ­¥åˆ°ä»èŠ‚ç‚¹ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p>\n<p>ä»æ€§èƒ½æ–¹é¢ï¼Œrediså¤åˆ¶åŠŸèƒ½å¢åŠ äº†è¯»çš„æ€§èƒ½ï¼Œç†è®ºä¸Šè¯´ï¼Œæ¯å¢åŠ ä¸€å€çš„æœåŠ¡å™¨ï¼Œæ•´ä¸ªç³»ç»Ÿçš„è¯»èƒ½åŠ›å°±å¢åŠ ä¸€å€ã€‚</p>\n<p>é€‰æ‹©å¥½è·¯å¾„ï¼Œé€šè¿‡å‘½ä»¤åˆ›å»ºæ–‡ä»¶å¤¹redisï¼Œç„¶åè¿›å…¥æ–‡ä»¶å¤¹åˆ›å»ºdocker-compose.ymlï¼Œæˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºï¼Œç„¶åé€šè¿‡Xftpå·¥å…·ä¸Šä¼ è‡³æœåŠ¡å™¨ã€‚docker-compose.ymlå†™å…¥å¦‚ä¸‹å†…å®¹ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;2&#x27;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  master:</span><br><span class=\"line\">    image: redisã€€ã€€ã€€ã€€## é•œåƒ</span><br><span class=\"line\">    container_name: redis-masterã€€ã€€ã€€ã€€##å®¹å™¨åˆ«å</span><br><span class=\"line\">    command: redis-server --requirepass 123456ã€€ã€€ã€€ã€€##rediså¯†ç </span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6379:6379&quot;ã€€ã€€ã€€ã€€##æš´éœ²ç«¯å£</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br><span class=\"line\">  slave1:</span><br><span class=\"line\">    image: redis</span><br><span class=\"line\">    container_name: redis-slave-1</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6380:6379&quot;</span><br><span class=\"line\">    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456 </span><br><span class=\"line\">    depends_on:</span><br><span class=\"line\">    - master</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br><span class=\"line\">  slave2:</span><br><span class=\"line\">    image: redis</span><br><span class=\"line\">    container_name: redis-slave-2</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;6381:6379&quot;</span><br><span class=\"line\">    command: redis-server --slaveof redis-master 6379 --requirepass 123456 --masterauth 123456</span><br><span class=\"line\">    depends_on:</span><br><span class=\"line\">    - master</span><br><span class=\"line\">    networks:</span><br><span class=\"line\">    - sentinel-master</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨redisé›†ç¾¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<p>docker psæŸ¥çœ‹è¿è¡Œçš„å®ä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸»èŠ‚ç‚¹çš„ipåœ°å€ï¼Œæ³¨æ„ä¸æ˜¯ç”µè„‘çš„ipå“¦ï¼Œæ˜¯èŠ‚ç‚¹çš„ipåœ°å€ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect ä¸»èŠ‚ç‚¹å®¹å™¨id</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/53f49345df59e36ee71202f08c7f8d94.png\" alt=\"image.png\"><br>è¿™é‡Œå…ˆè®°ç€è¿™ä¸ªipåœ°å€ï¼Œåé¢ä½¿ç”¨åˆ°å“¨å…µéœ€è¦ç»‘å®šè¿™ä¸ªä¸»èŠ‚ç‚¹çš„ipã€‚</p>\n<h2 id=\"å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\"><a href=\"#å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\" class=\"headerlink\" title=\"å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º\"></a>å››ã€å“¨å…µsentinelæ¨¡å¼æ­å»º</h2><p>ä¸Šé¢æˆ‘ä»¬å·²ç»æ­å»ºå¥½äº†ä¸»ä»æ¨¡å¼ï¼Œå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°æœåŠ¡å™¨åˆ‡æ¢æˆä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œéœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘<strong>å“¨å…µæ¨¡å¼</strong>ã€‚<br>å“¨å…µæ˜¯redisé«˜å¯ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªSentinelå®ä¾‹ç»„æˆçš„Sentinelç³»ç»Ÿå¯ä»¥ç›‘è§†ä»»æ„å¤šä¸ªä¸»æœåŠ¡å™¨ä»¥åŠè¿™äº›ä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œå®ƒèƒ½å¤Ÿåœ¨è¢«ç›‘è§†çš„ä¸»æœåŠ¡å™¨ä¸‹çº¿æ—¶ï¼Œè‡ªåŠ¨å°†è¯¥ä¸»æœåŠ¡å™¨å±ä¸‹çš„æŸä¸ªä¼˜å…ˆçš„ä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œç”±è¿™ä¸ªä¸»æœåŠ¡å™¨ä»£æ›¿å·²ä¸‹çº¿çš„ä¸»æœåŠ¡å™¨ç»§ç»­å¤„ç†å‘½ä»¤è¯·æ±‚ã€‚</p>\n<p>å“¨å…µçš„åŠŸèƒ½ï¼š<br>1.ç›‘æ§ï¼šå“¨å…µä¼šä¸æ–­åœ°ç›‘æ§æ£€æµ‹ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚<br>2.è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šå½“ä¸»èŠ‚ç‚¹ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚<br>3.é€šçŸ¥ï¼šå“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚<br>4.é…ç½®æä¾›è€…ï¼šå®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚</p>\n<p>è¿™é‡Œåˆ›å»ºsentinelæ–‡ä»¶å¤¹ï¼Œç„¶ååŒæ ·ç¼–å†™docker-compose.ymlæ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;2&#x27;</span><br><span class=\"line\">services:</span><br><span class=\"line\">  sentinel1:</span><br><span class=\"line\">    image: redis       ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-1</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26379:26379&quot;</span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - &quot;./sentinel.conf:/usr/local/etc/redis/sentinel.conf&quot;</span><br><span class=\"line\">  sentinel2:</span><br><span class=\"line\">    image: redis                ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-2</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26380:26379&quot;           </span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - &quot;./sentinel2.conf:/usr/local/etc/redis/sentinel.conf&quot;</span><br><span class=\"line\">  sentinel3:</span><br><span class=\"line\">    image: redis                ## é•œåƒ</span><br><span class=\"line\">    container_name: redis-sentinel-3</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">    - &quot;26381:26379&quot;           </span><br><span class=\"line\">    command: redis-sentinel /usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">    - ./sentinel3.conf:/usr/local/etc/redis/sentinel.conf</span><br><span class=\"line\">networks:</span><br><span class=\"line\">  default:</span><br><span class=\"line\">    external:</span><br><span class=\"line\">      name: redis_sentinel-master</span><br></pre></td></tr></table></figure>\n<p>ç»§ç»­åœ¨æ­¤ç›®å½•ç¼–å†™æ–‡ä»¶ï¼Œç¼–å†™sentinel.confæ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">port 26379</span><br><span class=\"line\">dir /tmp</span><br><span class=\"line\">#172.18.0.3å¡«å†™è‡ªå·±çš„ä¸»èŠ‚ç‚¹ip</span><br><span class=\"line\">sentinel monitor mymaster 172.18.0.3 6379 2</span><br><span class=\"line\">sentinel auth-pass mymaster 123456 </span><br><span class=\"line\">sentinel down-after-milliseconds mymaster 30000</span><br><span class=\"line\">sentinel parallel-syncs mymaster 1</span><br><span class=\"line\">sentinel failover-timeout mymaster 10000  </span><br><span class=\"line\">sentinel deny-scripts-reconfig yes</span><br></pre></td></tr></table></figure>\n<p>å¯¹å‘½ä»¤çš„è§£é‡Š</p>\n<blockquote>\n<p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºRedisç›‘æ§ä¸€ä¸ªå«åšmymasterçš„è¿è¡Œåœ¨172.18.0.3:6379çš„masterï¼ŒæŠ•ç¥¨è¾¾åˆ°2åˆ™è¡¨ç¤ºmasterä»¥åŠæŒ‚æ‰äº†ã€‚<br>ç¬¬å››è¡Œè®¾ç½®ä¸»èŠ‚ç‚¹çš„å¯†ç ã€‚<br>ç¬¬äº”è¡Œè¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´èŒƒå›´å†…sentinelå‘masterå‘é€çš„å¿ƒè·³PINGæ²¡æœ‰å›å¤åˆ™è®¤ä¸ºmasterä¸å¯ç”¨äº†ã€‚<br>ç¬¬å…­è¡Œçš„parallel-syncsè¡¨ç¤ºè®¾ç½®åœ¨æ•…éšœè½¬ç§»ä¹‹åï¼ŒåŒæ—¶å¯ä»¥é‡æ–°é…ç½®ä½¿ç”¨æ–°masterçš„slaveçš„æ•°é‡ã€‚æ•°å­—è¶Šä½ï¼Œæ›´å¤šçš„æ—¶é—´å°†ä¼šç”¨æ•…éšœè½¬ç§»å®Œæˆï¼Œä½†æ˜¯å¦‚æœslavesé…ç½®ä¸ºæœåŠ¡æ—§æ•°æ®ï¼Œä½ å¯èƒ½ä¸å¸Œæœ›æ‰€æœ‰çš„slaveåŒæ—¶é‡æ–°åŒæ­¥masterã€‚å› ä¸ºä¸»ä»å¤åˆ¶å¯¹äºslaveæ˜¯éé˜»å¡çš„ï¼Œå½“åœæ­¢ä»masteråŠ è½½æ‰¹é‡æ•°æ®æ—¶æœ‰ä¸€ä¸ªç‰‡åˆ»å»¶è¿Ÿã€‚é€šè¿‡è®¾ç½®é€‰é¡¹ä¸º1ï¼Œç¡®ä¿¡æ¯æ¬¡åªæœ‰ä¸€ä¸ªslaveæ˜¯ä¸å¯åˆ°è¾¾çš„ã€‚<br>ç¬¬ä¸ƒè¡Œè¡¨ç¤º10ç§’å†…mymasterè¿˜æ²¡æ´»è¿‡æ¥ï¼Œåˆ™è®¤ä¸ºmasterå®•æœºäº†ã€‚</p>\n</blockquote>\n<p>åˆ›å»ºå¥½æ–‡ä»¶åï¼Œå¤åˆ¶å¥½ä¸‰ä»½</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp sentinel.conf sentinel1.conf</span><br><span class=\"line\">cp sentinel.conf sentinel2.conf</span><br><span class=\"line\">cp sentinel.conf sentinel3.conf</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨rediså“¨å…µæ¨¡å¼</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up -d</span><br></pre></td></tr></table></figure>\n<h2 id=\"äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\"><a href=\"#äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\" class=\"headerlink\" title=\"äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•\"></a>äº”ã€æ•…éšœè½¬ç§»æµ‹è¯•</h2><p>ä¸Šé¢æ—¢ç„¶è¯´åˆ°äº†å“¨å…µå¯ä»¥è‡ªåŠ¨è½¬ç§»æ•…éšœï¼Œä¹Ÿå°±æ˜¯å½“ä¸»èŠ‚ç‚¹å®•æœºçš„æ—¶å€™ï¼Œå®ƒä»¬èƒ½é€šè¿‡é€‰ä¸¾åˆ¶åº¦ï¼Œåœ¨ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹æ¥ä»£æ›¿ä¸»èŠ‚ç‚¹ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸»èŠ‚ç‚¹æ­¤æ—¶çš„ä¿¡æ¯ï¼Œè¿™é‡Œa288c55db497æ˜¯æˆ‘ä¸»èŠ‚ç‚¹å®¹å™¨çš„ipï¼Œè¿™é‡Œå…ˆæ˜¯è¿›å…¥å®¹å™¨ï¼Œå†è¿›å…¥rediså®¢æˆ·ç«¯ï¼Œå†è¾“å…¥å¯†ç ï¼Œç„¶åä½¿ç”¨infoæŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/b78632e11091376763eb17eb0a456666.png\" alt=\"image.png\"><br>è¿™é‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„èº«ä»½æ˜¯masterä¹Ÿå°±æ˜¯ä¸»èŠ‚ç‚¹ï¼Œç„¶åæœ‰ä¸¤ä¸ªè¿æ¥ç€çš„ä»èŠ‚ç‚¹<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/29b59a2b56a62e32552c35bf626817e4.png\" alt=\"image.png\"></p>\n<p>ç°åœ¨æˆ‘ä»¬åœæ‰è¿™ä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å“¨å…µæ˜¯å¦å¯ä»¥å®ç°æ•…éšœè½¬ç§»</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker stop a288c55db497</span><br></pre></td></tr></table></figure>\n<p>ç„¶åé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä»èŠ‚ç‚¹è¿›å…¥å®¢æˆ·ç«¯ï¼Œè¾“å…¥infoæŸ¥çœ‹ä¿¡æ¯<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/81c6dc9c59ee6ff27dd01d9aabad7827.png\" alt=\"image.png\"><br>è¿™é‡Œå‘ç°å…¶ä¸­ä¸€å°ä»èŠ‚ç‚¹å·²ç»å˜æˆä¸»èŠ‚ç‚¹äº†ï¼Œè€Œä¸”è¿æ¥çš„ä»èŠ‚ç‚¹ï¼Œä¹Ÿå˜æˆäº†ä¸€ä¸ªã€‚</p>\n<p>äº†è§£Docker Composeå¯å‚è€ƒï¼š<a href=\"https://www.jianshu.com/p/658911a8cff3\">https://www.jianshu.com/p/658911a8cff3</a></p>\n<p>äº†è§£Redisä¸»ä»å“¨å…µå¯å‚è€ƒï¼š<a href=\"https://www.cnblogs.com/leeSmall/p/8398401.html\">https://www.cnblogs.com/leeSmall/p/8398401.html</a></p>\n"},{"title":"Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥","date":"2025-04-18T14:24:47.000Z","_content":"\n> åœ¨Dockerç¯å¢ƒä¸­ï¼Œå®¹å™¨é—´çš„é€šä¿¡æ˜¯æ„å»ºå¾®æœåŠ¡æ¶æ„çš„åŸºç¡€ã€‚ä½¿ç”¨å®¹å™¨åç§°è¿›è¡Œè¿æ¥ç›¸æ¯”ç›´æ¥ä½¿ç”¨IPåœ°å€å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚\n\n### ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\n\n1. **IPåœ°å€ä¸ç¨³å®šæ€§é—®é¢˜**ï¼š\n   â€¢ å®¹å™¨æ¯æ¬¡é‡å¯å¯èƒ½è·å¾—ä¸åŒçš„IPåœ°å€ï¼ˆå®¹å™¨å¯åŠ¨æ—¶ä¼šä»å­ç½‘ä¸­åŠ¨æ€è·å–å¯ç”¨IPï¼‰\n   â€¢ åœ¨é›†ç¾¤ç¯å¢ƒä¸­IPåœ°å€å˜åŒ–æ›´ä¸ºé¢‘ç¹\n   â€¢ ç¡¬ç¼–ç IPåœ°å€ä¼šå¯¼è‡´è¿æ¥å¤±æ•ˆ\n\n2. **ç®¡ç†å¤æ‚æ€§é™ä½**ï¼š\n   â€¢ ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°æ¯”è®°å¿†IPæ›´ç›´è§‚\n   â€¢ æ— éœ€ç»´æŠ¤IPåœ°å€æ˜ å°„è¡¨\n   â€¢ é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨åç§°æ›´å…·å¯è¯»æ€§\n\n3. **åŠ¨æ€æ‰©å±•æ”¯æŒ**ï¼š\n   â€¢ æœåŠ¡æ‰©å®¹æ—¶æ— éœ€ä¿®æ”¹è¿æ¥é…ç½®\n   â€¢ è‡ªåŠ¨é€‚åº”å®¹å™¨æ›¿æ¢å’Œè¿ç§»\n   â€¢ ä¸è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°æœºåˆ¶æ›´å¥½é…åˆ\n\n### äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\n\n### 1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\n\nDockerçš„é»˜è®¤bridgeç½‘ç»œï¼ˆdocker0ï¼‰**ä¸æ”¯æŒ**é€šè¿‡å®¹å™¨åç§°è¿æ¥ï¼Œåªæœ‰è‡ªå®šä¹‰ç½‘ç»œæ‰æä¾›å†…ç½®DNSæœåŠ¡ï¼š\n\n```bash\n# åˆ›å»ºæ”¯æŒåç§°è§£æçš„è‡ªå®šä¹‰ç½‘ç»œ\ndocker network create my-app-network\n```\n\n### 2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\n\næ‰€æœ‰éœ€è¦äº’ç›¸é€šä¿¡çš„å®¹å™¨å¿…é¡»è¿æ¥åˆ°åŒä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œï¼š\n\n```bash\ndocker run -d --name service-a --network my-app-network my-image\ndocker run -d --name service-b --network my-app-network my-image\n```\n\n### ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\n\n### åœºæ™¯å‡†å¤‡\n\nå‡è®¾æˆ‘ä»¬éœ€è¦éƒ¨ç½²ä¸€ä¸ªWebåº”ç”¨è¿æ¥MySQLæ•°æ®åº“\n\n### æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\n\n```bash\ndocker network create app-network\n```\n\n### æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\n\n```bash\ndocker run -d \\\n  --name mysql-db \\\n  --network app-network \\\n  -e MYSQL_ROOT_PASSWORD=secret \\\n  -e MYSQL_DATABASE=myapp \\\n  mysql:8.0\n```\n\n### æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\n\n```bash\ndocker run -d \\\n  --name web-app \\\n  --network app-network \\\n  -e DB_HOST=mysql-db \\\n  -e DB_PASSWORD=secret \\\n  -p 8080:8080 \\\n  my-web-app\n```\n\n### è¿æ¥éªŒè¯\n\nåœ¨web-appå®¹å™¨ä¸­ï¼š\n\n```bash\n# è¿›å…¥å®¹å™¨shell\ndocker exec -it web-app sh\n\n# æµ‹è¯•è¿æ¥MySQL\nping mysql-db  # åº”èƒ½æˆåŠŸè§£æ\nnc -zv mysql-db 3306  # æ£€æŸ¥ç«¯å£è¿é€šæ€§\n```\n\n### å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\n\n1Panelç­‰ç®¡ç†é¢æ¿ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘ç»œï¼ˆå¦‚`1panel-network`ï¼‰ï¼Œéœ€è¦å°†è‡ªå®šä¹‰å®¹å™¨åŠ å…¥è¯¥ç½‘ç»œï¼š\n\n### æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\n\n```bash\ndocker inspect 1Panel-mysql-Zhb7 | grep NetworkMode\n```\n\n### å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\n\n```bash\ndocker network connect 1panel-network my-app-container\n```\n\n### éªŒè¯è¿æ¥\n\n```bash\n# åœ¨åº”ç”¨å®¹å™¨ä¸­æµ‹è¯•\nping 1Panel-mysql-Zhb7\n```\n\n### äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\n\n1. **æ— æ³•è§£æå®¹å™¨å**ï¼š\n   â€¢ ç¡®è®¤å®¹å™¨åœ¨åŒä¸€è‡ªå®šä¹‰ç½‘ç»œ\n   â€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€ï¼š`docker network inspect <network>`\n   â€¢ éªŒè¯DNSè§£æï¼š`docker exec -it container-name nslookup target-name`\n\n2. **è¿æ¥è¶…æ—¶**ï¼š\n   â€¢ æ£€æŸ¥ç›®æ ‡æœåŠ¡æ˜¯å¦ç›‘å¬æ­£ç¡®ç«¯å£\n   â€¢ éªŒè¯é˜²ç«å¢™/å®‰å…¨ç»„è®¾ç½®\n   â€¢ æµ‹è¯•åŸºç¡€è¿é€šæ€§ï¼š`ping`å’Œ`telnet`\n\n3. **1Panelç¯å¢ƒç‰¹æ®Šé—®é¢˜**ï¼š\n   â€¢ ç¡®è®¤å®¹å™¨å·²åŠ å…¥`1panel-network`\n   â€¢ æ£€æŸ¥1Panelçš„ç½‘ç»œéš”ç¦»ç­–ç•¥\n   â€¢ æŸ¥çœ‹1Panelçš„æ—¥å¿—è·å–è¿æ¥å¤±è´¥è¯¦æƒ…\n\n### å…­ã€è¸©å‘è®°å½•\n\n[å…³äºmysqlçš„å®¹å™¨åº”ç”¨è¿æ¥](https://bbs.fit2cloud.com/t/topic/6388)","source":"_posts/Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥.md","raw":"---\ntitle: Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥\ndate: 2025-04-18 22:24:47\ntags:\n---\n\n> åœ¨Dockerç¯å¢ƒä¸­ï¼Œå®¹å™¨é—´çš„é€šä¿¡æ˜¯æ„å»ºå¾®æœåŠ¡æ¶æ„çš„åŸºç¡€ã€‚ä½¿ç”¨å®¹å™¨åç§°è¿›è¡Œè¿æ¥ç›¸æ¯”ç›´æ¥ä½¿ç”¨IPåœ°å€å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚\n\n### ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\n\n1. **IPåœ°å€ä¸ç¨³å®šæ€§é—®é¢˜**ï¼š\n   â€¢ å®¹å™¨æ¯æ¬¡é‡å¯å¯èƒ½è·å¾—ä¸åŒçš„IPåœ°å€ï¼ˆå®¹å™¨å¯åŠ¨æ—¶ä¼šä»å­ç½‘ä¸­åŠ¨æ€è·å–å¯ç”¨IPï¼‰\n   â€¢ åœ¨é›†ç¾¤ç¯å¢ƒä¸­IPåœ°å€å˜åŒ–æ›´ä¸ºé¢‘ç¹\n   â€¢ ç¡¬ç¼–ç IPåœ°å€ä¼šå¯¼è‡´è¿æ¥å¤±æ•ˆ\n\n2. **ç®¡ç†å¤æ‚æ€§é™ä½**ï¼š\n   â€¢ ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°æ¯”è®°å¿†IPæ›´ç›´è§‚\n   â€¢ æ— éœ€ç»´æŠ¤IPåœ°å€æ˜ å°„è¡¨\n   â€¢ é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨åç§°æ›´å…·å¯è¯»æ€§\n\n3. **åŠ¨æ€æ‰©å±•æ”¯æŒ**ï¼š\n   â€¢ æœåŠ¡æ‰©å®¹æ—¶æ— éœ€ä¿®æ”¹è¿æ¥é…ç½®\n   â€¢ è‡ªåŠ¨é€‚åº”å®¹å™¨æ›¿æ¢å’Œè¿ç§»\n   â€¢ ä¸è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°æœºåˆ¶æ›´å¥½é…åˆ\n\n### äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\n\n### 1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\n\nDockerçš„é»˜è®¤bridgeç½‘ç»œï¼ˆdocker0ï¼‰**ä¸æ”¯æŒ**é€šè¿‡å®¹å™¨åç§°è¿æ¥ï¼Œåªæœ‰è‡ªå®šä¹‰ç½‘ç»œæ‰æä¾›å†…ç½®DNSæœåŠ¡ï¼š\n\n```bash\n# åˆ›å»ºæ”¯æŒåç§°è§£æçš„è‡ªå®šä¹‰ç½‘ç»œ\ndocker network create my-app-network\n```\n\n### 2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\n\næ‰€æœ‰éœ€è¦äº’ç›¸é€šä¿¡çš„å®¹å™¨å¿…é¡»è¿æ¥åˆ°åŒä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œï¼š\n\n```bash\ndocker run -d --name service-a --network my-app-network my-image\ndocker run -d --name service-b --network my-app-network my-image\n```\n\n### ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\n\n### åœºæ™¯å‡†å¤‡\n\nå‡è®¾æˆ‘ä»¬éœ€è¦éƒ¨ç½²ä¸€ä¸ªWebåº”ç”¨è¿æ¥MySQLæ•°æ®åº“\n\n### æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\n\n```bash\ndocker network create app-network\n```\n\n### æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\n\n```bash\ndocker run -d \\\n  --name mysql-db \\\n  --network app-network \\\n  -e MYSQL_ROOT_PASSWORD=secret \\\n  -e MYSQL_DATABASE=myapp \\\n  mysql:8.0\n```\n\n### æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\n\n```bash\ndocker run -d \\\n  --name web-app \\\n  --network app-network \\\n  -e DB_HOST=mysql-db \\\n  -e DB_PASSWORD=secret \\\n  -p 8080:8080 \\\n  my-web-app\n```\n\n### è¿æ¥éªŒè¯\n\nåœ¨web-appå®¹å™¨ä¸­ï¼š\n\n```bash\n# è¿›å…¥å®¹å™¨shell\ndocker exec -it web-app sh\n\n# æµ‹è¯•è¿æ¥MySQL\nping mysql-db  # åº”èƒ½æˆåŠŸè§£æ\nnc -zv mysql-db 3306  # æ£€æŸ¥ç«¯å£è¿é€šæ€§\n```\n\n### å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\n\n1Panelç­‰ç®¡ç†é¢æ¿ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘ç»œï¼ˆå¦‚`1panel-network`ï¼‰ï¼Œéœ€è¦å°†è‡ªå®šä¹‰å®¹å™¨åŠ å…¥è¯¥ç½‘ç»œï¼š\n\n### æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\n\n```bash\ndocker inspect 1Panel-mysql-Zhb7 | grep NetworkMode\n```\n\n### å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\n\n```bash\ndocker network connect 1panel-network my-app-container\n```\n\n### éªŒè¯è¿æ¥\n\n```bash\n# åœ¨åº”ç”¨å®¹å™¨ä¸­æµ‹è¯•\nping 1Panel-mysql-Zhb7\n```\n\n### äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\n\n1. **æ— æ³•è§£æå®¹å™¨å**ï¼š\n   â€¢ ç¡®è®¤å®¹å™¨åœ¨åŒä¸€è‡ªå®šä¹‰ç½‘ç»œ\n   â€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€ï¼š`docker network inspect <network>`\n   â€¢ éªŒè¯DNSè§£æï¼š`docker exec -it container-name nslookup target-name`\n\n2. **è¿æ¥è¶…æ—¶**ï¼š\n   â€¢ æ£€æŸ¥ç›®æ ‡æœåŠ¡æ˜¯å¦ç›‘å¬æ­£ç¡®ç«¯å£\n   â€¢ éªŒè¯é˜²ç«å¢™/å®‰å…¨ç»„è®¾ç½®\n   â€¢ æµ‹è¯•åŸºç¡€è¿é€šæ€§ï¼š`ping`å’Œ`telnet`\n\n3. **1Panelç¯å¢ƒç‰¹æ®Šé—®é¢˜**ï¼š\n   â€¢ ç¡®è®¤å®¹å™¨å·²åŠ å…¥`1panel-network`\n   â€¢ æ£€æŸ¥1Panelçš„ç½‘ç»œéš”ç¦»ç­–ç•¥\n   â€¢ æŸ¥çœ‹1Panelçš„æ—¥å¿—è·å–è¿æ¥å¤±è´¥è¯¦æƒ…\n\n### å…­ã€è¸©å‘è®°å½•\n\n[å…³äºmysqlçš„å®¹å™¨åº”ç”¨è¿æ¥](https://bbs.fit2cloud.com/t/topic/6388)","slug":"Dockerå¦‚ä½•é€šè¿‡å®¹å™¨åç§°è¿›è¡Œè¿æ¥","published":1,"updated":"2025-04-18T14:26:34.478Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dg0003wen19vki79e8","content":"<blockquote>\n<p>åœ¨Dockerç¯å¢ƒä¸­ï¼Œå®¹å™¨é—´çš„é€šä¿¡æ˜¯æ„å»ºå¾®æœåŠ¡æ¶æ„çš„åŸºç¡€ã€‚ä½¿ç”¨å®¹å™¨åç§°è¿›è¡Œè¿æ¥ç›¸æ¯”ç›´æ¥ä½¿ç”¨IPåœ°å€å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\"><a href=\"#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\"></a>ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ</h3><ol>\n<li><p><strong>IPåœ°å€ä¸ç¨³å®šæ€§é—®é¢˜</strong>ï¼š<br>â€¢ å®¹å™¨æ¯æ¬¡é‡å¯å¯èƒ½è·å¾—ä¸åŒçš„IPåœ°å€ï¼ˆå®¹å™¨å¯åŠ¨æ—¶ä¼šä»å­ç½‘ä¸­åŠ¨æ€è·å–å¯ç”¨IPï¼‰<br>â€¢ åœ¨é›†ç¾¤ç¯å¢ƒä¸­IPåœ°å€å˜åŒ–æ›´ä¸ºé¢‘ç¹<br>â€¢ ç¡¬ç¼–ç IPåœ°å€ä¼šå¯¼è‡´è¿æ¥å¤±æ•ˆ</p>\n</li>\n<li><p><strong>ç®¡ç†å¤æ‚æ€§é™ä½</strong>ï¼š<br>â€¢ ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°æ¯”è®°å¿†IPæ›´ç›´è§‚<br>â€¢ æ— éœ€ç»´æŠ¤IPåœ°å€æ˜ å°„è¡¨<br>â€¢ é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨åç§°æ›´å…·å¯è¯»æ€§</p>\n</li>\n<li><p><strong>åŠ¨æ€æ‰©å±•æ”¯æŒ</strong>ï¼š<br>â€¢ æœåŠ¡æ‰©å®¹æ—¶æ— éœ€ä¿®æ”¹è¿æ¥é…ç½®<br>â€¢ è‡ªåŠ¨é€‚åº”å®¹å™¨æ›¿æ¢å’Œè¿ç§»<br>â€¢ ä¸è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°æœºåˆ¶æ›´å¥½é…åˆ</p>\n</li>\n</ol>\n<h3 id=\"äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\"><a href=\"#äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\" class=\"headerlink\" title=\"äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\"></a>äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶</h3><h3 id=\"1-å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\"><a href=\"#1-å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\" class=\"headerlink\" title=\"1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\"></a>1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ</h3><p>Dockerçš„é»˜è®¤bridgeç½‘ç»œï¼ˆdocker0ï¼‰<strong>ä¸æ”¯æŒ</strong>é€šè¿‡å®¹å™¨åç§°è¿æ¥ï¼Œåªæœ‰è‡ªå®šä¹‰ç½‘ç»œæ‰æä¾›å†…ç½®DNSæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åˆ›å»ºæ”¯æŒåç§°è§£æçš„è‡ªå®šä¹‰ç½‘ç»œ</span></span><br><span class=\"line\">docker network create my-app-network</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\"><a href=\"#2-å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\" class=\"headerlink\" title=\"2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\"></a>2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ</h3><p>æ‰€æœ‰éœ€è¦äº’ç›¸é€šä¿¡çš„å®¹å™¨å¿…é¡»è¿æ¥åˆ°åŒä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name service-a --network my-app-network my-image</span><br><span class=\"line\">docker run -d --name service-b --network my-app-network my-image</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\"><a href=\"#ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\" class=\"headerlink\" title=\"ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\"></a>ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨</h3><h3 id=\"åœºæ™¯å‡†å¤‡\"><a href=\"#åœºæ™¯å‡†å¤‡\" class=\"headerlink\" title=\"åœºæ™¯å‡†å¤‡\"></a>åœºæ™¯å‡†å¤‡</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦éƒ¨ç½²ä¸€ä¸ªWebåº”ç”¨è¿æ¥MySQLæ•°æ®åº“</p>\n<h3 id=\"æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\"><a href=\"#æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\" class=\"headerlink\" title=\"æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\"></a>æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network create app-network</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\"><a href=\"#æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\"></a>æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name mysql-db \\</span><br><span class=\"line\">  --network app-network \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=secret \\</span><br><span class=\"line\">  -e MYSQL_DATABASE=myapp \\</span><br><span class=\"line\">  mysql:8.0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\"><a href=\"#æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\"></a>æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name web-app \\</span><br><span class=\"line\">  --network app-network \\</span><br><span class=\"line\">  -e DB_HOST=mysql-db \\</span><br><span class=\"line\">  -e DB_PASSWORD=secret \\</span><br><span class=\"line\">  -p 8080:8080 \\</span><br><span class=\"line\">  my-web-app</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¿æ¥éªŒè¯\"><a href=\"#è¿æ¥éªŒè¯\" class=\"headerlink\" title=\"è¿æ¥éªŒè¯\"></a>è¿æ¥éªŒè¯</h3><p>åœ¨web-appå®¹å™¨ä¸­ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è¿›å…¥å®¹å™¨shell</span></span><br><span class=\"line\">docker <span class=\"built_in\">exec</span> -it web-app sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•è¿æ¥MySQL</span></span><br><span class=\"line\">ping mysql-db  <span class=\"comment\"># åº”èƒ½æˆåŠŸè§£æ</span></span><br><span class=\"line\">nc -zv mysql-db 3306  <span class=\"comment\"># æ£€æŸ¥ç«¯å£è¿é€šæ€§</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\"><a href=\"#å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\" class=\"headerlink\" title=\"å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\"></a>å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ</h3><p>1Panelç­‰ç®¡ç†é¢æ¿ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘ç»œï¼ˆå¦‚<code>1panel-network</code>ï¼‰ï¼Œéœ€è¦å°†è‡ªå®šä¹‰å®¹å™¨åŠ å…¥è¯¥ç½‘ç»œï¼š</p>\n<h3 id=\"æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\"><a href=\"#æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\" class=\"headerlink\" title=\"æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\"></a>æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect 1Panel-mysql-Zhb7 | grep NetworkMode</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\"><a href=\"#å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\" class=\"headerlink\" title=\"å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\"></a>å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network connect 1panel-network my-app-container</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"éªŒè¯è¿æ¥\"><a href=\"#éªŒè¯è¿æ¥\" class=\"headerlink\" title=\"éªŒè¯è¿æ¥\"></a>éªŒè¯è¿æ¥</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åœ¨åº”ç”¨å®¹å™¨ä¸­æµ‹è¯•</span></span><br><span class=\"line\">ping 1Panel-mysql-Zhb7</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\"><a href=\"#äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\" class=\"headerlink\" title=\"äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\"></a>äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥</h3><ol>\n<li><p><strong>æ— æ³•è§£æå®¹å™¨å</strong>ï¼š<br>â€¢ ç¡®è®¤å®¹å™¨åœ¨åŒä¸€è‡ªå®šä¹‰ç½‘ç»œ<br>â€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€ï¼š<code>docker network inspect &lt;network&gt;</code><br>â€¢ éªŒè¯DNSè§£æï¼š<code>docker exec -it container-name nslookup target-name</code></p>\n</li>\n<li><p><strong>è¿æ¥è¶…æ—¶</strong>ï¼š<br>â€¢ æ£€æŸ¥ç›®æ ‡æœåŠ¡æ˜¯å¦ç›‘å¬æ­£ç¡®ç«¯å£<br>â€¢ éªŒè¯é˜²ç«å¢™&#x2F;å®‰å…¨ç»„è®¾ç½®<br>â€¢ æµ‹è¯•åŸºç¡€è¿é€šæ€§ï¼š<code>ping</code>å’Œ<code>telnet</code></p>\n</li>\n<li><p><strong>1Panelç¯å¢ƒç‰¹æ®Šé—®é¢˜</strong>ï¼š<br>â€¢ ç¡®è®¤å®¹å™¨å·²åŠ å…¥<code>1panel-network</code><br>â€¢ æ£€æŸ¥1Panelçš„ç½‘ç»œéš”ç¦»ç­–ç•¥<br>â€¢ æŸ¥çœ‹1Panelçš„æ—¥å¿—è·å–è¿æ¥å¤±è´¥è¯¦æƒ…</p>\n</li>\n</ol>\n<h3 id=\"å…­ã€è¸©å‘è®°å½•\"><a href=\"#å…­ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"å…­ã€è¸©å‘è®°å½•\"></a>å…­ã€è¸©å‘è®°å½•</h3><p><a href=\"https://bbs.fit2cloud.com/t/topic/6388\">å…³äºmysqlçš„å®¹å™¨åº”ç”¨è¿æ¥</a></p>\n","excerpt":"","more":"<blockquote>\n<p>åœ¨Dockerç¯å¢ƒä¸­ï¼Œå®¹å™¨é—´çš„é€šä¿¡æ˜¯æ„å»ºå¾®æœåŠ¡æ¶æ„çš„åŸºç¡€ã€‚ä½¿ç”¨å®¹å™¨åç§°è¿›è¡Œè¿æ¥ç›¸æ¯”ç›´æ¥ä½¿ç”¨IPåœ°å€å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\"><a href=\"#ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ\"></a>ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨å®¹å™¨åç§°è¿æ¥ï¼Ÿ</h3><ol>\n<li><p><strong>IPåœ°å€ä¸ç¨³å®šæ€§é—®é¢˜</strong>ï¼š<br>â€¢ å®¹å™¨æ¯æ¬¡é‡å¯å¯èƒ½è·å¾—ä¸åŒçš„IPåœ°å€ï¼ˆå®¹å™¨å¯åŠ¨æ—¶ä¼šä»å­ç½‘ä¸­åŠ¨æ€è·å–å¯ç”¨IPï¼‰<br>â€¢ åœ¨é›†ç¾¤ç¯å¢ƒä¸­IPåœ°å€å˜åŒ–æ›´ä¸ºé¢‘ç¹<br>â€¢ ç¡¬ç¼–ç IPåœ°å€ä¼šå¯¼è‡´è¿æ¥å¤±æ•ˆ</p>\n</li>\n<li><p><strong>ç®¡ç†å¤æ‚æ€§é™ä½</strong>ï¼š<br>â€¢ ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°æ¯”è®°å¿†IPæ›´ç›´è§‚<br>â€¢ æ— éœ€ç»´æŠ¤IPåœ°å€æ˜ å°„è¡¨<br>â€¢ é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨åç§°æ›´å…·å¯è¯»æ€§</p>\n</li>\n<li><p><strong>åŠ¨æ€æ‰©å±•æ”¯æŒ</strong>ï¼š<br>â€¢ æœåŠ¡æ‰©å®¹æ—¶æ— éœ€ä¿®æ”¹è¿æ¥é…ç½®<br>â€¢ è‡ªåŠ¨é€‚åº”å®¹å™¨æ›¿æ¢å’Œè¿ç§»<br>â€¢ ä¸è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°æœºåˆ¶æ›´å¥½é…åˆ</p>\n</li>\n</ol>\n<h3 id=\"äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\"><a href=\"#äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\" class=\"headerlink\" title=\"äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶\"></a>äºŒã€å®ç°å®¹å™¨åç§°è¿æ¥çš„æ ¸å¿ƒæ¡ä»¶</h3><h3 id=\"1-å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\"><a href=\"#1-å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\" class=\"headerlink\" title=\"1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ\"></a>1. å¿…é¡»ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œ</h3><p>Dockerçš„é»˜è®¤bridgeç½‘ç»œï¼ˆdocker0ï¼‰<strong>ä¸æ”¯æŒ</strong>é€šè¿‡å®¹å™¨åç§°è¿æ¥ï¼Œåªæœ‰è‡ªå®šä¹‰ç½‘ç»œæ‰æä¾›å†…ç½®DNSæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åˆ›å»ºæ”¯æŒåç§°è§£æçš„è‡ªå®šä¹‰ç½‘ç»œ</span></span><br><span class=\"line\">docker network create my-app-network</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\"><a href=\"#2-å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\" class=\"headerlink\" title=\"2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ\"></a>2. å®¹å™¨å¿…é¡»åŠ å…¥åŒä¸€ç½‘ç»œ</h3><p>æ‰€æœ‰éœ€è¦äº’ç›¸é€šä¿¡çš„å®¹å™¨å¿…é¡»è¿æ¥åˆ°åŒä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name service-a --network my-app-network my-image</span><br><span class=\"line\">docker run -d --name service-b --network my-app-network my-image</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\"><a href=\"#ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\" class=\"headerlink\" title=\"ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨\"></a>ä¸‰ã€å®æˆ˜æ¼”ç¤ºï¼šé€šè¿‡åç§°è¿æ¥MySQLä¸åº”ç”¨</h3><h3 id=\"åœºæ™¯å‡†å¤‡\"><a href=\"#åœºæ™¯å‡†å¤‡\" class=\"headerlink\" title=\"åœºæ™¯å‡†å¤‡\"></a>åœºæ™¯å‡†å¤‡</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦éƒ¨ç½²ä¸€ä¸ªWebåº”ç”¨è¿æ¥MySQLæ•°æ®åº“</p>\n<h3 id=\"æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\"><a href=\"#æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\" class=\"headerlink\" title=\"æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ\"></a>æ­¥éª¤1ï¼šåˆ›å»ºä¸“ç”¨ç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network create app-network</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\"><a href=\"#æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨\"></a>æ­¥éª¤2ï¼šå¯åŠ¨MySQLå®¹å™¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name mysql-db \\</span><br><span class=\"line\">  --network app-network \\</span><br><span class=\"line\">  -e MYSQL_ROOT_PASSWORD=secret \\</span><br><span class=\"line\">  -e MYSQL_DATABASE=myapp \\</span><br><span class=\"line\">  mysql:8.0</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\"><a href=\"#æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨\"></a>æ­¥éª¤3ï¼šå¯åŠ¨åº”ç”¨å®¹å™¨</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name web-app \\</span><br><span class=\"line\">  --network app-network \\</span><br><span class=\"line\">  -e DB_HOST=mysql-db \\</span><br><span class=\"line\">  -e DB_PASSWORD=secret \\</span><br><span class=\"line\">  -p 8080:8080 \\</span><br><span class=\"line\">  my-web-app</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è¿æ¥éªŒè¯\"><a href=\"#è¿æ¥éªŒè¯\" class=\"headerlink\" title=\"è¿æ¥éªŒè¯\"></a>è¿æ¥éªŒè¯</h3><p>åœ¨web-appå®¹å™¨ä¸­ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># è¿›å…¥å®¹å™¨shell</span></span><br><span class=\"line\">docker <span class=\"built_in\">exec</span> -it web-app sh</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æµ‹è¯•è¿æ¥MySQL</span></span><br><span class=\"line\">ping mysql-db  <span class=\"comment\"># åº”èƒ½æˆåŠŸè§£æ</span></span><br><span class=\"line\">nc -zv mysql-db 3306  <span class=\"comment\"># æ£€æŸ¥ç«¯å£è¿é€šæ€§</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\"><a href=\"#å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\" class=\"headerlink\" title=\"å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ\"></a>å››ã€ç‰¹æ®Šåœºæ™¯å¤„ç†ï¼š1Panelç¯å¢ƒä¸‹çš„ç½‘ç»œé›†æˆ</h3><p>1Panelç­‰ç®¡ç†é¢æ¿ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘ç»œï¼ˆå¦‚<code>1panel-network</code>ï¼‰ï¼Œéœ€è¦å°†è‡ªå®šä¹‰å®¹å™¨åŠ å…¥è¯¥ç½‘ç»œï¼š</p>\n<h3 id=\"æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\"><a href=\"#æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\" class=\"headerlink\" title=\"æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ\"></a>æŸ¥çœ‹1Panelç®¡ç†çš„MySQLç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker inspect 1Panel-mysql-Zhb7 | grep NetworkMode</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\"><a href=\"#å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\" class=\"headerlink\" title=\"å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ\"></a>å°†åº”ç”¨å®¹å™¨åŠ å…¥åŒä¸€ç½‘ç»œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker network connect 1panel-network my-app-container</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"éªŒè¯è¿æ¥\"><a href=\"#éªŒè¯è¿æ¥\" class=\"headerlink\" title=\"éªŒè¯è¿æ¥\"></a>éªŒè¯è¿æ¥</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åœ¨åº”ç”¨å®¹å™¨ä¸­æµ‹è¯•</span></span><br><span class=\"line\">ping 1Panel-mysql-Zhb7</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\"><a href=\"#äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\" class=\"headerlink\" title=\"äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥\"></a>äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥</h3><ol>\n<li><p><strong>æ— æ³•è§£æå®¹å™¨å</strong>ï¼š<br>â€¢ ç¡®è®¤å®¹å™¨åœ¨åŒä¸€è‡ªå®šä¹‰ç½‘ç»œ<br>â€¢ æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€ï¼š<code>docker network inspect &lt;network&gt;</code><br>â€¢ éªŒè¯DNSè§£æï¼š<code>docker exec -it container-name nslookup target-name</code></p>\n</li>\n<li><p><strong>è¿æ¥è¶…æ—¶</strong>ï¼š<br>â€¢ æ£€æŸ¥ç›®æ ‡æœåŠ¡æ˜¯å¦ç›‘å¬æ­£ç¡®ç«¯å£<br>â€¢ éªŒè¯é˜²ç«å¢™&#x2F;å®‰å…¨ç»„è®¾ç½®<br>â€¢ æµ‹è¯•åŸºç¡€è¿é€šæ€§ï¼š<code>ping</code>å’Œ<code>telnet</code></p>\n</li>\n<li><p><strong>1Panelç¯å¢ƒç‰¹æ®Šé—®é¢˜</strong>ï¼š<br>â€¢ ç¡®è®¤å®¹å™¨å·²åŠ å…¥<code>1panel-network</code><br>â€¢ æ£€æŸ¥1Panelçš„ç½‘ç»œéš”ç¦»ç­–ç•¥<br>â€¢ æŸ¥çœ‹1Panelçš„æ—¥å¿—è·å–è¿æ¥å¤±è´¥è¯¦æƒ…</p>\n</li>\n</ol>\n<h3 id=\"å…­ã€è¸©å‘è®°å½•\"><a href=\"#å…­ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"å…­ã€è¸©å‘è®°å½•\"></a>å…­ã€è¸©å‘è®°å½•</h3><p><a href=\"https://bbs.fit2cloud.com/t/topic/6388\">å…³äºmysqlçš„å®¹å™¨åº”ç”¨è¿æ¥</a></p>\n"},{"title":"Dockerå®‰è£…nacosä½¿ç”¨mysql","date":"2025-05-08T06:03:23.000Z","_content":"\nè¦åœ¨ Docker ä¸­å®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨å¹¶ä½¿ç”¨ MySQL ä½œä¸ºå…¶æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ã€‚Nacos æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼Œå®ƒæ”¯æŒå¤šç§æ•°æ®åº“ä½œä¸ºå…¶å­˜å‚¨åç«¯ï¼ŒåŒ…æ‹¬ MySQLã€‚\n\n### æ­¥éª¤ 1: å®‰è£… Docker\n\nç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£… Dockerã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æ˜¯å¦å·²å®‰è£…ï¼š\n\n```\ndocker --version\n```\n\nå¦‚æœæœªå®‰è£…ï¼Œè¯·è®¿é—® [Docker å®˜ç½‘](https://docs.docker.com/get-docker/) è·å–å®‰è£…æŒ‡å—ã€‚\n\n### æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨\n\né¦–å…ˆï¼Œæ‚¨éœ€è¦è¿è¡Œä¸€ä¸ª MySQL å®¹å™¨ã€‚å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ MySQL é•œåƒã€‚åˆ›å»ºä¸€ä¸ªåä¸º `nacos-mysql` çš„å®¹å™¨ï¼Œå¹¶ä¸ºå®ƒè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ root ç”¨æˆ·çš„å¯†ç å’Œæ•°æ®åº“åï¼š\n\n```\ndocker run --name nacos-mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:5.7\n```\n\nè¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª MySQL 5.7 å®¹å™¨ï¼Œroot å¯†ç è®¾ç½®ä¸º `root`ï¼Œå¹¶ä¸”å°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 3306 ç«¯å£ã€‚\n\n### æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\n\nç™»å½•åˆ° MySQL å®¹å™¨ä¸­ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç”¨æˆ·ä¾› Nacos ä½¿ç”¨ï¼š\n\n```\ndocker exec -it nacos-mysql mysql -uroot -p\n```\n\nè¾“å…¥å¯†ç åï¼Œæ‰§è¡Œä»¥ä¸‹ SQL å‘½ä»¤ï¼š\n\n```\nCREATE DATABASE nacos DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;CREATE USER 'nacos'@'%' IDENTIFIED BY 'nacos';GRANT ALL PRIVILEGES ON nacos.* TO 'nacos'@'%';FLUSH PRIVILEGES;EXIT;\n```\n\n### æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨\n\næ¥ä¸‹æ¥ï¼Œæ‹‰å– Nacos çš„å®˜æ–¹ Docker é•œåƒå¹¶è¿è¡Œå®ƒï¼ŒæŒ‡å®šä½¿ç”¨ MySQL ä½œä¸ºå­˜å‚¨ï¼š\n\n```\ndocker run --name nacos -e MODE=standalone -e MYSQL_SERVICE_HOST=nacos-mysql -e MYSQL_SERVICE_PORT=3306 -e MYSQL_SERVICE_DB_NAME=nacos -e MYSQL_SERVICE_USER=nacos -e MYSQL_SERVICE_PASSWORD=nacos -p 8848:8848 -d nacos/nacos-server:latest\n```\n\nè¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª Nacos å®¹å™¨ï¼Œé…ç½®ä¸ºä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ MySQL æ•°æ®åº“ã€‚`MYSQL_SERVICE_HOST` åº”ä¸ MySQL å®¹å™¨çš„åç§°ç›¸åŒï¼ˆè¿™é‡Œæ˜¯ `nacos-mysql`ï¼‰ï¼Œè€Œ `MYSQL_SERVICE_PORT` æ˜¯ MySQL å®¹å™¨çš„ç«¯å£ï¼ˆè¿™é‡Œæ˜¯ `3306`ï¼‰ã€‚ç¡®ä¿è¿™äº›å€¼ä¸æ‚¨åœ¨æ­¥éª¤ 2 ä¸­è®¾ç½®çš„ç›¸åŒ¹é…ã€‚\n\n### æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ\n\næ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://localhost:8848/nacos`ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ `nacos`ã€‚å¦‚æœä¸€åˆ‡è®¾ç½®æ­£ç¡®ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° Nacos çš„ç®¡ç†ç•Œé¢ã€‚\n\né€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥åœ¨ Docker ä¸­æˆåŠŸå®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨ï¼Œä½¿ç”¨ MySQL ä½œä¸ºå…¶å­˜å‚¨åç«¯äº†ã€‚","source":"_posts/Dockerå®‰è£…nacosä½¿ç”¨mysql.md","raw":"---\ntitle: Dockerå®‰è£…nacosä½¿ç”¨mysql\ndate: 2025-05-08 14:03:23\ntags:\n---\n\nè¦åœ¨ Docker ä¸­å®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨å¹¶ä½¿ç”¨ MySQL ä½œä¸ºå…¶æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ã€‚Nacos æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼Œå®ƒæ”¯æŒå¤šç§æ•°æ®åº“ä½œä¸ºå…¶å­˜å‚¨åç«¯ï¼ŒåŒ…æ‹¬ MySQLã€‚\n\n### æ­¥éª¤ 1: å®‰è£… Docker\n\nç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£… Dockerã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æ˜¯å¦å·²å®‰è£…ï¼š\n\n```\ndocker --version\n```\n\nå¦‚æœæœªå®‰è£…ï¼Œè¯·è®¿é—® [Docker å®˜ç½‘](https://docs.docker.com/get-docker/) è·å–å®‰è£…æŒ‡å—ã€‚\n\n### æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨\n\né¦–å…ˆï¼Œæ‚¨éœ€è¦è¿è¡Œä¸€ä¸ª MySQL å®¹å™¨ã€‚å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ MySQL é•œåƒã€‚åˆ›å»ºä¸€ä¸ªåä¸º `nacos-mysql` çš„å®¹å™¨ï¼Œå¹¶ä¸ºå®ƒè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ root ç”¨æˆ·çš„å¯†ç å’Œæ•°æ®åº“åï¼š\n\n```\ndocker run --name nacos-mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:5.7\n```\n\nè¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª MySQL 5.7 å®¹å™¨ï¼Œroot å¯†ç è®¾ç½®ä¸º `root`ï¼Œå¹¶ä¸”å°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 3306 ç«¯å£ã€‚\n\n### æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\n\nç™»å½•åˆ° MySQL å®¹å™¨ä¸­ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç”¨æˆ·ä¾› Nacos ä½¿ç”¨ï¼š\n\n```\ndocker exec -it nacos-mysql mysql -uroot -p\n```\n\nè¾“å…¥å¯†ç åï¼Œæ‰§è¡Œä»¥ä¸‹ SQL å‘½ä»¤ï¼š\n\n```\nCREATE DATABASE nacos DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;CREATE USER 'nacos'@'%' IDENTIFIED BY 'nacos';GRANT ALL PRIVILEGES ON nacos.* TO 'nacos'@'%';FLUSH PRIVILEGES;EXIT;\n```\n\n### æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨\n\næ¥ä¸‹æ¥ï¼Œæ‹‰å– Nacos çš„å®˜æ–¹ Docker é•œåƒå¹¶è¿è¡Œå®ƒï¼ŒæŒ‡å®šä½¿ç”¨ MySQL ä½œä¸ºå­˜å‚¨ï¼š\n\n```\ndocker run --name nacos -e MODE=standalone -e MYSQL_SERVICE_HOST=nacos-mysql -e MYSQL_SERVICE_PORT=3306 -e MYSQL_SERVICE_DB_NAME=nacos -e MYSQL_SERVICE_USER=nacos -e MYSQL_SERVICE_PASSWORD=nacos -p 8848:8848 -d nacos/nacos-server:latest\n```\n\nè¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª Nacos å®¹å™¨ï¼Œé…ç½®ä¸ºä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ MySQL æ•°æ®åº“ã€‚`MYSQL_SERVICE_HOST` åº”ä¸ MySQL å®¹å™¨çš„åç§°ç›¸åŒï¼ˆè¿™é‡Œæ˜¯ `nacos-mysql`ï¼‰ï¼Œè€Œ `MYSQL_SERVICE_PORT` æ˜¯ MySQL å®¹å™¨çš„ç«¯å£ï¼ˆè¿™é‡Œæ˜¯ `3306`ï¼‰ã€‚ç¡®ä¿è¿™äº›å€¼ä¸æ‚¨åœ¨æ­¥éª¤ 2 ä¸­è®¾ç½®çš„ç›¸åŒ¹é…ã€‚\n\n### æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ\n\næ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://localhost:8848/nacos`ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ `nacos`ã€‚å¦‚æœä¸€åˆ‡è®¾ç½®æ­£ç¡®ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° Nacos çš„ç®¡ç†ç•Œé¢ã€‚\n\né€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥åœ¨ Docker ä¸­æˆåŠŸå®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨ï¼Œä½¿ç”¨ MySQL ä½œä¸ºå…¶å­˜å‚¨åç«¯äº†ã€‚","slug":"Dockerå®‰è£…nacosä½¿ç”¨mysql","published":1,"updated":"2025-06-01T15:51:30.553Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dg0004wen12v9hcpme","content":"<p>è¦åœ¨ Docker ä¸­å®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨å¹¶ä½¿ç”¨ MySQL ä½œä¸ºå…¶æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ã€‚Nacos æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼Œå®ƒæ”¯æŒå¤šç§æ•°æ®åº“ä½œä¸ºå…¶å­˜å‚¨åç«¯ï¼ŒåŒ…æ‹¬ MySQLã€‚</p>\n<h3 id=\"æ­¥éª¤-1-å®‰è£…-Docker\"><a href=\"#æ­¥éª¤-1-å®‰è£…-Docker\" class=\"headerlink\" title=\"æ­¥éª¤ 1: å®‰è£… Docker\"></a>æ­¥éª¤ 1: å®‰è£… Docker</h3><p>ç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£… Dockerã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æ˜¯å¦å·²å®‰è£…ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker --version</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæœªå®‰è£…ï¼Œè¯·è®¿é—® <a href=\"https://docs.docker.com/get-docker/\">Docker å®˜ç½‘</a> è·å–å®‰è£…æŒ‡å—ã€‚</p>\n<h3 id=\"æ­¥éª¤-2-å¯åŠ¨-MySQL-å®¹å™¨\"><a href=\"#æ­¥éª¤-2-å¯åŠ¨-MySQL-å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨\"></a>æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨</h3><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦è¿è¡Œä¸€ä¸ª MySQL å®¹å™¨ã€‚å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ MySQL é•œåƒã€‚åˆ›å»ºä¸€ä¸ªåä¸º <code>nacos-mysql</code> çš„å®¹å™¨ï¼Œå¹¶ä¸ºå®ƒè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ root ç”¨æˆ·çš„å¯†ç å’Œæ•°æ®åº“åï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nacos-mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª MySQL 5.7 å®¹å™¨ï¼Œroot å¯†ç è®¾ç½®ä¸º <code>root</code>ï¼Œå¹¶ä¸”å°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 3306 ç«¯å£ã€‚</p>\n<h3 id=\"æ­¥éª¤-3-åˆ›å»º-Nacos-æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\"><a href=\"#æ­¥éª¤-3-åˆ›å»º-Nacos-æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\" class=\"headerlink\" title=\"æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\"></a>æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·</h3><p>ç™»å½•åˆ° MySQL å®¹å™¨ä¸­ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç”¨æˆ·ä¾› Nacos ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it nacos-mysql mysql -uroot -p</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å…¥å¯†ç åï¼Œæ‰§è¡Œä»¥ä¸‹ SQL å‘½ä»¤ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE DATABASE nacos DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;CREATE USER &#x27;nacos&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;nacos&#x27;;GRANT ALL PRIVILEGES ON nacos.* TO &#x27;nacos&#x27;@&#x27;%&#x27;;FLUSH PRIVILEGES;EXIT;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤-4-æ‹‰å–å¹¶è¿è¡Œ-Nacos-å®¹å™¨\"><a href=\"#æ­¥éª¤-4-æ‹‰å–å¹¶è¿è¡Œ-Nacos-å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨\"></a>æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨</h3><p>æ¥ä¸‹æ¥ï¼Œæ‹‰å– Nacos çš„å®˜æ–¹ Docker é•œåƒå¹¶è¿è¡Œå®ƒï¼ŒæŒ‡å®šä½¿ç”¨ MySQL ä½œä¸ºå­˜å‚¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nacos -e MODE=standalone -e MYSQL_SERVICE_HOST=nacos-mysql -e MYSQL_SERVICE_PORT=3306 -e MYSQL_SERVICE_DB_NAME=nacos -e MYSQL_SERVICE_USER=nacos -e MYSQL_SERVICE_PASSWORD=nacos -p 8848:8848 -d nacos/nacos-server:latest</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª Nacos å®¹å™¨ï¼Œé…ç½®ä¸ºä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ MySQL æ•°æ®åº“ã€‚<code>MYSQL_SERVICE_HOST</code> åº”ä¸ MySQL å®¹å™¨çš„åç§°ç›¸åŒï¼ˆè¿™é‡Œæ˜¯ <code>nacos-mysql</code>ï¼‰ï¼Œè€Œ <code>MYSQL_SERVICE_PORT</code> æ˜¯ MySQL å®¹å™¨çš„ç«¯å£ï¼ˆè¿™é‡Œæ˜¯ <code>3306</code>ï¼‰ã€‚ç¡®ä¿è¿™äº›å€¼ä¸æ‚¨åœ¨æ­¥éª¤ 2 ä¸­è®¾ç½®çš„ç›¸åŒ¹é…ã€‚</p>\n<h3 id=\"æ­¥éª¤-5-éªŒè¯-Nacos-æ˜¯å¦æ­£å¸¸è¿è¡Œ\"><a href=\"#æ­¥éª¤-5-éªŒè¯-Nacos-æ˜¯å¦æ­£å¸¸è¿è¡Œ\" class=\"headerlink\" title=\"æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ\"></a>æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ</h3><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://localhost:8848/nacos</code>ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ <code>nacos</code>ã€‚å¦‚æœä¸€åˆ‡è®¾ç½®æ­£ç¡®ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° Nacos çš„ç®¡ç†ç•Œé¢ã€‚</p>\n<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥åœ¨ Docker ä¸­æˆåŠŸå®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨ï¼Œä½¿ç”¨ MySQL ä½œä¸ºå…¶å­˜å‚¨åç«¯äº†ã€‚</p>\n","excerpt":"","more":"<p>è¦åœ¨ Docker ä¸­å®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨å¹¶ä½¿ç”¨ MySQL ä½œä¸ºå…¶æ•°æ®åº“ï¼Œæ‚¨å¯ä»¥éµå¾ªä»¥ä¸‹æ­¥éª¤ã€‚Nacos æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼Œå®ƒæ”¯æŒå¤šç§æ•°æ®åº“ä½œä¸ºå…¶å­˜å‚¨åç«¯ï¼ŒåŒ…æ‹¬ MySQLã€‚</p>\n<h3 id=\"æ­¥éª¤-1-å®‰è£…-Docker\"><a href=\"#æ­¥éª¤-1-å®‰è£…-Docker\" class=\"headerlink\" title=\"æ­¥éª¤ 1: å®‰è£… Docker\"></a>æ­¥éª¤ 1: å®‰è£… Docker</h3><p>ç¡®ä¿æ‚¨çš„ç³»ç»Ÿä¸Šå·²å®‰è£… Dockerã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æ˜¯å¦å·²å®‰è£…ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker --version</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæœªå®‰è£…ï¼Œè¯·è®¿é—® <a href=\"https://docs.docker.com/get-docker/\">Docker å®˜ç½‘</a> è·å–å®‰è£…æŒ‡å—ã€‚</p>\n<h3 id=\"æ­¥éª¤-2-å¯åŠ¨-MySQL-å®¹å™¨\"><a href=\"#æ­¥éª¤-2-å¯åŠ¨-MySQL-å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨\"></a>æ­¥éª¤ 2: å¯åŠ¨ MySQL å®¹å™¨</h3><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦è¿è¡Œä¸€ä¸ª MySQL å®¹å™¨ã€‚å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„ MySQL é•œåƒã€‚åˆ›å»ºä¸€ä¸ªåä¸º <code>nacos-mysql</code> çš„å®¹å™¨ï¼Œå¹¶ä¸ºå®ƒè®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ root ç”¨æˆ·çš„å¯†ç å’Œæ•°æ®åº“åï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nacos-mysql -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª MySQL 5.7 å®¹å™¨ï¼Œroot å¯†ç è®¾ç½®ä¸º <code>root</code>ï¼Œå¹¶ä¸”å°†å®¹å™¨çš„ 3306 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 3306 ç«¯å£ã€‚</p>\n<h3 id=\"æ­¥éª¤-3-åˆ›å»º-Nacos-æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\"><a href=\"#æ­¥éª¤-3-åˆ›å»º-Nacos-æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\" class=\"headerlink\" title=\"æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·\"></a>æ­¥éª¤ 3: åˆ›å»º Nacos æ‰€éœ€çš„æ•°æ®åº“å’Œç”¨æˆ·</h3><p>ç™»å½•åˆ° MySQL å®¹å™¨ä¸­ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“å’Œç”¨æˆ·ä¾› Nacos ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it nacos-mysql mysql -uroot -p</span><br></pre></td></tr></table></figure>\n\n<p>è¾“å…¥å¯†ç åï¼Œæ‰§è¡Œä»¥ä¸‹ SQL å‘½ä»¤ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE DATABASE nacos DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;CREATE USER &#x27;nacos&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;nacos&#x27;;GRANT ALL PRIVILEGES ON nacos.* TO &#x27;nacos&#x27;@&#x27;%&#x27;;FLUSH PRIVILEGES;EXIT;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤-4-æ‹‰å–å¹¶è¿è¡Œ-Nacos-å®¹å™¨\"><a href=\"#æ­¥éª¤-4-æ‹‰å–å¹¶è¿è¡Œ-Nacos-å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨\"></a>æ­¥éª¤ 4: æ‹‰å–å¹¶è¿è¡Œ Nacos å®¹å™¨</h3><p>æ¥ä¸‹æ¥ï¼Œæ‹‰å– Nacos çš„å®˜æ–¹ Docker é•œåƒå¹¶è¿è¡Œå®ƒï¼ŒæŒ‡å®šä½¿ç”¨ MySQL ä½œä¸ºå­˜å‚¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nacos -e MODE=standalone -e MYSQL_SERVICE_HOST=nacos-mysql -e MYSQL_SERVICE_PORT=3306 -e MYSQL_SERVICE_DB_NAME=nacos -e MYSQL_SERVICE_USER=nacos -e MYSQL_SERVICE_PASSWORD=nacos -p 8848:8848 -d nacos/nacos-server:latest</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ¡å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ª Nacos å®¹å™¨ï¼Œé…ç½®ä¸ºä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ MySQL æ•°æ®åº“ã€‚<code>MYSQL_SERVICE_HOST</code> åº”ä¸ MySQL å®¹å™¨çš„åç§°ç›¸åŒï¼ˆè¿™é‡Œæ˜¯ <code>nacos-mysql</code>ï¼‰ï¼Œè€Œ <code>MYSQL_SERVICE_PORT</code> æ˜¯ MySQL å®¹å™¨çš„ç«¯å£ï¼ˆè¿™é‡Œæ˜¯ <code>3306</code>ï¼‰ã€‚ç¡®ä¿è¿™äº›å€¼ä¸æ‚¨åœ¨æ­¥éª¤ 2 ä¸­è®¾ç½®çš„ç›¸åŒ¹é…ã€‚</p>\n<h3 id=\"æ­¥éª¤-5-éªŒè¯-Nacos-æ˜¯å¦æ­£å¸¸è¿è¡Œ\"><a href=\"#æ­¥éª¤-5-éªŒè¯-Nacos-æ˜¯å¦æ­£å¸¸è¿è¡Œ\" class=\"headerlink\" title=\"æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ\"></a>æ­¥éª¤ 5: éªŒè¯ Nacos æ˜¯å¦æ­£å¸¸è¿è¡Œ</h3><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://localhost:8848/nacos</code>ï¼Œé»˜è®¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ <code>nacos</code>ã€‚å¦‚æœä¸€åˆ‡è®¾ç½®æ­£ç¡®ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ° Nacos çš„ç®¡ç†ç•Œé¢ã€‚</p>\n<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥åœ¨ Docker ä¸­æˆåŠŸå®‰è£…å¹¶è¿è¡Œ Nacos æœåŠ¡å™¨ï¼Œä½¿ç”¨ MySQL ä½œä¸ºå…¶å­˜å‚¨åç«¯äº†ã€‚</p>\n"},{"title":"Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“","date":"2024-10-16T05:59:25.000Z","_content":"\n> ç¦…é“é¡¹ç›®ç®¡ç†å·¥å…·æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬ä»»åŠ¡ç®¡ç†ã€éœ€æ±‚ç®¡ç†ã€Bugè·Ÿè¸ªã€ç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿåä½œã€é¡¹ç›®æŠ¥è¡¨ç­‰ï¼Œè¿™äº›åŠŸèƒ½è¦†ç›–äº†é¡¹ç›®ç®¡ç†çš„å„ä¸ªæ–¹é¢ã€‚å…¨é¢çš„åŠŸèƒ½æ¨¡å—ä½¿å¾—é¡¹ç›®å›¢é˜Ÿå¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šè¿›è¡ŒååŒå·¥ä½œï¼Œæ— éœ€å†æ•´åˆå¤šä¸ªç³»ç»Ÿï¼Œä»è€Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚\n\nå…¬å¸ä½¿ç”¨ç¦…é“æ¥ç®¡ç†é¡¹ç›®éœ€æ±‚ã€è¿›åº¦ä»¥åŠBugæµ‹è¯•ï¼Œæ–°ç‰ˆç¦…é“æ·»åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘æ­å»ºä½¿ç”¨çš„æ˜¯è€ç‰ˆæœ¬12.5.3ã€‚\n\n### Dockeræ‹‰å–ç¦…é“é•œåƒ\n\n```shell\ndocker pull idoop/zentao:12.5.3\n```\n\n![image-20241016134837422](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016134837422.png)\n\n### è¿è¡Œç¦…é“å®¹å™¨\n\n```shell\ndocker run --privileged=true -d -p 8082:80 -p 3316:3306 \\\n        -e ADMINER_USER=\"admin\" -e ADMINER_PASSWD=\"123456\" \\\n        -v /dockerdatafile/chandao/:/opt/zbox/ \\\n        --name zentao-server \\\n        idoop/zentao:12.5.3\n```\n\nå‚æ•°è¯´æ˜ï¼š\n\n- ADMINER_USERï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜è´¦å·\n\n- ADMINER_PASSWDï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜é¦–æ¬¡ç™»å½•å¯†ç \n\n### è®¿é—®ç¦…é“\n\næµè§ˆå™¨è®¿é—®å®¿ä¸»æœºå™¨åœ°å€åŠ 8082ç«¯å£ï¼Œç™»å½•ä½¿ç”¨ç”¨æˆ·å adminï¼Œå¯†ç  123456\n\n![image-20241016135156614](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135156614.png)\n\n### ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\n\nå¯é€šè¿‡åŸŸåè¿›è¡Œè®¿é—®\n\n![image-20241016135651301](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135651301.png)\n\n ","source":"_posts/Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“.md","raw":"---\ntitle: Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“\ndate: 2024-10-16 13:59:25\ntags:\n---\n\n> ç¦…é“é¡¹ç›®ç®¡ç†å·¥å…·æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬ä»»åŠ¡ç®¡ç†ã€éœ€æ±‚ç®¡ç†ã€Bugè·Ÿè¸ªã€ç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿåä½œã€é¡¹ç›®æŠ¥è¡¨ç­‰ï¼Œè¿™äº›åŠŸèƒ½è¦†ç›–äº†é¡¹ç›®ç®¡ç†çš„å„ä¸ªæ–¹é¢ã€‚å…¨é¢çš„åŠŸèƒ½æ¨¡å—ä½¿å¾—é¡¹ç›®å›¢é˜Ÿå¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šè¿›è¡ŒååŒå·¥ä½œï¼Œæ— éœ€å†æ•´åˆå¤šä¸ªç³»ç»Ÿï¼Œä»è€Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚\n\nå…¬å¸ä½¿ç”¨ç¦…é“æ¥ç®¡ç†é¡¹ç›®éœ€æ±‚ã€è¿›åº¦ä»¥åŠBugæµ‹è¯•ï¼Œæ–°ç‰ˆç¦…é“æ·»åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘æ­å»ºä½¿ç”¨çš„æ˜¯è€ç‰ˆæœ¬12.5.3ã€‚\n\n### Dockeræ‹‰å–ç¦…é“é•œåƒ\n\n```shell\ndocker pull idoop/zentao:12.5.3\n```\n\n![image-20241016134837422](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016134837422.png)\n\n### è¿è¡Œç¦…é“å®¹å™¨\n\n```shell\ndocker run --privileged=true -d -p 8082:80 -p 3316:3306 \\\n        -e ADMINER_USER=\"admin\" -e ADMINER_PASSWD=\"123456\" \\\n        -v /dockerdatafile/chandao/:/opt/zbox/ \\\n        --name zentao-server \\\n        idoop/zentao:12.5.3\n```\n\nå‚æ•°è¯´æ˜ï¼š\n\n- ADMINER_USERï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜è´¦å·\n\n- ADMINER_PASSWDï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜é¦–æ¬¡ç™»å½•å¯†ç \n\n### è®¿é—®ç¦…é“\n\næµè§ˆå™¨è®¿é—®å®¿ä¸»æœºå™¨åœ°å€åŠ 8082ç«¯å£ï¼Œç™»å½•ä½¿ç”¨ç”¨æˆ·å adminï¼Œå¯†ç  123456\n\n![image-20241016135156614](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135156614.png)\n\n### ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\n\nå¯é€šè¿‡åŸŸåè¿›è¡Œè®¿é—®\n\n![image-20241016135651301](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135651301.png)\n\n ","slug":"Dockeræ­å»ºå’Œéƒ¨ç½²ç¦…é“","published":1,"updated":"2024-10-16T05:59:44.745Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dh0005wen1aeb00ab6","content":"<blockquote>\n<p>ç¦…é“é¡¹ç›®ç®¡ç†å·¥å…·æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬ä»»åŠ¡ç®¡ç†ã€éœ€æ±‚ç®¡ç†ã€Bugè·Ÿè¸ªã€ç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿåä½œã€é¡¹ç›®æŠ¥è¡¨ç­‰ï¼Œè¿™äº›åŠŸèƒ½è¦†ç›–äº†é¡¹ç›®ç®¡ç†çš„å„ä¸ªæ–¹é¢ã€‚å…¨é¢çš„åŠŸèƒ½æ¨¡å—ä½¿å¾—é¡¹ç›®å›¢é˜Ÿå¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šè¿›è¡ŒååŒå·¥ä½œï¼Œæ— éœ€å†æ•´åˆå¤šä¸ªç³»ç»Ÿï¼Œä»è€Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚</p>\n</blockquote>\n<p>å…¬å¸ä½¿ç”¨ç¦…é“æ¥ç®¡ç†é¡¹ç›®éœ€æ±‚ã€è¿›åº¦ä»¥åŠBugæµ‹è¯•ï¼Œæ–°ç‰ˆç¦…é“æ·»åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘æ­å»ºä½¿ç”¨çš„æ˜¯è€ç‰ˆæœ¬12.5.3ã€‚</p>\n<h3 id=\"Dockeræ‹‰å–ç¦…é“é•œåƒ\"><a href=\"#Dockeræ‹‰å–ç¦…é“é•œåƒ\" class=\"headerlink\" title=\"Dockeræ‹‰å–ç¦…é“é•œåƒ\"></a>Dockeræ‹‰å–ç¦…é“é•œåƒ</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull idoop/zentao:12.5.3</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016134837422.png\" alt=\"image-20241016134837422\"></p>\n<h3 id=\"è¿è¡Œç¦…é“å®¹å™¨\"><a href=\"#è¿è¡Œç¦…é“å®¹å™¨\" class=\"headerlink\" title=\"è¿è¡Œç¦…é“å®¹å™¨\"></a>è¿è¡Œç¦…é“å®¹å™¨</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged=true -d -p 8082:80 -p 3316:3306 \\</span><br><span class=\"line\">        -e ADMINER_USER=&quot;admin&quot; -e ADMINER_PASSWD=&quot;123456&quot; \\</span><br><span class=\"line\">        -v /dockerdatafile/chandao/:/opt/zbox/ \\</span><br><span class=\"line\">        --name zentao-server \\</span><br><span class=\"line\">        idoop/zentao:12.5.3</span><br></pre></td></tr></table></figure>\n\n<p>å‚æ•°è¯´æ˜ï¼š</p>\n<ul>\n<li><p>ADMINER_USERï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜è´¦å·</p>\n</li>\n<li><p>ADMINER_PASSWDï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜é¦–æ¬¡ç™»å½•å¯†ç </p>\n</li>\n</ul>\n<h3 id=\"è®¿é—®ç¦…é“\"><a href=\"#è®¿é—®ç¦…é“\" class=\"headerlink\" title=\"è®¿é—®ç¦…é“\"></a>è®¿é—®ç¦…é“</h3><p>æµè§ˆå™¨è®¿é—®å®¿ä¸»æœºå™¨åœ°å€åŠ 8082ç«¯å£ï¼Œç™»å½•ä½¿ç”¨ç”¨æˆ·å adminï¼Œå¯†ç  123456</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135156614.png\" alt=\"image-20241016135156614\"></p>\n<h3 id=\"ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\"><a href=\"#ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\" class=\"headerlink\" title=\"ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\"></a>ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™</h3><p>å¯é€šè¿‡åŸŸåè¿›è¡Œè®¿é—®</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135651301.png\" alt=\"image-20241016135651301\"></p>\n","excerpt":"","more":"<blockquote>\n<p>ç¦…é“é¡¹ç›®ç®¡ç†å·¥å…·æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½æ¨¡å—ï¼ŒåŒ…æ‹¬ä»»åŠ¡ç®¡ç†ã€éœ€æ±‚ç®¡ç†ã€Bugè·Ÿè¸ªã€ç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿåä½œã€é¡¹ç›®æŠ¥è¡¨ç­‰ï¼Œè¿™äº›åŠŸèƒ½è¦†ç›–äº†é¡¹ç›®ç®¡ç†çš„å„ä¸ªæ–¹é¢ã€‚å…¨é¢çš„åŠŸèƒ½æ¨¡å—ä½¿å¾—é¡¹ç›®å›¢é˜Ÿå¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ä¸Šè¿›è¡ŒååŒå·¥ä½œï¼Œæ— éœ€å†æ•´åˆå¤šä¸ªç³»ç»Ÿï¼Œä»è€Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚</p>\n</blockquote>\n<p>å…¬å¸ä½¿ç”¨ç¦…é“æ¥ç®¡ç†é¡¹ç›®éœ€æ±‚ã€è¿›åº¦ä»¥åŠBugæµ‹è¯•ï¼Œæ–°ç‰ˆç¦…é“æ·»åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘æ­å»ºä½¿ç”¨çš„æ˜¯è€ç‰ˆæœ¬12.5.3ã€‚</p>\n<h3 id=\"Dockeræ‹‰å–ç¦…é“é•œåƒ\"><a href=\"#Dockeræ‹‰å–ç¦…é“é•œåƒ\" class=\"headerlink\" title=\"Dockeræ‹‰å–ç¦…é“é•œåƒ\"></a>Dockeræ‹‰å–ç¦…é“é•œåƒ</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull idoop/zentao:12.5.3</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016134837422.png\" alt=\"image-20241016134837422\"></p>\n<h3 id=\"è¿è¡Œç¦…é“å®¹å™¨\"><a href=\"#è¿è¡Œç¦…é“å®¹å™¨\" class=\"headerlink\" title=\"è¿è¡Œç¦…é“å®¹å™¨\"></a>è¿è¡Œç¦…é“å®¹å™¨</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --privileged=true -d -p 8082:80 -p 3316:3306 \\</span><br><span class=\"line\">        -e ADMINER_USER=&quot;admin&quot; -e ADMINER_PASSWD=&quot;123456&quot; \\</span><br><span class=\"line\">        -v /dockerdatafile/chandao/:/opt/zbox/ \\</span><br><span class=\"line\">        --name zentao-server \\</span><br><span class=\"line\">        idoop/zentao:12.5.3</span><br></pre></td></tr></table></figure>\n\n<p>å‚æ•°è¯´æ˜ï¼š</p>\n<ul>\n<li><p>ADMINER_USERï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜è´¦å·</p>\n</li>\n<li><p>ADMINER_PASSWDï¼šæŒ‡å®šç¦…é“ç®¡ç†å‘˜é¦–æ¬¡ç™»å½•å¯†ç </p>\n</li>\n</ul>\n<h3 id=\"è®¿é—®ç¦…é“\"><a href=\"#è®¿é—®ç¦…é“\" class=\"headerlink\" title=\"è®¿é—®ç¦…é“\"></a>è®¿é—®ç¦…é“</h3><p>æµè§ˆå™¨è®¿é—®å®¿ä¸»æœºå™¨åœ°å€åŠ 8082ç«¯å£ï¼Œç™»å½•ä½¿ç”¨ç”¨æˆ·å adminï¼Œå¯†ç  123456</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135156614.png\" alt=\"image-20241016135156614\"></p>\n<h3 id=\"ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\"><a href=\"#ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\" class=\"headerlink\" title=\"ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™\"></a>ä½¿ç”¨1Panelåˆ›å»ºç½‘ç«™</h3><p>å¯é€šè¿‡åŸŸåè¿›è¡Œè®¿é—®</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20241016135651301.png\" alt=\"image-20241016135651301\"></p>\n"},{"title":"Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®","date":"2022-02-07T09:35:40.000Z","_content":"\nä¹‹å‰å†™SpringBooté¡¹ç›®ï¼Œæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨å»å†™å®ä½“ç±»ã€daoå±‚å•¥çš„ï¼Œå°¤å…¶æ˜¯æ•°æ®åº“è¡¨å­—æ®µç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚ç„¶åå¾ˆå¤šå°ä¼™ä¼´éƒ½ä¼šç”¨é€†å‘å·¥ç¨‹æ¥è‡ªåŠ¨ç”Ÿæˆè¿™äº›ç±»ï¼Œçœå»è®¸å¤šæ²¡å¿…è¦çš„ä»£ç é‡ï¼Œä½†æ˜¯Mybatisçš„é€†å‘å·¥ç¨‹ä¾ç„¶éœ€è¦é…ç½®ï¼Œå¯¼é€†å‘å·¥ç¨‹çš„jarå•Šï¼Œè¿˜æœ‰ç¼–å†™generatorConfig.xmlæ–‡ä»¶å•Šï¼ˆæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹è¿™ç¯‡[](åšå®¢)ï¼‰ã€‚ä»Šå¤©é€›giteeçš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€æ¬¾å¯ä»¥å…å»è®¸å¤šé…ç½®çš„ideaé€†å‘å·¥ç¨‹æ’ä»¶ï¼Œå‡ ä¸ªæ­¥éª¤ç®€å•ä½¿ç”¨ä¸€ä¸‹\n\nè¿™ä¸ªæ’ä»¶ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/03211e75a42c7cdfb6feeae5e6e72104.png)\n\n### ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\nSetting->Pluginsã€‚æœç´¢EasyCodeæ’ä»¶ï¼Œå¹¶é‡å¯Ideaç¼–è¾‘å™¨\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/adb271ad8f16d31f54fe857f62466897.png)\n\n### äºŒã€é…ç½®MYSQLæ•°æ®æº\nç‚¹å‡»Ideaå³ä¾§çš„Databaseï¼Œç„¶åå†ç‚¹ä¸€ä¸‹åŠ å·ï¼Œé€‰æ‹©ä½ çš„æ•°æ®åº“ç±»å‹ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯MySQL\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/867fa36ed0e166104a784b39b6313f1f.png)\n\n### ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\né…ç½®å¥½è‡ªå·±çš„æ•°æ®åº“è¿æ¥å‚æ•°åï¼Œç‚¹å‡»Applyï¼Œç„¶åå†ç‚¹å‡»Schemasé€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9cebd4ceea4ccbfea4a7bd42cd6b01af.png)\n\n### å››ã€ç”Ÿæˆä»£ç \nå¦‚å›¾ï¼Œç‚¹å‡»Generate Code\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c3b18d5697e490ecb39f5d99b8a759b9.png)\nè¿™é‡Œé€‰æ‹©é¡¹ç›®æ¨¡å—ï¼Œè¿˜æœ‰éœ€è¦ç”Ÿæˆçš„ä»£ç \n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb737e2b3d63f054f9d07b36805cfe6f.png)\nç”Ÿæˆåçš„ç›®å½•å°±è¿™ä¸ªæ ·å­ï¼Œé‡Œé¢è¿˜å†™å¥½äº†å•è¡¨çš„CRUDæ“ä½œ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/17c05c5e193dc89a1409c742da29680e.png)","source":"_posts/Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®.md","raw":"---\ntitle: Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®\ndate: 2022-02-07 17:35:40\ntags:\n---\n\nä¹‹å‰å†™SpringBooté¡¹ç›®ï¼Œæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨å»å†™å®ä½“ç±»ã€daoå±‚å•¥çš„ï¼Œå°¤å…¶æ˜¯æ•°æ®åº“è¡¨å­—æ®µç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚ç„¶åå¾ˆå¤šå°ä¼™ä¼´éƒ½ä¼šç”¨é€†å‘å·¥ç¨‹æ¥è‡ªåŠ¨ç”Ÿæˆè¿™äº›ç±»ï¼Œçœå»è®¸å¤šæ²¡å¿…è¦çš„ä»£ç é‡ï¼Œä½†æ˜¯Mybatisçš„é€†å‘å·¥ç¨‹ä¾ç„¶éœ€è¦é…ç½®ï¼Œå¯¼é€†å‘å·¥ç¨‹çš„jarå•Šï¼Œè¿˜æœ‰ç¼–å†™generatorConfig.xmlæ–‡ä»¶å•Šï¼ˆæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹è¿™ç¯‡[](åšå®¢)ï¼‰ã€‚ä»Šå¤©é€›giteeçš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€æ¬¾å¯ä»¥å…å»è®¸å¤šé…ç½®çš„ideaé€†å‘å·¥ç¨‹æ’ä»¶ï¼Œå‡ ä¸ªæ­¥éª¤ç®€å•ä½¿ç”¨ä¸€ä¸‹\n\nè¿™ä¸ªæ’ä»¶ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/03211e75a42c7cdfb6feeae5e6e72104.png)\n\n### ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\nSetting->Pluginsã€‚æœç´¢EasyCodeæ’ä»¶ï¼Œå¹¶é‡å¯Ideaç¼–è¾‘å™¨\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/adb271ad8f16d31f54fe857f62466897.png)\n\n### äºŒã€é…ç½®MYSQLæ•°æ®æº\nç‚¹å‡»Ideaå³ä¾§çš„Databaseï¼Œç„¶åå†ç‚¹ä¸€ä¸‹åŠ å·ï¼Œé€‰æ‹©ä½ çš„æ•°æ®åº“ç±»å‹ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯MySQL\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/867fa36ed0e166104a784b39b6313f1f.png)\n\n### ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\né…ç½®å¥½è‡ªå·±çš„æ•°æ®åº“è¿æ¥å‚æ•°åï¼Œç‚¹å‡»Applyï¼Œç„¶åå†ç‚¹å‡»Schemasé€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9cebd4ceea4ccbfea4a7bd42cd6b01af.png)\n\n### å››ã€ç”Ÿæˆä»£ç \nå¦‚å›¾ï¼Œç‚¹å‡»Generate Code\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c3b18d5697e490ecb39f5d99b8a759b9.png)\nè¿™é‡Œé€‰æ‹©é¡¹ç›®æ¨¡å—ï¼Œè¿˜æœ‰éœ€è¦ç”Ÿæˆçš„ä»£ç \n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb737e2b3d63f054f9d07b36805cfe6f.png)\nç”Ÿæˆåçš„ç›®å½•å°±è¿™ä¸ªæ ·å­ï¼Œé‡Œé¢è¿˜å†™å¥½äº†å•è¡¨çš„CRUDæ“ä½œ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/17c05c5e193dc89a1409c742da29680e.png)","slug":"Ideaä½¿ç”¨æ’ä»¶å®ç°é€†å‘å·¥ç¨‹æ­å»ºSpringBooté¡¹ç›®","published":1,"updated":"2024-02-07T07:27:45.070Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dh0006wen1c9azatg3","content":"<p>ä¹‹å‰å†™SpringBooté¡¹ç›®ï¼Œæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨å»å†™å®ä½“ç±»ã€daoå±‚å•¥çš„ï¼Œå°¤å…¶æ˜¯æ•°æ®åº“è¡¨å­—æ®µç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚ç„¶åå¾ˆå¤šå°ä¼™ä¼´éƒ½ä¼šç”¨é€†å‘å·¥ç¨‹æ¥è‡ªåŠ¨ç”Ÿæˆè¿™äº›ç±»ï¼Œçœå»è®¸å¤šæ²¡å¿…è¦çš„ä»£ç é‡ï¼Œä½†æ˜¯Mybatisçš„é€†å‘å·¥ç¨‹ä¾ç„¶éœ€è¦é…ç½®ï¼Œå¯¼é€†å‘å·¥ç¨‹çš„jarå•Šï¼Œè¿˜æœ‰ç¼–å†™generatorConfig.xmlæ–‡ä»¶å•Šï¼ˆæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href=\"%E5%8D%9A%E5%AE%A2\"></a>ï¼‰ã€‚ä»Šå¤©é€›giteeçš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€æ¬¾å¯ä»¥å…å»è®¸å¤šé…ç½®çš„ideaé€†å‘å·¥ç¨‹æ’ä»¶ï¼Œå‡ ä¸ªæ­¥éª¤ç®€å•ä½¿ç”¨ä¸€ä¸‹</p>\n<p>è¿™ä¸ªæ’ä»¶ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/03211e75a42c7cdfb6feeae5e6e72104.png\" alt=\"image.png\"></p>\n<h3 id=\"ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\"><a href=\"#ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\" class=\"headerlink\" title=\"ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\"></a>ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶</h3><p>Setting-&gt;Pluginsã€‚æœç´¢EasyCodeæ’ä»¶ï¼Œå¹¶é‡å¯Ideaç¼–è¾‘å™¨<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/adb271ad8f16d31f54fe857f62466897.png\" alt=\"image.png\"></p>\n<h3 id=\"äºŒã€é…ç½®MYSQLæ•°æ®æº\"><a href=\"#äºŒã€é…ç½®MYSQLæ•°æ®æº\" class=\"headerlink\" title=\"äºŒã€é…ç½®MYSQLæ•°æ®æº\"></a>äºŒã€é…ç½®MYSQLæ•°æ®æº</h3><p>ç‚¹å‡»Ideaå³ä¾§çš„Databaseï¼Œç„¶åå†ç‚¹ä¸€ä¸‹åŠ å·ï¼Œé€‰æ‹©ä½ çš„æ•°æ®åº“ç±»å‹ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯MySQL<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/867fa36ed0e166104a784b39b6313f1f.png\" alt=\"image.png\"></p>\n<h3 id=\"ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\"><a href=\"#ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\"></a>ä¸‰ã€é…ç½®è¿æ¥å‚æ•°</h3><p>é…ç½®å¥½è‡ªå·±çš„æ•°æ®åº“è¿æ¥å‚æ•°åï¼Œç‚¹å‡»Applyï¼Œç„¶åå†ç‚¹å‡»Schemasé€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9cebd4ceea4ccbfea4a7bd42cd6b01af.png\" alt=\"image.png\"></p>\n<h3 id=\"å››ã€ç”Ÿæˆä»£ç \"><a href=\"#å››ã€ç”Ÿæˆä»£ç \" class=\"headerlink\" title=\"å››ã€ç”Ÿæˆä»£ç \"></a>å››ã€ç”Ÿæˆä»£ç </h3><p>å¦‚å›¾ï¼Œç‚¹å‡»Generate Code<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c3b18d5697e490ecb39f5d99b8a759b9.png\" alt=\"image.png\"><br>è¿™é‡Œé€‰æ‹©é¡¹ç›®æ¨¡å—ï¼Œè¿˜æœ‰éœ€è¦ç”Ÿæˆçš„ä»£ç <br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb737e2b3d63f054f9d07b36805cfe6f.png\" alt=\"image.png\"><br>ç”Ÿæˆåçš„ç›®å½•å°±è¿™ä¸ªæ ·å­ï¼Œé‡Œé¢è¿˜å†™å¥½äº†å•è¡¨çš„CRUDæ“ä½œ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/17c05c5e193dc89a1409c742da29680e.png\" alt=\"image.png\"></p>\n","excerpt":"","more":"<p>ä¹‹å‰å†™SpringBooté¡¹ç›®ï¼Œæ¯æ¬¡éƒ½è¦æ‰‹åŠ¨å»å†™å®ä½“ç±»ã€daoå±‚å•¥çš„ï¼Œå°¤å…¶æ˜¯æ•°æ®åº“è¡¨å­—æ®µç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œç‰¹åˆ«éº»çƒ¦ã€‚ç„¶åå¾ˆå¤šå°ä¼™ä¼´éƒ½ä¼šç”¨é€†å‘å·¥ç¨‹æ¥è‡ªåŠ¨ç”Ÿæˆè¿™äº›ç±»ï¼Œçœå»è®¸å¤šæ²¡å¿…è¦çš„ä»£ç é‡ï¼Œä½†æ˜¯Mybatisçš„é€†å‘å·¥ç¨‹ä¾ç„¶éœ€è¦é…ç½®ï¼Œå¯¼é€†å‘å·¥ç¨‹çš„jarå•Šï¼Œè¿˜æœ‰ç¼–å†™generatorConfig.xmlæ–‡ä»¶å•Šï¼ˆæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href=\"%E5%8D%9A%E5%AE%A2\"></a>ï¼‰ã€‚ä»Šå¤©é€›giteeçš„æ—¶å€™ï¼Œçœ‹åˆ°äº†ä¸€æ¬¾å¯ä»¥å…å»è®¸å¤šé…ç½®çš„ideaé€†å‘å·¥ç¨‹æ’ä»¶ï¼Œå‡ ä¸ªæ­¥éª¤ç®€å•ä½¿ç”¨ä¸€ä¸‹</p>\n<p>è¿™ä¸ªæ’ä»¶ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/03211e75a42c7cdfb6feeae5e6e72104.png\" alt=\"image.png\"></p>\n<h3 id=\"ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\"><a href=\"#ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\" class=\"headerlink\" title=\"ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶\"></a>ä¸€ã€ä¸‹è½½å¹¶å®‰è£…EasyCodeæ’ä»¶</h3><p>Setting-&gt;Pluginsã€‚æœç´¢EasyCodeæ’ä»¶ï¼Œå¹¶é‡å¯Ideaç¼–è¾‘å™¨<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/adb271ad8f16d31f54fe857f62466897.png\" alt=\"image.png\"></p>\n<h3 id=\"äºŒã€é…ç½®MYSQLæ•°æ®æº\"><a href=\"#äºŒã€é…ç½®MYSQLæ•°æ®æº\" class=\"headerlink\" title=\"äºŒã€é…ç½®MYSQLæ•°æ®æº\"></a>äºŒã€é…ç½®MYSQLæ•°æ®æº</h3><p>ç‚¹å‡»Ideaå³ä¾§çš„Databaseï¼Œç„¶åå†ç‚¹ä¸€ä¸‹åŠ å·ï¼Œé€‰æ‹©ä½ çš„æ•°æ®åº“ç±»å‹ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯MySQL<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/867fa36ed0e166104a784b39b6313f1f.png\" alt=\"image.png\"></p>\n<h3 id=\"ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\"><a href=\"#ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®è¿æ¥å‚æ•°\"></a>ä¸‰ã€é…ç½®è¿æ¥å‚æ•°</h3><p>é…ç½®å¥½è‡ªå·±çš„æ•°æ®åº“è¿æ¥å‚æ•°åï¼Œç‚¹å‡»Applyï¼Œç„¶åå†ç‚¹å‡»Schemasé€‰æ‹©ä½¿ç”¨å“ªä¸ªæ•°æ®åº“<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9cebd4ceea4ccbfea4a7bd42cd6b01af.png\" alt=\"image.png\"></p>\n<h3 id=\"å››ã€ç”Ÿæˆä»£ç \"><a href=\"#å››ã€ç”Ÿæˆä»£ç \" class=\"headerlink\" title=\"å››ã€ç”Ÿæˆä»£ç \"></a>å››ã€ç”Ÿæˆä»£ç </h3><p>å¦‚å›¾ï¼Œç‚¹å‡»Generate Code<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c3b18d5697e490ecb39f5d99b8a759b9.png\" alt=\"image.png\"><br>è¿™é‡Œé€‰æ‹©é¡¹ç›®æ¨¡å—ï¼Œè¿˜æœ‰éœ€è¦ç”Ÿæˆçš„ä»£ç <br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb737e2b3d63f054f9d07b36805cfe6f.png\" alt=\"image.png\"><br>ç”Ÿæˆåçš„ç›®å½•å°±è¿™ä¸ªæ ·å­ï¼Œé‡Œé¢è¿˜å†™å¥½äº†å•è¡¨çš„CRUDæ“ä½œ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/17c05c5e193dc89a1409c742da29680e.png\" alt=\"image.png\"></p>\n"},{"title":"Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®","date":"2022-02-01T09:35:40.000Z","_content":"\n**Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ã€‚**\n\nDockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2db39f1e0972b7dd1557c891d9300fdd.png)\nLinux å®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„ã€‚å°†åº”ç”¨è¿è¡Œåœ¨ Docker å®¹å™¨ä¸Šé¢ï¼Œè€Œ Docker å®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œã€‚\n\n####  ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\n> æˆ‘å–œæ¬¢å°†Dockeræ¯”å–»æˆ\"æ–¹ä¾¿é¢\"ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯æ–¹ä¾¿é¢ï¼Œä¹‹å‰éƒ¨ç½²é¡¹ç›®ç¯å¢ƒçš„é…ç½®ååˆ†éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±è¦é‡æ¥ä¸€æ¬¡ï¼Œè´¹åŠ›è´¹æ—¶ã€‚ä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé¢é…ç½®é¡¹ç›®çš„è¿è¡Œç¯å¢ƒï¼Œè¦å®‰è£…å„ç§å„æ ·çš„è½¯ä»¶JDK/MySQL/Redis/nginxï¼Œå®‰è£…å’Œé…ç½®è¿™äº›ä¸œè¥¿ååˆ†éº»çƒ¦ï¼Œä¸‹æ¬¡éœ€è¦æ¢ä¸ªæœåŠ¡å™¨é‡æ–°éƒ¨ç½²åˆå¾—é‡æ–°å®‰è£…ä¸€éï¼Œç®€ç›´è¦å‘½ã€‚è€ŒDockerèƒ½å°†é¡¹ç›®è¿å¸¦ç€è¿è¡Œç¯å¢ƒä¸€åŒéƒ¨ç½²è¿‡å»ï¼Œå°±å¥½åƒæ³¡é¢ï¼Œæ³¡é¢æ‰€éœ€çš„è°ƒæ–™åŒ…è¿˜æœ‰å·¥å…·éƒ½é™„åŠ åœ¨äº†é‡Œé¢ã€‚ä¸€å¥è¯æ€»ç»“Dockerçš„å¥½å¤„ï¼ŒDockerè§£å†³äº†è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚\n\n#### äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\n\n||Dockerå®¹å™¨|è™šæ‹Ÿæœºï¼ˆVMï¼‰|\n|-|-|-|\n|æ“ä½œç³»ç»Ÿ|ä¸å®¿ä¸»æœºå…±äº«OS|å®¿ä¸»æœºOSä¸Šè¿è¡Œè™šæ‹ŸæœºOS|\n|å­˜å‚¨å¤§å°|é•œåƒå°ï¼Œä¾¿äºå­˜å‚¨ä¸ä¼ è¾“|é•œåƒåºå¤§ï¼ˆvmdkã€vdiç­‰ï¼‰|\n|è¿è¡Œæ€§èƒ½|å‡ ä¹æ— é¢å¤–æ€§èƒ½æŸå¤±|æ“ä½œç³»ç»Ÿé¢å¤–çš„CPUã€å†…å­˜æ¶ˆè€—|\n|ç§»æ¤æ€§|è½»ä¾¿ã€çµæ´»ï¼Œé€‚ç”¨äºLinux|ç¬¨é‡ï¼Œä¸è™šæ‹ŸåŒ–æŠ€æœ¯è€¦åˆåº¦é«˜|\n|ç¡¬ä»¶äº²å’Œæ€§|é¢å‘è½¯ä»¶å¼€å‘è€…|é¢å‘ç¡¬ä»¶è¿ç»´è€…|\n\n#### ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)\n1.Dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚\n\nDockerfileä½“ç³»ç»“æ„ï¼š\n```xml\nFROMã€€ã€€åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„\nMAINTAINERã€€ã€€é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€\nRUNã€€ã€€å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤\nEXPOSEã€€ã€€å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£\nWORKDIRã€€ã€€æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•è¿›æ¥çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹\nENVã€€ã€€ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡\nADã€€ã€€å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…\nCOPYã€€ã€€ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­<æºè·¯å¾„>çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„<ç›®æ ‡è·¯å¾„>ä½ç½®\nVOLUMEã€€ã€€å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ\nCMDã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚Dockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªè¦æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMDä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢\nENTRYPOINTã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚ENTRYPOINTçš„ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°\nONBUILDã€€ã€€å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘\n```\n2.é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚\n\n3.å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚\n\n#### å››ã€å®‰è£…Docker\n\n1.å®‰è£…Dockerä¾èµ–åŒ…\n\n```xml\nyum install -y yum-utils device-mapper-persistent-data lvm2\n```\n\n2.è®¾ç½®é˜¿é‡Œäº‘é•œåƒæº\n```xml\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n```xml\n3.å®‰è£… Docker-CE\n```\n```xml\nyum install docker-ce\n```\n4.æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ\n```xml\ndocker version\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/3d0de6d7f169b639389384e8184829f5.png)\n\n#### äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\n\n1.ä½¿ç”¨Dockeræ‹‰å–Mysqlé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯MySQL5.6ç‰ˆæœ¬)\n```xml\ndocker pull mysql:5.6\n```\n2.å®‰è£…mysqlå‘½ä»¤\n```xml\ndocker run -d -p 3306:3306 --name mysql -v /ray/mysql/conf:/etc/mysql/conf.d -v /ray/mysql/logs:/logs -v /ray/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7\n```\nå‘½ä»¤è¯´æ˜ï¼š\n\n```java\n-p 3306:3306ã€€ã€€å°†ä¸»æœºçš„3306ç«¯å£æ˜ å°„åˆ°dockerå®¹å™¨çš„3306ç«¯å£\n--name mysqlã€€ã€€è¿è¡ŒæœåŠ¡å™¨åå­—\n-v /ray/mysql/conf:/etc/mysql/conf.dã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„conf/my.cnfæŒ‚è½½åˆ°å®¹å™¨çš„/etc/mysql/conf.d\n-v /ray/mysql/logs:/logsã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/logs\n-v /ray/mysql/data:/var/lib/mysqlã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/var/lib/mysql\n-e MYSQL_ROOT_PASSWORD=adminã€€ã€€åˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç \n-d mysql:5.7ã€€ã€€åå°ç¨‹åºè¿è¡Œmysql5.7\n```\n3.è¿›å…¥mysql\n```xml\ndocker exec -it MySQLè¿è¡ŒæˆåŠŸåçš„å®¹å™¨ID /bin/bash\n```\nç„¶åå³å¯ç™»å½•MySQLï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œæˆ–è€…ä½¿ç”¨Navicatç­‰å·¥å…·åˆ›å»ºæ•°æ®åº“ã€‚\n\n#### å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\n1.ä½¿ç”¨Dockeræ‹‰å–Redisé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯Redis3.2ç‰ˆæœ¬)\n```xml\ndocker pull redis:3.2\n```\n2.å®‰è£…rediså‘½ä»¤(è¿™é‡Œä¸å¯¹å‘½ä»¤åšè§£é‡Š)\n```xml\ndocker run -p 6379:6379 -v /ray/redis/data:/data -v /ray/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf --appendonly yes\n```\nåŠ å¯†ç `--requirepass \"admin\"`\n#### ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\n\n1.å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…(å‡è®¾åå­—ä¸ºmyblog.jar)ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªDockerfileæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n\n```xml\n# Docker image for springboot file run\n# VERSION 0.0.1\n# Author: Ray\n# åŸºç¡€é•œåƒä½¿ç”¨java\nFROM java:8\n# ä½œè€…\nMAINTAINER Ray <185048761@qq.com>\n# VOLUME æŒ‡å®šäº†ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸º/tmpã€‚\n# å…¶æ•ˆæœæ˜¯åœ¨ä¸»æœº /var/lib/docker ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶é“¾æ¥åˆ°å®¹å™¨çš„/tmp\nVOLUME /tmp\n# å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ä¸­å¹¶æ›´åä¸ºapp.jar\nADD myblog.jar app.jar\n# è¿è¡ŒjaråŒ…\nRUN bash -c 'touch /app.jar'\nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/app.jar\"]\n#æš´éœ²8080ç«¯å£\nEXPOSE 80\n```\n2.å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€å¹¶ä¸Šä¼ è‡³æœåŠ¡å™¨ä¸­çš„åŒä¸€ä¸ªç›®å½•ä¸‹é¢ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹åæ‰§è¡Œæ­¤å‘½ä»¤æ„å»ºé•œåƒï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/f175e9402c4d4bf3e98c78f055b6e9c6.png)\n```xml\ndocker build -t myblog.jar .\n```\n3.ç”Ÿæˆdockerå®¹å™¨ï¼Œå¹¶è¿è¡Œ\n```xml\ndocker run -d -p 80:80 myblog.jar\n```\nç­‰ä¸€ä¼šå„¿ï¼ŒSpringBooté¡¹ç›®è·‘èµ·æ¥äº†åï¼Œå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨é€šè¿‡80ç«¯å£è¿›è¡Œè®¿é—®äº†","source":"_posts/Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®.md","raw":"---\ntitle: Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®\ndate: 2022-02-01 17:35:40\ntags:\n---\n\n**Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ã€‚**\n\nDockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2db39f1e0972b7dd1557c891d9300fdd.png)\nLinux å®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„ã€‚å°†åº”ç”¨è¿è¡Œåœ¨ Docker å®¹å™¨ä¸Šé¢ï¼Œè€Œ Docker å®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œã€‚\n\n####  ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\n> æˆ‘å–œæ¬¢å°†Dockeræ¯”å–»æˆ\"æ–¹ä¾¿é¢\"ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯æ–¹ä¾¿é¢ï¼Œä¹‹å‰éƒ¨ç½²é¡¹ç›®ç¯å¢ƒçš„é…ç½®ååˆ†éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±è¦é‡æ¥ä¸€æ¬¡ï¼Œè´¹åŠ›è´¹æ—¶ã€‚ä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé¢é…ç½®é¡¹ç›®çš„è¿è¡Œç¯å¢ƒï¼Œè¦å®‰è£…å„ç§å„æ ·çš„è½¯ä»¶JDK/MySQL/Redis/nginxï¼Œå®‰è£…å’Œé…ç½®è¿™äº›ä¸œè¥¿ååˆ†éº»çƒ¦ï¼Œä¸‹æ¬¡éœ€è¦æ¢ä¸ªæœåŠ¡å™¨é‡æ–°éƒ¨ç½²åˆå¾—é‡æ–°å®‰è£…ä¸€éï¼Œç®€ç›´è¦å‘½ã€‚è€ŒDockerèƒ½å°†é¡¹ç›®è¿å¸¦ç€è¿è¡Œç¯å¢ƒä¸€åŒéƒ¨ç½²è¿‡å»ï¼Œå°±å¥½åƒæ³¡é¢ï¼Œæ³¡é¢æ‰€éœ€çš„è°ƒæ–™åŒ…è¿˜æœ‰å·¥å…·éƒ½é™„åŠ åœ¨äº†é‡Œé¢ã€‚ä¸€å¥è¯æ€»ç»“Dockerçš„å¥½å¤„ï¼ŒDockerè§£å†³äº†è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚\n\n#### äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\n\n||Dockerå®¹å™¨|è™šæ‹Ÿæœºï¼ˆVMï¼‰|\n|-|-|-|\n|æ“ä½œç³»ç»Ÿ|ä¸å®¿ä¸»æœºå…±äº«OS|å®¿ä¸»æœºOSä¸Šè¿è¡Œè™šæ‹ŸæœºOS|\n|å­˜å‚¨å¤§å°|é•œåƒå°ï¼Œä¾¿äºå­˜å‚¨ä¸ä¼ è¾“|é•œåƒåºå¤§ï¼ˆvmdkã€vdiç­‰ï¼‰|\n|è¿è¡Œæ€§èƒ½|å‡ ä¹æ— é¢å¤–æ€§èƒ½æŸå¤±|æ“ä½œç³»ç»Ÿé¢å¤–çš„CPUã€å†…å­˜æ¶ˆè€—|\n|ç§»æ¤æ€§|è½»ä¾¿ã€çµæ´»ï¼Œé€‚ç”¨äºLinux|ç¬¨é‡ï¼Œä¸è™šæ‹ŸåŒ–æŠ€æœ¯è€¦åˆåº¦é«˜|\n|ç¡¬ä»¶äº²å’Œæ€§|é¢å‘è½¯ä»¶å¼€å‘è€…|é¢å‘ç¡¬ä»¶è¿ç»´è€…|\n\n#### ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)\n1.Dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚\n\nDockerfileä½“ç³»ç»“æ„ï¼š\n```xml\nFROMã€€ã€€åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„\nMAINTAINERã€€ã€€é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€\nRUNã€€ã€€å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤\nEXPOSEã€€ã€€å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£\nWORKDIRã€€ã€€æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•è¿›æ¥çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹\nENVã€€ã€€ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡\nADã€€ã€€å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…\nCOPYã€€ã€€ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­<æºè·¯å¾„>çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„<ç›®æ ‡è·¯å¾„>ä½ç½®\nVOLUMEã€€ã€€å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ\nCMDã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚Dockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªè¦æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMDä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢\nENTRYPOINTã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚ENTRYPOINTçš„ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°\nONBUILDã€€ã€€å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘\n```\n2.é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚\n\n3.å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚\n\n#### å››ã€å®‰è£…Docker\n\n1.å®‰è£…Dockerä¾èµ–åŒ…\n\n```xml\nyum install -y yum-utils device-mapper-persistent-data lvm2\n```\n\n2.è®¾ç½®é˜¿é‡Œäº‘é•œåƒæº\n```xml\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n```\n```xml\n3.å®‰è£… Docker-CE\n```\n```xml\nyum install docker-ce\n```\n4.æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ\n```xml\ndocker version\n```\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/3d0de6d7f169b639389384e8184829f5.png)\n\n#### äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\n\n1.ä½¿ç”¨Dockeræ‹‰å–Mysqlé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯MySQL5.6ç‰ˆæœ¬)\n```xml\ndocker pull mysql:5.6\n```\n2.å®‰è£…mysqlå‘½ä»¤\n```xml\ndocker run -d -p 3306:3306 --name mysql -v /ray/mysql/conf:/etc/mysql/conf.d -v /ray/mysql/logs:/logs -v /ray/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7\n```\nå‘½ä»¤è¯´æ˜ï¼š\n\n```java\n-p 3306:3306ã€€ã€€å°†ä¸»æœºçš„3306ç«¯å£æ˜ å°„åˆ°dockerå®¹å™¨çš„3306ç«¯å£\n--name mysqlã€€ã€€è¿è¡ŒæœåŠ¡å™¨åå­—\n-v /ray/mysql/conf:/etc/mysql/conf.dã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„conf/my.cnfæŒ‚è½½åˆ°å®¹å™¨çš„/etc/mysql/conf.d\n-v /ray/mysql/logs:/logsã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/logs\n-v /ray/mysql/data:/var/lib/mysqlã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/var/lib/mysql\n-e MYSQL_ROOT_PASSWORD=adminã€€ã€€åˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç \n-d mysql:5.7ã€€ã€€åå°ç¨‹åºè¿è¡Œmysql5.7\n```\n3.è¿›å…¥mysql\n```xml\ndocker exec -it MySQLè¿è¡ŒæˆåŠŸåçš„å®¹å™¨ID /bin/bash\n```\nç„¶åå³å¯ç™»å½•MySQLï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œæˆ–è€…ä½¿ç”¨Navicatç­‰å·¥å…·åˆ›å»ºæ•°æ®åº“ã€‚\n\n#### å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\n1.ä½¿ç”¨Dockeræ‹‰å–Redisé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯Redis3.2ç‰ˆæœ¬)\n```xml\ndocker pull redis:3.2\n```\n2.å®‰è£…rediså‘½ä»¤(è¿™é‡Œä¸å¯¹å‘½ä»¤åšè§£é‡Š)\n```xml\ndocker run -p 6379:6379 -v /ray/redis/data:/data -v /ray/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf --appendonly yes\n```\nåŠ å¯†ç `--requirepass \"admin\"`\n#### ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\n\n1.å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…(å‡è®¾åå­—ä¸ºmyblog.jar)ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªDockerfileæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n\n```xml\n# Docker image for springboot file run\n# VERSION 0.0.1\n# Author: Ray\n# åŸºç¡€é•œåƒä½¿ç”¨java\nFROM java:8\n# ä½œè€…\nMAINTAINER Ray <185048761@qq.com>\n# VOLUME æŒ‡å®šäº†ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸º/tmpã€‚\n# å…¶æ•ˆæœæ˜¯åœ¨ä¸»æœº /var/lib/docker ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶é“¾æ¥åˆ°å®¹å™¨çš„/tmp\nVOLUME /tmp\n# å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ä¸­å¹¶æ›´åä¸ºapp.jar\nADD myblog.jar app.jar\n# è¿è¡ŒjaråŒ…\nRUN bash -c 'touch /app.jar'\nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/app.jar\"]\n#æš´éœ²8080ç«¯å£\nEXPOSE 80\n```\n2.å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€å¹¶ä¸Šä¼ è‡³æœåŠ¡å™¨ä¸­çš„åŒä¸€ä¸ªç›®å½•ä¸‹é¢ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹åæ‰§è¡Œæ­¤å‘½ä»¤æ„å»ºé•œåƒï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/f175e9402c4d4bf3e98c78f055b6e9c6.png)\n```xml\ndocker build -t myblog.jar .\n```\n3.ç”Ÿæˆdockerå®¹å™¨ï¼Œå¹¶è¿è¡Œ\n```xml\ndocker run -d -p 80:80 myblog.jar\n```\nç­‰ä¸€ä¼šå„¿ï¼ŒSpringBooté¡¹ç›®è·‘èµ·æ¥äº†åï¼Œå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨é€šè¿‡80ç«¯å£è¿›è¡Œè®¿é—®äº†","slug":"Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®","published":1,"updated":"2024-04-17T07:24:29.537Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83di0007wen122tphjgn","content":"<p><strong>Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ã€‚</strong></p>\n<p>Dockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2db39f1e0972b7dd1557c891d9300fdd.png\" alt=\"image.png\"><br>Linux å®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„ã€‚å°†åº”ç”¨è¿è¡Œåœ¨ Docker å®¹å™¨ä¸Šé¢ï¼Œè€Œ Docker å®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œã€‚</p>\n<h4 id=\"ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\"><a href=\"#ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\" class=\"headerlink\" title=\"ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\"></a>ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker</h4><blockquote>\n<p>æˆ‘å–œæ¬¢å°†Dockeræ¯”å–»æˆâ€æ–¹ä¾¿é¢â€ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯æ–¹ä¾¿é¢ï¼Œä¹‹å‰éƒ¨ç½²é¡¹ç›®ç¯å¢ƒçš„é…ç½®ååˆ†éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±è¦é‡æ¥ä¸€æ¬¡ï¼Œè´¹åŠ›è´¹æ—¶ã€‚ä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé¢é…ç½®é¡¹ç›®çš„è¿è¡Œç¯å¢ƒï¼Œè¦å®‰è£…å„ç§å„æ ·çš„è½¯ä»¶JDK&#x2F;MySQL&#x2F;Redis&#x2F;nginxï¼Œå®‰è£…å’Œé…ç½®è¿™äº›ä¸œè¥¿ååˆ†éº»çƒ¦ï¼Œä¸‹æ¬¡éœ€è¦æ¢ä¸ªæœåŠ¡å™¨é‡æ–°éƒ¨ç½²åˆå¾—é‡æ–°å®‰è£…ä¸€éï¼Œç®€ç›´è¦å‘½ã€‚è€ŒDockerèƒ½å°†é¡¹ç›®è¿å¸¦ç€è¿è¡Œç¯å¢ƒä¸€åŒéƒ¨ç½²è¿‡å»ï¼Œå°±å¥½åƒæ³¡é¢ï¼Œæ³¡é¢æ‰€éœ€çš„è°ƒæ–™åŒ…è¿˜æœ‰å·¥å…·éƒ½é™„åŠ åœ¨äº†é‡Œé¢ã€‚ä¸€å¥è¯æ€»ç»“Dockerçš„å¥½å¤„ï¼ŒDockerè§£å†³äº†è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚</p>\n</blockquote>\n<h4 id=\"äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\"><a href=\"#äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\" class=\"headerlink\" title=\"äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\"></a>äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th>Dockerå®¹å™¨</th>\n<th>è™šæ‹Ÿæœºï¼ˆVMï¼‰</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ“ä½œç³»ç»Ÿ</td>\n<td>ä¸å®¿ä¸»æœºå…±äº«OS</td>\n<td>å®¿ä¸»æœºOSä¸Šè¿è¡Œè™šæ‹ŸæœºOS</td>\n</tr>\n<tr>\n<td>å­˜å‚¨å¤§å°</td>\n<td>é•œåƒå°ï¼Œä¾¿äºå­˜å‚¨ä¸ä¼ è¾“</td>\n<td>é•œåƒåºå¤§ï¼ˆvmdkã€vdiç­‰ï¼‰</td>\n</tr>\n<tr>\n<td>è¿è¡Œæ€§èƒ½</td>\n<td>å‡ ä¹æ— é¢å¤–æ€§èƒ½æŸå¤±</td>\n<td>æ“ä½œç³»ç»Ÿé¢å¤–çš„CPUã€å†…å­˜æ¶ˆè€—</td>\n</tr>\n<tr>\n<td>ç§»æ¤æ€§</td>\n<td>è½»ä¾¿ã€çµæ´»ï¼Œé€‚ç”¨äºLinux</td>\n<td>ç¬¨é‡ï¼Œä¸è™šæ‹ŸåŒ–æŠ€æœ¯è€¦åˆåº¦é«˜</td>\n</tr>\n<tr>\n<td>ç¡¬ä»¶äº²å’Œæ€§</td>\n<td>é¢å‘è½¯ä»¶å¼€å‘è€…</td>\n<td>é¢å‘ç¡¬ä»¶è¿ç»´è€…</td>\n</tr>\n</tbody></table>\n<h4 id=\"ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ-image-ã€å®¹å™¨-Container\"><a href=\"#ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ-image-ã€å®¹å™¨-Container\" class=\"headerlink\" title=\"ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)\"></a>ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)</h4><p>1.Dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚</p>\n<p>Dockerfileä½“ç³»ç»“æ„ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROMã€€ã€€åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„</span><br><span class=\"line\">MAINTAINERã€€ã€€é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€</span><br><span class=\"line\">RUNã€€ã€€å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</span><br><span class=\"line\">EXPOSEã€€ã€€å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£</span><br><span class=\"line\">WORKDIRã€€ã€€æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•è¿›æ¥çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹</span><br><span class=\"line\">ENVã€€ã€€ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class=\"line\">ADã€€ã€€å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…</span><br><span class=\"line\">COPYã€€ã€€ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­<span class=\"tag\">&lt;<span class=\"name\">æºè·¯å¾„</span>&gt;</span>çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„<span class=\"tag\">&lt;<span class=\"name\">ç›®æ ‡è·¯å¾„</span>&gt;</span>ä½ç½®</span><br><span class=\"line\">VOLUMEã€€ã€€å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ</span><br><span class=\"line\">CMDã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚Dockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªè¦æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMDä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢</span><br><span class=\"line\">ENTRYPOINTã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚ENTRYPOINTçš„ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°</span><br><span class=\"line\">ONBUILDã€€ã€€å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘</span><br></pre></td></tr></table></figure>\n<p>2.é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</p>\n<p>3.å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚</p>\n<h4 id=\"å››ã€å®‰è£…Docker\"><a href=\"#å››ã€å®‰è£…Docker\" class=\"headerlink\" title=\"å››ã€å®‰è£…Docker\"></a>å››ã€å®‰è£…Docker</h4><p>1.å®‰è£…Dockerä¾èµ–åŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>\n\n<p>2.è®¾ç½®é˜¿é‡Œäº‘é•œåƒæº</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3.å®‰è£… Docker-CE</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install docker-ce</span><br></pre></td></tr></table></figure>\n<p>4.æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/3d0de6d7f169b639389384e8184829f5.png\" alt=\"image.png\"></p>\n<h4 id=\"äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\"><a href=\"#äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\" class=\"headerlink\" title=\"äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\"></a>äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL</h4><p>1.ä½¿ç”¨Dockeræ‹‰å–Mysqlé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯MySQL5.6ç‰ˆæœ¬)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:5.6</span><br></pre></td></tr></table></figure>\n<p>2.å®‰è£…mysqlå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 --name mysql -v /ray/mysql/conf:/etc/mysql/conf.d -v /ray/mysql/logs:/logs -v /ray/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7</span><br></pre></td></tr></table></figure>\n<p>å‘½ä»¤è¯´æ˜ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-p <span class=\"number\">3306</span>:<span class=\"number\">3306</span>ã€€ã€€å°†ä¸»æœºçš„<span class=\"number\">3306</span>ç«¯å£æ˜ å°„åˆ°dockerå®¹å™¨çš„<span class=\"number\">3306</span>ç«¯å£</span><br><span class=\"line\">--name mysqlã€€ã€€è¿è¡ŒæœåŠ¡å™¨åå­—</span><br><span class=\"line\">-v /ray/mysql/conf:/etc/mysql/conf.dã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„conf/my.cnfæŒ‚è½½åˆ°å®¹å™¨çš„/etc/mysql/conf.d</span><br><span class=\"line\">-v /ray/mysql/logs:/logsã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/logs</span><br><span class=\"line\">-v /ray/mysql/data:/<span class=\"keyword\">var</span>/lib/mysqlã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/<span class=\"keyword\">var</span>/lib/mysql</span><br><span class=\"line\">-e MYSQL_ROOT_PASSWORD=adminã€€ã€€åˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç </span><br><span class=\"line\">-d mysql:<span class=\"number\">5.7</span>ã€€ã€€åå°ç¨‹åºè¿è¡Œmysql5<span class=\"number\">.7</span></span><br></pre></td></tr></table></figure>\n<p>3.è¿›å…¥mysql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it MySQLè¿è¡ŒæˆåŠŸåçš„å®¹å™¨ID /bin/bash</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå³å¯ç™»å½•MySQLï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œæˆ–è€…ä½¿ç”¨Navicatç­‰å·¥å…·åˆ›å»ºæ•°æ®åº“ã€‚</p>\n<h4 id=\"å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\"><a href=\"#å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\" class=\"headerlink\" title=\"å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\"></a>å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis</h4><p>1.ä½¿ç”¨Dockeræ‹‰å–Redisé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯Redis3.2ç‰ˆæœ¬)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull redis:3.2</span><br></pre></td></tr></table></figure>\n<p>2.å®‰è£…rediså‘½ä»¤(è¿™é‡Œä¸å¯¹å‘½ä»¤åšè§£é‡Š)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -p 6379:6379 -v /ray/redis/data:/data -v /ray/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf --appendonly yes</span><br></pre></td></tr></table></figure>\n<p>åŠ å¯†ç <code>--requirepass &quot;admin&quot;</code></p>\n<h4 id=\"ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\"><a href=\"#ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\" class=\"headerlink\" title=\"ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\"></a>ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®</h4><p>1.å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…(å‡è®¾åå­—ä¸ºmyblog.jar)ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªDockerfileæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Docker image for springboot file run</span><br><span class=\"line\"># VERSION 0.0.1</span><br><span class=\"line\"># Author: Ray</span><br><span class=\"line\"># åŸºç¡€é•œåƒä½¿ç”¨java</span><br><span class=\"line\">FROM java:8</span><br><span class=\"line\"># ä½œè€…</span><br><span class=\"line\">MAINTAINER Ray &lt;185048761@qq.com&gt;</span><br><span class=\"line\"># VOLUME æŒ‡å®šäº†ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸º/tmpã€‚</span><br><span class=\"line\"># å…¶æ•ˆæœæ˜¯åœ¨ä¸»æœº /var/lib/docker ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶é“¾æ¥åˆ°å®¹å™¨çš„/tmp</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\"># å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ä¸­å¹¶æ›´åä¸ºapp.jar</span><br><span class=\"line\">ADD myblog.jar app.jar</span><br><span class=\"line\"># è¿è¡ŒjaråŒ…</span><br><span class=\"line\">RUN bash -c &#x27;touch /app.jar&#x27;</span><br><span class=\"line\">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br><span class=\"line\">#æš´éœ²8080ç«¯å£</span><br><span class=\"line\">EXPOSE 80</span><br></pre></td></tr></table></figure>\n<p>2.å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€å¹¶ä¸Šä¼ è‡³æœåŠ¡å™¨ä¸­çš„åŒä¸€ä¸ªç›®å½•ä¸‹é¢ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹åæ‰§è¡Œæ­¤å‘½ä»¤æ„å»ºé•œåƒï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/f175e9402c4d4bf3e98c78f055b6e9c6.png\" alt=\"image.png\"></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t myblog.jar .</span><br></pre></td></tr></table></figure>\n<p>3.ç”Ÿæˆdockerå®¹å™¨ï¼Œå¹¶è¿è¡Œ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 80:80 myblog.jar</span><br></pre></td></tr></table></figure>\n<p>ç­‰ä¸€ä¼šå„¿ï¼ŒSpringBooté¡¹ç›®è·‘èµ·æ¥äº†åï¼Œå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨é€šè¿‡80ç«¯å£è¿›è¡Œè®¿é—®äº†</p>\n","excerpt":"","more":"<p><strong>Dockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ã€‚</strong></p>\n<p>Dockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2db39f1e0972b7dd1557c891d9300fdd.png\" alt=\"image.png\"><br>Linux å®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„ã€‚å°†åº”ç”¨è¿è¡Œåœ¨ Docker å®¹å™¨ä¸Šé¢ï¼Œè€Œ Docker å®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œã€‚</p>\n<h4 id=\"ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\"><a href=\"#ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\" class=\"headerlink\" title=\"ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker\"></a>ä¸€ã€æˆ‘æ‰€ç†è§£çš„Docker</h4><blockquote>\n<p>æˆ‘å–œæ¬¢å°†Dockeræ¯”å–»æˆâ€æ–¹ä¾¿é¢â€ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯æ–¹ä¾¿é¢ï¼Œä¹‹å‰éƒ¨ç½²é¡¹ç›®ç¯å¢ƒçš„é…ç½®ååˆ†éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±è¦é‡æ¥ä¸€æ¬¡ï¼Œè´¹åŠ›è´¹æ—¶ã€‚ä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªSpringBooté¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé¢é…ç½®é¡¹ç›®çš„è¿è¡Œç¯å¢ƒï¼Œè¦å®‰è£…å„ç§å„æ ·çš„è½¯ä»¶JDK&#x2F;MySQL&#x2F;Redis&#x2F;nginxï¼Œå®‰è£…å’Œé…ç½®è¿™äº›ä¸œè¥¿ååˆ†éº»çƒ¦ï¼Œä¸‹æ¬¡éœ€è¦æ¢ä¸ªæœåŠ¡å™¨é‡æ–°éƒ¨ç½²åˆå¾—é‡æ–°å®‰è£…ä¸€éï¼Œç®€ç›´è¦å‘½ã€‚è€ŒDockerèƒ½å°†é¡¹ç›®è¿å¸¦ç€è¿è¡Œç¯å¢ƒä¸€åŒéƒ¨ç½²è¿‡å»ï¼Œå°±å¥½åƒæ³¡é¢ï¼Œæ³¡é¢æ‰€éœ€çš„è°ƒæ–™åŒ…è¿˜æœ‰å·¥å…·éƒ½é™„åŠ åœ¨äº†é‡Œé¢ã€‚ä¸€å¥è¯æ€»ç»“Dockerçš„å¥½å¤„ï¼ŒDockerè§£å†³äº†è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚</p>\n</blockquote>\n<h4 id=\"äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\"><a href=\"#äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\" class=\"headerlink\" title=\"äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«\"></a>äºŒã€Dockerä¸è™šæ‹Ÿæœºçš„åŒºåˆ«</h4><table>\n<thead>\n<tr>\n<th></th>\n<th>Dockerå®¹å™¨</th>\n<th>è™šæ‹Ÿæœºï¼ˆVMï¼‰</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ“ä½œç³»ç»Ÿ</td>\n<td>ä¸å®¿ä¸»æœºå…±äº«OS</td>\n<td>å®¿ä¸»æœºOSä¸Šè¿è¡Œè™šæ‹ŸæœºOS</td>\n</tr>\n<tr>\n<td>å­˜å‚¨å¤§å°</td>\n<td>é•œåƒå°ï¼Œä¾¿äºå­˜å‚¨ä¸ä¼ è¾“</td>\n<td>é•œåƒåºå¤§ï¼ˆvmdkã€vdiç­‰ï¼‰</td>\n</tr>\n<tr>\n<td>è¿è¡Œæ€§èƒ½</td>\n<td>å‡ ä¹æ— é¢å¤–æ€§èƒ½æŸå¤±</td>\n<td>æ“ä½œç³»ç»Ÿé¢å¤–çš„CPUã€å†…å­˜æ¶ˆè€—</td>\n</tr>\n<tr>\n<td>ç§»æ¤æ€§</td>\n<td>è½»ä¾¿ã€çµæ´»ï¼Œé€‚ç”¨äºLinux</td>\n<td>ç¬¨é‡ï¼Œä¸è™šæ‹ŸåŒ–æŠ€æœ¯è€¦åˆåº¦é«˜</td>\n</tr>\n<tr>\n<td>ç¡¬ä»¶äº²å’Œæ€§</td>\n<td>é¢å‘è½¯ä»¶å¼€å‘è€…</td>\n<td>é¢å‘ç¡¬ä»¶è¿ç»´è€…</td>\n</tr>\n</tbody></table>\n<h4 id=\"ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ-image-ã€å®¹å™¨-Container\"><a href=\"#ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ-image-ã€å®¹å™¨-Container\" class=\"headerlink\" title=\"ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)\"></a>ä¸‰ã€Dockeré‡Œé¢ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µDockerfileã€é•œåƒ(image)ã€å®¹å™¨(Container)</h4><p>1.Dockerfileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚</p>\n<p>Dockerfileä½“ç³»ç»“æ„ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROMã€€ã€€åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„</span><br><span class=\"line\">MAINTAINERã€€ã€€é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€</span><br><span class=\"line\">RUNã€€ã€€å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</span><br><span class=\"line\">EXPOSEã€€ã€€å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£</span><br><span class=\"line\">WORKDIRã€€ã€€æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•è¿›æ¥çš„å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹</span><br><span class=\"line\">ENVã€€ã€€ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class=\"line\">ADã€€ã€€å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…</span><br><span class=\"line\">COPYã€€ã€€ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚å°†ä»æ„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­<span class=\"tag\">&lt;<span class=\"name\">æºè·¯å¾„</span>&gt;</span>çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„<span class=\"tag\">&lt;<span class=\"name\">ç›®æ ‡è·¯å¾„</span>&gt;</span>ä½ç½®</span><br><span class=\"line\">VOLUMEã€€ã€€å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ</span><br><span class=\"line\">CMDã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚Dockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªè¦æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMDä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢</span><br><span class=\"line\">ENTRYPOINTã€€ã€€æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ã€‚ENTRYPOINTçš„ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°</span><br><span class=\"line\">ONBUILDã€€ã€€å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘</span><br></pre></td></tr></table></figure>\n<p>2.é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</p>\n<p>3.å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„Linuxç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚</p>\n<h4 id=\"å››ã€å®‰è£…Docker\"><a href=\"#å››ã€å®‰è£…Docker\" class=\"headerlink\" title=\"å››ã€å®‰è£…Docker\"></a>å››ã€å®‰è£…Docker</h4><p>1.å®‰è£…Dockerä¾èµ–åŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>\n\n<p>2.è®¾ç½®é˜¿é‡Œäº‘é•œåƒæº</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3.å®‰è£… Docker-CE</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install docker-ce</span><br></pre></td></tr></table></figure>\n<p>4.æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/3d0de6d7f169b639389384e8184829f5.png\" alt=\"image.png\"></p>\n<h4 id=\"äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\"><a href=\"#äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\" class=\"headerlink\" title=\"äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL\"></a>äº”ã€ä½¿ç”¨Dockerå®‰è£…MySQL</h4><p>1.ä½¿ç”¨Dockeræ‹‰å–Mysqlé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯MySQL5.6ç‰ˆæœ¬)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:5.6</span><br></pre></td></tr></table></figure>\n<p>2.å®‰è£…mysqlå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 3306:3306 --name mysql -v /ray/mysql/conf:/etc/mysql/conf.d -v /ray/mysql/logs:/logs -v /ray/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7</span><br></pre></td></tr></table></figure>\n<p>å‘½ä»¤è¯´æ˜ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-p <span class=\"number\">3306</span>:<span class=\"number\">3306</span>ã€€ã€€å°†ä¸»æœºçš„<span class=\"number\">3306</span>ç«¯å£æ˜ å°„åˆ°dockerå®¹å™¨çš„<span class=\"number\">3306</span>ç«¯å£</span><br><span class=\"line\">--name mysqlã€€ã€€è¿è¡ŒæœåŠ¡å™¨åå­—</span><br><span class=\"line\">-v /ray/mysql/conf:/etc/mysql/conf.dã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„conf/my.cnfæŒ‚è½½åˆ°å®¹å™¨çš„/etc/mysql/conf.d</span><br><span class=\"line\">-v /ray/mysql/logs:/logsã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„logsç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/logs</span><br><span class=\"line\">-v /ray/mysql/data:/<span class=\"keyword\">var</span>/lib/mysqlã€€ã€€å°†ä¸»æœº/ray/mysqlç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/<span class=\"keyword\">var</span>/lib/mysql</span><br><span class=\"line\">-e MYSQL_ROOT_PASSWORD=adminã€€ã€€åˆå§‹åŒ–rootç”¨æˆ·çš„å¯†ç </span><br><span class=\"line\">-d mysql:<span class=\"number\">5.7</span>ã€€ã€€åå°ç¨‹åºè¿è¡Œmysql5<span class=\"number\">.7</span></span><br></pre></td></tr></table></figure>\n<p>3.è¿›å…¥mysql</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it MySQLè¿è¡ŒæˆåŠŸåçš„å®¹å™¨ID /bin/bash</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå³å¯ç™»å½•MySQLï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œæˆ–è€…ä½¿ç”¨Navicatç­‰å·¥å…·åˆ›å»ºæ•°æ®åº“ã€‚</p>\n<h4 id=\"å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\"><a href=\"#å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\" class=\"headerlink\" title=\"å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis\"></a>å…­ã€ä½¿ç”¨Dockerå®‰è£…Redis</h4><p>1.ä½¿ç”¨Dockeræ‹‰å–Redisé•œåƒ(è¿™é‡Œå®‰è£…çš„æ˜¯Redis3.2ç‰ˆæœ¬)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull redis:3.2</span><br></pre></td></tr></table></figure>\n<p>2.å®‰è£…rediså‘½ä»¤(è¿™é‡Œä¸å¯¹å‘½ä»¤åšè§£é‡Š)</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -p 6379:6379 -v /ray/redis/data:/data -v /ray/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf --appendonly yes</span><br></pre></td></tr></table></figure>\n<p>åŠ å¯†ç <code>--requirepass &quot;admin&quot;</code></p>\n<h4 id=\"ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\"><a href=\"#ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\" class=\"headerlink\" title=\"ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®\"></a>ä¸ƒã€Dockeréƒ¨ç½²SpringBooté¡¹ç›®</h4><p>1.å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…(å‡è®¾åå­—ä¸ºmyblog.jar)ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªDockerfileæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Docker image for springboot file run</span><br><span class=\"line\"># VERSION 0.0.1</span><br><span class=\"line\"># Author: Ray</span><br><span class=\"line\"># åŸºç¡€é•œåƒä½¿ç”¨java</span><br><span class=\"line\">FROM java:8</span><br><span class=\"line\"># ä½œè€…</span><br><span class=\"line\">MAINTAINER Ray &lt;185048761@qq.com&gt;</span><br><span class=\"line\"># VOLUME æŒ‡å®šäº†ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸º/tmpã€‚</span><br><span class=\"line\"># å…¶æ•ˆæœæ˜¯åœ¨ä¸»æœº /var/lib/docker ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶é“¾æ¥åˆ°å®¹å™¨çš„/tmp</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\"># å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ä¸­å¹¶æ›´åä¸ºapp.jar</span><br><span class=\"line\">ADD myblog.jar app.jar</span><br><span class=\"line\"># è¿è¡ŒjaråŒ…</span><br><span class=\"line\">RUN bash -c &#x27;touch /app.jar&#x27;</span><br><span class=\"line\">ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br><span class=\"line\">#æš´éœ²8080ç«¯å£</span><br><span class=\"line\">EXPOSE 80</span><br></pre></td></tr></table></figure>\n<p>2.å°†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€å¹¶ä¸Šä¼ è‡³æœåŠ¡å™¨ä¸­çš„åŒä¸€ä¸ªç›®å½•ä¸‹é¢ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹åæ‰§è¡Œæ­¤å‘½ä»¤æ„å»ºé•œåƒï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/f175e9402c4d4bf3e98c78f055b6e9c6.png\" alt=\"image.png\"></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t myblog.jar .</span><br></pre></td></tr></table></figure>\n<p>3.ç”Ÿæˆdockerå®¹å™¨ï¼Œå¹¶è¿è¡Œ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 80:80 myblog.jar</span><br></pre></td></tr></table></figure>\n<p>ç­‰ä¸€ä¼šå„¿ï¼ŒSpringBooté¡¹ç›®è·‘èµ·æ¥äº†åï¼Œå°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨é€šè¿‡80ç«¯å£è¿›è¡Œè®¿é—®äº†</p>\n"},{"title":"Ideaå¼€å‘å¿…è£…æ’ä»¶","date":"2022-07-27T07:24:24.000Z","_content":"\n> ï¼‚å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼‚ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘å·¥ä½œä¸­å¿…å¤‡çš„Ideaå¼€å‘æ’ä»¶\n\n### 1.Alibaba Java Coding Guidelines\n\n> æˆ‘ä»¬å¾ˆé«˜å…´æ¨å‡ºé˜¿é‡Œå·´å·´ Java ç¼–ç æŒ‡å—ï¼Œå®ƒæ•´åˆäº†é˜¿é‡Œå·´å·´é›†å›¢æŠ€æœ¯å›¢é˜Ÿå¤šå¹´æ¥çš„æœ€ä½³ç¼–ç¨‹å®è·µã€‚å¤§é‡çš„ Java ç¼–ç¨‹å›¢é˜Ÿå¯¹è·¨é¡¹ç›®çš„ä»£ç è´¨é‡æå‡ºäº†è‹›åˆ»çš„è¦æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬é¼“åŠ±é‡ç”¨å’Œæ›´å¥½åœ°ç†è§£å½¼æ­¤çš„ç¨‹åºã€‚è¿‡å»æˆ‘ä»¬è§è¿‡å¾ˆå¤šç¼–ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæœ‰ç¼ºé™·çš„æ•°æ®åº“è¡¨ç»“æ„å’Œç´¢å¼•è®¾è®¡å¯èƒ½ä¼šå¯¼è‡´è½¯ä»¶æ¶æ„ç¼ºé™·å’Œæ€§èƒ½é£é™©ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯éš¾ä»¥ç»´æŠ¤çš„æ··ä¹±ä»£ç ç»“æ„ã€‚æ­¤å¤–ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ˜“å—æ”»å‡»çš„ä»£ç å¾ˆå®¹æ˜“å—åˆ°é»‘å®¢çš„æ”»å‡»ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ºé˜¿é‡Œå·´å·´çš„ Java å¼€å‘äººå‘˜ç¼–å†™äº†è¿™ä»½æ–‡æ¡£ã€‚\n\né˜¿é‡Œå·´å·´ä»£ç è§„èŒƒæ£€æŸ¥æ’ä»¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬çš„ä»£ç æ›´åŠ è§„èŒƒã€‚\n\n### 2.ignore\n\nå¿½ç•¥Gitä¸å¿…è¦æäº¤çš„æ–‡ä»¶\n\n### 3.Codota Ai\n\né€‚ç”¨äºJavaå’ŒJavaScriptçš„Codota AIè‡ªåŠ¨è¡¥å…¨ä»£ç æ’ä»¶\n\n>[Codota](https://www.codota.com/)åŸºäºæ•°ç™¾ä¸‡ä¸ªå¼€æº Java ç¨‹åºå’Œæ‚¨çš„ä¸Šä¸‹æ–‡å®Œæˆä»£ç è¡Œï¼Œå¸®åŠ©æ‚¨æ›´å¿«åœ°ç¼–å†™ä»£ç å¹¶å‡å°‘é”™è¯¯ã€‚æ–°ç‰ˆ Codota æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š\n\n- å…¨çº¿AIè‡ªåŠ¨å®Œæˆ\n- è¡Œå†…å’Œç›¸å…³çš„ä»£ç ç¤ºä¾‹\n- åŸºäºæ‚¨è‡ªå·±çš„ç¼–ç å®è·µçš„ä»£ç å»ºè®®\n\n### 4.Easy Code\n\n>EasyCodeæ˜¯åŸºäºIntelliJ IDEA Ultimateç‰ˆå¼€å‘çš„ä¸€ä¸ªä»£ç ç”Ÿæˆæ’ä»¶ï¼Œä¸»è¦é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿ï¼ˆåŸºäºvelocityï¼‰æ¥ç”Ÿæˆå„ç§ä½ æƒ³è¦çš„ä»£ç ã€‚é€šå¸¸ç”¨äºç”ŸæˆEntityã€Daoã€Serviceã€Controllerã€‚å¦‚æœä½ åŠ¨æ‰‹èƒ½åŠ›å¼ºè¿˜å¯ä»¥ç”¨äºç”ŸæˆHTMLã€JSã€PHPç­‰ä»£ç ã€‚ç†è®ºä¸Šæ¥è¯´åªè¦æ˜¯ä¸æ•°æ®æœ‰å…³çš„ä»£ç éƒ½æ˜¯å¯ä»¥ç”Ÿæˆçš„ã€‚\n\n### 5.JavaDoc\n\nå¿«é€Ÿç”Ÿæˆjavadocæ–‡æ¡£æ³¨é‡Š\n\n### 6.Lombok\n\nä¸»è¦ç”¨é€”æ˜¯æä¾›äº†ç®€å•çš„æ³¨è§£çš„å½¢å¼æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„ java ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚\n\n### 7.MyBatisPlus\n\n>generator code\n>live template\n>MybatisPlus plugin from java to xml or from xml to java\n\n### 8.Nyan Progress Bar\n\n> Pretty progress bars with nyan cat for IJ based IDEs.\n\n![Nyan Progress Bar](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727142237704.png)\n\n### 9.One Dark theme\n\nå…¶ä¸­One Dark Vividä¸»é¢˜çœŸçš„å¾ˆç®€æ´ã€èˆ’æœï¼Œçœ‹è…»äº†Ideaè‡ªå¸¦çš„ç³»ç»Ÿï¼Œå¯ä»¥è€ƒè™‘æ¢ä¸ªä¸»é¢˜è¯•è¯•ã€‚\n\n![One Dark Vivid](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727143552405.png)\n\n### 10.Translation\n\n> Translation plugin for IntelliJ based IDEs/Android Studio/HUAWEI DevEco Studio.\n\n![translation](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f596969477578696e672f5472616e736c6174696f6e506c7567696e406d61737465722f696d616765732f73637265656e73686f74732e676966.gif)\n\n### 11.å…¶ä»–\n\nPythonã€requirementsç­‰å¼€å‘pythonçš„æ’ä»¶ï¼Œè®©æˆ‘å¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨Ideaä¸­ç¼–å†™pythonä»£ç ã€‚\nsmart input proè‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ³•\nGsonformatç®€åŒ–JSONå’ŒJavaBeanä¹‹é—´çš„è½¬æ¢\nFree MyBatis Toolå®ç°mapperé—´æ¥å›è·³è½¬\n","source":"_posts/Ideaå¼€å‘å¿…è£…æ’ä»¶.md","raw":"---\ntitle: Ideaå¼€å‘å¿…è£…æ’ä»¶\ndate: 2022-07-27 15:24:24\ntags:\n---\n\n> ï¼‚å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼‚ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘å·¥ä½œä¸­å¿…å¤‡çš„Ideaå¼€å‘æ’ä»¶\n\n### 1.Alibaba Java Coding Guidelines\n\n> æˆ‘ä»¬å¾ˆé«˜å…´æ¨å‡ºé˜¿é‡Œå·´å·´ Java ç¼–ç æŒ‡å—ï¼Œå®ƒæ•´åˆäº†é˜¿é‡Œå·´å·´é›†å›¢æŠ€æœ¯å›¢é˜Ÿå¤šå¹´æ¥çš„æœ€ä½³ç¼–ç¨‹å®è·µã€‚å¤§é‡çš„ Java ç¼–ç¨‹å›¢é˜Ÿå¯¹è·¨é¡¹ç›®çš„ä»£ç è´¨é‡æå‡ºäº†è‹›åˆ»çš„è¦æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬é¼“åŠ±é‡ç”¨å’Œæ›´å¥½åœ°ç†è§£å½¼æ­¤çš„ç¨‹åºã€‚è¿‡å»æˆ‘ä»¬è§è¿‡å¾ˆå¤šç¼–ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæœ‰ç¼ºé™·çš„æ•°æ®åº“è¡¨ç»“æ„å’Œç´¢å¼•è®¾è®¡å¯èƒ½ä¼šå¯¼è‡´è½¯ä»¶æ¶æ„ç¼ºé™·å’Œæ€§èƒ½é£é™©ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯éš¾ä»¥ç»´æŠ¤çš„æ··ä¹±ä»£ç ç»“æ„ã€‚æ­¤å¤–ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ˜“å—æ”»å‡»çš„ä»£ç å¾ˆå®¹æ˜“å—åˆ°é»‘å®¢çš„æ”»å‡»ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ºé˜¿é‡Œå·´å·´çš„ Java å¼€å‘äººå‘˜ç¼–å†™äº†è¿™ä»½æ–‡æ¡£ã€‚\n\né˜¿é‡Œå·´å·´ä»£ç è§„èŒƒæ£€æŸ¥æ’ä»¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬çš„ä»£ç æ›´åŠ è§„èŒƒã€‚\n\n### 2.ignore\n\nå¿½ç•¥Gitä¸å¿…è¦æäº¤çš„æ–‡ä»¶\n\n### 3.Codota Ai\n\né€‚ç”¨äºJavaå’ŒJavaScriptçš„Codota AIè‡ªåŠ¨è¡¥å…¨ä»£ç æ’ä»¶\n\n>[Codota](https://www.codota.com/)åŸºäºæ•°ç™¾ä¸‡ä¸ªå¼€æº Java ç¨‹åºå’Œæ‚¨çš„ä¸Šä¸‹æ–‡å®Œæˆä»£ç è¡Œï¼Œå¸®åŠ©æ‚¨æ›´å¿«åœ°ç¼–å†™ä»£ç å¹¶å‡å°‘é”™è¯¯ã€‚æ–°ç‰ˆ Codota æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š\n\n- å…¨çº¿AIè‡ªåŠ¨å®Œæˆ\n- è¡Œå†…å’Œç›¸å…³çš„ä»£ç ç¤ºä¾‹\n- åŸºäºæ‚¨è‡ªå·±çš„ç¼–ç å®è·µçš„ä»£ç å»ºè®®\n\n### 4.Easy Code\n\n>EasyCodeæ˜¯åŸºäºIntelliJ IDEA Ultimateç‰ˆå¼€å‘çš„ä¸€ä¸ªä»£ç ç”Ÿæˆæ’ä»¶ï¼Œä¸»è¦é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿ï¼ˆåŸºäºvelocityï¼‰æ¥ç”Ÿæˆå„ç§ä½ æƒ³è¦çš„ä»£ç ã€‚é€šå¸¸ç”¨äºç”ŸæˆEntityã€Daoã€Serviceã€Controllerã€‚å¦‚æœä½ åŠ¨æ‰‹èƒ½åŠ›å¼ºè¿˜å¯ä»¥ç”¨äºç”ŸæˆHTMLã€JSã€PHPç­‰ä»£ç ã€‚ç†è®ºä¸Šæ¥è¯´åªè¦æ˜¯ä¸æ•°æ®æœ‰å…³çš„ä»£ç éƒ½æ˜¯å¯ä»¥ç”Ÿæˆçš„ã€‚\n\n### 5.JavaDoc\n\nå¿«é€Ÿç”Ÿæˆjavadocæ–‡æ¡£æ³¨é‡Š\n\n### 6.Lombok\n\nä¸»è¦ç”¨é€”æ˜¯æä¾›äº†ç®€å•çš„æ³¨è§£çš„å½¢å¼æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„ java ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚\n\n### 7.MyBatisPlus\n\n>generator code\n>live template\n>MybatisPlus plugin from java to xml or from xml to java\n\n### 8.Nyan Progress Bar\n\n> Pretty progress bars with nyan cat for IJ based IDEs.\n\n![Nyan Progress Bar](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727142237704.png)\n\n### 9.One Dark theme\n\nå…¶ä¸­One Dark Vividä¸»é¢˜çœŸçš„å¾ˆç®€æ´ã€èˆ’æœï¼Œçœ‹è…»äº†Ideaè‡ªå¸¦çš„ç³»ç»Ÿï¼Œå¯ä»¥è€ƒè™‘æ¢ä¸ªä¸»é¢˜è¯•è¯•ã€‚\n\n![One Dark Vivid](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727143552405.png)\n\n### 10.Translation\n\n> Translation plugin for IntelliJ based IDEs/Android Studio/HUAWEI DevEco Studio.\n\n![translation](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f596969477578696e672f5472616e736c6174696f6e506c7567696e406d61737465722f696d616765732f73637265656e73686f74732e676966.gif)\n\n### 11.å…¶ä»–\n\nPythonã€requirementsç­‰å¼€å‘pythonçš„æ’ä»¶ï¼Œè®©æˆ‘å¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨Ideaä¸­ç¼–å†™pythonä»£ç ã€‚\nsmart input proè‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ³•\nGsonformatç®€åŒ–JSONå’ŒJavaBeanä¹‹é—´çš„è½¬æ¢\nFree MyBatis Toolå®ç°mapperé—´æ¥å›è·³è½¬\n","slug":"Ideaå¼€å‘å¿…è£…æ’ä»¶","published":1,"updated":"2025-04-30T14:23:18.373Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83di0008wen10stwek9n","content":"<blockquote>\n<p>ï¼‚å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼‚ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘å·¥ä½œä¸­å¿…å¤‡çš„Ideaå¼€å‘æ’ä»¶</p>\n</blockquote>\n<h3 id=\"1-Alibaba-Java-Coding-Guidelines\"><a href=\"#1-Alibaba-Java-Coding-Guidelines\" class=\"headerlink\" title=\"1.Alibaba Java Coding Guidelines\"></a>1.Alibaba Java Coding Guidelines</h3><blockquote>\n<p>æˆ‘ä»¬å¾ˆé«˜å…´æ¨å‡ºé˜¿é‡Œå·´å·´ Java ç¼–ç æŒ‡å—ï¼Œå®ƒæ•´åˆäº†é˜¿é‡Œå·´å·´é›†å›¢æŠ€æœ¯å›¢é˜Ÿå¤šå¹´æ¥çš„æœ€ä½³ç¼–ç¨‹å®è·µã€‚å¤§é‡çš„ Java ç¼–ç¨‹å›¢é˜Ÿå¯¹è·¨é¡¹ç›®çš„ä»£ç è´¨é‡æå‡ºäº†è‹›åˆ»çš„è¦æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬é¼“åŠ±é‡ç”¨å’Œæ›´å¥½åœ°ç†è§£å½¼æ­¤çš„ç¨‹åºã€‚è¿‡å»æˆ‘ä»¬è§è¿‡å¾ˆå¤šç¼–ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæœ‰ç¼ºé™·çš„æ•°æ®åº“è¡¨ç»“æ„å’Œç´¢å¼•è®¾è®¡å¯èƒ½ä¼šå¯¼è‡´è½¯ä»¶æ¶æ„ç¼ºé™·å’Œæ€§èƒ½é£é™©ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯éš¾ä»¥ç»´æŠ¤çš„æ··ä¹±ä»£ç ç»“æ„ã€‚æ­¤å¤–ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ˜“å—æ”»å‡»çš„ä»£ç å¾ˆå®¹æ˜“å—åˆ°é»‘å®¢çš„æ”»å‡»ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ºé˜¿é‡Œå·´å·´çš„ Java å¼€å‘äººå‘˜ç¼–å†™äº†è¿™ä»½æ–‡æ¡£ã€‚</p>\n</blockquote>\n<p>é˜¿é‡Œå·´å·´ä»£ç è§„èŒƒæ£€æŸ¥æ’ä»¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬çš„ä»£ç æ›´åŠ è§„èŒƒã€‚</p>\n<h3 id=\"2-ignore\"><a href=\"#2-ignore\" class=\"headerlink\" title=\"2.ignore\"></a>2.ignore</h3><p>å¿½ç•¥Gitä¸å¿…è¦æäº¤çš„æ–‡ä»¶</p>\n<h3 id=\"3-Codota-Ai\"><a href=\"#3-Codota-Ai\" class=\"headerlink\" title=\"3.Codota Ai\"></a>3.Codota Ai</h3><p>é€‚ç”¨äºJavaå’ŒJavaScriptçš„Codota AIè‡ªåŠ¨è¡¥å…¨ä»£ç æ’ä»¶</p>\n<blockquote>\n<p><a href=\"https://www.codota.com/\">Codota</a>åŸºäºæ•°ç™¾ä¸‡ä¸ªå¼€æº Java ç¨‹åºå’Œæ‚¨çš„ä¸Šä¸‹æ–‡å®Œæˆä»£ç è¡Œï¼Œå¸®åŠ©æ‚¨æ›´å¿«åœ°ç¼–å†™ä»£ç å¹¶å‡å°‘é”™è¯¯ã€‚æ–°ç‰ˆ Codota æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>\n</blockquote>\n<ul>\n<li>å…¨çº¿AIè‡ªåŠ¨å®Œæˆ</li>\n<li>è¡Œå†…å’Œç›¸å…³çš„ä»£ç ç¤ºä¾‹</li>\n<li>åŸºäºæ‚¨è‡ªå·±çš„ç¼–ç å®è·µçš„ä»£ç å»ºè®®</li>\n</ul>\n<h3 id=\"4-Easy-Code\"><a href=\"#4-Easy-Code\" class=\"headerlink\" title=\"4.Easy Code\"></a>4.Easy Code</h3><blockquote>\n<p>EasyCodeæ˜¯åŸºäºIntelliJ IDEA Ultimateç‰ˆå¼€å‘çš„ä¸€ä¸ªä»£ç ç”Ÿæˆæ’ä»¶ï¼Œä¸»è¦é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿ï¼ˆåŸºäºvelocityï¼‰æ¥ç”Ÿæˆå„ç§ä½ æƒ³è¦çš„ä»£ç ã€‚é€šå¸¸ç”¨äºç”ŸæˆEntityã€Daoã€Serviceã€Controllerã€‚å¦‚æœä½ åŠ¨æ‰‹èƒ½åŠ›å¼ºè¿˜å¯ä»¥ç”¨äºç”ŸæˆHTMLã€JSã€PHPç­‰ä»£ç ã€‚ç†è®ºä¸Šæ¥è¯´åªè¦æ˜¯ä¸æ•°æ®æœ‰å…³çš„ä»£ç éƒ½æ˜¯å¯ä»¥ç”Ÿæˆçš„ã€‚</p>\n</blockquote>\n<h3 id=\"5-JavaDoc\"><a href=\"#5-JavaDoc\" class=\"headerlink\" title=\"5.JavaDoc\"></a>5.JavaDoc</h3><p>å¿«é€Ÿç”Ÿæˆjavadocæ–‡æ¡£æ³¨é‡Š</p>\n<h3 id=\"6-Lombok\"><a href=\"#6-Lombok\" class=\"headerlink\" title=\"6.Lombok\"></a>6.Lombok</h3><p>ä¸»è¦ç”¨é€”æ˜¯æä¾›äº†ç®€å•çš„æ³¨è§£çš„å½¢å¼æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„ java ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚</p>\n<h3 id=\"7-MyBatisPlus\"><a href=\"#7-MyBatisPlus\" class=\"headerlink\" title=\"7.MyBatisPlus\"></a>7.MyBatisPlus</h3><blockquote>\n<p>generator code<br>live template<br>MybatisPlus plugin from java to xml or from xml to java</p>\n</blockquote>\n<h3 id=\"8-Nyan-Progress-Bar\"><a href=\"#8-Nyan-Progress-Bar\" class=\"headerlink\" title=\"8.Nyan Progress Bar\"></a>8.Nyan Progress Bar</h3><blockquote>\n<p>Pretty progress bars with nyan cat for IJ based IDEs.</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727142237704.png\" alt=\"Nyan Progress Bar\"></p>\n<h3 id=\"9-One-Dark-theme\"><a href=\"#9-One-Dark-theme\" class=\"headerlink\" title=\"9.One Dark theme\"></a>9.One Dark theme</h3><p>å…¶ä¸­One Dark Vividä¸»é¢˜çœŸçš„å¾ˆç®€æ´ã€èˆ’æœï¼Œçœ‹è…»äº†Ideaè‡ªå¸¦çš„ç³»ç»Ÿï¼Œå¯ä»¥è€ƒè™‘æ¢ä¸ªä¸»é¢˜è¯•è¯•ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727143552405.png\" alt=\"One Dark Vivid\"></p>\n<h3 id=\"10-Translation\"><a href=\"#10-Translation\" class=\"headerlink\" title=\"10.Translation\"></a>10.Translation</h3><blockquote>\n<p>Translation plugin for IntelliJ based IDEs&#x2F;Android Studio&#x2F;HUAWEI DevEco Studio.</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f596969477578696e672f5472616e736c6174696f6e506c7567696e406d61737465722f696d616765732f73637265656e73686f74732e676966.gif\" alt=\"translation\"></p>\n<h3 id=\"11-å…¶ä»–\"><a href=\"#11-å…¶ä»–\" class=\"headerlink\" title=\"11.å…¶ä»–\"></a>11.å…¶ä»–</h3><p>Pythonã€requirementsç­‰å¼€å‘pythonçš„æ’ä»¶ï¼Œè®©æˆ‘å¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨Ideaä¸­ç¼–å†™pythonä»£ç ã€‚<br>smart input proè‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ³•<br>Gsonformatç®€åŒ–JSONå’ŒJavaBeanä¹‹é—´çš„è½¬æ¢<br>Free MyBatis Toolå®ç°mapperé—´æ¥å›è·³è½¬</p>\n","excerpt":"","more":"<blockquote>\n<p>ï¼‚å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼‚ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘å·¥ä½œä¸­å¿…å¤‡çš„Ideaå¼€å‘æ’ä»¶</p>\n</blockquote>\n<h3 id=\"1-Alibaba-Java-Coding-Guidelines\"><a href=\"#1-Alibaba-Java-Coding-Guidelines\" class=\"headerlink\" title=\"1.Alibaba Java Coding Guidelines\"></a>1.Alibaba Java Coding Guidelines</h3><blockquote>\n<p>æˆ‘ä»¬å¾ˆé«˜å…´æ¨å‡ºé˜¿é‡Œå·´å·´ Java ç¼–ç æŒ‡å—ï¼Œå®ƒæ•´åˆäº†é˜¿é‡Œå·´å·´é›†å›¢æŠ€æœ¯å›¢é˜Ÿå¤šå¹´æ¥çš„æœ€ä½³ç¼–ç¨‹å®è·µã€‚å¤§é‡çš„ Java ç¼–ç¨‹å›¢é˜Ÿå¯¹è·¨é¡¹ç›®çš„ä»£ç è´¨é‡æå‡ºäº†è‹›åˆ»çš„è¦æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬é¼“åŠ±é‡ç”¨å’Œæ›´å¥½åœ°ç†è§£å½¼æ­¤çš„ç¨‹åºã€‚è¿‡å»æˆ‘ä»¬è§è¿‡å¾ˆå¤šç¼–ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæœ‰ç¼ºé™·çš„æ•°æ®åº“è¡¨ç»“æ„å’Œç´¢å¼•è®¾è®¡å¯èƒ½ä¼šå¯¼è‡´è½¯ä»¶æ¶æ„ç¼ºé™·å’Œæ€§èƒ½é£é™©ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯éš¾ä»¥ç»´æŠ¤çš„æ··ä¹±ä»£ç ç»“æ„ã€‚æ­¤å¤–ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ˜“å—æ”»å‡»çš„ä»£ç å¾ˆå®¹æ˜“å—åˆ°é»‘å®¢çš„æ”»å‡»ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ºé˜¿é‡Œå·´å·´çš„ Java å¼€å‘äººå‘˜ç¼–å†™äº†è¿™ä»½æ–‡æ¡£ã€‚</p>\n</blockquote>\n<p>é˜¿é‡Œå·´å·´ä»£ç è§„èŒƒæ£€æŸ¥æ’ä»¶ï¼Œæœ‰åŠ©äºæˆ‘ä»¬çš„ä»£ç æ›´åŠ è§„èŒƒã€‚</p>\n<h3 id=\"2-ignore\"><a href=\"#2-ignore\" class=\"headerlink\" title=\"2.ignore\"></a>2.ignore</h3><p>å¿½ç•¥Gitä¸å¿…è¦æäº¤çš„æ–‡ä»¶</p>\n<h3 id=\"3-Codota-Ai\"><a href=\"#3-Codota-Ai\" class=\"headerlink\" title=\"3.Codota Ai\"></a>3.Codota Ai</h3><p>é€‚ç”¨äºJavaå’ŒJavaScriptçš„Codota AIè‡ªåŠ¨è¡¥å…¨ä»£ç æ’ä»¶</p>\n<blockquote>\n<p><a href=\"https://www.codota.com/\">Codota</a>åŸºäºæ•°ç™¾ä¸‡ä¸ªå¼€æº Java ç¨‹åºå’Œæ‚¨çš„ä¸Šä¸‹æ–‡å®Œæˆä»£ç è¡Œï¼Œå¸®åŠ©æ‚¨æ›´å¿«åœ°ç¼–å†™ä»£ç å¹¶å‡å°‘é”™è¯¯ã€‚æ–°ç‰ˆ Codota æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>\n</blockquote>\n<ul>\n<li>å…¨çº¿AIè‡ªåŠ¨å®Œæˆ</li>\n<li>è¡Œå†…å’Œç›¸å…³çš„ä»£ç ç¤ºä¾‹</li>\n<li>åŸºäºæ‚¨è‡ªå·±çš„ç¼–ç å®è·µçš„ä»£ç å»ºè®®</li>\n</ul>\n<h3 id=\"4-Easy-Code\"><a href=\"#4-Easy-Code\" class=\"headerlink\" title=\"4.Easy Code\"></a>4.Easy Code</h3><blockquote>\n<p>EasyCodeæ˜¯åŸºäºIntelliJ IDEA Ultimateç‰ˆå¼€å‘çš„ä¸€ä¸ªä»£ç ç”Ÿæˆæ’ä»¶ï¼Œä¸»è¦é€šè¿‡è‡ªå®šä¹‰æ¨¡æ¿ï¼ˆåŸºäºvelocityï¼‰æ¥ç”Ÿæˆå„ç§ä½ æƒ³è¦çš„ä»£ç ã€‚é€šå¸¸ç”¨äºç”ŸæˆEntityã€Daoã€Serviceã€Controllerã€‚å¦‚æœä½ åŠ¨æ‰‹èƒ½åŠ›å¼ºè¿˜å¯ä»¥ç”¨äºç”ŸæˆHTMLã€JSã€PHPç­‰ä»£ç ã€‚ç†è®ºä¸Šæ¥è¯´åªè¦æ˜¯ä¸æ•°æ®æœ‰å…³çš„ä»£ç éƒ½æ˜¯å¯ä»¥ç”Ÿæˆçš„ã€‚</p>\n</blockquote>\n<h3 id=\"5-JavaDoc\"><a href=\"#5-JavaDoc\" class=\"headerlink\" title=\"5.JavaDoc\"></a>5.JavaDoc</h3><p>å¿«é€Ÿç”Ÿæˆjavadocæ–‡æ¡£æ³¨é‡Š</p>\n<h3 id=\"6-Lombok\"><a href=\"#6-Lombok\" class=\"headerlink\" title=\"6.Lombok\"></a>6.Lombok</h3><p>ä¸»è¦ç”¨é€”æ˜¯æä¾›äº†ç®€å•çš„æ³¨è§£çš„å½¢å¼æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„ java ä»£ç ï¼Œæé«˜ç¼–ç æ•ˆç‡ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚</p>\n<h3 id=\"7-MyBatisPlus\"><a href=\"#7-MyBatisPlus\" class=\"headerlink\" title=\"7.MyBatisPlus\"></a>7.MyBatisPlus</h3><blockquote>\n<p>generator code<br>live template<br>MybatisPlus plugin from java to xml or from xml to java</p>\n</blockquote>\n<h3 id=\"8-Nyan-Progress-Bar\"><a href=\"#8-Nyan-Progress-Bar\" class=\"headerlink\" title=\"8.Nyan Progress Bar\"></a>8.Nyan Progress Bar</h3><blockquote>\n<p>Pretty progress bars with nyan cat for IJ based IDEs.</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727142237704.png\" alt=\"Nyan Progress Bar\"></p>\n<h3 id=\"9-One-Dark-theme\"><a href=\"#9-One-Dark-theme\" class=\"headerlink\" title=\"9.One Dark theme\"></a>9.One Dark theme</h3><p>å…¶ä¸­One Dark Vividä¸»é¢˜çœŸçš„å¾ˆç®€æ´ã€èˆ’æœï¼Œçœ‹è…»äº†Ideaè‡ªå¸¦çš„ç³»ç»Ÿï¼Œå¯ä»¥è€ƒè™‘æ¢ä¸ªä¸»é¢˜è¯•è¯•ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20220727143552405.png\" alt=\"One Dark Vivid\"></p>\n<h3 id=\"10-Translation\"><a href=\"#10-Translation\" class=\"headerlink\" title=\"10.Translation\"></a>10.Translation</h3><blockquote>\n<p>Translation plugin for IntelliJ based IDEs&#x2F;Android Studio&#x2F;HUAWEI DevEco Studio.</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f596969477578696e672f5472616e736c6174696f6e506c7567696e406d61737465722f696d616765732f73637265656e73686f74732e676966.gif\" alt=\"translation\"></p>\n<h3 id=\"11-å…¶ä»–\"><a href=\"#11-å…¶ä»–\" class=\"headerlink\" title=\"11.å…¶ä»–\"></a>11.å…¶ä»–</h3><p>Pythonã€requirementsç­‰å¼€å‘pythonçš„æ’ä»¶ï¼Œè®©æˆ‘å¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨Ideaä¸­ç¼–å†™pythonä»£ç ã€‚<br>smart input proè‡ªåŠ¨åˆ‡æ¢è¾“å…¥æ³•<br>Gsonformatç®€åŒ–JSONå’ŒJavaBeanä¹‹é—´çš„è½¬æ¢<br>Free MyBatis Toolå®ç°mapperé—´æ¥å›è·³è½¬</p>\n"},{"title":"Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—","date":"2022-02-03T09:35:40.000Z","_content":"\n1.çº¿ç¨‹ä¸å¤šçº¿ç¨‹çš„æ¦‚å¿µï¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼Œèƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„ç¨‹åºç‰‡æ®µå«ä½œâ€œ*çº¿ç¨‹*â€ï¼ˆThreadï¼‰ã€‚*å¤šçº¿ç¨‹*ï¼ˆmultithreadingï¼‰æ˜¯æŒ‡ä»è½¯ä»¶æˆ–è€…ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚\n\n2.å¤šçº¿ç¨‹çš„æ„ä¹‰ï¼šå¤šçº¿ç¨‹å¯ä»¥åœ¨æ—¶é—´ç‰‡é‡Œè¢«cpuå¿«é€Ÿåˆ‡æ¢ï¼Œèµ„æºèƒ½æ›´å¥½è¢«è°ƒç”¨ã€ç¨‹åºè®¾è®¡åœ¨æŸäº›æƒ…å†µä¸‹æ›´ç®€å•ã€ç¨‹åºå“åº”æ›´å¿«ã€è¿è¡Œæ›´åŠ æµç•…ã€‚\n\n2.å¦‚ä½•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼šç»§æ‰¿Threadç±»ã€å®ç°Runnableæ¥å£ã€å®ç°Callableæ¥å£\n\n3.ä¸ºä»€ä¹ˆè¦ä¿è¯çº¿ç¨‹çš„åŒæ­¥ï¼Ÿï¼šjavaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚\n\n4.åŸºæœ¬çš„çº¿ç¨‹åŒæ­¥ï¼šä½¿ç”¨*synchronized*å…³é”®å­—ã€ç‰¹æ®ŠåŸŸå˜é‡volatileã€waitå’Œnotifyæ–¹æ³•ç­‰ã€‚\n\n```java\npublic class T {\n    private int count=10;\n    private Object o=new Object();\n\n    public void m(){\n        synchronized (o){\n            //ä»»ä½•çº¿ç¨‹è¦æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¿…é¡»å…ˆæ‹¿åˆ°oçš„é”\n            count--;\n            System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n        }\n    }\n}\n\n```\nå‡è®¾è¿™æ®µä»£ç ä¸­æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°mæ–¹æ³•æ¥çš„æ—¶å€™ï¼Œsyncé”ä½äº†å †å†…å­˜ä¸­çš„oå¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯è¿›ä¸æ¥çš„ï¼Œå®ƒå¿…é¡»ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œï¼Œé”é‡Šæ”¾æ‰æ‰å¯ä»¥æ¥ç€æ‰§è¡Œã€‚è¿™é‡Œæœ‰ä¸ªé”çš„æ¦‚å¿µå«åšäº’æ–¥é”ï¼Œsyncæ˜¯ä¸€ç§*äº’æ–¥é”*ã€‚\n```java\npublic class T1 {\n    private static int count =10;\n\n    public synchronized static void m(){\n        //è¿™é‡Œç­‰åŒäºsynchronized(T3.class)\n        count--;\n        System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n    }\n\n    public static void mm(){\n        synchronized (T1.class){\n            //æ€è€ƒï¼šè¿™é‡Œå†™æˆsynchronized(this)æ˜¯å¦å¯ä»¥ï¼Ÿ\n            count--;\n        }\n    }\n}\n```\næ€è€ƒè¿™é‡Œï¼Œæ³¨æ„syncä¿®é¥°çš„æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•å’Œé™æ€çš„å±æ€§ï¼Œé™æ€ä¿®é¥°çš„æ–¹æ³•å’Œå±æ€§æ˜¯ä¸éœ€è¦newå‡ºå¯¹è±¡æ¥å°±å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰newå‡ºå¯¹è±¡ï¼Œsyncé”å®šçš„æ˜¯T3.classå¯¹è±¡ã€‚\n\n```java\npublic class T2 implements Runnable{\n    private int count =10;\n\n    @Override\n    public /*synchronized*/ void run(){\n        count--;\n        System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n    }\n\n    public static void main(String[] args) {\n        T2 t=new T2();\n        for (int i=0;i<5;i++){\n            new Thread(t,\"THREAD\"+i).start();\n        }\n    }\n}\n```\nä¸Šé¢ä»£ç ä¸­å¼€å¯äº†äº”ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œrunæ–¹æ³•å¯¹countè¿›è¡Œå‡ä¸€çš„æ“ä½œï¼Œè¿™é‡Œä¼šå‡ºç°çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ã€‚å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œrunæ–¹æ³•æ—¶ï¼Œå‡å‡çš„è¿‡ç¨‹ä¸­ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿè¿›å…¥äº†æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿåœ¨æ‰§è¡Œå‡å‡ï¼Œå¯èƒ½ä¼šå‡ºç°ç¬¬äºŒä¸ªçº¿ç¨‹å‡å®Œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰è¾“å‡ºcountï¼Œè¿™æ—¶å€™å°±å‡ºç°äº†çº¿ç¨‹é‡å…¥ã€‚å¤„ç†æ–¹æ³•å¯ä»¥åŠ ä¸Šsynchronizedå…³é”®å­—ï¼Œåªæœ‰ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ‰å¯ä»¥è¿›å…¥ï¼Œå³åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯*åŸå­æ€§*ã€‚\n\n```java\npublic class Account {\n\n    /**\n     * è´¦å·æŒæœ‰äººå’Œè´¦å·ä½™é¢\n     */\n    String name;\n    double balance;\n\n    /**\n     * è®¾ç½®è´¦å·ä½™é¢ï¼Œçº¿ç¨‹ç¡çœ ç›®çš„æ˜¯å…ˆè®©å®ƒè¯»æ•°æ®\n     * @param name\n     * @param balance\n     */\n    public synchronized void set(String name,double balance){\n        this.name=name;\n\n        try {\n            Thread.sleep(2000);\n        }catch (InterruptedException e){\n            e.printStackTrace();\n        }\n        this.balance=balance;\n    }\n\n    public double getBalance(String name){\n        return this.balance;\n    }\n\n    public static void main(String[] args) {\n        Account a=new Account();\n        new Thread(()->a.set(\"zhangsan\",100.0)).start();\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(a.getBalance(\"zhangsan\"));\n\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(a.getBalance(\"zhangsan\"));\n    }\n}\n```\nè¿™æ˜¯ä¸€ä¸ªå°demoï¼Œä»£ç ä¸­åªå¯¹setæ–¹æ³•åŠ äº†é”ï¼Œæ²¡æœ‰å¯¹getæ–¹æ³•åŠ é”ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°*è„è¯»*ç°è±¡ã€‚è§£å†³æ–¹æ³•æ˜¯è¯»å’Œå†™çš„æ–¹æ³•éƒ½åŠ é”ã€‚\n\n```java\npublic class T3 {\n\n    synchronized void m1(){\n        System.out.println(\"m1 start\");\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        m2();\n    }\n\n    synchronized void m2() {\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"m2\");\n    }\n}\n```\nè¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œm1å’Œm2æ–¹æ³•éƒ½å·²ç»åŠ ä¸Šäº†é”ï¼Œå½“æ‰§è¡Œm1çš„æ—¶å€™å†å»æ‰§è¡Œm2ï¼Œè¿™æ ·æ˜¯å¯ä»¥çš„ã€‚ä¸€ä¸ªåŒæ­¥æ–¹æ³•å¯ä»¥è°ƒç”¨å¦å¤–ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´syncè·å¾—çš„é”æ˜¯*å¯é‡å…¥é”*ã€‚è¿˜æœ‰ä¸ªæ¦‚å¿µæ˜¯*æ­»é”*ï¼Œæ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹æŠ¢å èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®±å­éœ€è¦ä¸¤æŠŠé’¥åŒ™æ‰å¯ä»¥æ‰“å¼€ï¼Œé’¥åŒ™åˆ†åˆ«åœ¨ä¸¤ä¸ªäººæ‰‹ä¸­ï¼Œè¿™ä¸¤ä¸ªäººäº’ç›¸æŠ¢å å¦å¤–ä¸€ä¸ªäººçš„é’¥åŒ™ï¼Œå¯¼è‡´ç®±å­æ‰“ä¸å¼€ã€‚","source":"_posts/Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—.md","raw":"---\ntitle: Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—\ndate: 2022-02-03 17:35:40\ntags:\n---\n\n1.çº¿ç¨‹ä¸å¤šçº¿ç¨‹çš„æ¦‚å¿µï¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼Œèƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„ç¨‹åºç‰‡æ®µå«ä½œâ€œ*çº¿ç¨‹*â€ï¼ˆThreadï¼‰ã€‚*å¤šçº¿ç¨‹*ï¼ˆmultithreadingï¼‰æ˜¯æŒ‡ä»è½¯ä»¶æˆ–è€…ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚\n\n2.å¤šçº¿ç¨‹çš„æ„ä¹‰ï¼šå¤šçº¿ç¨‹å¯ä»¥åœ¨æ—¶é—´ç‰‡é‡Œè¢«cpuå¿«é€Ÿåˆ‡æ¢ï¼Œèµ„æºèƒ½æ›´å¥½è¢«è°ƒç”¨ã€ç¨‹åºè®¾è®¡åœ¨æŸäº›æƒ…å†µä¸‹æ›´ç®€å•ã€ç¨‹åºå“åº”æ›´å¿«ã€è¿è¡Œæ›´åŠ æµç•…ã€‚\n\n2.å¦‚ä½•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼šç»§æ‰¿Threadç±»ã€å®ç°Runnableæ¥å£ã€å®ç°Callableæ¥å£\n\n3.ä¸ºä»€ä¹ˆè¦ä¿è¯çº¿ç¨‹çš„åŒæ­¥ï¼Ÿï¼šjavaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚\n\n4.åŸºæœ¬çš„çº¿ç¨‹åŒæ­¥ï¼šä½¿ç”¨*synchronized*å…³é”®å­—ã€ç‰¹æ®ŠåŸŸå˜é‡volatileã€waitå’Œnotifyæ–¹æ³•ç­‰ã€‚\n\n```java\npublic class T {\n    private int count=10;\n    private Object o=new Object();\n\n    public void m(){\n        synchronized (o){\n            //ä»»ä½•çº¿ç¨‹è¦æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¿…é¡»å…ˆæ‹¿åˆ°oçš„é”\n            count--;\n            System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n        }\n    }\n}\n\n```\nå‡è®¾è¿™æ®µä»£ç ä¸­æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°mæ–¹æ³•æ¥çš„æ—¶å€™ï¼Œsyncé”ä½äº†å †å†…å­˜ä¸­çš„oå¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯è¿›ä¸æ¥çš„ï¼Œå®ƒå¿…é¡»ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œï¼Œé”é‡Šæ”¾æ‰æ‰å¯ä»¥æ¥ç€æ‰§è¡Œã€‚è¿™é‡Œæœ‰ä¸ªé”çš„æ¦‚å¿µå«åšäº’æ–¥é”ï¼Œsyncæ˜¯ä¸€ç§*äº’æ–¥é”*ã€‚\n```java\npublic class T1 {\n    private static int count =10;\n\n    public synchronized static void m(){\n        //è¿™é‡Œç­‰åŒäºsynchronized(T3.class)\n        count--;\n        System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n    }\n\n    public static void mm(){\n        synchronized (T1.class){\n            //æ€è€ƒï¼šè¿™é‡Œå†™æˆsynchronized(this)æ˜¯å¦å¯ä»¥ï¼Ÿ\n            count--;\n        }\n    }\n}\n```\næ€è€ƒè¿™é‡Œï¼Œæ³¨æ„syncä¿®é¥°çš„æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•å’Œé™æ€çš„å±æ€§ï¼Œé™æ€ä¿®é¥°çš„æ–¹æ³•å’Œå±æ€§æ˜¯ä¸éœ€è¦newå‡ºå¯¹è±¡æ¥å°±å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰newå‡ºå¯¹è±¡ï¼Œsyncé”å®šçš„æ˜¯T3.classå¯¹è±¡ã€‚\n\n```java\npublic class T2 implements Runnable{\n    private int count =10;\n\n    @Override\n    public /*synchronized*/ void run(){\n        count--;\n        System.out.println(Thread.currentThread().getName()+\"count=\"+count);\n    }\n\n    public static void main(String[] args) {\n        T2 t=new T2();\n        for (int i=0;i<5;i++){\n            new Thread(t,\"THREAD\"+i).start();\n        }\n    }\n}\n```\nä¸Šé¢ä»£ç ä¸­å¼€å¯äº†äº”ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œrunæ–¹æ³•å¯¹countè¿›è¡Œå‡ä¸€çš„æ“ä½œï¼Œè¿™é‡Œä¼šå‡ºç°çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ã€‚å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œrunæ–¹æ³•æ—¶ï¼Œå‡å‡çš„è¿‡ç¨‹ä¸­ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿè¿›å…¥äº†æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿåœ¨æ‰§è¡Œå‡å‡ï¼Œå¯èƒ½ä¼šå‡ºç°ç¬¬äºŒä¸ªçº¿ç¨‹å‡å®Œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰è¾“å‡ºcountï¼Œè¿™æ—¶å€™å°±å‡ºç°äº†çº¿ç¨‹é‡å…¥ã€‚å¤„ç†æ–¹æ³•å¯ä»¥åŠ ä¸Šsynchronizedå…³é”®å­—ï¼Œåªæœ‰ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ‰å¯ä»¥è¿›å…¥ï¼Œå³åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯*åŸå­æ€§*ã€‚\n\n```java\npublic class Account {\n\n    /**\n     * è´¦å·æŒæœ‰äººå’Œè´¦å·ä½™é¢\n     */\n    String name;\n    double balance;\n\n    /**\n     * è®¾ç½®è´¦å·ä½™é¢ï¼Œçº¿ç¨‹ç¡çœ ç›®çš„æ˜¯å…ˆè®©å®ƒè¯»æ•°æ®\n     * @param name\n     * @param balance\n     */\n    public synchronized void set(String name,double balance){\n        this.name=name;\n\n        try {\n            Thread.sleep(2000);\n        }catch (InterruptedException e){\n            e.printStackTrace();\n        }\n        this.balance=balance;\n    }\n\n    public double getBalance(String name){\n        return this.balance;\n    }\n\n    public static void main(String[] args) {\n        Account a=new Account();\n        new Thread(()->a.set(\"zhangsan\",100.0)).start();\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(a.getBalance(\"zhangsan\"));\n\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(a.getBalance(\"zhangsan\"));\n    }\n}\n```\nè¿™æ˜¯ä¸€ä¸ªå°demoï¼Œä»£ç ä¸­åªå¯¹setæ–¹æ³•åŠ äº†é”ï¼Œæ²¡æœ‰å¯¹getæ–¹æ³•åŠ é”ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°*è„è¯»*ç°è±¡ã€‚è§£å†³æ–¹æ³•æ˜¯è¯»å’Œå†™çš„æ–¹æ³•éƒ½åŠ é”ã€‚\n\n```java\npublic class T3 {\n\n    synchronized void m1(){\n        System.out.println(\"m1 start\");\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        m2();\n    }\n\n    synchronized void m2() {\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        System.out.println(\"m2\");\n    }\n}\n```\nè¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œm1å’Œm2æ–¹æ³•éƒ½å·²ç»åŠ ä¸Šäº†é”ï¼Œå½“æ‰§è¡Œm1çš„æ—¶å€™å†å»æ‰§è¡Œm2ï¼Œè¿™æ ·æ˜¯å¯ä»¥çš„ã€‚ä¸€ä¸ªåŒæ­¥æ–¹æ³•å¯ä»¥è°ƒç”¨å¦å¤–ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´syncè·å¾—çš„é”æ˜¯*å¯é‡å…¥é”*ã€‚è¿˜æœ‰ä¸ªæ¦‚å¿µæ˜¯*æ­»é”*ï¼Œæ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹æŠ¢å èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®±å­éœ€è¦ä¸¤æŠŠé’¥åŒ™æ‰å¯ä»¥æ‰“å¼€ï¼Œé’¥åŒ™åˆ†åˆ«åœ¨ä¸¤ä¸ªäººæ‰‹ä¸­ï¼Œè¿™ä¸¤ä¸ªäººäº’ç›¸æŠ¢å å¦å¤–ä¸€ä¸ªäººçš„é’¥åŒ™ï¼Œå¯¼è‡´ç®±å­æ‰“ä¸å¼€ã€‚","slug":"Javaå¹¶å‘ç¼–ç¨‹(ä¸€)ï¼šçº¿ç¨‹åŸºç¡€çŸ¥è¯†ä»¥åŠsynchronizedå…³é”®å­—","published":1,"updated":"2024-02-07T07:27:45.070Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83di0009wen1gygz6pir","content":"<p>1.çº¿ç¨‹ä¸å¤šçº¿ç¨‹çš„æ¦‚å¿µï¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼Œèƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„ç¨‹åºç‰‡æ®µå«ä½œâ€œ<em>çº¿ç¨‹</em>â€ï¼ˆThreadï¼‰ã€‚<em>å¤šçº¿ç¨‹</em>ï¼ˆmultithreadingï¼‰æ˜¯æŒ‡ä»è½¯ä»¶æˆ–è€…ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚</p>\n<p>2.å¤šçº¿ç¨‹çš„æ„ä¹‰ï¼šå¤šçº¿ç¨‹å¯ä»¥åœ¨æ—¶é—´ç‰‡é‡Œè¢«cpuå¿«é€Ÿåˆ‡æ¢ï¼Œèµ„æºèƒ½æ›´å¥½è¢«è°ƒç”¨ã€ç¨‹åºè®¾è®¡åœ¨æŸäº›æƒ…å†µä¸‹æ›´ç®€å•ã€ç¨‹åºå“åº”æ›´å¿«ã€è¿è¡Œæ›´åŠ æµç•…ã€‚</p>\n<p>2.å¦‚ä½•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼šç»§æ‰¿Threadç±»ã€å®ç°Runnableæ¥å£ã€å®ç°Callableæ¥å£</p>\n<p>3.ä¸ºä»€ä¹ˆè¦ä¿è¯çº¿ç¨‹çš„åŒæ­¥ï¼Ÿï¼šjavaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚</p>\n<p>4.åŸºæœ¬çš„çº¿ç¨‹åŒæ­¥ï¼šä½¿ç”¨<em>synchronized</em>å…³é”®å­—ã€ç‰¹æ®ŠåŸŸå˜é‡volatileã€waitå’Œnotifyæ–¹æ³•ç­‰ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> count=<span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object o=<span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (o)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//ä»»ä½•çº¿ç¨‹è¦æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¿…é¡»å…ˆæ‹¿åˆ°oçš„é”</span></span><br><span class=\"line\">            count--;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å‡è®¾è¿™æ®µä»£ç ä¸­æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°mæ–¹æ³•æ¥çš„æ—¶å€™ï¼Œsyncé”ä½äº†å †å†…å­˜ä¸­çš„oå¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯è¿›ä¸æ¥çš„ï¼Œå®ƒå¿…é¡»ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œï¼Œé”é‡Šæ”¾æ‰æ‰å¯ä»¥æ¥ç€æ‰§è¡Œã€‚è¿™é‡Œæœ‰ä¸ªé”çš„æ¦‚å¿µå«åšäº’æ–¥é”ï¼Œsyncæ˜¯ä¸€ç§<em>äº’æ–¥é”</em>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//è¿™é‡Œç­‰åŒäºsynchronized(T3.class)</span></span><br><span class=\"line\">        count--;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">mm</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (T1.class)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//æ€è€ƒï¼šè¿™é‡Œå†™æˆsynchronized(this)æ˜¯å¦å¯ä»¥ï¼Ÿ</span></span><br><span class=\"line\">            count--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ€è€ƒè¿™é‡Œï¼Œæ³¨æ„syncä¿®é¥°çš„æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•å’Œé™æ€çš„å±æ€§ï¼Œé™æ€ä¿®é¥°çš„æ–¹æ³•å’Œå±æ€§æ˜¯ä¸éœ€è¦newå‡ºå¯¹è±¡æ¥å°±å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰newå‡ºå¯¹è±¡ï¼Œsyncé”å®šçš„æ˜¯T3.classå¯¹è±¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T2</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"comment\">/*synchronized*/</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        count--;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        T2 t=<span class=\"keyword\">new</span> <span class=\"title class_\">T2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">5</span>;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(t,<span class=\"string\">&quot;THREAD&quot;</span>+i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢ä»£ç ä¸­å¼€å¯äº†äº”ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œrunæ–¹æ³•å¯¹countè¿›è¡Œå‡ä¸€çš„æ“ä½œï¼Œè¿™é‡Œä¼šå‡ºç°çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ã€‚å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œrunæ–¹æ³•æ—¶ï¼Œå‡å‡çš„è¿‡ç¨‹ä¸­ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿè¿›å…¥äº†æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿåœ¨æ‰§è¡Œå‡å‡ï¼Œå¯èƒ½ä¼šå‡ºç°ç¬¬äºŒä¸ªçº¿ç¨‹å‡å®Œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰è¾“å‡ºcountï¼Œè¿™æ—¶å€™å°±å‡ºç°äº†çº¿ç¨‹é‡å…¥ã€‚å¤„ç†æ–¹æ³•å¯ä»¥åŠ ä¸Šsynchronizedå…³é”®å­—ï¼Œåªæœ‰ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ‰å¯ä»¥è¿›å…¥ï¼Œå³åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯<em>åŸå­æ€§</em>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Account</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è´¦å·æŒæœ‰äººå’Œè´¦å·ä½™é¢</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String name;</span><br><span class=\"line\">    <span class=\"type\">double</span> balance;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è®¾ç½®è´¦å·ä½™é¢ï¼Œçº¿ç¨‹ç¡çœ ç›®çš„æ˜¯å…ˆè®©å®ƒè¯»æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> balance</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">set</span><span class=\"params\">(String name,<span class=\"type\">double</span> balance)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.name=name;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.balance=balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">double</span> <span class=\"title function_\">getBalance</span><span class=\"params\">(String name)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Account a=<span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;a.set(<span class=\"string\">&quot;zhangsan&quot;</span>,<span class=\"number\">100.0</span>)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(a.getBalance(<span class=\"string\">&quot;zhangsan&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(a.getBalance(<span class=\"string\">&quot;zhangsan&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ˜¯ä¸€ä¸ªå°demoï¼Œä»£ç ä¸­åªå¯¹setæ–¹æ³•åŠ äº†é”ï¼Œæ²¡æœ‰å¯¹getæ–¹æ³•åŠ é”ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°<em>è„è¯»</em>ç°è±¡ã€‚è§£å†³æ–¹æ³•æ˜¯è¯»å’Œå†™çš„æ–¹æ³•éƒ½åŠ é”ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T3</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m1</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m1 start&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        m2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œm1å’Œm2æ–¹æ³•éƒ½å·²ç»åŠ ä¸Šäº†é”ï¼Œå½“æ‰§è¡Œm1çš„æ—¶å€™å†å»æ‰§è¡Œm2ï¼Œè¿™æ ·æ˜¯å¯ä»¥çš„ã€‚ä¸€ä¸ªåŒæ­¥æ–¹æ³•å¯ä»¥è°ƒç”¨å¦å¤–ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´syncè·å¾—çš„é”æ˜¯<em>å¯é‡å…¥é”</em>ã€‚è¿˜æœ‰ä¸ªæ¦‚å¿µæ˜¯<em>æ­»é”</em>ï¼Œæ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹æŠ¢å èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®±å­éœ€è¦ä¸¤æŠŠé’¥åŒ™æ‰å¯ä»¥æ‰“å¼€ï¼Œé’¥åŒ™åˆ†åˆ«åœ¨ä¸¤ä¸ªäººæ‰‹ä¸­ï¼Œè¿™ä¸¤ä¸ªäººäº’ç›¸æŠ¢å å¦å¤–ä¸€ä¸ªäººçš„é’¥åŒ™ï¼Œå¯¼è‡´ç®±å­æ‰“ä¸å¼€ã€‚</p>\n","excerpt":"","more":"<p>1.çº¿ç¨‹ä¸å¤šçº¿ç¨‹çš„æ¦‚å¿µï¼šåœ¨ä¸€ä¸ªç¨‹åºä¸­ï¼Œèƒ½å¤Ÿç‹¬ç«‹è¿è¡Œçš„ç¨‹åºç‰‡æ®µå«ä½œâ€œ<em>çº¿ç¨‹</em>â€ï¼ˆThreadï¼‰ã€‚<em>å¤šçº¿ç¨‹</em>ï¼ˆmultithreadingï¼‰æ˜¯æŒ‡ä»è½¯ä»¶æˆ–è€…ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚</p>\n<p>2.å¤šçº¿ç¨‹çš„æ„ä¹‰ï¼šå¤šçº¿ç¨‹å¯ä»¥åœ¨æ—¶é—´ç‰‡é‡Œè¢«cpuå¿«é€Ÿåˆ‡æ¢ï¼Œèµ„æºèƒ½æ›´å¥½è¢«è°ƒç”¨ã€ç¨‹åºè®¾è®¡åœ¨æŸäº›æƒ…å†µä¸‹æ›´ç®€å•ã€ç¨‹åºå“åº”æ›´å¿«ã€è¿è¡Œæ›´åŠ æµç•…ã€‚</p>\n<p>2.å¦‚ä½•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼šç»§æ‰¿Threadç±»ã€å®ç°Runnableæ¥å£ã€å®ç°Callableæ¥å£</p>\n<p>3.ä¸ºä»€ä¹ˆè¦ä¿è¯çº¿ç¨‹çš„åŒæ­¥ï¼Ÿï¼šjavaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚</p>\n<p>4.åŸºæœ¬çš„çº¿ç¨‹åŒæ­¥ï¼šä½¿ç”¨<em>synchronized</em>å…³é”®å­—ã€ç‰¹æ®ŠåŸŸå˜é‡volatileã€waitå’Œnotifyæ–¹æ³•ç­‰ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> count=<span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object o=<span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (o)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//ä»»ä½•çº¿ç¨‹è¦æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå¿…é¡»å…ˆæ‹¿åˆ°oçš„é”</span></span><br><span class=\"line\">            count--;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å‡è®¾è¿™æ®µä»£ç ä¸­æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°mæ–¹æ³•æ¥çš„æ—¶å€™ï¼Œsyncé”ä½äº†å †å†…å­˜ä¸­çš„oå¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬äºŒä¸ªçº¿ç¨‹æ˜¯è¿›ä¸æ¥çš„ï¼Œå®ƒå¿…é¡»ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œï¼Œé”é‡Šæ”¾æ‰æ‰å¯ä»¥æ¥ç€æ‰§è¡Œã€‚è¿™é‡Œæœ‰ä¸ªé”çš„æ¦‚å¿µå«åšäº’æ–¥é”ï¼Œsyncæ˜¯ä¸€ç§<em>äº’æ–¥é”</em>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//è¿™é‡Œç­‰åŒäºsynchronized(T3.class)</span></span><br><span class=\"line\">        count--;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">mm</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (T1.class)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//æ€è€ƒï¼šè¿™é‡Œå†™æˆsynchronized(this)æ˜¯å¦å¯ä»¥ï¼Ÿ</span></span><br><span class=\"line\">            count--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ€è€ƒè¿™é‡Œï¼Œæ³¨æ„syncä¿®é¥°çš„æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•å’Œé™æ€çš„å±æ€§ï¼Œé™æ€ä¿®é¥°çš„æ–¹æ³•å’Œå±æ€§æ˜¯ä¸éœ€è¦newå‡ºå¯¹è±¡æ¥å°±å¯ä»¥è®¿é—®çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰newå‡ºå¯¹è±¡ï¼Œsyncé”å®šçš„æ˜¯T3.classå¯¹è±¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T2</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span><span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"comment\">/*synchronized*/</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        count--;</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;count=&quot;</span>+count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        T2 t=<span class=\"keyword\">new</span> <span class=\"title class_\">T2</span>();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">5</span>;i++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(t,<span class=\"string\">&quot;THREAD&quot;</span>+i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šé¢ä»£ç ä¸­å¼€å¯äº†äº”ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œrunæ–¹æ³•å¯¹countè¿›è¡Œå‡ä¸€çš„æ“ä½œï¼Œè¿™é‡Œä¼šå‡ºç°çº¿ç¨‹æŠ¢å èµ„æºçš„é—®é¢˜ã€‚å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œrunæ–¹æ³•æ—¶ï¼Œå‡å‡çš„è¿‡ç¨‹ä¸­ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿè¿›å…¥äº†æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿåœ¨æ‰§è¡Œå‡å‡ï¼Œå¯èƒ½ä¼šå‡ºç°ç¬¬äºŒä¸ªçº¿ç¨‹å‡å®Œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰è¾“å‡ºcountï¼Œè¿™æ—¶å€™å°±å‡ºç°äº†çº¿ç¨‹é‡å…¥ã€‚å¤„ç†æ–¹æ³•å¯ä»¥åŠ ä¸Šsynchronizedå…³é”®å­—ï¼Œåªæœ‰ç­‰ç¬¬ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹æ‰å¯ä»¥è¿›å…¥ï¼Œå³åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å¯¹å®ƒè¿›è¡Œæ“ä½œï¼Œä¹Ÿå°±æ˜¯<em>åŸå­æ€§</em>ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Account</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è´¦å·æŒæœ‰äººå’Œè´¦å·ä½™é¢</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String name;</span><br><span class=\"line\">    <span class=\"type\">double</span> balance;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è®¾ç½®è´¦å·ä½™é¢ï¼Œçº¿ç¨‹ç¡çœ ç›®çš„æ˜¯å…ˆè®©å®ƒè¯»æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> balance</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">set</span><span class=\"params\">(String name,<span class=\"type\">double</span> balance)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.name=name;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.balance=balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">double</span> <span class=\"title function_\">getBalance</span><span class=\"params\">(String name)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Account a=<span class=\"keyword\">new</span> <span class=\"title class_\">Account</span>();</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;a.set(<span class=\"string\">&quot;zhangsan&quot;</span>,<span class=\"number\">100.0</span>)).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(a.getBalance(<span class=\"string\">&quot;zhangsan&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(a.getBalance(<span class=\"string\">&quot;zhangsan&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ˜¯ä¸€ä¸ªå°demoï¼Œä»£ç ä¸­åªå¯¹setæ–¹æ³•åŠ äº†é”ï¼Œæ²¡æœ‰å¯¹getæ–¹æ³•åŠ é”ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°<em>è„è¯»</em>ç°è±¡ã€‚è§£å†³æ–¹æ³•æ˜¯è¯»å’Œå†™çš„æ–¹æ³•éƒ½åŠ é”ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T3</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m1</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m1 start&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        m2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m2&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œm1å’Œm2æ–¹æ³•éƒ½å·²ç»åŠ ä¸Šäº†é”ï¼Œå½“æ‰§è¡Œm1çš„æ—¶å€™å†å»æ‰§è¡Œm2ï¼Œè¿™æ ·æ˜¯å¯ä»¥çš„ã€‚ä¸€ä¸ªåŒæ­¥æ–¹æ³•å¯ä»¥è°ƒç”¨å¦å¤–ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´syncè·å¾—çš„é”æ˜¯<em>å¯é‡å…¥é”</em>ã€‚è¿˜æœ‰ä¸ªæ¦‚å¿µæ˜¯<em>æ­»é”</em>ï¼Œæ­»é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹æŠ¢å èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç®±å­éœ€è¦ä¸¤æŠŠé’¥åŒ™æ‰å¯ä»¥æ‰“å¼€ï¼Œé’¥åŒ™åˆ†åˆ«åœ¨ä¸¤ä¸ªäººæ‰‹ä¸­ï¼Œè¿™ä¸¤ä¸ªäººäº’ç›¸æŠ¢å å¦å¤–ä¸€ä¸ªäººçš„é’¥åŒ™ï¼Œå¯¼è‡´ç®±å­æ‰“ä¸å¼€ã€‚</p>\n"},{"title":"JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡","date":"2022-01-31T09:35:40.000Z","_content":"\n**Javaæ˜¯ä¸€é—¨å¯ä»¥è·¨å¹³å°çš„è¯­è¨€ï¼Œä½†æ˜¯Javaæœ¬èº«æ˜¯ä¸å¯ä»¥å®ç°è·¨å¹³å°çš„ï¼Œéœ€è¦JVMå®ç°è·¨å¹³å°ã€‚javacç¼–è¯‘å¥½åçš„classæ–‡ä»¶ï¼Œåœ¨Windowsã€Linuxã€Macç­‰ç³»ç»Ÿä¸Šï¼Œåªè¦è¯¥ç³»ç»Ÿå®‰è£…å¯¹åº”çš„Javaè™šæ‹Ÿæœºï¼Œclassæ–‡ä»¶éƒ½å¯ä»¥è¿è¡Œã€‚è¾¾åˆ°â€ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„æ•ˆæœã€‚**\n\n## ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\nè€ŒJVMåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¼•ç”¨ç™¾åº¦ç™¾ç§‘å¯¹JVMçš„ä»‹ç»ï¼š\n\n> JVMæ˜¯Java Virtual Machineï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼ŒJVMæ˜¯ä¸€ç§ç”¨äºè®¡ç®—è®¾å¤‡çš„è§„èŒƒï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ„å‡ºæ¥çš„è®¡ç®—æœºï¼Œæ˜¯é€šè¿‡åœ¨å®é™…çš„è®¡ç®—æœºä¸Šä»¿çœŸæ¨¡æ‹Ÿå„ç§è®¡ç®—æœºåŠŸèƒ½æ¥å®ç°çš„ã€‚\n\n## äºŒã€JVMæ¶æ„çŸ¥è¯†\n1.JVMä¸»è¦åŒ…å«**ç±»è£…è½½å™¨ã€è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜æ¨¡å‹ï¼‰ã€æ‰§è¡Œå¼•æ“**ã€‚é‡Œé¢å†…å­˜æ¨¡å‹æœ‰å¯ä»¥ç»†åˆ†åŒ…æ‹¬æœ¬åœ°æ–¹æ³•æ ˆã€å †ã€æ ˆï¼ˆçº¿ç¨‹ï¼‰ã€æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ã€ç¨‹åºè®¡æ•°å™¨ã€‚\nå¦‚å›¾æ‰€ç¤ºï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/351bc7933dbca9d91c52db9f79bec760.png)\n\n1.ç±»è£…è½½å™¨çš„ä½œç”¨å°±æ˜¯è´Ÿè´£åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡ç¤ºï¼Œå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„å¹¶ä¸”ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰å†³å®šã€‚ç±»åŠ è½½å™¨åˆæœ‰å››å¤§ç±»åŠ è½½å™¨ï¼š\n\nå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰:è´Ÿè´£åŠ è½½JREæ ¸å¿ƒç±»åº“ï¼ŒåƒJREä¸­çš„rt.jarç­‰ï¼ˆC/C++ï¼‰ï¼›\n\næ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½JREæ‰©å±•ç›®å½•extä¸­çš„jaråŒ…ï¼›\n\nç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½ClassPathè·¯å¾„ä¸‹çš„ç±»åŒ…ï¼›\n\nè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ï¼ˆUser ClassLoaderï¼‰ï¼šåªåŠ è½½æŒ‡å®šç›®å½•ä¸‹çš„jarå’Œclassï¼Œæƒ³åŠ è½½å…¶å®ƒä½ç½®çš„ç±»æˆ–jaræ—¶å¾—è‡ªè¡Œå®šä¹‰ç±»åŠ è½½å™¨ï¼›\n\n2.**JVMä¸­ï¼Œå¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å†…å­˜ç©ºé—´çš„ï¼Œæ ˆåªç”¨äºä¿å­˜å±€éƒ¨å˜é‡å’Œä¸´æ—¶å˜é‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåªä¿å­˜å¼•ç”¨**ï¼Œå®é™…å†…å­˜è¿˜æ˜¯åœ¨å †ä¸­ã€‚æ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼Œå‡è®¾ä¸€ä¸ªmainæ–¹æ³•ï¼Œé‡Œé¢æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯åæ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•å³é‚£ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯æ‰§è¡Œå®Œæ¯•åï¼Œé‚£ä¸ªçº¿ç¨‹æ˜¯å…ˆé”€æ¯çš„ã€‚**æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼ˆå­˜æ”¾å±€éƒ¨å˜é‡çš„ï¼‰ã€æ“ä½œæ•°æ ˆï¼ˆå­˜æ”¾éœ€è¦è¿ç®—çš„æ•°æ®ï¼‰ã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ï¼ˆæ‰§è¡Œå®Œæ–¹æ³• å›åˆ°mainæ–¹æ³•çš„ä½ç½®ï¼‰ç­‰ä¿¡æ¯**ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚å³ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€å—æ ˆå¸§å†…å­˜åŒºåŸŸï¼ˆå­˜æ”¾æœ¬æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼‰ã€‚\n\n3.æ–¹æ³•åŒºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ï¼ˆå †ä¸­çš„å¯¹è±¡å¸¸é‡åœ°å€ï¼‰ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚\n\n4.æœ¬åœ°æ–¹æ³•æ ˆå’Œæ ˆçš„ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæœåŠ¡çš„å¯¹è±¡æ˜¯nativeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¾—ç”±cè¯­è¨€æ¥å®ç°ã€‚\n\n5.ç¨‹åºè®¡æ•°å™¨ä½œç”¨æ˜¯å½“CPUå¤šçº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™ï¼Œåˆ‡å›åˆ°å½“å‰çº¿ç¨‹çš„æ—¶å€™ï¼Œå›åˆ°ç¨‹åºè®¡æ•°å™¨è®¡æ•°çš„ä½ç½®ï¼Œç»§ç»­æ‰§è¡Œã€‚\n\n## ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\næ–°ç”Ÿä»£åŒ…æ‹¬EdenåŠ ä¸Š2ä¸ªsurvivoråŒºï¼Œæ‰§è¡Œminor gcä¹‹åï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œæ´»ç€çš„è¿›å…¥s0ï¼Œå†æ¬¡minor gcï¼Œæ´»ç€çš„å¯¹è±¡eden+s0->s1ï¼Œå†æ¬¡minor gcï¼Œeden+s1->s0â€¦è¿™é‡Œè™šæ‹Ÿæœºé‡‡å–äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼ŒJVMç»™æ¯ä¸ªå¯¹è±¡ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ï¼Œåˆ†ä»£å¹´é¾„è¾¾åˆ°15åå³å¯¹è±¡è¢«æ‰§è¡Œäº†15æ¬¡minor gcåç§»å…¥è€å¹´ä»£ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒsåŒºè£…ä¸ä¸‹çš„å¤§å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚\n\næœ€åï¼Œè€å¹´ä»£å­˜çš„å°±æ˜¯ä¸€äº›å¤§å¯¹è±¡å’Œéœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼ˆé™æ€å˜é‡ã€ç¼“å­˜ã€çº¿ç¨‹æ± ç­‰ï¼‰ï¼Œè€å¹´ä»£æ»¡äº†çš„è¯ï¼Œä¼šæ‰§è¡ŒFull GCåƒåœ¾æ”¶é›†ã€‚å®˜ç½‘å¯¹Full GCçš„è§£é‡Šä¸­ä»‹ç»äº†ä¸ªè¯â€Stop-The-Worldâ€ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰çš„åº”ç”¨çº¿ç¨‹åœæ‰ï¼Œè¿™æ—¶å€™ç³»ç»Ÿä¼šå¡æ‰ã€‚**JVMè™šæ‹Ÿæœºè°ƒä¼˜çš„ç›®æ ‡å°±æ˜¯å‡å°‘full gcå³å‡å°‘STWã€‚**\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a79e182e285aa8a998b64f8c2929cea2.png)\n\n## å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\n**å †é‡Œé¢å­˜æ”¾newçš„å¯¹è±¡å’Œæ•°ç»„**ï¼ŒJavaä¼˜äºå…¶ä»–è¯­è¨€ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯å®ƒèƒ½è‡ªåŠ¨å¤„ç†åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ã€‚æœ‰äº†åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å‡ ç‚¹å¥½å¤„ç¼–ç¨‹ç®€å•ï¼Œç³»ç»Ÿä¸å®¹æ˜“å‡ºé”™ã€‚\n\n1.ä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ\n\n**æˆ‘ä»¬æŠŠæ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æˆ–è€…ä¸€å †å¯¹è±¡ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰å®šä¹‰ä¸ºåƒåœ¾ã€‚**\n\n2.ç³»ç»Ÿå¦‚ä½•å®šä½åƒåœ¾\n\n- å¼•ç”¨è®¡æ•°ç®—æ³•-ç®€å•ä¸”é«˜æ•ˆä½†æ˜¯ä¸»æµçš„Javaè™šæ‹Ÿæœºé‡Œå¹¶æ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚\n- **æ ¹å¯è¾¾åˆ†æç®—æ³•**-å°†â€GC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢å¼•ç”¨çš„å¯¹è±¡ï¼Œæ‰¾åˆ°çš„å¯¹è±¡éƒ½æ ‡è®°ä¸ºéåƒåœ¾å¯¹è±¡ï¼Œå…¶ä½™æœªæ ‡è®°çš„å¯¹è±¡éƒ½æ˜¯åƒåœ¾å¯¹è±¡ã€‚çº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ã€é™æ€å˜é‡ã€æœ¬åœ°æ–¹æ³•æ ˆçš„å˜é‡ç­‰ç­‰éƒ½å¯ä»¥ç§°ä½œGC Rootsè·ŸèŠ‚ç‚¹ã€‚\nå¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/313951e066caf10cfb67e43c4a5a6dcc.png)\n\n3.å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•\n\n- **å¤åˆ¶ç®—æ³•**-æ²¡æœ‰ç¢ç‰‡ æµªè´¹å†…å­˜ç©ºé—´ï¼ˆç›®å‰ä½¿ç”¨æ–°ç”Ÿä»£ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼‰\n- æ ‡è®°æ¸…é™¤-ä½ç½®ä¸è¿ç»­ äº§ç”Ÿå†…å­˜ç¢ç‰‡\n- æ ‡è®°å‹ç¼©-æ²¡æœ‰ç¢ç‰‡ æ•ˆç‡åä½\nå¤åˆ¶ç®—æ³•å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚\n\n## äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨\næ–°ç”Ÿä»£æ”¶é›†å™¨ï¼šSerialã€ParNewã€Parallel Scavenge\nè€å¹´ä»£æ”¶é›†å™¨ï¼šCMSã€Serial Oldã€Parallel Old\næ•´å †æ”¶é›†å™¨ï¼š G1\n\n**jdk1.8 é»˜è®¤åƒåœ¾æ”¶é›†å™¨Parallel Scavengeï¼ˆæ–°ç”Ÿä»£ï¼‰+Parallel Oldï¼ˆè€å¹´ä»£ï¼‰**","source":"_posts/JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡.md","raw":"---\ntitle: JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡\ndate: 2022-01-31 17:35:40\ntags:\n---\n\n**Javaæ˜¯ä¸€é—¨å¯ä»¥è·¨å¹³å°çš„è¯­è¨€ï¼Œä½†æ˜¯Javaæœ¬èº«æ˜¯ä¸å¯ä»¥å®ç°è·¨å¹³å°çš„ï¼Œéœ€è¦JVMå®ç°è·¨å¹³å°ã€‚javacç¼–è¯‘å¥½åçš„classæ–‡ä»¶ï¼Œåœ¨Windowsã€Linuxã€Macç­‰ç³»ç»Ÿä¸Šï¼Œåªè¦è¯¥ç³»ç»Ÿå®‰è£…å¯¹åº”çš„Javaè™šæ‹Ÿæœºï¼Œclassæ–‡ä»¶éƒ½å¯ä»¥è¿è¡Œã€‚è¾¾åˆ°â€ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„æ•ˆæœã€‚**\n\n## ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\nè€ŒJVMåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¼•ç”¨ç™¾åº¦ç™¾ç§‘å¯¹JVMçš„ä»‹ç»ï¼š\n\n> JVMæ˜¯Java Virtual Machineï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼ŒJVMæ˜¯ä¸€ç§ç”¨äºè®¡ç®—è®¾å¤‡çš„è§„èŒƒï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ„å‡ºæ¥çš„è®¡ç®—æœºï¼Œæ˜¯é€šè¿‡åœ¨å®é™…çš„è®¡ç®—æœºä¸Šä»¿çœŸæ¨¡æ‹Ÿå„ç§è®¡ç®—æœºåŠŸèƒ½æ¥å®ç°çš„ã€‚\n\n## äºŒã€JVMæ¶æ„çŸ¥è¯†\n1.JVMä¸»è¦åŒ…å«**ç±»è£…è½½å™¨ã€è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜æ¨¡å‹ï¼‰ã€æ‰§è¡Œå¼•æ“**ã€‚é‡Œé¢å†…å­˜æ¨¡å‹æœ‰å¯ä»¥ç»†åˆ†åŒ…æ‹¬æœ¬åœ°æ–¹æ³•æ ˆã€å †ã€æ ˆï¼ˆçº¿ç¨‹ï¼‰ã€æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ã€ç¨‹åºè®¡æ•°å™¨ã€‚\nå¦‚å›¾æ‰€ç¤ºï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/351bc7933dbca9d91c52db9f79bec760.png)\n\n1.ç±»è£…è½½å™¨çš„ä½œç”¨å°±æ˜¯è´Ÿè´£åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡ç¤ºï¼Œå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„å¹¶ä¸”ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰å†³å®šã€‚ç±»åŠ è½½å™¨åˆæœ‰å››å¤§ç±»åŠ è½½å™¨ï¼š\n\nå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰:è´Ÿè´£åŠ è½½JREæ ¸å¿ƒç±»åº“ï¼ŒåƒJREä¸­çš„rt.jarç­‰ï¼ˆC/C++ï¼‰ï¼›\n\næ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½JREæ‰©å±•ç›®å½•extä¸­çš„jaråŒ…ï¼›\n\nç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½ClassPathè·¯å¾„ä¸‹çš„ç±»åŒ…ï¼›\n\nè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ï¼ˆUser ClassLoaderï¼‰ï¼šåªåŠ è½½æŒ‡å®šç›®å½•ä¸‹çš„jarå’Œclassï¼Œæƒ³åŠ è½½å…¶å®ƒä½ç½®çš„ç±»æˆ–jaræ—¶å¾—è‡ªè¡Œå®šä¹‰ç±»åŠ è½½å™¨ï¼›\n\n2.**JVMä¸­ï¼Œå¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å†…å­˜ç©ºé—´çš„ï¼Œæ ˆåªç”¨äºä¿å­˜å±€éƒ¨å˜é‡å’Œä¸´æ—¶å˜é‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåªä¿å­˜å¼•ç”¨**ï¼Œå®é™…å†…å­˜è¿˜æ˜¯åœ¨å †ä¸­ã€‚æ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼Œå‡è®¾ä¸€ä¸ªmainæ–¹æ³•ï¼Œé‡Œé¢æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯åæ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•å³é‚£ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯æ‰§è¡Œå®Œæ¯•åï¼Œé‚£ä¸ªçº¿ç¨‹æ˜¯å…ˆé”€æ¯çš„ã€‚**æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼ˆå­˜æ”¾å±€éƒ¨å˜é‡çš„ï¼‰ã€æ“ä½œæ•°æ ˆï¼ˆå­˜æ”¾éœ€è¦è¿ç®—çš„æ•°æ®ï¼‰ã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ï¼ˆæ‰§è¡Œå®Œæ–¹æ³• å›åˆ°mainæ–¹æ³•çš„ä½ç½®ï¼‰ç­‰ä¿¡æ¯**ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚å³ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€å—æ ˆå¸§å†…å­˜åŒºåŸŸï¼ˆå­˜æ”¾æœ¬æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼‰ã€‚\n\n3.æ–¹æ³•åŒºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ï¼ˆå †ä¸­çš„å¯¹è±¡å¸¸é‡åœ°å€ï¼‰ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚\n\n4.æœ¬åœ°æ–¹æ³•æ ˆå’Œæ ˆçš„ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæœåŠ¡çš„å¯¹è±¡æ˜¯nativeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¾—ç”±cè¯­è¨€æ¥å®ç°ã€‚\n\n5.ç¨‹åºè®¡æ•°å™¨ä½œç”¨æ˜¯å½“CPUå¤šçº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™ï¼Œåˆ‡å›åˆ°å½“å‰çº¿ç¨‹çš„æ—¶å€™ï¼Œå›åˆ°ç¨‹åºè®¡æ•°å™¨è®¡æ•°çš„ä½ç½®ï¼Œç»§ç»­æ‰§è¡Œã€‚\n\n## ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\næ–°ç”Ÿä»£åŒ…æ‹¬EdenåŠ ä¸Š2ä¸ªsurvivoråŒºï¼Œæ‰§è¡Œminor gcä¹‹åï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œæ´»ç€çš„è¿›å…¥s0ï¼Œå†æ¬¡minor gcï¼Œæ´»ç€çš„å¯¹è±¡eden+s0->s1ï¼Œå†æ¬¡minor gcï¼Œeden+s1->s0â€¦è¿™é‡Œè™šæ‹Ÿæœºé‡‡å–äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼ŒJVMç»™æ¯ä¸ªå¯¹è±¡ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ï¼Œåˆ†ä»£å¹´é¾„è¾¾åˆ°15åå³å¯¹è±¡è¢«æ‰§è¡Œäº†15æ¬¡minor gcåç§»å…¥è€å¹´ä»£ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒsåŒºè£…ä¸ä¸‹çš„å¤§å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚\n\næœ€åï¼Œè€å¹´ä»£å­˜çš„å°±æ˜¯ä¸€äº›å¤§å¯¹è±¡å’Œéœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼ˆé™æ€å˜é‡ã€ç¼“å­˜ã€çº¿ç¨‹æ± ç­‰ï¼‰ï¼Œè€å¹´ä»£æ»¡äº†çš„è¯ï¼Œä¼šæ‰§è¡ŒFull GCåƒåœ¾æ”¶é›†ã€‚å®˜ç½‘å¯¹Full GCçš„è§£é‡Šä¸­ä»‹ç»äº†ä¸ªè¯â€Stop-The-Worldâ€ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰çš„åº”ç”¨çº¿ç¨‹åœæ‰ï¼Œè¿™æ—¶å€™ç³»ç»Ÿä¼šå¡æ‰ã€‚**JVMè™šæ‹Ÿæœºè°ƒä¼˜çš„ç›®æ ‡å°±æ˜¯å‡å°‘full gcå³å‡å°‘STWã€‚**\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a79e182e285aa8a998b64f8c2929cea2.png)\n\n## å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\n**å †é‡Œé¢å­˜æ”¾newçš„å¯¹è±¡å’Œæ•°ç»„**ï¼ŒJavaä¼˜äºå…¶ä»–è¯­è¨€ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯å®ƒèƒ½è‡ªåŠ¨å¤„ç†åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ã€‚æœ‰äº†åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å‡ ç‚¹å¥½å¤„ç¼–ç¨‹ç®€å•ï¼Œç³»ç»Ÿä¸å®¹æ˜“å‡ºé”™ã€‚\n\n1.ä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ\n\n**æˆ‘ä»¬æŠŠæ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æˆ–è€…ä¸€å †å¯¹è±¡ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰å®šä¹‰ä¸ºåƒåœ¾ã€‚**\n\n2.ç³»ç»Ÿå¦‚ä½•å®šä½åƒåœ¾\n\n- å¼•ç”¨è®¡æ•°ç®—æ³•-ç®€å•ä¸”é«˜æ•ˆä½†æ˜¯ä¸»æµçš„Javaè™šæ‹Ÿæœºé‡Œå¹¶æ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚\n- **æ ¹å¯è¾¾åˆ†æç®—æ³•**-å°†â€GC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢å¼•ç”¨çš„å¯¹è±¡ï¼Œæ‰¾åˆ°çš„å¯¹è±¡éƒ½æ ‡è®°ä¸ºéåƒåœ¾å¯¹è±¡ï¼Œå…¶ä½™æœªæ ‡è®°çš„å¯¹è±¡éƒ½æ˜¯åƒåœ¾å¯¹è±¡ã€‚çº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ã€é™æ€å˜é‡ã€æœ¬åœ°æ–¹æ³•æ ˆçš„å˜é‡ç­‰ç­‰éƒ½å¯ä»¥ç§°ä½œGC Rootsè·ŸèŠ‚ç‚¹ã€‚\nå¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/313951e066caf10cfb67e43c4a5a6dcc.png)\n\n3.å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•\n\n- **å¤åˆ¶ç®—æ³•**-æ²¡æœ‰ç¢ç‰‡ æµªè´¹å†…å­˜ç©ºé—´ï¼ˆç›®å‰ä½¿ç”¨æ–°ç”Ÿä»£ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼‰\n- æ ‡è®°æ¸…é™¤-ä½ç½®ä¸è¿ç»­ äº§ç”Ÿå†…å­˜ç¢ç‰‡\n- æ ‡è®°å‹ç¼©-æ²¡æœ‰ç¢ç‰‡ æ•ˆç‡åä½\nå¤åˆ¶ç®—æ³•å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚\n\n## äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨\næ–°ç”Ÿä»£æ”¶é›†å™¨ï¼šSerialã€ParNewã€Parallel Scavenge\nè€å¹´ä»£æ”¶é›†å™¨ï¼šCMSã€Serial Oldã€Parallel Old\næ•´å †æ”¶é›†å™¨ï¼š G1\n\n**jdk1.8 é»˜è®¤åƒåœ¾æ”¶é›†å™¨Parallel Scavengeï¼ˆæ–°ç”Ÿä»£ï¼‰+Parallel Oldï¼ˆè€å¹´ä»£ï¼‰**","slug":"JVMåŸºç¡€å¿«é€Ÿå…¥é—¨ç¯‡","published":1,"updated":"2024-02-07T07:27:45.070Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dj000awen10ydj6d4u","content":"<p><strong>Javaæ˜¯ä¸€é—¨å¯ä»¥è·¨å¹³å°çš„è¯­è¨€ï¼Œä½†æ˜¯Javaæœ¬èº«æ˜¯ä¸å¯ä»¥å®ç°è·¨å¹³å°çš„ï¼Œéœ€è¦JVMå®ç°è·¨å¹³å°ã€‚javacç¼–è¯‘å¥½åçš„classæ–‡ä»¶ï¼Œåœ¨Windowsã€Linuxã€Macç­‰ç³»ç»Ÿä¸Šï¼Œåªè¦è¯¥ç³»ç»Ÿå®‰è£…å¯¹åº”çš„Javaè™šæ‹Ÿæœºï¼Œclassæ–‡ä»¶éƒ½å¯ä»¥è¿è¡Œã€‚è¾¾åˆ°â€ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„æ•ˆæœã€‚</strong></p>\n<h2 id=\"ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>è€ŒJVMåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¼•ç”¨ç™¾åº¦ç™¾ç§‘å¯¹JVMçš„ä»‹ç»ï¼š</p>\n<blockquote>\n<p>JVMæ˜¯Java Virtual Machineï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼ŒJVMæ˜¯ä¸€ç§ç”¨äºè®¡ç®—è®¾å¤‡çš„è§„èŒƒï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ„å‡ºæ¥çš„è®¡ç®—æœºï¼Œæ˜¯é€šè¿‡åœ¨å®é™…çš„è®¡ç®—æœºä¸Šä»¿çœŸæ¨¡æ‹Ÿå„ç§è®¡ç®—æœºåŠŸèƒ½æ¥å®ç°çš„ã€‚</p>\n</blockquote>\n<h2 id=\"äºŒã€JVMæ¶æ„çŸ¥è¯†\"><a href=\"#äºŒã€JVMæ¶æ„çŸ¥è¯†\" class=\"headerlink\" title=\"äºŒã€JVMæ¶æ„çŸ¥è¯†\"></a>äºŒã€JVMæ¶æ„çŸ¥è¯†</h2><p>1.JVMä¸»è¦åŒ…å«<strong>ç±»è£…è½½å™¨ã€è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜æ¨¡å‹ï¼‰ã€æ‰§è¡Œå¼•æ“</strong>ã€‚é‡Œé¢å†…å­˜æ¨¡å‹æœ‰å¯ä»¥ç»†åˆ†åŒ…æ‹¬æœ¬åœ°æ–¹æ³•æ ˆã€å †ã€æ ˆï¼ˆçº¿ç¨‹ï¼‰ã€æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ã€ç¨‹åºè®¡æ•°å™¨ã€‚<br>å¦‚å›¾æ‰€ç¤ºï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/351bc7933dbca9d91c52db9f79bec760.png\" alt=\"image.png\"></p>\n<p>1.ç±»è£…è½½å™¨çš„ä½œç”¨å°±æ˜¯è´Ÿè´£åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡ç¤ºï¼Œå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„å¹¶ä¸”ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰å†³å®šã€‚ç±»åŠ è½½å™¨åˆæœ‰å››å¤§ç±»åŠ è½½å™¨ï¼š</p>\n<p>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰:è´Ÿè´£åŠ è½½JREæ ¸å¿ƒç±»åº“ï¼ŒåƒJREä¸­çš„rt.jarç­‰ï¼ˆC&#x2F;C++ï¼‰ï¼›</p>\n<p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½JREæ‰©å±•ç›®å½•extä¸­çš„jaråŒ…ï¼›</p>\n<p>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½ClassPathè·¯å¾„ä¸‹çš„ç±»åŒ…ï¼›</p>\n<p>è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ï¼ˆUser ClassLoaderï¼‰ï¼šåªåŠ è½½æŒ‡å®šç›®å½•ä¸‹çš„jarå’Œclassï¼Œæƒ³åŠ è½½å…¶å®ƒä½ç½®çš„ç±»æˆ–jaræ—¶å¾—è‡ªè¡Œå®šä¹‰ç±»åŠ è½½å™¨ï¼›</p>\n<p>2.<strong>JVMä¸­ï¼Œå¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å†…å­˜ç©ºé—´çš„ï¼Œæ ˆåªç”¨äºä¿å­˜å±€éƒ¨å˜é‡å’Œä¸´æ—¶å˜é‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåªä¿å­˜å¼•ç”¨</strong>ï¼Œå®é™…å†…å­˜è¿˜æ˜¯åœ¨å †ä¸­ã€‚æ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼Œå‡è®¾ä¸€ä¸ªmainæ–¹æ³•ï¼Œé‡Œé¢æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯åæ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•å³é‚£ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯æ‰§è¡Œå®Œæ¯•åï¼Œé‚£ä¸ªçº¿ç¨‹æ˜¯å…ˆé”€æ¯çš„ã€‚<strong>æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼ˆå­˜æ”¾å±€éƒ¨å˜é‡çš„ï¼‰ã€æ“ä½œæ•°æ ˆï¼ˆå­˜æ”¾éœ€è¦è¿ç®—çš„æ•°æ®ï¼‰ã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ï¼ˆæ‰§è¡Œå®Œæ–¹æ³• å›åˆ°mainæ–¹æ³•çš„ä½ç½®ï¼‰ç­‰ä¿¡æ¯</strong>ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚å³ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€å—æ ˆå¸§å†…å­˜åŒºåŸŸï¼ˆå­˜æ”¾æœ¬æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼‰ã€‚</p>\n<p>3.æ–¹æ³•åŒºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ï¼ˆå †ä¸­çš„å¯¹è±¡å¸¸é‡åœ°å€ï¼‰ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</p>\n<p>4.æœ¬åœ°æ–¹æ³•æ ˆå’Œæ ˆçš„ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæœåŠ¡çš„å¯¹è±¡æ˜¯nativeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¾—ç”±cè¯­è¨€æ¥å®ç°ã€‚</p>\n<p>5.ç¨‹åºè®¡æ•°å™¨ä½œç”¨æ˜¯å½“CPUå¤šçº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™ï¼Œåˆ‡å›åˆ°å½“å‰çº¿ç¨‹çš„æ—¶å€™ï¼Œå›åˆ°ç¨‹åºè®¡æ•°å™¨è®¡æ•°çš„ä½ç½®ï¼Œç»§ç»­æ‰§è¡Œã€‚</p>\n<h2 id=\"ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\"><a href=\"#ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\" class=\"headerlink\" title=\"ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\"></a>ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹</h2><p>æ–°ç”Ÿä»£åŒ…æ‹¬EdenåŠ ä¸Š2ä¸ªsurvivoråŒºï¼Œæ‰§è¡Œminor gcä¹‹åï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œæ´»ç€çš„è¿›å…¥s0ï¼Œå†æ¬¡minor gcï¼Œæ´»ç€çš„å¯¹è±¡eden+s0-&gt;s1ï¼Œå†æ¬¡minor gcï¼Œeden+s1-&gt;s0â€¦è¿™é‡Œè™šæ‹Ÿæœºé‡‡å–äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼ŒJVMç»™æ¯ä¸ªå¯¹è±¡ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ï¼Œåˆ†ä»£å¹´é¾„è¾¾åˆ°15åå³å¯¹è±¡è¢«æ‰§è¡Œäº†15æ¬¡minor gcåç§»å…¥è€å¹´ä»£ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒsåŒºè£…ä¸ä¸‹çš„å¤§å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚</p>\n<p>æœ€åï¼Œè€å¹´ä»£å­˜çš„å°±æ˜¯ä¸€äº›å¤§å¯¹è±¡å’Œéœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼ˆé™æ€å˜é‡ã€ç¼“å­˜ã€çº¿ç¨‹æ± ç­‰ï¼‰ï¼Œè€å¹´ä»£æ»¡äº†çš„è¯ï¼Œä¼šæ‰§è¡ŒFull GCåƒåœ¾æ”¶é›†ã€‚å®˜ç½‘å¯¹Full GCçš„è§£é‡Šä¸­ä»‹ç»äº†ä¸ªè¯â€Stop-The-Worldâ€ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰çš„åº”ç”¨çº¿ç¨‹åœæ‰ï¼Œè¿™æ—¶å€™ç³»ç»Ÿä¼šå¡æ‰ã€‚<strong>JVMè™šæ‹Ÿæœºè°ƒä¼˜çš„ç›®æ ‡å°±æ˜¯å‡å°‘full gcå³å‡å°‘STWã€‚</strong><br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a79e182e285aa8a998b64f8c2929cea2.png\" alt=\"image.png\"></p>\n<h2 id=\"å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\"><a href=\"#å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\" class=\"headerlink\" title=\"å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\"></a>å››ã€åƒåœ¾å›æ”¶æœºåˆ¶</h2><p><strong>å †é‡Œé¢å­˜æ”¾newçš„å¯¹è±¡å’Œæ•°ç»„</strong>ï¼ŒJavaä¼˜äºå…¶ä»–è¯­è¨€ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯å®ƒèƒ½è‡ªåŠ¨å¤„ç†åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ã€‚æœ‰äº†åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å‡ ç‚¹å¥½å¤„ç¼–ç¨‹ç®€å•ï¼Œç³»ç»Ÿä¸å®¹æ˜“å‡ºé”™ã€‚</p>\n<p>1.ä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ</p>\n<p><strong>æˆ‘ä»¬æŠŠæ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æˆ–è€…ä¸€å †å¯¹è±¡ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰å®šä¹‰ä¸ºåƒåœ¾ã€‚</strong></p>\n<p>2.ç³»ç»Ÿå¦‚ä½•å®šä½åƒåœ¾</p>\n<ul>\n<li>å¼•ç”¨è®¡æ•°ç®—æ³•-ç®€å•ä¸”é«˜æ•ˆä½†æ˜¯ä¸»æµçš„Javaè™šæ‹Ÿæœºé‡Œå¹¶æ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</li>\n<li><strong>æ ¹å¯è¾¾åˆ†æç®—æ³•</strong>-å°†â€GC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢å¼•ç”¨çš„å¯¹è±¡ï¼Œæ‰¾åˆ°çš„å¯¹è±¡éƒ½æ ‡è®°ä¸ºéåƒåœ¾å¯¹è±¡ï¼Œå…¶ä½™æœªæ ‡è®°çš„å¯¹è±¡éƒ½æ˜¯åƒåœ¾å¯¹è±¡ã€‚çº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ã€é™æ€å˜é‡ã€æœ¬åœ°æ–¹æ³•æ ˆçš„å˜é‡ç­‰ç­‰éƒ½å¯ä»¥ç§°ä½œGC Rootsè·ŸèŠ‚ç‚¹ã€‚<br>å¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/313951e066caf10cfb67e43c4a5a6dcc.png\" alt=\"image.png\"></li>\n</ul>\n<p>3.å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•</p>\n<ul>\n<li><strong>å¤åˆ¶ç®—æ³•</strong>-æ²¡æœ‰ç¢ç‰‡ æµªè´¹å†…å­˜ç©ºé—´ï¼ˆç›®å‰ä½¿ç”¨æ–°ç”Ÿä»£ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼‰</li>\n<li>æ ‡è®°æ¸…é™¤-ä½ç½®ä¸è¿ç»­ äº§ç”Ÿå†…å­˜ç¢ç‰‡</li>\n<li>æ ‡è®°å‹ç¼©-æ²¡æœ‰ç¢ç‰‡ æ•ˆç‡åä½<br>å¤åˆ¶ç®—æ³•å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚</li>\n</ul>\n<h2 id=\"äº”-å¸¸è§åƒåœ¾å›æ”¶å™¨\"><a href=\"#äº”-å¸¸è§åƒåœ¾å›æ”¶å™¨\" class=\"headerlink\" title=\"äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨\"></a>äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨</h2><p>æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼šSerialã€ParNewã€Parallel Scavenge<br>è€å¹´ä»£æ”¶é›†å™¨ï¼šCMSã€Serial Oldã€Parallel Old<br>æ•´å †æ”¶é›†å™¨ï¼š G1</p>\n<p><strong>jdk1.8 é»˜è®¤åƒåœ¾æ”¶é›†å™¨Parallel Scavengeï¼ˆæ–°ç”Ÿä»£ï¼‰+Parallel Oldï¼ˆè€å¹´ä»£ï¼‰</strong></p>\n","excerpt":"","more":"<p><strong>Javaæ˜¯ä¸€é—¨å¯ä»¥è·¨å¹³å°çš„è¯­è¨€ï¼Œä½†æ˜¯Javaæœ¬èº«æ˜¯ä¸å¯ä»¥å®ç°è·¨å¹³å°çš„ï¼Œéœ€è¦JVMå®ç°è·¨å¹³å°ã€‚javacç¼–è¯‘å¥½åçš„classæ–‡ä»¶ï¼Œåœ¨Windowsã€Linuxã€Macç­‰ç³»ç»Ÿä¸Šï¼Œåªè¦è¯¥ç³»ç»Ÿå®‰è£…å¯¹åº”çš„Javaè™šæ‹Ÿæœºï¼Œclassæ–‡ä»¶éƒ½å¯ä»¥è¿è¡Œã€‚è¾¾åˆ°â€ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„æ•ˆæœã€‚</strong></p>\n<h2 id=\"ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ä¸€ã€JVMæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>è€ŒJVMåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¼•ç”¨ç™¾åº¦ç™¾ç§‘å¯¹JVMçš„ä»‹ç»ï¼š</p>\n<blockquote>\n<p>JVMæ˜¯Java Virtual Machineï¼ˆJavaè™šæ‹Ÿæœºï¼‰çš„ç¼©å†™ï¼ŒJVMæ˜¯ä¸€ç§ç”¨äºè®¡ç®—è®¾å¤‡çš„è§„èŒƒï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ„å‡ºæ¥çš„è®¡ç®—æœºï¼Œæ˜¯é€šè¿‡åœ¨å®é™…çš„è®¡ç®—æœºä¸Šä»¿çœŸæ¨¡æ‹Ÿå„ç§è®¡ç®—æœºåŠŸèƒ½æ¥å®ç°çš„ã€‚</p>\n</blockquote>\n<h2 id=\"äºŒã€JVMæ¶æ„çŸ¥è¯†\"><a href=\"#äºŒã€JVMæ¶æ„çŸ¥è¯†\" class=\"headerlink\" title=\"äºŒã€JVMæ¶æ„çŸ¥è¯†\"></a>äºŒã€JVMæ¶æ„çŸ¥è¯†</h2><p>1.JVMä¸»è¦åŒ…å«<strong>ç±»è£…è½½å™¨ã€è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆå†…å­˜æ¨¡å‹ï¼‰ã€æ‰§è¡Œå¼•æ“</strong>ã€‚é‡Œé¢å†…å­˜æ¨¡å‹æœ‰å¯ä»¥ç»†åˆ†åŒ…æ‹¬æœ¬åœ°æ–¹æ³•æ ˆã€å †ã€æ ˆï¼ˆçº¿ç¨‹ï¼‰ã€æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ã€ç¨‹åºè®¡æ•°å™¨ã€‚<br>å¦‚å›¾æ‰€ç¤ºï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/351bc7933dbca9d91c52db9f79bec760.png\" alt=\"image.png\"></p>\n<p>1.ç±»è£…è½½å™¨çš„ä½œç”¨å°±æ˜¯è´Ÿè´£åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡ç¤ºï¼Œå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„å¹¶ä¸”ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰å†³å®šã€‚ç±»åŠ è½½å™¨åˆæœ‰å››å¤§ç±»åŠ è½½å™¨ï¼š</p>\n<p>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰:è´Ÿè´£åŠ è½½JREæ ¸å¿ƒç±»åº“ï¼ŒåƒJREä¸­çš„rt.jarç­‰ï¼ˆC&#x2F;C++ï¼‰ï¼›</p>\n<p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½JREæ‰©å±•ç›®å½•extä¸­çš„jaråŒ…ï¼›</p>\n<p>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼šè´Ÿè´£åŠ è½½ClassPathè·¯å¾„ä¸‹çš„ç±»åŒ…ï¼›</p>\n<p>è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ï¼ˆUser ClassLoaderï¼‰ï¼šåªåŠ è½½æŒ‡å®šç›®å½•ä¸‹çš„jarå’Œclassï¼Œæƒ³åŠ è½½å…¶å®ƒä½ç½®çš„ç±»æˆ–jaræ—¶å¾—è‡ªè¡Œå®šä¹‰ç±»åŠ è½½å™¨ï¼›</p>\n<p>2.<strong>JVMä¸­ï¼Œå¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å†…å­˜ç©ºé—´çš„ï¼Œæ ˆåªç”¨äºä¿å­˜å±€éƒ¨å˜é‡å’Œä¸´æ—¶å˜é‡ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œåªä¿å­˜å¼•ç”¨</strong>ï¼Œå®é™…å†…å­˜è¿˜æ˜¯åœ¨å †ä¸­ã€‚æ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼Œå‡è®¾ä¸€ä¸ªmainæ–¹æ³•ï¼Œé‡Œé¢æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ˜¯åæ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•å³é‚£ä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯æ‰§è¡Œå®Œæ¯•åï¼Œé‚£ä¸ªçº¿ç¨‹æ˜¯å…ˆé”€æ¯çš„ã€‚<strong>æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼ˆå­˜æ”¾å±€éƒ¨å˜é‡çš„ï¼‰ã€æ“ä½œæ•°æ ˆï¼ˆå­˜æ”¾éœ€è¦è¿ç®—çš„æ•°æ®ï¼‰ã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ï¼ˆæ‰§è¡Œå®Œæ–¹æ³• å›åˆ°mainæ–¹æ³•çš„ä½ç½®ï¼‰ç­‰ä¿¡æ¯</strong>ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚å³ä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€å—æ ˆå¸§å†…å­˜åŒºåŸŸï¼ˆå­˜æ”¾æœ¬æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼‰ã€‚</p>\n<p>3.æ–¹æ³•åŒºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ï¼ˆå †ä¸­çš„å¯¹è±¡å¸¸é‡åœ°å€ï¼‰ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</p>\n<p>4.æœ¬åœ°æ–¹æ³•æ ˆå’Œæ ˆçš„ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæœåŠ¡çš„å¯¹è±¡æ˜¯nativeæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¾—ç”±cè¯­è¨€æ¥å®ç°ã€‚</p>\n<p>5.ç¨‹åºè®¡æ•°å™¨ä½œç”¨æ˜¯å½“CPUå¤šçº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™ï¼Œåˆ‡å›åˆ°å½“å‰çº¿ç¨‹çš„æ—¶å€™ï¼Œå›åˆ°ç¨‹åºè®¡æ•°å™¨è®¡æ•°çš„ä½ç½®ï¼Œç»§ç»­æ‰§è¡Œã€‚</p>\n<h2 id=\"ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\"><a href=\"#ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\" class=\"headerlink\" title=\"ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹\"></a>ä¸‰ã€å †å†…å­˜çš„ç»“æ„æ¨¡å‹</h2><p>æ–°ç”Ÿä»£åŒ…æ‹¬EdenåŠ ä¸Š2ä¸ªsurvivoråŒºï¼Œæ‰§è¡Œminor gcä¹‹åï¼Œå¤§å¤šæ•°çš„å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œæ´»ç€çš„è¿›å…¥s0ï¼Œå†æ¬¡minor gcï¼Œæ´»ç€çš„å¯¹è±¡eden+s0-&gt;s1ï¼Œå†æ¬¡minor gcï¼Œeden+s1-&gt;s0â€¦è¿™é‡Œè™šæ‹Ÿæœºé‡‡å–äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼ŒJVMç»™æ¯ä¸ªå¯¹è±¡ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ï¼Œåˆ†ä»£å¹´é¾„è¾¾åˆ°15åå³å¯¹è±¡è¢«æ‰§è¡Œäº†15æ¬¡minor gcåç§»å…¥è€å¹´ä»£ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒsåŒºè£…ä¸ä¸‹çš„å¤§å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚</p>\n<p>æœ€åï¼Œè€å¹´ä»£å­˜çš„å°±æ˜¯ä¸€äº›å¤§å¯¹è±¡å’Œéœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼ˆé™æ€å˜é‡ã€ç¼“å­˜ã€çº¿ç¨‹æ± ç­‰ï¼‰ï¼Œè€å¹´ä»£æ»¡äº†çš„è¯ï¼Œä¼šæ‰§è¡ŒFull GCåƒåœ¾æ”¶é›†ã€‚å®˜ç½‘å¯¹Full GCçš„è§£é‡Šä¸­ä»‹ç»äº†ä¸ªè¯â€Stop-The-Worldâ€ï¼Œå®ƒä¼šæŠŠæ‰€æœ‰çš„åº”ç”¨çº¿ç¨‹åœæ‰ï¼Œè¿™æ—¶å€™ç³»ç»Ÿä¼šå¡æ‰ã€‚<strong>JVMè™šæ‹Ÿæœºè°ƒä¼˜çš„ç›®æ ‡å°±æ˜¯å‡å°‘full gcå³å‡å°‘STWã€‚</strong><br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a79e182e285aa8a998b64f8c2929cea2.png\" alt=\"image.png\"></p>\n<h2 id=\"å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\"><a href=\"#å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\" class=\"headerlink\" title=\"å››ã€åƒåœ¾å›æ”¶æœºåˆ¶\"></a>å››ã€åƒåœ¾å›æ”¶æœºåˆ¶</h2><p><strong>å †é‡Œé¢å­˜æ”¾newçš„å¯¹è±¡å’Œæ•°ç»„</strong>ï¼ŒJavaä¼˜äºå…¶ä»–è¯­è¨€ä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯å®ƒèƒ½è‡ªåŠ¨å¤„ç†åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰ã€‚æœ‰äº†åƒåœ¾å›æ”¶æœºåˆ¶æœ‰å‡ ç‚¹å¥½å¤„ç¼–ç¨‹ç®€å•ï¼Œç³»ç»Ÿä¸å®¹æ˜“å‡ºé”™ã€‚</p>\n<p>1.ä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ</p>\n<p><strong>æˆ‘ä»¬æŠŠæ²¡æœ‰ä»»ä½•å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æˆ–è€…ä¸€å †å¯¹è±¡ï¼ˆå¾ªç¯å¼•ç”¨ï¼‰å®šä¹‰ä¸ºåƒåœ¾ã€‚</strong></p>\n<p>2.ç³»ç»Ÿå¦‚ä½•å®šä½åƒåœ¾</p>\n<ul>\n<li>å¼•ç”¨è®¡æ•°ç®—æ³•-ç®€å•ä¸”é«˜æ•ˆä½†æ˜¯ä¸»æµçš„Javaè™šæ‹Ÿæœºé‡Œå¹¶æ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</li>\n<li><strong>æ ¹å¯è¾¾åˆ†æç®—æ³•</strong>-å°†â€GC Rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢å¼•ç”¨çš„å¯¹è±¡ï¼Œæ‰¾åˆ°çš„å¯¹è±¡éƒ½æ ‡è®°ä¸ºéåƒåœ¾å¯¹è±¡ï¼Œå…¶ä½™æœªæ ‡è®°çš„å¯¹è±¡éƒ½æ˜¯åƒåœ¾å¯¹è±¡ã€‚çº¿ç¨‹æ ˆçš„æœ¬åœ°å˜é‡ã€é™æ€å˜é‡ã€æœ¬åœ°æ–¹æ³•æ ˆçš„å˜é‡ç­‰ç­‰éƒ½å¯ä»¥ç§°ä½œGC Rootsè·ŸèŠ‚ç‚¹ã€‚<br>å¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/313951e066caf10cfb67e43c4a5a6dcc.png\" alt=\"image.png\"></li>\n</ul>\n<p>3.å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•</p>\n<ul>\n<li><strong>å¤åˆ¶ç®—æ³•</strong>-æ²¡æœ‰ç¢ç‰‡ æµªè´¹å†…å­˜ç©ºé—´ï¼ˆç›®å‰ä½¿ç”¨æ–°ç”Ÿä»£ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼‰</li>\n<li>æ ‡è®°æ¸…é™¤-ä½ç½®ä¸è¿ç»­ äº§ç”Ÿå†…å­˜ç¢ç‰‡</li>\n<li>æ ‡è®°å‹ç¼©-æ²¡æœ‰ç¢ç‰‡ æ•ˆç‡åä½<br>å¤åˆ¶ç®—æ³•å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ï¼Œå½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚</li>\n</ul>\n<h2 id=\"äº”-å¸¸è§åƒåœ¾å›æ”¶å™¨\"><a href=\"#äº”-å¸¸è§åƒåœ¾å›æ”¶å™¨\" class=\"headerlink\" title=\"äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨\"></a>äº”.å¸¸è§åƒåœ¾å›æ”¶å™¨</h2><p>æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼šSerialã€ParNewã€Parallel Scavenge<br>è€å¹´ä»£æ”¶é›†å™¨ï¼šCMSã€Serial Oldã€Parallel Old<br>æ•´å †æ”¶é›†å™¨ï¼š G1</p>\n<p><strong>jdk1.8 é»˜è®¤åƒåœ¾æ”¶é›†å™¨Parallel Scavengeï¼ˆæ–°ç”Ÿä»£ï¼‰+Parallel Oldï¼ˆè€å¹´ä»£ï¼‰</strong></p>\n"},{"title":"Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock","date":"2022-02-05T09:35:40.000Z","_content":"\nReentrantLockæ˜¯å¯ä»¥ç”¨æ¥ä»£æ›¿synchronizedçš„ã€‚ReentrantLockæ¯”synchronizedæ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½ä¸Šé¢æ›´åŠ ä¸°å¯Œï¼Œæ€§èƒ½æ–¹é¢è‡ªsynchronizedä¼˜åŒ–åä¸¤è€…æ€§èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§å·®åˆ«ã€‚\n\nè¯´ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«é¦–å…ˆReetrantLockæ˜¯åŸºäºJDKå®ç°å±‚é¢çš„ï¼Œè€Œsynchronizedæ˜¯åŸºäºJVMå±‚é¢å®ç°çš„ã€‚ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼Œæ”¯æŒå…¬å¹³é”çš„å®ç°ã€‚\n```java\nLock lock = new ReentrantLock(); \nlock.lock();\ntry {\n    //ä¸šåŠ¡é€»è¾‘  \n} finally {\n  lock.unlock();\n}\n```\n ä¸€ä¸ªReentrantLockçš„ç®€å•å®ç°ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œä¸ç„¶å¾ˆå®¹æ˜“äº§ç”Ÿæ­»é”ã€‚ä½¿ç”¨syncé”å®šçš„è¯é‡åˆ°å¼‚å¸¸ï¼Œjvmä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä½†æ˜¯reentrantLockå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå› æ­¤ç»å¸¸åœ¨finallyä¸­è¿›è¡Œé”çš„é‡Šæ”¾ã€‚\n\n```java\nLock lock=new ReentrantLock();\n    boolean locked=false;\n    try{\n        try {\n            locked=lock.tryLock(5,TimeUnit.SECONDS);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }finally {\n        if(locked){\n            lock.unlock();\n        }\n    }\n```\nReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼ŒtryLockçš„æ–¹æ³•å°±æ˜¯è¿›è¡Œå°è¯•é”å®šï¼Œå¦‚æœèƒ½åœ¨æŒ‡å®šæ—¶é—´å†…å¾—åˆ°é”ï¼Œå°±è¿”å›trueï¼Œåä¹‹è¿”å›falseã€‚æŒ‡å®šæ—¶é—´å†…æ— æ³•é”å®šæ—¶ï¼Œçº¿ç¨‹å¯ä»¥å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚\n\n```java\nprivate static ReentrantLock lock=new ReentrantLock(true); //å‚æ•°ä¸ºtrueè¡¨ç¤ºå…¬å¹³é”\n```\nReentrantLockå¯ä»¥æŒ‡å®šä¸ºå…¬å¹³é”ï¼ŒReentrantLockå’Œsyncé»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œ**éå…¬å¹³é”**ï¼šçº¿ç¨‹åŠ é”æ—¶**ç›´æ¥å°è¯•è·å–é”**ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚è€Œ**å…¬å¹³é”**ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œ**å…ˆæ¥å…ˆå¾—**ã€‚\n","source":"_posts/Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock.md","raw":"---\ntitle: Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock\ndate: 2022-02-05 17:35:40\ntags:\n---\n\nReentrantLockæ˜¯å¯ä»¥ç”¨æ¥ä»£æ›¿synchronizedçš„ã€‚ReentrantLockæ¯”synchronizedæ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½ä¸Šé¢æ›´åŠ ä¸°å¯Œï¼Œæ€§èƒ½æ–¹é¢è‡ªsynchronizedä¼˜åŒ–åä¸¤è€…æ€§èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§å·®åˆ«ã€‚\n\nè¯´ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«é¦–å…ˆReetrantLockæ˜¯åŸºäºJDKå®ç°å±‚é¢çš„ï¼Œè€Œsynchronizedæ˜¯åŸºäºJVMå±‚é¢å®ç°çš„ã€‚ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼Œæ”¯æŒå…¬å¹³é”çš„å®ç°ã€‚\n```java\nLock lock = new ReentrantLock(); \nlock.lock();\ntry {\n    //ä¸šåŠ¡é€»è¾‘  \n} finally {\n  lock.unlock();\n}\n```\n ä¸€ä¸ªReentrantLockçš„ç®€å•å®ç°ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œä¸ç„¶å¾ˆå®¹æ˜“äº§ç”Ÿæ­»é”ã€‚ä½¿ç”¨syncé”å®šçš„è¯é‡åˆ°å¼‚å¸¸ï¼Œjvmä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä½†æ˜¯reentrantLockå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå› æ­¤ç»å¸¸åœ¨finallyä¸­è¿›è¡Œé”çš„é‡Šæ”¾ã€‚\n\n```java\nLock lock=new ReentrantLock();\n    boolean locked=false;\n    try{\n        try {\n            locked=lock.tryLock(5,TimeUnit.SECONDS);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }finally {\n        if(locked){\n            lock.unlock();\n        }\n    }\n```\nReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼ŒtryLockçš„æ–¹æ³•å°±æ˜¯è¿›è¡Œå°è¯•é”å®šï¼Œå¦‚æœèƒ½åœ¨æŒ‡å®šæ—¶é—´å†…å¾—åˆ°é”ï¼Œå°±è¿”å›trueï¼Œåä¹‹è¿”å›falseã€‚æŒ‡å®šæ—¶é—´å†…æ— æ³•é”å®šæ—¶ï¼Œçº¿ç¨‹å¯ä»¥å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚\n\n```java\nprivate static ReentrantLock lock=new ReentrantLock(true); //å‚æ•°ä¸ºtrueè¡¨ç¤ºå…¬å¹³é”\n```\nReentrantLockå¯ä»¥æŒ‡å®šä¸ºå…¬å¹³é”ï¼ŒReentrantLockå’Œsyncé»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œ**éå…¬å¹³é”**ï¼šçº¿ç¨‹åŠ é”æ—¶**ç›´æ¥å°è¯•è·å–é”**ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚è€Œ**å…¬å¹³é”**ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œ**å…ˆæ¥å…ˆå¾—**ã€‚\n","slug":"Javaå¹¶å‘ç¼–ç¨‹(ä¸‰)ï¼šReentrantLock","published":1,"updated":"2024-02-07T07:27:45.071Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dj000bwen11yuv4mnq","content":"<p>ReentrantLockæ˜¯å¯ä»¥ç”¨æ¥ä»£æ›¿synchronizedçš„ã€‚ReentrantLockæ¯”synchronizedæ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½ä¸Šé¢æ›´åŠ ä¸°å¯Œï¼Œæ€§èƒ½æ–¹é¢è‡ªsynchronizedä¼˜åŒ–åä¸¤è€…æ€§èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§å·®åˆ«ã€‚</p>\n<p>è¯´ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«é¦–å…ˆReetrantLockæ˜¯åŸºäºJDKå®ç°å±‚é¢çš„ï¼Œè€Œsynchronizedæ˜¯åŸºäºJVMå±‚é¢å®ç°çš„ã€‚ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼Œæ”¯æŒå…¬å¹³é”çš„å®ç°ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>(); </span><br><span class=\"line\">lock.lock();</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘  </span></span><br><span class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">  lock.unlock();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> ä¸€ä¸ªReentrantLockçš„ç®€å•å®ç°ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œä¸ç„¶å¾ˆå®¹æ˜“äº§ç”Ÿæ­»é”ã€‚ä½¿ç”¨syncé”å®šçš„è¯é‡åˆ°å¼‚å¸¸ï¼Œjvmä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä½†æ˜¯reentrantLockå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå› æ­¤ç»å¸¸åœ¨finallyä¸­è¿›è¡Œé”çš„é‡Šæ”¾ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Lock lock=<span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\">    <span class=\"type\">boolean</span> locked=<span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            locked=lock.tryLock(<span class=\"number\">5</span>,TimeUnit.SECONDS);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(locked)&#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼ŒtryLockçš„æ–¹æ³•å°±æ˜¯è¿›è¡Œå°è¯•é”å®šï¼Œå¦‚æœèƒ½åœ¨æŒ‡å®šæ—¶é—´å†…å¾—åˆ°é”ï¼Œå°±è¿”å›trueï¼Œåä¹‹è¿”å›falseã€‚æŒ‡å®šæ—¶é—´å†…æ— æ³•é”å®šæ—¶ï¼Œçº¿ç¨‹å¯ä»¥å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ReentrantLock lock=<span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>(<span class=\"literal\">true</span>); <span class=\"comment\">//å‚æ•°ä¸ºtrueè¡¨ç¤ºå…¬å¹³é”</span></span><br></pre></td></tr></table></figure>\n<p>ReentrantLockå¯ä»¥æŒ‡å®šä¸ºå…¬å¹³é”ï¼ŒReentrantLockå’Œsyncé»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œ<strong>éå…¬å¹³é”</strong>ï¼šçº¿ç¨‹åŠ é”æ—¶<strong>ç›´æ¥å°è¯•è·å–é”</strong>ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚è€Œ<strong>å…¬å¹³é”</strong>ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œ<strong>å…ˆæ¥å…ˆå¾—</strong>ã€‚</p>\n","excerpt":"","more":"<p>ReentrantLockæ˜¯å¯ä»¥ç”¨æ¥ä»£æ›¿synchronizedçš„ã€‚ReentrantLockæ¯”synchronizedæ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½ä¸Šé¢æ›´åŠ ä¸°å¯Œï¼Œæ€§èƒ½æ–¹é¢è‡ªsynchronizedä¼˜åŒ–åä¸¤è€…æ€§èƒ½æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§å·®åˆ«ã€‚</p>\n<p>è¯´ä¸€ä¸‹ä¸¤è€…çš„åŒºåˆ«é¦–å…ˆReetrantLockæ˜¯åŸºäºJDKå®ç°å±‚é¢çš„ï¼Œè€Œsynchronizedæ˜¯åŸºäºJVMå±‚é¢å®ç°çš„ã€‚ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼Œæ”¯æŒå…¬å¹³é”çš„å®ç°ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Lock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>(); </span><br><span class=\"line\">lock.lock();</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘  </span></span><br><span class=\"line\">&#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">  lock.unlock();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> ä¸€ä¸ªReentrantLockçš„ç®€å•å®ç°ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œä¸ç„¶å¾ˆå®¹æ˜“äº§ç”Ÿæ­»é”ã€‚ä½¿ç”¨syncé”å®šçš„è¯é‡åˆ°å¼‚å¸¸ï¼Œjvmä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œä½†æ˜¯reentrantLockå¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå› æ­¤ç»å¸¸åœ¨finallyä¸­è¿›è¡Œé”çš„é‡Šæ”¾ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Lock lock=<span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>();</span><br><span class=\"line\">    <span class=\"type\">boolean</span> locked=<span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            locked=lock.tryLock(<span class=\"number\">5</span>,TimeUnit.SECONDS);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(locked)&#123;</span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>ReentrantLockå¯ä»¥è¿›è¡ŒtryLockå°è¯•é”å®šï¼ŒtryLockçš„æ–¹æ³•å°±æ˜¯è¿›è¡Œå°è¯•é”å®šï¼Œå¦‚æœèƒ½åœ¨æŒ‡å®šæ—¶é—´å†…å¾—åˆ°é”ï¼Œå°±è¿”å›trueï¼Œåä¹‹è¿”å›falseã€‚æŒ‡å®šæ—¶é—´å†…æ— æ³•é”å®šæ—¶ï¼Œçº¿ç¨‹å¯ä»¥å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ReentrantLock lock=<span class=\"keyword\">new</span> <span class=\"title class_\">ReentrantLock</span>(<span class=\"literal\">true</span>); <span class=\"comment\">//å‚æ•°ä¸ºtrueè¡¨ç¤ºå…¬å¹³é”</span></span><br></pre></td></tr></table></figure>\n<p>ReentrantLockå¯ä»¥æŒ‡å®šä¸ºå…¬å¹³é”ï¼ŒReentrantLockå’Œsyncé»˜è®¤æ˜¯éå…¬å¹³é”ï¼Œ<strong>éå…¬å¹³é”</strong>ï¼šçº¿ç¨‹åŠ é”æ—¶<strong>ç›´æ¥å°è¯•è·å–é”</strong>ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚è€Œ<strong>å…¬å¹³é”</strong>ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œ<strong>å…ˆæ¥å…ˆå¾—</strong>ã€‚</p>\n"},{"title":"Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—","date":"2022-02-04T09:35:40.000Z","_content":"\nvolatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚volatileå…³é”®å­—æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨ï¼Œä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯**å†…å­˜å¯è§æ€§**å’Œç¦æ­¢é‡æ’åºã€‚\n1ï¼‰ä¿è¯è¢«volatileä¿®é¥°çš„å…±äº«å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹æ€»æ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯**å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªè¢«volatileä¿®é¥°å…±äº«å˜é‡çš„å€¼ï¼Œæ–°å€¼æ€»æ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ç«‹å³å¾—çŸ¥ã€‚**\n2ï¼‰ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚åœ¨æ‰§è¡Œç¨‹åºæ—¶ä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨é€šå¸¸ä¼šé‡æ–°å®‰æ’æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚\n```java\npublic class T {\n\n    /*volatile*/ boolean running=true;\n\n    void m(){\n        System.out.println(\"m start\");\n        while (running){}\n        System.out.println(\"m end\");\n    }\n\n    public static void main(String[] args) {\n        T t=new T();\n\n        new Thread(()->t.m(),\"t1\").start();\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        t.running=false;\n    }\n}\n```\nè¿™æ®µä»£ç ä¸­æ²¡åŠ volatileçš„è¯ï¼Œå¾ªç¯çš„åé¢çš„è¾“å‡ºè¯­å¥\"m end\"ä¸ä¼šè¾“å‡ºï¼Œä½†æ˜¯mainæ–¹æ³•é‡Œé¢ç¡®å®æ˜¯å·²ç»å°†runningçš„å€¼æ”¹æˆäº†falseã€‚è¿™é‡Œæœ‰å…³javaçš„**å†…å­˜æ¨¡å‹**ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ï¼Œrunningçš„å€¼å·²ç»è¢«åŠ è½½åˆ°äº†ç¼“å­˜é‡Œé¢ï¼Œè€Œæ”¹çš„æ˜¯tå¯¹è±¡çš„runningå€¼åœ¨å †å†…å­˜ä¸­ã€‚åŠ äº†volatileå°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ”¹å®Œæ•°å€¼ä¹‹åï¼Œä¼šé€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œè®©å…¶ä»–çº¿ç¨‹é‡æ–°è¯»ä¸€ä¸‹å †å†…å­˜ä¸­çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å†…å­˜å¯è§æ€§ã€‚\n\n```java\npublic class T1 {\n\n    volatile int count=0;\n\n    /*synchronized*/ void m(){\n        for (int i=0;i<10000;i++){\n            count++;\n        }\n    }\n\n    public static void main(String[] args) {\n\n        T1 t=new T1();\n        List<Thread> threads=new ArrayList<Thread>();\n\n        for(int i=0;i<10;i++){\n            threads.add(new Thread(()->t.m(),\"thread-\"+i));\n        }\n        threads.forEach((o)->o.start());\n        threads.forEach((o)->{\n            try {\n                o.join();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n        System.out.println(t.count);\n    }\n}\n```\nè¿™æ®µä»£ç ä¸­ï¼Œåä¸ªçº¿ç¨‹æ‰§è¡Œcount++åŠ åˆ°1wå¾ªç¯ï¼Œç†æƒ³çŠ¶æ€å½“ç„¶æ˜¯åŠ åˆ°10wï¼Œä½†æ˜¯volatileåªèƒ½ä¿æŒçº¿ç¨‹çš„å¯è§æ€§ï¼Œä¸èƒ½ä¿æŒåŸå­æ€§ã€‚ç»™countå˜é‡åŠ ä¸Šäº†volatileï¼Œæœ€åè¾“å‡ºçš„countå€¼ä¹Ÿè¾¾ä¸åˆ°10wã€‚è¿™å°±æ˜¯volatileä¸synchronizedçš„åŒºåˆ«ï¼Œ**volatileåªèƒ½ä¿æŒå¯è§æ€§ï¼Œè€Œsynchronizedå¯ä»¥ä¿æŒå¯è§æ€§å’ŒåŸå­æ€§ã€‚**ä½†æ˜¯volatileæ›´åŠ è½»é‡çº§ï¼Œèƒ½ç”¨volatileçš„æƒ…å†µä¸‹ï¼Œå°½é‡åˆ«ç”¨synchronizedã€‚","source":"_posts/Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—.md","raw":"---\ntitle: Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—\ndate: 2022-02-04 17:35:40\ntags:\n---\n\nvolatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚volatileå…³é”®å­—æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨ï¼Œä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯**å†…å­˜å¯è§æ€§**å’Œç¦æ­¢é‡æ’åºã€‚\n1ï¼‰ä¿è¯è¢«volatileä¿®é¥°çš„å…±äº«å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹æ€»æ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯**å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªè¢«volatileä¿®é¥°å…±äº«å˜é‡çš„å€¼ï¼Œæ–°å€¼æ€»æ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ç«‹å³å¾—çŸ¥ã€‚**\n2ï¼‰ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚åœ¨æ‰§è¡Œç¨‹åºæ—¶ä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨é€šå¸¸ä¼šé‡æ–°å®‰æ’æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚\n```java\npublic class T {\n\n    /*volatile*/ boolean running=true;\n\n    void m(){\n        System.out.println(\"m start\");\n        while (running){}\n        System.out.println(\"m end\");\n    }\n\n    public static void main(String[] args) {\n        T t=new T();\n\n        new Thread(()->t.m(),\"t1\").start();\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        t.running=false;\n    }\n}\n```\nè¿™æ®µä»£ç ä¸­æ²¡åŠ volatileçš„è¯ï¼Œå¾ªç¯çš„åé¢çš„è¾“å‡ºè¯­å¥\"m end\"ä¸ä¼šè¾“å‡ºï¼Œä½†æ˜¯mainæ–¹æ³•é‡Œé¢ç¡®å®æ˜¯å·²ç»å°†runningçš„å€¼æ”¹æˆäº†falseã€‚è¿™é‡Œæœ‰å…³javaçš„**å†…å­˜æ¨¡å‹**ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ï¼Œrunningçš„å€¼å·²ç»è¢«åŠ è½½åˆ°äº†ç¼“å­˜é‡Œé¢ï¼Œè€Œæ”¹çš„æ˜¯tå¯¹è±¡çš„runningå€¼åœ¨å †å†…å­˜ä¸­ã€‚åŠ äº†volatileå°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ”¹å®Œæ•°å€¼ä¹‹åï¼Œä¼šé€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œè®©å…¶ä»–çº¿ç¨‹é‡æ–°è¯»ä¸€ä¸‹å †å†…å­˜ä¸­çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å†…å­˜å¯è§æ€§ã€‚\n\n```java\npublic class T1 {\n\n    volatile int count=0;\n\n    /*synchronized*/ void m(){\n        for (int i=0;i<10000;i++){\n            count++;\n        }\n    }\n\n    public static void main(String[] args) {\n\n        T1 t=new T1();\n        List<Thread> threads=new ArrayList<Thread>();\n\n        for(int i=0;i<10;i++){\n            threads.add(new Thread(()->t.m(),\"thread-\"+i));\n        }\n        threads.forEach((o)->o.start());\n        threads.forEach((o)->{\n            try {\n                o.join();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        });\n        System.out.println(t.count);\n    }\n}\n```\nè¿™æ®µä»£ç ä¸­ï¼Œåä¸ªçº¿ç¨‹æ‰§è¡Œcount++åŠ åˆ°1wå¾ªç¯ï¼Œç†æƒ³çŠ¶æ€å½“ç„¶æ˜¯åŠ åˆ°10wï¼Œä½†æ˜¯volatileåªèƒ½ä¿æŒçº¿ç¨‹çš„å¯è§æ€§ï¼Œä¸èƒ½ä¿æŒåŸå­æ€§ã€‚ç»™countå˜é‡åŠ ä¸Šäº†volatileï¼Œæœ€åè¾“å‡ºçš„countå€¼ä¹Ÿè¾¾ä¸åˆ°10wã€‚è¿™å°±æ˜¯volatileä¸synchronizedçš„åŒºåˆ«ï¼Œ**volatileåªèƒ½ä¿æŒå¯è§æ€§ï¼Œè€Œsynchronizedå¯ä»¥ä¿æŒå¯è§æ€§å’ŒåŸå­æ€§ã€‚**ä½†æ˜¯volatileæ›´åŠ è½»é‡çº§ï¼Œèƒ½ç”¨volatileçš„æƒ…å†µä¸‹ï¼Œå°½é‡åˆ«ç”¨synchronizedã€‚","slug":"Javaå¹¶å‘ç¼–ç¨‹(äºŒ)ï¼švolatileå…³é”®å­—","published":1,"updated":"2024-02-07T07:27:45.071Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dj000cwen15mph7f6i","content":"<p>volatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚volatileå…³é”®å­—æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨ï¼Œä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯<strong>å†…å­˜å¯è§æ€§</strong>å’Œç¦æ­¢é‡æ’åºã€‚<br>1ï¼‰ä¿è¯è¢«volatileä¿®é¥°çš„å…±äº«å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹æ€»æ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯<strong>å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªè¢«volatileä¿®é¥°å…±äº«å˜é‡çš„å€¼ï¼Œæ–°å€¼æ€»æ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ç«‹å³å¾—çŸ¥ã€‚</strong><br>2ï¼‰ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚åœ¨æ‰§è¡Œç¨‹åºæ—¶ä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨é€šå¸¸ä¼šé‡æ–°å®‰æ’æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*volatile*/</span> <span class=\"type\">boolean</span> running=<span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m start&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (running)&#123;&#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m end&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        T t=<span class=\"keyword\">new</span> <span class=\"title class_\">T</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;t.m(),<span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t.running=<span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç ä¸­æ²¡åŠ volatileçš„è¯ï¼Œå¾ªç¯çš„åé¢çš„è¾“å‡ºè¯­å¥â€m endâ€ä¸ä¼šè¾“å‡ºï¼Œä½†æ˜¯mainæ–¹æ³•é‡Œé¢ç¡®å®æ˜¯å·²ç»å°†runningçš„å€¼æ”¹æˆäº†falseã€‚è¿™é‡Œæœ‰å…³javaçš„<strong>å†…å­˜æ¨¡å‹</strong>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ï¼Œrunningçš„å€¼å·²ç»è¢«åŠ è½½åˆ°äº†ç¼“å­˜é‡Œé¢ï¼Œè€Œæ”¹çš„æ˜¯tå¯¹è±¡çš„runningå€¼åœ¨å †å†…å­˜ä¸­ã€‚åŠ äº†volatileå°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ”¹å®Œæ•°å€¼ä¹‹åï¼Œä¼šé€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œè®©å…¶ä»–çº¿ç¨‹é‡æ–°è¯»ä¸€ä¸‹å †å†…å­˜ä¸­çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å†…å­˜å¯è§æ€§ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"type\">int</span> count=<span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*synchronized*/</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">10000</span>;i++)&#123;</span><br><span class=\"line\">            count++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        T1 t=<span class=\"keyword\">new</span> <span class=\"title class_\">T1</span>();</span><br><span class=\"line\">        List&lt;Thread&gt; threads=<span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;Thread&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">10</span>;i++)&#123;</span><br><span class=\"line\">            threads.add(<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;t.m(),<span class=\"string\">&quot;thread-&quot;</span>+i));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        threads.forEach((o)-&gt;o.start());</span><br><span class=\"line\">        threads.forEach((o)-&gt;&#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                o.join();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        System.out.println(t.count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç ä¸­ï¼Œåä¸ªçº¿ç¨‹æ‰§è¡Œcount++åŠ åˆ°1wå¾ªç¯ï¼Œç†æƒ³çŠ¶æ€å½“ç„¶æ˜¯åŠ åˆ°10wï¼Œä½†æ˜¯volatileåªèƒ½ä¿æŒçº¿ç¨‹çš„å¯è§æ€§ï¼Œä¸èƒ½ä¿æŒåŸå­æ€§ã€‚ç»™countå˜é‡åŠ ä¸Šäº†volatileï¼Œæœ€åè¾“å‡ºçš„countå€¼ä¹Ÿè¾¾ä¸åˆ°10wã€‚è¿™å°±æ˜¯volatileä¸synchronizedçš„åŒºåˆ«ï¼Œ<strong>volatileåªèƒ½ä¿æŒå¯è§æ€§ï¼Œè€Œsynchronizedå¯ä»¥ä¿æŒå¯è§æ€§å’ŒåŸå­æ€§ã€‚</strong>ä½†æ˜¯volatileæ›´åŠ è½»é‡çº§ï¼Œèƒ½ç”¨volatileçš„æƒ…å†µä¸‹ï¼Œå°½é‡åˆ«ç”¨synchronizedã€‚</p>\n","excerpt":"","more":"<p>volatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚volatileå…³é”®å­—æœ‰å¦‚ä¸‹ä¸¤ä¸ªä½œç”¨ï¼Œä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯<strong>å†…å­˜å¯è§æ€§</strong>å’Œç¦æ­¢é‡æ’åºã€‚<br>1ï¼‰ä¿è¯è¢«volatileä¿®é¥°çš„å…±äº«å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹æ€»æ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯<strong>å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªè¢«volatileä¿®é¥°å…±äº«å˜é‡çš„å€¼ï¼Œæ–°å€¼æ€»æ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹ç«‹å³å¾—çŸ¥ã€‚</strong><br>2ï¼‰ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚åœ¨æ‰§è¡Œç¨‹åºæ—¶ä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨é€šå¸¸ä¼šé‡æ–°å®‰æ’æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*volatile*/</span> <span class=\"type\">boolean</span> running=<span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m start&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (running)&#123;&#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;m end&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        T t=<span class=\"keyword\">new</span> <span class=\"title class_\">T</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;t.m(),<span class=\"string\">&quot;t1&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        t.running=<span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç ä¸­æ²¡åŠ volatileçš„è¯ï¼Œå¾ªç¯çš„åé¢çš„è¾“å‡ºè¯­å¥â€m endâ€ä¸ä¼šè¾“å‡ºï¼Œä½†æ˜¯mainæ–¹æ³•é‡Œé¢ç¡®å®æ˜¯å·²ç»å°†runningçš„å€¼æ”¹æˆäº†falseã€‚è¿™é‡Œæœ‰å…³javaçš„<strong>å†…å­˜æ¨¡å‹</strong>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ï¼Œrunningçš„å€¼å·²ç»è¢«åŠ è½½åˆ°äº†ç¼“å­˜é‡Œé¢ï¼Œè€Œæ”¹çš„æ˜¯tå¯¹è±¡çš„runningå€¼åœ¨å †å†…å­˜ä¸­ã€‚åŠ äº†volatileå°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ”¹å®Œæ•°å€¼ä¹‹åï¼Œä¼šé€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œè®©å…¶ä»–çº¿ç¨‹é‡æ–°è¯»ä¸€ä¸‹å †å†…å­˜ä¸­çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å†…å­˜å¯è§æ€§ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">T1</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"type\">int</span> count=<span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/*synchronized*/</span> <span class=\"keyword\">void</span> <span class=\"title function_\">m</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">10000</span>;i++)&#123;</span><br><span class=\"line\">            count++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        T1 t=<span class=\"keyword\">new</span> <span class=\"title class_\">T1</span>();</span><br><span class=\"line\">        List&lt;Thread&gt; threads=<span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;Thread&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">10</span>;i++)&#123;</span><br><span class=\"line\">            threads.add(<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;t.m(),<span class=\"string\">&quot;thread-&quot;</span>+i));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        threads.forEach((o)-&gt;o.start());</span><br><span class=\"line\">        threads.forEach((o)-&gt;&#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                o.join();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        System.out.println(t.count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µä»£ç ä¸­ï¼Œåä¸ªçº¿ç¨‹æ‰§è¡Œcount++åŠ åˆ°1wå¾ªç¯ï¼Œç†æƒ³çŠ¶æ€å½“ç„¶æ˜¯åŠ åˆ°10wï¼Œä½†æ˜¯volatileåªèƒ½ä¿æŒçº¿ç¨‹çš„å¯è§æ€§ï¼Œä¸èƒ½ä¿æŒåŸå­æ€§ã€‚ç»™countå˜é‡åŠ ä¸Šäº†volatileï¼Œæœ€åè¾“å‡ºçš„countå€¼ä¹Ÿè¾¾ä¸åˆ°10wã€‚è¿™å°±æ˜¯volatileä¸synchronizedçš„åŒºåˆ«ï¼Œ<strong>volatileåªèƒ½ä¿æŒå¯è§æ€§ï¼Œè€Œsynchronizedå¯ä»¥ä¿æŒå¯è§æ€§å’ŒåŸå­æ€§ã€‚</strong>ä½†æ˜¯volatileæ›´åŠ è½»é‡çº§ï¼Œèƒ½ç”¨volatileçš„æƒ…å†µä¸‹ï¼Œå°½é‡åˆ«ç”¨synchronizedã€‚</p>\n"},{"title":"Linuxå®‰è£…nginxå’Œé…ç½®https","date":"2024-06-27T13:33:35.000Z","_content":"\n### 1.å®‰è£…nginx\n\nå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…Nginxï¼Œå¯ä»¥ä½¿ç”¨ä½ çš„Linuxå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§å‘è¡Œç‰ˆçš„å®‰è£…å‘½ä»¤ï¼š\n\n- å¯¹äºDebian/Ubuntuç³»ç»Ÿï¼š\n\n```bash\nsudo apt update  \nsudo apt install nginx\n```\n\n- å¯¹äºCentOS/RHELç³»ç»Ÿï¼ˆä½¿ç”¨yumï¼‰ï¼š\n\n```bash\nsudo yum install nginx\n```\n\n### 2.å¯åŠ¨nginx\n\n- å®‰è£…å®Œæˆåï¼Œå¯åŠ¨NginxæœåŠ¡ï¼š\n\n  ```bash\n  sudo systemctl start nginx\n  ```\n\n- å¹¶ä¸”è®¾ç½®å®ƒå¼€æœºè‡ªå¯ï¼š\n\n  ```bash\n  sudo systemctl enable nginx\n  ```\n\n### 3. æ£€æŸ¥NginxçŠ¶æ€\n\nä½ å¯ä»¥æ£€æŸ¥Nginxçš„çŠ¶æ€æ¥ç¡®ä¿å®ƒæ­£åœ¨è¿è¡Œï¼š\n\n```bash\nsudo systemctl status nginx\n```\n\n### 4. é…ç½®Nginx\n\nNginxçš„ä¸»è¦é…ç½®æ–‡ä»¶é€šå¸¸ä½äº`/etc/nginx/`ç›®å½•ä¸‹ï¼Œç‰¹åˆ«æ˜¯`nginx.conf`æ–‡ä»¶ã€‚ä½†å¤§å¤šæ•°é…ç½®æ›´æ”¹é€šå¸¸ä¼šåœ¨`sites-available/`æˆ–`conf.d/`ç›®å½•ä¸­çš„å•ç‹¬æ–‡ä»¶ä¸­è¿›è¡Œï¼Œç„¶åé€šè¿‡åœ¨`nginx.conf`ä¸­åŒ…å«è¿™äº›æ–‡ä»¶æ¥åº”ç”¨ã€‚\n\n- æ‰“å¼€Nginxçš„ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½ éœ€è¦ç›´æ¥ç¼–è¾‘å®ƒï¼‰ï¼š\n\n```bash\nsudo nano /etc/nginx/nginx.conf\n```\n\n- é‡æ–°åŠ è½½Nginxé…ç½®ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š\n\n```bash\nsudo systemctl reload nginx\n```\n\næˆ–è€…ä½ å¯ä»¥å®Œå…¨é‡å¯NginxæœåŠ¡ï¼š\n\n```bash\nsudo systemctl restart nginx\n```\n\n\n\n## äºŒã€Let's Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\n\nLet's Encryptç®€ä»‹Let's Encryptæ˜¯ä¸€ä¸ªç”±Mozillaã€Ciscoã€Akamaiã€IdenTrustå’ŒEFFç­‰ç»„ç»‡å‘èµ·çš„é¡¹ç›®ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨åŒ–æ–¹å¼ä¸ºç½‘ç«™æä¾›å…è´¹çš„SSL/TLSè¯ä¹¦ã€‚å®ƒçš„ç›®æ ‡æ˜¯ä¿ƒè¿›äº’è”ç½‘çš„åŠ å¯†åŒ–ï¼Œä¿éšœç”¨æˆ·çš„åœ¨çº¿å®‰å…¨ã€‚Let's Encryptæä¾›çš„è¯ä¹¦æœ‰æ•ˆæœŸä¸º90å¤©ï¼Œä½†å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–è¿‡ç¨‹å…è´¹ç»­æœŸã€‚\n\n### 1.å®‰è£…Certbot\n\n```bash\nsudo apt-get update\nsudo apt-get install certbot python3-certbot-nginx\n```\n\n### 2.é…ç½®HTTPS\n\n```bash\nsudo certbot --nginx\n```\n\n![image-20240627212626690](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240627212626690.png)\n\nåœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ä½ çš„åŸŸåå¹¶åŠ ä¸Šhttps://å‰ç¼€ï¼ˆä¾‹å¦‚ï¼šhttps://www.example.comï¼‰ï¼Œå¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡ï¼Œå¹¶ä¸”URLåœ°å€ä»¥https://å¼€å¤´ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ çš„ç½‘ç«™å·²ç»æˆåŠŸé…ç½®äº†HTTPSï¼\n\n## ä¸‰ã€é…ç½®nginx.conf\n\n```python\nserver {\n       listen 443 ssl;\n       server_name åŸŸå.com;\n\n       ssl_certificate /etc/letsencrypt/live/åœ°å€/fullchain.pem;\n       ssl_certificate_key /etc/letsencrypt/live/åœ°å€/privkey.pem;\n\n       location / {\n          proxy_pass http://ip:port;\n          proxy_set_header Host $host;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n}\n```\n\n## å››ã€é…ç½®å¤šä¸ªåŸŸå\n\nå¯ä»¥ç°åœ¨nginx.confä¸­é…ç½®åŸŸåï¼Œç„¶ååœ¨è¾“å…¥`sudo certbot --nginx`\n\n![image-20240730185947293](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240730185947293.png)\n\n\nå‚è€ƒæ–‡ç« ï¼š[Let's Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS](https://zhuanlan.zhihu.com/p/696518542)","source":"_posts/Linuxå®‰è£…nginxå’Œé…ç½®https.md","raw":"---\ntitle: Linuxå®‰è£…nginxå’Œé…ç½®https\ndate: 2024-06-27 21:33:35\ntags:\n---\n\n### 1.å®‰è£…nginx\n\nå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…Nginxï¼Œå¯ä»¥ä½¿ç”¨ä½ çš„Linuxå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§å‘è¡Œç‰ˆçš„å®‰è£…å‘½ä»¤ï¼š\n\n- å¯¹äºDebian/Ubuntuç³»ç»Ÿï¼š\n\n```bash\nsudo apt update  \nsudo apt install nginx\n```\n\n- å¯¹äºCentOS/RHELç³»ç»Ÿï¼ˆä½¿ç”¨yumï¼‰ï¼š\n\n```bash\nsudo yum install nginx\n```\n\n### 2.å¯åŠ¨nginx\n\n- å®‰è£…å®Œæˆåï¼Œå¯åŠ¨NginxæœåŠ¡ï¼š\n\n  ```bash\n  sudo systemctl start nginx\n  ```\n\n- å¹¶ä¸”è®¾ç½®å®ƒå¼€æœºè‡ªå¯ï¼š\n\n  ```bash\n  sudo systemctl enable nginx\n  ```\n\n### 3. æ£€æŸ¥NginxçŠ¶æ€\n\nä½ å¯ä»¥æ£€æŸ¥Nginxçš„çŠ¶æ€æ¥ç¡®ä¿å®ƒæ­£åœ¨è¿è¡Œï¼š\n\n```bash\nsudo systemctl status nginx\n```\n\n### 4. é…ç½®Nginx\n\nNginxçš„ä¸»è¦é…ç½®æ–‡ä»¶é€šå¸¸ä½äº`/etc/nginx/`ç›®å½•ä¸‹ï¼Œç‰¹åˆ«æ˜¯`nginx.conf`æ–‡ä»¶ã€‚ä½†å¤§å¤šæ•°é…ç½®æ›´æ”¹é€šå¸¸ä¼šåœ¨`sites-available/`æˆ–`conf.d/`ç›®å½•ä¸­çš„å•ç‹¬æ–‡ä»¶ä¸­è¿›è¡Œï¼Œç„¶åé€šè¿‡åœ¨`nginx.conf`ä¸­åŒ…å«è¿™äº›æ–‡ä»¶æ¥åº”ç”¨ã€‚\n\n- æ‰“å¼€Nginxçš„ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½ éœ€è¦ç›´æ¥ç¼–è¾‘å®ƒï¼‰ï¼š\n\n```bash\nsudo nano /etc/nginx/nginx.conf\n```\n\n- é‡æ–°åŠ è½½Nginxé…ç½®ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š\n\n```bash\nsudo systemctl reload nginx\n```\n\næˆ–è€…ä½ å¯ä»¥å®Œå…¨é‡å¯NginxæœåŠ¡ï¼š\n\n```bash\nsudo systemctl restart nginx\n```\n\n\n\n## äºŒã€Let's Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\n\nLet's Encryptç®€ä»‹Let's Encryptæ˜¯ä¸€ä¸ªç”±Mozillaã€Ciscoã€Akamaiã€IdenTrustå’ŒEFFç­‰ç»„ç»‡å‘èµ·çš„é¡¹ç›®ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨åŒ–æ–¹å¼ä¸ºç½‘ç«™æä¾›å…è´¹çš„SSL/TLSè¯ä¹¦ã€‚å®ƒçš„ç›®æ ‡æ˜¯ä¿ƒè¿›äº’è”ç½‘çš„åŠ å¯†åŒ–ï¼Œä¿éšœç”¨æˆ·çš„åœ¨çº¿å®‰å…¨ã€‚Let's Encryptæä¾›çš„è¯ä¹¦æœ‰æ•ˆæœŸä¸º90å¤©ï¼Œä½†å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–è¿‡ç¨‹å…è´¹ç»­æœŸã€‚\n\n### 1.å®‰è£…Certbot\n\n```bash\nsudo apt-get update\nsudo apt-get install certbot python3-certbot-nginx\n```\n\n### 2.é…ç½®HTTPS\n\n```bash\nsudo certbot --nginx\n```\n\n![image-20240627212626690](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240627212626690.png)\n\nåœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ä½ çš„åŸŸåå¹¶åŠ ä¸Šhttps://å‰ç¼€ï¼ˆä¾‹å¦‚ï¼šhttps://www.example.comï¼‰ï¼Œå¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡ï¼Œå¹¶ä¸”URLåœ°å€ä»¥https://å¼€å¤´ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ çš„ç½‘ç«™å·²ç»æˆåŠŸé…ç½®äº†HTTPSï¼\n\n## ä¸‰ã€é…ç½®nginx.conf\n\n```python\nserver {\n       listen 443 ssl;\n       server_name åŸŸå.com;\n\n       ssl_certificate /etc/letsencrypt/live/åœ°å€/fullchain.pem;\n       ssl_certificate_key /etc/letsencrypt/live/åœ°å€/privkey.pem;\n\n       location / {\n          proxy_pass http://ip:port;\n          proxy_set_header Host $host;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n}\n```\n\n## å››ã€é…ç½®å¤šä¸ªåŸŸå\n\nå¯ä»¥ç°åœ¨nginx.confä¸­é…ç½®åŸŸåï¼Œç„¶ååœ¨è¾“å…¥`sudo certbot --nginx`\n\n![image-20240730185947293](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240730185947293.png)\n\n\nå‚è€ƒæ–‡ç« ï¼š[Let's Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS](https://zhuanlan.zhihu.com/p/696518542)","slug":"Linuxå®‰è£…nginxå’Œé…ç½®https","published":1,"updated":"2024-07-30T11:01:37.409Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dk000dwen11n6bd4y2","content":"<h3 id=\"1-å®‰è£…nginx\"><a href=\"#1-å®‰è£…nginx\" class=\"headerlink\" title=\"1.å®‰è£…nginx\"></a>1.å®‰è£…nginx</h3><p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…Nginxï¼Œå¯ä»¥ä½¿ç”¨ä½ çš„Linuxå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§å‘è¡Œç‰ˆçš„å®‰è£…å‘½ä»¤ï¼š</p>\n<ul>\n<li>å¯¹äºDebian&#x2F;Ubuntuç³»ç»Ÿï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update  </span><br><span class=\"line\">sudo apt install nginx</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å¯¹äºCentOS&#x2F;RHELç³»ç»Ÿï¼ˆä½¿ç”¨yumï¼‰ï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-å¯åŠ¨nginx\"><a href=\"#2-å¯åŠ¨nginx\" class=\"headerlink\" title=\"2.å¯åŠ¨nginx\"></a>2.å¯åŠ¨nginx</h3><ul>\n<li><p>å®‰è£…å®Œæˆåï¼Œå¯åŠ¨NginxæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¹¶ä¸”è®¾ç½®å®ƒå¼€æœºè‡ªå¯ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"3-æ£€æŸ¥NginxçŠ¶æ€\"><a href=\"#3-æ£€æŸ¥NginxçŠ¶æ€\" class=\"headerlink\" title=\"3. æ£€æŸ¥NginxçŠ¶æ€\"></a>3. æ£€æŸ¥NginxçŠ¶æ€</h3><p>ä½ å¯ä»¥æ£€æŸ¥Nginxçš„çŠ¶æ€æ¥ç¡®ä¿å®ƒæ­£åœ¨è¿è¡Œï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl status nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-é…ç½®Nginx\"><a href=\"#4-é…ç½®Nginx\" class=\"headerlink\" title=\"4. é…ç½®Nginx\"></a>4. é…ç½®Nginx</h3><p>Nginxçš„ä¸»è¦é…ç½®æ–‡ä»¶é€šå¸¸ä½äº<code>/etc/nginx/</code>ç›®å½•ä¸‹ï¼Œç‰¹åˆ«æ˜¯<code>nginx.conf</code>æ–‡ä»¶ã€‚ä½†å¤§å¤šæ•°é…ç½®æ›´æ”¹é€šå¸¸ä¼šåœ¨<code>sites-available/</code>æˆ–<code>conf.d/</code>ç›®å½•ä¸­çš„å•ç‹¬æ–‡ä»¶ä¸­è¿›è¡Œï¼Œç„¶åé€šè¿‡åœ¨<code>nginx.conf</code>ä¸­åŒ…å«è¿™äº›æ–‡ä»¶æ¥åº”ç”¨ã€‚</p>\n<ul>\n<li>æ‰“å¼€Nginxçš„ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½ éœ€è¦ç›´æ¥ç¼–è¾‘å®ƒï¼‰ï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nano /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>é‡æ–°åŠ è½½Nginxé…ç½®ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure>\n\n<p>æˆ–è€…ä½ å¯ä»¥å®Œå…¨é‡å¯NginxæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"äºŒã€Letâ€™s-Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\"><a href=\"#äºŒã€Letâ€™s-Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\" class=\"headerlink\" title=\"äºŒã€Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\"></a>äºŒã€Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS</h2><p>Letâ€™s Encryptç®€ä»‹Letâ€™s Encryptæ˜¯ä¸€ä¸ªç”±Mozillaã€Ciscoã€Akamaiã€IdenTrustå’ŒEFFç­‰ç»„ç»‡å‘èµ·çš„é¡¹ç›®ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨åŒ–æ–¹å¼ä¸ºç½‘ç«™æä¾›å…è´¹çš„SSL&#x2F;TLSè¯ä¹¦ã€‚å®ƒçš„ç›®æ ‡æ˜¯ä¿ƒè¿›äº’è”ç½‘çš„åŠ å¯†åŒ–ï¼Œä¿éšœç”¨æˆ·çš„åœ¨çº¿å®‰å…¨ã€‚Letâ€™s Encryptæä¾›çš„è¯ä¹¦æœ‰æ•ˆæœŸä¸º90å¤©ï¼Œä½†å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–è¿‡ç¨‹å…è´¹ç»­æœŸã€‚</p>\n<h3 id=\"1-å®‰è£…Certbot\"><a href=\"#1-å®‰è£…Certbot\" class=\"headerlink\" title=\"1.å®‰è£…Certbot\"></a>1.å®‰è£…Certbot</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install certbot python3-certbot-nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-é…ç½®HTTPS\"><a href=\"#2-é…ç½®HTTPS\" class=\"headerlink\" title=\"2.é…ç½®HTTPS\"></a>2.é…ç½®HTTPS</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo certbot --nginx</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240627212626690.png\" alt=\"image-20240627212626690\"></p>\n<p>åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ä½ çš„åŸŸåå¹¶åŠ ä¸Šhttps:&#x2F;&#x2F;å‰ç¼€ï¼ˆä¾‹å¦‚ï¼š<a href=\"https://www.example.com),å¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡,å¹¶ä¸”urlåœ°å€ä»¥https//%E5%BC%80%E5%A4%B4%EF%BC%8C%E9%82%A3%E4%B9%88%E6%81%AD%E5%96%9C%E4%BD%A0%EF%BC%8C%E4%BD%A0%E7%9A%84%E7%BD%91%E7%AB%99%E5%B7%B2%E7%BB%8F%E6%88%90%E5%8A%9F%E9%85%8D%E7%BD%AE%E4%BA%86HTTPS%EF%BC%81\">https://www.example.comï¼‰ï¼Œå¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡ï¼Œå¹¶ä¸”URLåœ°å€ä»¥https://å¼€å¤´ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ çš„ç½‘ç«™å·²ç»æˆåŠŸé…ç½®äº†HTTPSï¼</a></p>\n<h2 id=\"ä¸‰ã€é…ç½®nginx-conf\"><a href=\"#ä¸‰ã€é…ç½®nginx-conf\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®nginx.conf\"></a>ä¸‰ã€é…ç½®nginx.conf</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">       listen <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">       server_name åŸŸå.com;</span><br><span class=\"line\"></span><br><span class=\"line\">       ssl_certificate /etc/letsencrypt/live/åœ°å€/fullchain.pem;</span><br><span class=\"line\">       ssl_certificate_key /etc/letsencrypt/live/åœ°å€/privkey.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">       location / &#123;</span><br><span class=\"line\">          proxy_pass http://ip:port;</span><br><span class=\"line\">          proxy_set_header Host $host;</span><br><span class=\"line\">          proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å››ã€é…ç½®å¤šä¸ªåŸŸå\"><a href=\"#å››ã€é…ç½®å¤šä¸ªåŸŸå\" class=\"headerlink\" title=\"å››ã€é…ç½®å¤šä¸ªåŸŸå\"></a>å››ã€é…ç½®å¤šä¸ªåŸŸå</h2><p>å¯ä»¥ç°åœ¨nginx.confä¸­é…ç½®åŸŸåï¼Œç„¶ååœ¨è¾“å…¥<code>sudo certbot --nginx</code></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240730185947293.png\" alt=\"image-20240730185947293\"></p>\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://zhuanlan.zhihu.com/p/696518542\">Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS</a></p>\n","excerpt":"","more":"<h3 id=\"1-å®‰è£…nginx\"><a href=\"#1-å®‰è£…nginx\" class=\"headerlink\" title=\"1.å®‰è£…nginx\"></a>1.å®‰è£…nginx</h3><p>å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…Nginxï¼Œå¯ä»¥ä½¿ç”¨ä½ çš„Linuxå‘è¡Œç‰ˆçš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§å‘è¡Œç‰ˆçš„å®‰è£…å‘½ä»¤ï¼š</p>\n<ul>\n<li>å¯¹äºDebian&#x2F;Ubuntuç³»ç»Ÿï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update  </span><br><span class=\"line\">sudo apt install nginx</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>å¯¹äºCentOS&#x2F;RHELç³»ç»Ÿï¼ˆä½¿ç”¨yumï¼‰ï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-å¯åŠ¨nginx\"><a href=\"#2-å¯åŠ¨nginx\" class=\"headerlink\" title=\"2.å¯åŠ¨nginx\"></a>2.å¯åŠ¨nginx</h3><ul>\n<li><p>å®‰è£…å®Œæˆåï¼Œå¯åŠ¨NginxæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl start nginx</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>å¹¶ä¸”è®¾ç½®å®ƒå¼€æœºè‡ªå¯ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"3-æ£€æŸ¥NginxçŠ¶æ€\"><a href=\"#3-æ£€æŸ¥NginxçŠ¶æ€\" class=\"headerlink\" title=\"3. æ£€æŸ¥NginxçŠ¶æ€\"></a>3. æ£€æŸ¥NginxçŠ¶æ€</h3><p>ä½ å¯ä»¥æ£€æŸ¥Nginxçš„çŠ¶æ€æ¥ç¡®ä¿å®ƒæ­£åœ¨è¿è¡Œï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl status nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-é…ç½®Nginx\"><a href=\"#4-é…ç½®Nginx\" class=\"headerlink\" title=\"4. é…ç½®Nginx\"></a>4. é…ç½®Nginx</h3><p>Nginxçš„ä¸»è¦é…ç½®æ–‡ä»¶é€šå¸¸ä½äº<code>/etc/nginx/</code>ç›®å½•ä¸‹ï¼Œç‰¹åˆ«æ˜¯<code>nginx.conf</code>æ–‡ä»¶ã€‚ä½†å¤§å¤šæ•°é…ç½®æ›´æ”¹é€šå¸¸ä¼šåœ¨<code>sites-available/</code>æˆ–<code>conf.d/</code>ç›®å½•ä¸­çš„å•ç‹¬æ–‡ä»¶ä¸­è¿›è¡Œï¼Œç„¶åé€šè¿‡åœ¨<code>nginx.conf</code>ä¸­åŒ…å«è¿™äº›æ–‡ä»¶æ¥åº”ç”¨ã€‚</p>\n<ul>\n<li>æ‰“å¼€Nginxçš„ä¸»é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœä½ éœ€è¦ç›´æ¥ç¼–è¾‘å®ƒï¼‰ï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nano /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>é‡æ–°åŠ è½½Nginxé…ç½®ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl reload nginx</span><br></pre></td></tr></table></figure>\n\n<p>æˆ–è€…ä½ å¯ä»¥å®Œå…¨é‡å¯NginxæœåŠ¡ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl restart nginx</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"äºŒã€Letâ€™s-Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\"><a href=\"#äºŒã€Letâ€™s-Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\" class=\"headerlink\" title=\"äºŒã€Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS\"></a>äºŒã€Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS</h2><p>Letâ€™s Encryptç®€ä»‹Letâ€™s Encryptæ˜¯ä¸€ä¸ªç”±Mozillaã€Ciscoã€Akamaiã€IdenTrustå’ŒEFFç­‰ç»„ç»‡å‘èµ·çš„é¡¹ç›®ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨åŒ–æ–¹å¼ä¸ºç½‘ç«™æä¾›å…è´¹çš„SSL&#x2F;TLSè¯ä¹¦ã€‚å®ƒçš„ç›®æ ‡æ˜¯ä¿ƒè¿›äº’è”ç½‘çš„åŠ å¯†åŒ–ï¼Œä¿éšœç”¨æˆ·çš„åœ¨çº¿å®‰å…¨ã€‚Letâ€™s Encryptæä¾›çš„è¯ä¹¦æœ‰æ•ˆæœŸä¸º90å¤©ï¼Œä½†å¯ä»¥é€šè¿‡è‡ªåŠ¨åŒ–è¿‡ç¨‹å…è´¹ç»­æœŸã€‚</p>\n<h3 id=\"1-å®‰è£…Certbot\"><a href=\"#1-å®‰è£…Certbot\" class=\"headerlink\" title=\"1.å®‰è£…Certbot\"></a>1.å®‰è£…Certbot</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install certbot python3-certbot-nginx</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-é…ç½®HTTPS\"><a href=\"#2-é…ç½®HTTPS\" class=\"headerlink\" title=\"2.é…ç½®HTTPS\"></a>2.é…ç½®HTTPS</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo certbot --nginx</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240627212626690.png\" alt=\"image-20240627212626690\"></p>\n<p>åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ä½ çš„åŸŸåå¹¶åŠ ä¸Šhttps:&#x2F;&#x2F;å‰ç¼€ï¼ˆä¾‹å¦‚ï¼š<a href=\"https://www.example.com),å¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡,å¹¶ä¸”urlåœ°å€ä»¥https//%E5%BC%80%E5%A4%B4%EF%BC%8C%E9%82%A3%E4%B9%88%E6%81%AD%E5%96%9C%E4%BD%A0%EF%BC%8C%E4%BD%A0%E7%9A%84%E7%BD%91%E7%AB%99%E5%B7%B2%E7%BB%8F%E6%88%90%E5%8A%9F%E9%85%8D%E7%BD%AE%E4%BA%86HTTPS%EF%BC%81\">https://www.example.comï¼‰ï¼Œå¦‚æœæµè§ˆå™¨æ˜¾ç¤ºäº†ä¸€ä¸ªç»¿è‰²çš„é”å½¢å›¾æ ‡ï¼Œå¹¶ä¸”URLåœ°å€ä»¥https://å¼€å¤´ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ çš„ç½‘ç«™å·²ç»æˆåŠŸé…ç½®äº†HTTPSï¼</a></p>\n<h2 id=\"ä¸‰ã€é…ç½®nginx-conf\"><a href=\"#ä¸‰ã€é…ç½®nginx-conf\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®nginx.conf\"></a>ä¸‰ã€é…ç½®nginx.conf</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">       listen <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">       server_name åŸŸå.com;</span><br><span class=\"line\"></span><br><span class=\"line\">       ssl_certificate /etc/letsencrypt/live/åœ°å€/fullchain.pem;</span><br><span class=\"line\">       ssl_certificate_key /etc/letsencrypt/live/åœ°å€/privkey.pem;</span><br><span class=\"line\"></span><br><span class=\"line\">       location / &#123;</span><br><span class=\"line\">          proxy_pass http://ip:port;</span><br><span class=\"line\">          proxy_set_header Host $host;</span><br><span class=\"line\">          proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å››ã€é…ç½®å¤šä¸ªåŸŸå\"><a href=\"#å››ã€é…ç½®å¤šä¸ªåŸŸå\" class=\"headerlink\" title=\"å››ã€é…ç½®å¤šä¸ªåŸŸå\"></a>å››ã€é…ç½®å¤šä¸ªåŸŸå</h2><p>å¯ä»¥ç°åœ¨nginx.confä¸­é…ç½®åŸŸåï¼Œç„¶ååœ¨è¾“å…¥<code>sudo certbot --nginx</code></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240730185947293.png\" alt=\"image-20240730185947293\"></p>\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://zhuanlan.zhihu.com/p/696518542\">Letâ€™s Encryptåœ¨Linuxä¸Šå…è´¹é…ç½®HTTPS</a></p>\n"},{"title":"Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬","date":"2024-01-10T06:32:41.000Z","_content":"\n> ç³»ç»Ÿç”¨çš„æ˜¯Centosï¼Œè‡ªå¸¦äº†pythonç¯å¢ƒï¼Œè€ƒè™‘åˆ°åæœŸç»´æŠ¤ä½¿ç”¨virtualenvè™šæ‹Ÿç¯å¢ƒæ¥ä¸ºåº”ç”¨åˆ›å»º\"éš”ç¦»\"çš„pythonè¿è¡Œç¯å¢ƒã€‚\n>\n> virtualenvè™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç»çš„Pythonç¯å¢ƒçš„å·¥å…·ã€‚\n\n![image-20240110124003769](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110124003769.png)\n\n- **éš”ç¦»æ€§**ï¼švirtualenvå¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¸å…¶ä»–Pythonç¯å¢ƒï¼ˆå¦‚ç³»ç»Ÿç¯å¢ƒæˆ–å…¨å±€ç¯å¢ƒï¼‰å®Œå…¨éš”ç¦»ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æœ‰åŠ©äºè§£å†³ä¸åŒé¡¹ç›®ä¹‹é—´çš„ä¾èµ–å†²çªé—®é¢˜ã€‚\n- **æ˜“äºç®¡ç†**ï¼šæ¯ä¸ªè™šæ‹Ÿç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„`pip`ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºæ¯ä¸ªé¡¹ç›®å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„`pip`ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨ï¼Œè¿™ä½¿å¾—ç‰ˆæœ¬æ§åˆ¶å˜å¾—ç®€å•ã€‚\n- **å®‰å…¨æ€§**ï¼šç”±äºæ¯ä¸ªç¯å¢ƒéƒ½æ˜¯éš”ç¦»çš„ï¼Œå› æ­¤åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„æ¶æ„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚\n- **çµæ´»æ€§**ï¼šä½ å¯ä»¥ä¸ºä¸åŒçš„é¡¹ç›®åˆ›å»ºä¸åŒçš„è™šæ‹Ÿç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨å’Œpipç‰ˆæœ¬ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€æ±‚æ¥é…ç½®ç¯å¢ƒã€‚\n- **æ˜“äºä½¿ç”¨**ï¼švirtualenvæ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚ä½ åªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸€äº›å‘½ä»¤å°±å¯ä»¥åˆ›å»ºæ–°çš„ç¯å¢ƒï¼Œå®‰è£…åŒ…ç­‰ã€‚è¿™å¯¹äºåˆå­¦è€…æ¥è¯´éå¸¸å‹å¥½ã€‚\n\n\n\n### ä¸€ã€éƒ¨ç½²é¡¹ç›®\n\n\n1.å¯¼å‡ºé¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–åŒ…\n\n```xml\npip freeze > requements.txt\n```\n\n2.åˆ›å»ºpythonè™šæ‹Ÿç¯å¢ƒï¼ˆenv_nameå½“å‰ç¯å¢ƒçš„åç§°ï¼‰\n\n```xml\npython -m venv env_name\n```\n\nåˆ›å»ºåä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«äº†é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒ\n\n![image-20240110125725202](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110125725202.png)\n\n3.å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ\n\n```xml\nsource env_name/bin/activate\n```\n\n3.å¯åŠ¨pythonè„šæœ¬\n\n```xml\npip install -r requements.txt # å…ˆå¯¼å…¥ä¾èµ–åŒ…\npython xx.py # è¿è¡Œç¨‹åºæ–‡ä»¶\n```\n\n4.å…³é—­è™šæ‹Ÿç¯å¢ƒå‘½ä»¤\n\n```xml\ndeactivate\n```\n\n\n\n## äºŒã€åå°è¿è¡Œpythonè„šæœ¬\n\n1.nohupå‘½ä»¤å¯ä»¥ä½¿ä½ åœ¨æ³¨é”€è´¦æˆ·æˆ–å…³é—­ç»ˆç«¯æ—¶ï¼Œç¨‹åºä»ç„¶ä¿æŒè¿è¡Œã€‚è¯¥å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š\n\n```xml\nnohup python your_program.py &\næˆ–è€…ï¼šnohup python your_program.py >app.log 2>&1 &\n```\n\n&1æ˜¯ä¸€ä¸ªæŒ‡å‘æ ‡å‡†è¾“å‡ºçš„æŒ‡é’ˆï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥å‘½ä»¤ä¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯å†™å…¥åˆ°app.log\n\n2.å…¶ä¸­ï¼Œ`your_program.py`ä¸ºéœ€è¦åå°è¿è¡Œçš„Pythonç¨‹åºæ–‡ä»¶åï¼Œ`&`ç¬¦å·è¡¨ç¤ºåœ¨åå°è¿è¡Œç¨‹åºã€‚è¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š\n\n```xml\nnohup: ignoring input and appending output to 'nohup.out'\n```\n\n3.è¿™æ„å‘³ç€ä½ çš„Pythonç¨‹åºå·²ç»åœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¾“å‡ºä¿¡æ¯ä¿å­˜åœ¨nohup.outæ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨`tail`å‘½ä»¤è·Ÿè¸ªè¯¥æ–‡ä»¶ä»¥æŸ¥çœ‹ç¨‹åºè¾“å‡ºä¿¡æ¯ã€‚å¦‚æœä½ æƒ³åœæ­¢ç¨‹åºçš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨`kill`å‘½ä»¤ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n\n```xml\ntail -f nohup.out\nkill PID\n```\n\n4.å…¶ä¸­ï¼Œ`PID`ä¸ºä½ ç¨‹åºçš„è¿›ç¨‹IDï¼Œåœ¨è¿è¡Œ`nohup`å‘½ä»¤åä½ å¯ä»¥ä½¿ç”¨ï¼š\n\n```xml\nps -ef | grep python # å‘½ä»¤æŸ¥æ‰¾è¿›ç¨‹IDã€‚\n```\n\n\n## ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\n\n1.[å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…]([www.python.org/downloads/](https://link.juejin.cn/?target=https%3A%2F%2Fwww.python.org%2Fdownloads%2F))\n\n2.è§£å‹ï¼š`tar  -xf   Python-3.10.4.tgz`\n\n3.è¿›å…¥è§£å‹åçš„ç›®å½•ï¼š`./configure && make && make install `\n\n4.å…ˆæ‰¾åˆ°pythonæ–‡ä»¶ï¼Œå‡†å¤‡åˆ›å»ºè½¯é“¾æ¥\n\n![image-20240119145905288](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240119145905288.png)\n\n5.åˆ›å»ºè½¯è¿æ¥ï¼ˆ/usr/local/bin/python3.10æ˜¯å­˜æ”¾pythonæ–‡ä»¶ç›®å½•ï¼‰\n\n```xml\nln -sf /usr/local/bin/python3.10 /usr/bin/python\nln -sf /usr/local/bin/python3.10-config /usr/bin/python-config\n```\n\n\n## å››ã€è¸©å‘è®°å½•\n\n1.ä½¿ç”¨nohupå‘½ä»¤åï¼Œæ—¥å¿—æ–‡ä»¶å†…æ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯å­˜åœ¨è¾“å‡ºç¼“å­˜ï¼Œé€šè¿‡ä¿®æ”¹å¯åŠ¨å‘½ä»¤è§£å†³ï¼š\n\n```xml\nnohup python -u your_program.py >app.log 2>&1 &\n```\n\nå‚è€ƒæ–‡ç« ï¼š[Python nohup å¯åŠ¨pythonè„šæœ¬ï¼Œåå°æ²¡æœ‰æ—¥å¿—](https://blog.csdn.net/xunfengdumo/article/details/132448270)","source":"_posts/Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬.md","raw":"---\ntitle: Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬\ndate: 2024-01-10 14:32:41\ntags:\n---\n\n> ç³»ç»Ÿç”¨çš„æ˜¯Centosï¼Œè‡ªå¸¦äº†pythonç¯å¢ƒï¼Œè€ƒè™‘åˆ°åæœŸç»´æŠ¤ä½¿ç”¨virtualenvè™šæ‹Ÿç¯å¢ƒæ¥ä¸ºåº”ç”¨åˆ›å»º\"éš”ç¦»\"çš„pythonè¿è¡Œç¯å¢ƒã€‚\n>\n> virtualenvè™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç»çš„Pythonç¯å¢ƒçš„å·¥å…·ã€‚\n\n![image-20240110124003769](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110124003769.png)\n\n- **éš”ç¦»æ€§**ï¼švirtualenvå¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¸å…¶ä»–Pythonç¯å¢ƒï¼ˆå¦‚ç³»ç»Ÿç¯å¢ƒæˆ–å…¨å±€ç¯å¢ƒï¼‰å®Œå…¨éš”ç¦»ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æœ‰åŠ©äºè§£å†³ä¸åŒé¡¹ç›®ä¹‹é—´çš„ä¾èµ–å†²çªé—®é¢˜ã€‚\n- **æ˜“äºç®¡ç†**ï¼šæ¯ä¸ªè™šæ‹Ÿç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„`pip`ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºæ¯ä¸ªé¡¹ç›®å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„`pip`ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨ï¼Œè¿™ä½¿å¾—ç‰ˆæœ¬æ§åˆ¶å˜å¾—ç®€å•ã€‚\n- **å®‰å…¨æ€§**ï¼šç”±äºæ¯ä¸ªç¯å¢ƒéƒ½æ˜¯éš”ç¦»çš„ï¼Œå› æ­¤åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„æ¶æ„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚\n- **çµæ´»æ€§**ï¼šä½ å¯ä»¥ä¸ºä¸åŒçš„é¡¹ç›®åˆ›å»ºä¸åŒçš„è™šæ‹Ÿç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨å’Œpipç‰ˆæœ¬ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€æ±‚æ¥é…ç½®ç¯å¢ƒã€‚\n- **æ˜“äºä½¿ç”¨**ï¼švirtualenvæ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚ä½ åªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸€äº›å‘½ä»¤å°±å¯ä»¥åˆ›å»ºæ–°çš„ç¯å¢ƒï¼Œå®‰è£…åŒ…ç­‰ã€‚è¿™å¯¹äºåˆå­¦è€…æ¥è¯´éå¸¸å‹å¥½ã€‚\n\n\n\n### ä¸€ã€éƒ¨ç½²é¡¹ç›®\n\n\n1.å¯¼å‡ºé¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–åŒ…\n\n```xml\npip freeze > requements.txt\n```\n\n2.åˆ›å»ºpythonè™šæ‹Ÿç¯å¢ƒï¼ˆenv_nameå½“å‰ç¯å¢ƒçš„åç§°ï¼‰\n\n```xml\npython -m venv env_name\n```\n\nåˆ›å»ºåä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«äº†é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒ\n\n![image-20240110125725202](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110125725202.png)\n\n3.å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ\n\n```xml\nsource env_name/bin/activate\n```\n\n3.å¯åŠ¨pythonè„šæœ¬\n\n```xml\npip install -r requements.txt # å…ˆå¯¼å…¥ä¾èµ–åŒ…\npython xx.py # è¿è¡Œç¨‹åºæ–‡ä»¶\n```\n\n4.å…³é—­è™šæ‹Ÿç¯å¢ƒå‘½ä»¤\n\n```xml\ndeactivate\n```\n\n\n\n## äºŒã€åå°è¿è¡Œpythonè„šæœ¬\n\n1.nohupå‘½ä»¤å¯ä»¥ä½¿ä½ åœ¨æ³¨é”€è´¦æˆ·æˆ–å…³é—­ç»ˆç«¯æ—¶ï¼Œç¨‹åºä»ç„¶ä¿æŒè¿è¡Œã€‚è¯¥å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š\n\n```xml\nnohup python your_program.py &\næˆ–è€…ï¼šnohup python your_program.py >app.log 2>&1 &\n```\n\n&1æ˜¯ä¸€ä¸ªæŒ‡å‘æ ‡å‡†è¾“å‡ºçš„æŒ‡é’ˆï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥å‘½ä»¤ä¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯å†™å…¥åˆ°app.log\n\n2.å…¶ä¸­ï¼Œ`your_program.py`ä¸ºéœ€è¦åå°è¿è¡Œçš„Pythonç¨‹åºæ–‡ä»¶åï¼Œ`&`ç¬¦å·è¡¨ç¤ºåœ¨åå°è¿è¡Œç¨‹åºã€‚è¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š\n\n```xml\nnohup: ignoring input and appending output to 'nohup.out'\n```\n\n3.è¿™æ„å‘³ç€ä½ çš„Pythonç¨‹åºå·²ç»åœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¾“å‡ºä¿¡æ¯ä¿å­˜åœ¨nohup.outæ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨`tail`å‘½ä»¤è·Ÿè¸ªè¯¥æ–‡ä»¶ä»¥æŸ¥çœ‹ç¨‹åºè¾“å‡ºä¿¡æ¯ã€‚å¦‚æœä½ æƒ³åœæ­¢ç¨‹åºçš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨`kill`å‘½ä»¤ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n\n```xml\ntail -f nohup.out\nkill PID\n```\n\n4.å…¶ä¸­ï¼Œ`PID`ä¸ºä½ ç¨‹åºçš„è¿›ç¨‹IDï¼Œåœ¨è¿è¡Œ`nohup`å‘½ä»¤åä½ å¯ä»¥ä½¿ç”¨ï¼š\n\n```xml\nps -ef | grep python # å‘½ä»¤æŸ¥æ‰¾è¿›ç¨‹IDã€‚\n```\n\n\n## ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\n\n1.[å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…]([www.python.org/downloads/](https://link.juejin.cn/?target=https%3A%2F%2Fwww.python.org%2Fdownloads%2F))\n\n2.è§£å‹ï¼š`tar  -xf   Python-3.10.4.tgz`\n\n3.è¿›å…¥è§£å‹åçš„ç›®å½•ï¼š`./configure && make && make install `\n\n4.å…ˆæ‰¾åˆ°pythonæ–‡ä»¶ï¼Œå‡†å¤‡åˆ›å»ºè½¯é“¾æ¥\n\n![image-20240119145905288](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240119145905288.png)\n\n5.åˆ›å»ºè½¯è¿æ¥ï¼ˆ/usr/local/bin/python3.10æ˜¯å­˜æ”¾pythonæ–‡ä»¶ç›®å½•ï¼‰\n\n```xml\nln -sf /usr/local/bin/python3.10 /usr/bin/python\nln -sf /usr/local/bin/python3.10-config /usr/bin/python-config\n```\n\n\n## å››ã€è¸©å‘è®°å½•\n\n1.ä½¿ç”¨nohupå‘½ä»¤åï¼Œæ—¥å¿—æ–‡ä»¶å†…æ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯å­˜åœ¨è¾“å‡ºç¼“å­˜ï¼Œé€šè¿‡ä¿®æ”¹å¯åŠ¨å‘½ä»¤è§£å†³ï¼š\n\n```xml\nnohup python -u your_program.py >app.log 2>&1 &\n```\n\nå‚è€ƒæ–‡ç« ï¼š[Python nohup å¯åŠ¨pythonè„šæœ¬ï¼Œåå°æ²¡æœ‰æ—¥å¿—](https://blog.csdn.net/xunfengdumo/article/details/132448270)","slug":"Linuxç¯å¢ƒä¸‹éƒ¨ç½²Pythonè„šæœ¬","published":1,"updated":"2024-02-07T07:27:45.071Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dk000ewen1eeushh23","content":"<blockquote>\n<p>ç³»ç»Ÿç”¨çš„æ˜¯Centosï¼Œè‡ªå¸¦äº†pythonç¯å¢ƒï¼Œè€ƒè™‘åˆ°åæœŸç»´æŠ¤ä½¿ç”¨virtualenvè™šæ‹Ÿç¯å¢ƒæ¥ä¸ºåº”ç”¨åˆ›å»ºâ€éš”ç¦»â€çš„pythonè¿è¡Œç¯å¢ƒã€‚</p>\n<p>virtualenvè™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç»çš„Pythonç¯å¢ƒçš„å·¥å…·ã€‚</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110124003769.png\" alt=\"image-20240110124003769\"></p>\n<ul>\n<li><strong>éš”ç¦»æ€§</strong>ï¼švirtualenvå¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¸å…¶ä»–Pythonç¯å¢ƒï¼ˆå¦‚ç³»ç»Ÿç¯å¢ƒæˆ–å…¨å±€ç¯å¢ƒï¼‰å®Œå…¨éš”ç¦»ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æœ‰åŠ©äºè§£å†³ä¸åŒé¡¹ç›®ä¹‹é—´çš„ä¾èµ–å†²çªé—®é¢˜ã€‚</li>\n<li><strong>æ˜“äºç®¡ç†</strong>ï¼šæ¯ä¸ªè™šæ‹Ÿç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„<code>pip</code>ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºæ¯ä¸ªé¡¹ç›®å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„<code>pip</code>ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨ï¼Œè¿™ä½¿å¾—ç‰ˆæœ¬æ§åˆ¶å˜å¾—ç®€å•ã€‚</li>\n<li><strong>å®‰å…¨æ€§</strong>ï¼šç”±äºæ¯ä¸ªç¯å¢ƒéƒ½æ˜¯éš”ç¦»çš„ï¼Œå› æ­¤åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„æ¶æ„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚</li>\n<li><strong>çµæ´»æ€§</strong>ï¼šä½ å¯ä»¥ä¸ºä¸åŒçš„é¡¹ç›®åˆ›å»ºä¸åŒçš„è™šæ‹Ÿç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨å’Œpipç‰ˆæœ¬ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€æ±‚æ¥é…ç½®ç¯å¢ƒã€‚</li>\n<li><strong>æ˜“äºä½¿ç”¨</strong>ï¼švirtualenvæ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚ä½ åªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸€äº›å‘½ä»¤å°±å¯ä»¥åˆ›å»ºæ–°çš„ç¯å¢ƒï¼Œå®‰è£…åŒ…ç­‰ã€‚è¿™å¯¹äºåˆå­¦è€…æ¥è¯´éå¸¸å‹å¥½ã€‚</li>\n</ul>\n<h3 id=\"ä¸€ã€éƒ¨ç½²é¡¹ç›®\"><a href=\"#ä¸€ã€éƒ¨ç½²é¡¹ç›®\" class=\"headerlink\" title=\"ä¸€ã€éƒ¨ç½²é¡¹ç›®\"></a>ä¸€ã€éƒ¨ç½²é¡¹ç›®</h3><p>1.å¯¼å‡ºé¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–åŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip freeze &gt; requements.txt</span><br></pre></td></tr></table></figure>\n\n<p>2.åˆ›å»ºpythonè™šæ‹Ÿç¯å¢ƒï¼ˆenv_nameå½“å‰ç¯å¢ƒçš„åç§°ï¼‰</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m venv env_name</span><br></pre></td></tr></table></figure>\n\n<p>åˆ›å»ºåä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«äº†é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110125725202.png\" alt=\"image-20240110125725202\"></p>\n<p>3.å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source env_name/bin/activate</span><br></pre></td></tr></table></figure>\n\n<p>3.å¯åŠ¨pythonè„šæœ¬</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requements.txt # å…ˆå¯¼å…¥ä¾èµ–åŒ…</span><br><span class=\"line\">python xx.py # è¿è¡Œç¨‹åºæ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>4.å…³é—­è™šæ‹Ÿç¯å¢ƒå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deactivate</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"äºŒã€åå°è¿è¡Œpythonè„šæœ¬\"><a href=\"#äºŒã€åå°è¿è¡Œpythonè„šæœ¬\" class=\"headerlink\" title=\"äºŒã€åå°è¿è¡Œpythonè„šæœ¬\"></a>äºŒã€åå°è¿è¡Œpythonè„šæœ¬</h2><p>1.nohupå‘½ä»¤å¯ä»¥ä½¿ä½ åœ¨æ³¨é”€è´¦æˆ·æˆ–å…³é—­ç»ˆç«¯æ—¶ï¼Œç¨‹åºä»ç„¶ä¿æŒè¿è¡Œã€‚è¯¥å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python your_program.py &amp;</span><br><span class=\"line\">æˆ–è€…ï¼šnohup python your_program.py &gt;app.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>\n\n<p>&amp;1æ˜¯ä¸€ä¸ªæŒ‡å‘æ ‡å‡†è¾“å‡ºçš„æŒ‡é’ˆï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥å‘½ä»¤ä¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯å†™å…¥åˆ°app.log</p>\n<p>2.å…¶ä¸­ï¼Œ<code>your_program.py</code>ä¸ºéœ€è¦åå°è¿è¡Œçš„Pythonç¨‹åºæ–‡ä»¶åï¼Œ<code>&amp;</code>ç¬¦å·è¡¨ç¤ºåœ¨åå°è¿è¡Œç¨‹åºã€‚è¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup: ignoring input and appending output to &#x27;nohup.out&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>3.è¿™æ„å‘³ç€ä½ çš„Pythonç¨‹åºå·²ç»åœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¾“å‡ºä¿¡æ¯ä¿å­˜åœ¨nohup.outæ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>tail</code>å‘½ä»¤è·Ÿè¸ªè¯¥æ–‡ä»¶ä»¥æŸ¥çœ‹ç¨‹åºè¾“å‡ºä¿¡æ¯ã€‚å¦‚æœä½ æƒ³åœæ­¢ç¨‹åºçš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>kill</code>å‘½ä»¤ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f nohup.out</span><br><span class=\"line\">kill PID</span><br></pre></td></tr></table></figure>\n\n<p>4.å…¶ä¸­ï¼Œ<code>PID</code>ä¸ºä½ ç¨‹åºçš„è¿›ç¨‹IDï¼Œåœ¨è¿è¡Œ<code>nohup</code>å‘½ä»¤åä½ å¯ä»¥ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep python # å‘½ä»¤æŸ¥æ‰¾è¿›ç¨‹IDã€‚</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\"><a href=\"#ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\" class=\"headerlink\" title=\"ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\"></a>ä¸‰ã€å‡çº§pythonç‰ˆæœ¬</h2><p>1.<a href=\"%5Bwww.python.org/downloads/%5D(https://link.juejin.cn/?target=https://www.python.org/downloads/)\">å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…</a></p>\n<p>2.è§£å‹ï¼š<code>tar  -xf   Python-3.10.4.tgz</code></p>\n<p>3.è¿›å…¥è§£å‹åçš„ç›®å½•ï¼š<code>./configure &amp;&amp; make &amp;&amp; make install </code></p>\n<p>4.å…ˆæ‰¾åˆ°pythonæ–‡ä»¶ï¼Œå‡†å¤‡åˆ›å»ºè½¯é“¾æ¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240119145905288.png\" alt=\"image-20240119145905288\"></p>\n<p>5.åˆ›å»ºè½¯è¿æ¥ï¼ˆ&#x2F;usr&#x2F;local&#x2F;bin&#x2F;python3.10æ˜¯å­˜æ”¾pythonæ–‡ä»¶ç›®å½•ï¼‰</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sf /usr/local/bin/python3.10 /usr/bin/python</span><br><span class=\"line\">ln -sf /usr/local/bin/python3.10-config /usr/bin/python-config</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"å››ã€è¸©å‘è®°å½•\"><a href=\"#å››ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"å››ã€è¸©å‘è®°å½•\"></a>å››ã€è¸©å‘è®°å½•</h2><p>1.ä½¿ç”¨nohupå‘½ä»¤åï¼Œæ—¥å¿—æ–‡ä»¶å†…æ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯å­˜åœ¨è¾“å‡ºç¼“å­˜ï¼Œé€šè¿‡ä¿®æ”¹å¯åŠ¨å‘½ä»¤è§£å†³ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python -u your_program.py &gt;app.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>\n\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://blog.csdn.net/xunfengdumo/article/details/132448270\">Python nohup å¯åŠ¨pythonè„šæœ¬ï¼Œåå°æ²¡æœ‰æ—¥å¿—</a></p>\n","excerpt":"","more":"<blockquote>\n<p>ç³»ç»Ÿç”¨çš„æ˜¯Centosï¼Œè‡ªå¸¦äº†pythonç¯å¢ƒï¼Œè€ƒè™‘åˆ°åæœŸç»´æŠ¤ä½¿ç”¨virtualenvè™šæ‹Ÿç¯å¢ƒæ¥ä¸ºåº”ç”¨åˆ›å»ºâ€éš”ç¦»â€çš„pythonè¿è¡Œç¯å¢ƒã€‚</p>\n<p>virtualenvè™šæ‹Ÿç¯å¢ƒæ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç»çš„Pythonç¯å¢ƒçš„å·¥å…·ã€‚</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110124003769.png\" alt=\"image-20240110124003769\"></p>\n<ul>\n<li><strong>éš”ç¦»æ€§</strong>ï¼švirtualenvå¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒä¸å…¶ä»–Pythonç¯å¢ƒï¼ˆå¦‚ç³»ç»Ÿç¯å¢ƒæˆ–å…¨å±€ç¯å¢ƒï¼‰å®Œå…¨éš”ç¦»ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¿™ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æœ‰åŠ©äºè§£å†³ä¸åŒé¡¹ç›®ä¹‹é—´çš„ä¾èµ–å†²çªé—®é¢˜ã€‚</li>\n<li><strong>æ˜“äºç®¡ç†</strong>ï¼šæ¯ä¸ªè™šæ‹Ÿç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„<code>pip</code>ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºæ¯ä¸ªé¡¹ç›®å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„<code>pip</code>ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨ï¼Œè¿™ä½¿å¾—ç‰ˆæœ¬æ§åˆ¶å˜å¾—ç®€å•ã€‚</li>\n<li><strong>å®‰å…¨æ€§</strong>ï¼šç”±äºæ¯ä¸ªç¯å¢ƒéƒ½æ˜¯éš”ç¦»çš„ï¼Œå› æ­¤åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªç¯å¢ƒä¸­å®‰è£…çš„æ¶æ„åŒ…ä¸ä¼šå½±å“å…¶ä»–ç¯å¢ƒã€‚</li>\n<li><strong>çµæ´»æ€§</strong>ï¼šä½ å¯ä»¥ä¸ºä¸åŒçš„é¡¹ç›®åˆ›å»ºä¸åŒçš„è™šæ‹Ÿç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„Pythonè§£é‡Šå™¨å’Œpipç‰ˆæœ¬ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®é¡¹ç›®çš„éœ€æ±‚æ¥é…ç½®ç¯å¢ƒã€‚</li>\n<li><strong>æ˜“äºä½¿ç”¨</strong>ï¼švirtualenvæ˜“äºå®‰è£…å’Œä½¿ç”¨ã€‚ä½ åªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸€äº›å‘½ä»¤å°±å¯ä»¥åˆ›å»ºæ–°çš„ç¯å¢ƒï¼Œå®‰è£…åŒ…ç­‰ã€‚è¿™å¯¹äºåˆå­¦è€…æ¥è¯´éå¸¸å‹å¥½ã€‚</li>\n</ul>\n<h3 id=\"ä¸€ã€éƒ¨ç½²é¡¹ç›®\"><a href=\"#ä¸€ã€éƒ¨ç½²é¡¹ç›®\" class=\"headerlink\" title=\"ä¸€ã€éƒ¨ç½²é¡¹ç›®\"></a>ä¸€ã€éƒ¨ç½²é¡¹ç›®</h3><p>1.å¯¼å‡ºé¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–åŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip freeze &gt; requements.txt</span><br></pre></td></tr></table></figure>\n\n<p>2.åˆ›å»ºpythonè™šæ‹Ÿç¯å¢ƒï¼ˆenv_nameå½“å‰ç¯å¢ƒçš„åç§°ï¼‰</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m venv env_name</span><br></pre></td></tr></table></figure>\n\n<p>åˆ›å»ºåä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«äº†é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240110125725202.png\" alt=\"image-20240110125725202\"></p>\n<p>3.å¯åŠ¨è™šæ‹Ÿç¯å¢ƒ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source env_name/bin/activate</span><br></pre></td></tr></table></figure>\n\n<p>3.å¯åŠ¨pythonè„šæœ¬</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install -r requements.txt # å…ˆå¯¼å…¥ä¾èµ–åŒ…</span><br><span class=\"line\">python xx.py # è¿è¡Œç¨‹åºæ–‡ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>4.å…³é—­è™šæ‹Ÿç¯å¢ƒå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">deactivate</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"äºŒã€åå°è¿è¡Œpythonè„šæœ¬\"><a href=\"#äºŒã€åå°è¿è¡Œpythonè„šæœ¬\" class=\"headerlink\" title=\"äºŒã€åå°è¿è¡Œpythonè„šæœ¬\"></a>äºŒã€åå°è¿è¡Œpythonè„šæœ¬</h2><p>1.nohupå‘½ä»¤å¯ä»¥ä½¿ä½ åœ¨æ³¨é”€è´¦æˆ·æˆ–å…³é—­ç»ˆç«¯æ—¶ï¼Œç¨‹åºä»ç„¶ä¿æŒè¿è¡Œã€‚è¯¥å‘½ä»¤çš„åŸºæœ¬è¯­æ³•ä¸ºï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python your_program.py &amp;</span><br><span class=\"line\">æˆ–è€…ï¼šnohup python your_program.py &gt;app.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>\n\n<p>&amp;1æ˜¯ä¸€ä¸ªæŒ‡å‘æ ‡å‡†è¾“å‡ºçš„æŒ‡é’ˆï¼Œ2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥å‘½ä»¤ä¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯å†™å…¥åˆ°app.log</p>\n<p>2.å…¶ä¸­ï¼Œ<code>your_program.py</code>ä¸ºéœ€è¦åå°è¿è¡Œçš„Pythonç¨‹åºæ–‡ä»¶åï¼Œ<code>&amp;</code>ç¬¦å·è¡¨ç¤ºåœ¨åå°è¿è¡Œç¨‹åºã€‚è¿è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä½ å¯ä»¥çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup: ignoring input and appending output to &#x27;nohup.out&#x27;</span><br></pre></td></tr></table></figure>\n\n<p>3.è¿™æ„å‘³ç€ä½ çš„Pythonç¨‹åºå·²ç»åœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¾“å‡ºä¿¡æ¯ä¿å­˜åœ¨nohup.outæ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>tail</code>å‘½ä»¤è·Ÿè¸ªè¯¥æ–‡ä»¶ä»¥æŸ¥çœ‹ç¨‹åºè¾“å‡ºä¿¡æ¯ã€‚å¦‚æœä½ æƒ³åœæ­¢ç¨‹åºçš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>kill</code>å‘½ä»¤ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tail -f nohup.out</span><br><span class=\"line\">kill PID</span><br></pre></td></tr></table></figure>\n\n<p>4.å…¶ä¸­ï¼Œ<code>PID</code>ä¸ºä½ ç¨‹åºçš„è¿›ç¨‹IDï¼Œåœ¨è¿è¡Œ<code>nohup</code>å‘½ä»¤åä½ å¯ä»¥ä½¿ç”¨ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps -ef | grep python # å‘½ä»¤æŸ¥æ‰¾è¿›ç¨‹IDã€‚</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\"><a href=\"#ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\" class=\"headerlink\" title=\"ä¸‰ã€å‡çº§pythonç‰ˆæœ¬\"></a>ä¸‰ã€å‡çº§pythonç‰ˆæœ¬</h2><p>1.<a href=\"%5Bwww.python.org/downloads/%5D(https://link.juejin.cn/?target=https://www.python.org/downloads/)\">å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…</a></p>\n<p>2.è§£å‹ï¼š<code>tar  -xf   Python-3.10.4.tgz</code></p>\n<p>3.è¿›å…¥è§£å‹åçš„ç›®å½•ï¼š<code>./configure &amp;&amp; make &amp;&amp; make install </code></p>\n<p>4.å…ˆæ‰¾åˆ°pythonæ–‡ä»¶ï¼Œå‡†å¤‡åˆ›å»ºè½¯é“¾æ¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240119145905288.png\" alt=\"image-20240119145905288\"></p>\n<p>5.åˆ›å»ºè½¯è¿æ¥ï¼ˆ&#x2F;usr&#x2F;local&#x2F;bin&#x2F;python3.10æ˜¯å­˜æ”¾pythonæ–‡ä»¶ç›®å½•ï¼‰</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -sf /usr/local/bin/python3.10 /usr/bin/python</span><br><span class=\"line\">ln -sf /usr/local/bin/python3.10-config /usr/bin/python-config</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"å››ã€è¸©å‘è®°å½•\"><a href=\"#å››ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"å››ã€è¸©å‘è®°å½•\"></a>å››ã€è¸©å‘è®°å½•</h2><p>1.ä½¿ç”¨nohupå‘½ä»¤åï¼Œæ—¥å¿—æ–‡ä»¶å†…æ²¡æœ‰æ—¥å¿—è¾“å‡ºï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯å­˜åœ¨è¾“å‡ºç¼“å­˜ï¼Œé€šè¿‡ä¿®æ”¹å¯åŠ¨å‘½ä»¤è§£å†³ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup python -u your_program.py &gt;app.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>\n\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://blog.csdn.net/xunfengdumo/article/details/132448270\">Python nohup å¯åŠ¨pythonè„šæœ¬ï¼Œåå°æ²¡æœ‰æ—¥å¿—</a></p>\n"},{"title":"Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬)","date":"2022-02-06T09:35:40.000Z","_content":"\nè§£å†³å¹¶å‘æƒ…å†µä¸‹çš„å®¹å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ã€‚ç»™å¤šçº¿ç¨‹ç¯å¢ƒå‡†å¤‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡ã€‚\nçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡: Vector, Hashtableã€‚çº¿ç¨‹å®‰å…¨å®¹å™¨å¯¹è±¡ï¼Œéƒ½æ˜¯ä½¿ç”¨synchronized æ–¹æ³•å®ç°çš„ã€‚concurrentåŒ…ä¸­çš„åŒæ­¥å®¹å™¨ï¼Œå¤§å¤šæ•°æ˜¯ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çš„çº¿ç¨‹å®‰å…¨ã€‚ç±»ä¼¼nativeã€‚Java8 ä¸­ä½¿ç”¨ CASã€‚\n\n## 1ã€Map/Set\n### 1.1 ConcurrentHashMap/ConcurrentHashSet\nåº•å±‚å“ˆå¸Œå®ç°çš„åŒæ­¥ Map(Set)ã€‚æ•ˆç‡é«˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çº¿ç¨‹å®‰å…¨ã€‚ é‡çº§è¾ƒ synchronized ä½ã€‚key å’Œ value ä¸èƒ½ä¸º nullã€‚\n\n### 1.2 ConcurrentSkipListMap/ConcurrentSkipListSet\nåº•å±‚è·³è¡¨(SkipList)å®ç°çš„åŒæ­¥ Map(Set)ã€‚æœ‰åºï¼Œæ•ˆç‡æ¯” ConcurrentHashMap ç¨ä½ã€‚\n```java\nimport java.util.Map;\nimport java.util.Random;\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.concurrent.CountDownLatch;\n\npublic class Test_01_ConcurrentMap {\n\n    public static void main(String[] args) {\n//        final Map<String, String> map = new Hashtable<>();\n         final Map<String, String> map = new ConcurrentHashMap<>();\n         //ConcurrentSkipListMapè·³è¡¨å®ç°çš„ï¼Œæ˜¯æ’åºçš„ï¼Œæœ€æ…¢\n//         final Map<String, String> map = new ConcurrentSkipListMap<>();\n        final Random r = new Random();\n        Thread[] array = new Thread[100];\n        final CountDownLatch latch = new CountDownLatch(array.length);\n\n        long begin = System.currentTimeMillis();\n        for (int i = 0; i < array.length; i++) {\n            array[i] = new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    for (int j = 0; j < 100000; j++) {\n                        map.put(\"key\" + r.nextInt(100000), \"value\" + r.nextInt(100000));\n                    }\n                    latch.countDown();\n                }\n            });\n        }\n        for (Thread t : array) {\n            t.start();\n        }\n        try {\n            latch.await();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println(\"æ‰§è¡Œæ—¶é—´ä¸º ï¼š \" + (end - begin) + \"æ¯«ç§’ï¼\");\n    }\n\n}\n```\n\n## 2ã€List\n### 2.1 CopyOnWriteArrayList\nå†™æ—¶å¤åˆ¶é›†åˆã€‚å†™å…¥æ•ˆç‡ä½ï¼Œè¯»å–æ•ˆç‡é«˜ã€‚æ¯æ¬¡å†™å…¥æ•°æ®ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ã€‚\n```java\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.CountDownLatch;\n\npublic class Test_02_CopyOnWriteList {\n\n    public static void main(String[] args) {\n         final List<String> list = new ArrayList<>();\n//         final List<String> list = new Vector<>();\n//        final List<String> list = new CopyOnWriteArrayList<>();\n        final Random r = new Random();\n        Thread[] array = new Thread[100];\n        final CountDownLatch latch = new CountDownLatch(array.length);\n\n        long begin = System.currentTimeMillis();\n        for (int i = 0; i < array.length; i++) {\n            array[i] = new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    for (int j = 0; j < 1000; j++) {\n                        list.add(\"value\" + r.nextInt(100000));\n                    }\n                    latch.countDown();\n                }\n            });\n        }\n        for (Thread t : array) {\n            t.start();\n        }\n        try {\n            latch.await();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println(\"æ‰§è¡Œæ—¶é—´ä¸º ï¼š \" + (end - begin) + \"æ¯«ç§’ï¼\");\n        System.out.println(\"List.size() : \" + list.size());\n    }\n\n}\n```\n\n## 3ã€Queue\n### 3.1 ConcurrentLinkedQueue\nåŸºç¡€é“¾è¡¨åŒæ­¥é˜Ÿåˆ—ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - ConcurrentLinkedQueue\n * é˜Ÿåˆ— - é“¾è¡¨å®ç°çš„ã€‚\n */\nimport java.util.Queue;\nimport java.util.concurrent.ConcurrentLinkedQueue;\n\npublic class Test_03_ConcurrentLinkedQueue {\n\n    public static void main(String[] args) {\n        Queue<String> queue = new ConcurrentLinkedQueue<>();\n        for (int i = 0; i < 10; i++) {\n            queue.offer(\"value\" + i);\n        }\n\n        System.out.println(queue);\n        System.out.println(queue.size());\n\n        // peek() -> æŸ¥çœ‹queueä¸­çš„é¦–æ•°æ®\n        System.out.println(queue.peek());\n        System.out.println(queue.size());\n\n        // poll() -> è·å–queueä¸­çš„é¦–æ•°æ®\n        System.out.println(queue.poll());\n        System.out.println(queue.size());\n    }\n\n}\n```\n### 3.2 LinkedBlockingQueue\né˜»å¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å®¹é‡ä¸è¶³è‡ªåŠ¨é˜»å¡ï¼Œé˜Ÿåˆ—å®¹é‡ä¸º 0 è‡ªåŠ¨é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - LinkedBlockingQueue\n * é˜»å¡å®¹å™¨ã€‚\n * put & take - è‡ªåŠ¨é˜»å¡ã€‚\n * putè‡ªåŠ¨é˜»å¡ï¼Œ é˜Ÿåˆ—å®¹é‡æ»¡åï¼Œè‡ªåŠ¨é˜»å¡\n * takeè‡ªåŠ¨é˜»å¡æ–¹æ³•ï¼Œ é˜Ÿåˆ—å®¹é‡ä¸º0åï¼Œè‡ªåŠ¨é˜»å¡ã€‚\n */\n\nimport java.util.Random;\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.LinkedBlockingQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_04_LinkedBlockingQueue {\n\n    final BlockingQueue<String> queue = new LinkedBlockingQueue<>();\n    final Random r = new Random();\n\n    public static void main(String[] args) {\n        final Test_04_LinkedBlockingQueue t = new Test_04_LinkedBlockingQueue();\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                while (true) {\n                    try {\n                        t.queue.put(\"value\" + t.r.nextInt(1000));\n                        TimeUnit.SECONDS.sleep(1);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }, \"producer\").start();\n\n        for (int i = 0; i < 3; i++) {\n            new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    while (true) {\n                        try {\n                            System.out.println(Thread.currentThread().getName() +\n                                    \" - \" + t.queue.take());\n                        } catch (InterruptedException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }\n            }, \"consumer\" + i).start();\n        }\n    }\n\n}\n```\n### 3.3 ArrayBlockingQueue\nåº•å±‚æ•°ç»„å®ç°çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚è‡ªåŠ¨é˜»å¡ã€‚æ ¹æ®è°ƒç”¨ API(add/put/offer)ä¸åŒï¼Œæœ‰ä¸åŒç‰¹æ€§ã€‚\nå½“å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œæœ‰é˜»å¡èƒ½åŠ›ã€‚\nadd æ–¹æ³•ï¼šåœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚put æ–¹æ³•åœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ç­‰å¾…ã€‚\noffer æ–¹æ³•ï¼šå•å‚æ•° offer æ–¹æ³•ï¼Œä¸é˜»å¡ã€‚å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œè¿”å› falseã€‚å½“å‰æ–°å¢æ•°æ®æ“ä½œæ”¾å¼ƒã€‚ ä¸‰å‚æ•° offer æ–¹æ³•(offer(value,times,timeunit))ï¼Œå®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ times æ—¶é•¿(å•ä½ä¸º timeunit)ï¼Œå¦‚æœåœ¨é˜»å¡æ—¶é•¿å†…ï¼Œæœ‰å®¹é‡ç©ºé—²ï¼Œæ–°å¢æ•°æ®è¿”å› trueã€‚å¦‚æœé˜»å¡æ—¶é•¿èŒƒå›´å†…ï¼Œæ— å®¹é‡ç©ºé—²ï¼Œæ”¾å¼ƒæ–°å¢æ•°æ®ï¼Œè¿”å› falseã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - ArrayBlockingQueue\n * æœ‰ç•Œå®¹å™¨ã€‚\n */\n\nimport java.util.concurrent.ArrayBlockingQueue;\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_05_ArrayBlockingQueue {\n\n    final BlockingQueue<String> queue = new ArrayBlockingQueue<>(3);\n\n    public static void main(String[] args) {\n        final Test_05_ArrayBlockingQueue t = new Test_05_ArrayBlockingQueue();\n\n        for (int i = 0; i < 5; i++) {\n            // System.out.println(\"add method : \" + t.queue.add(\"value\"+i));\n            /*try {\n                t.queue.put(\"put\"+i);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(\"put method : \" + i);*/\n            // System.out.println(\"offer method : \" + t.queue.offer(\"value\"+i));\n            try {\n                System.out.println(\"offer method : \" +\n                        t.queue.offer(\"value\" + i, 1, TimeUnit.SECONDS));\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n\n        System.out.println(t.queue);\n    }\n\n}\n```\n### 3.4 DelayQueue\nå»¶æ—¶é˜Ÿåˆ—ã€‚æ ¹æ®æ¯”è¾ƒæœºåˆ¶ï¼Œå®ç°è‡ªå®šä¹‰å¤„ç†é¡ºåºçš„é˜Ÿåˆ—ã€‚å¸¸ç”¨äºå®šæ—¶ä»»åŠ¡ã€‚\nå¦‚:å®šæ—¶å…³æœºã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - DelayQueue\n * æ— ç•Œå®¹å™¨ã€‚\n */\n\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.DelayQueue;\nimport java.util.concurrent.Delayed;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_06_DelayQueue {\n\n    static BlockingQueue<MyTask_06> queue = new DelayQueue<>();\n\n    public static void main(String[] args) throws InterruptedException {\n        long value = System.currentTimeMillis();\n        MyTask_06 task1 = new MyTask_06(value + 2000);\n        MyTask_06 task2 = new MyTask_06(value + 1000);\n        MyTask_06 task3 = new MyTask_06(value + 3000);\n        MyTask_06 task4 = new MyTask_06(value + 2500);\n        MyTask_06 task5 = new MyTask_06(value + 1500);\n\n        queue.put(task1);\n        queue.put(task2);\n        queue.put(task3);\n        queue.put(task4);\n        queue.put(task5);\n\n        System.out.println(queue);\n        System.out.println(value);\n        for (int i = 0; i < 5; i++) {\n            System.out.println(queue.take());\n        }\n    }\n\n}\n\nclass MyTask_06 implements Delayed {\n\n    private long compareValue;\n\n    public MyTask_06(long compareValue) {\n        this.compareValue = compareValue;\n    }\n\n    /**\n     * æ¯”è¾ƒå¤§å°ã€‚è‡ªåŠ¨å®ç°å‡åº\n     * å»ºè®®å’ŒgetDelayæ–¹æ³•é…åˆå®Œæˆã€‚\n     * å¦‚æœåœ¨DelayQueueæ˜¯éœ€è¦æŒ‰æ—¶é—´å®Œæˆçš„è®¡åˆ’ä»»åŠ¡ï¼Œå¿…é¡»é…åˆgetDelayæ–¹æ³•å®Œæˆã€‚\n     */\n    @Override\n    public int compareTo(Delayed o) {\n        return (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));\n    }\n\n    /**\n     * è·å–è®¡åˆ’æ—¶é•¿çš„æ–¹æ³•ã€‚\n     * æ ¹æ®å‚æ•°TimeUnitæ¥å†³å®šï¼Œå¦‚ä½•è¿”å›ç»“æœå€¼ã€‚\n     */\n    @Override\n    public long getDelay(TimeUnit unit) {\n        return unit.convert(compareValue - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n\n    @Override\n    public String toString() {\n        return \"Task compare value is : \" + this.compareValue;\n    }\n\n}\n```\n### 3.5 LinkedTransferQueue\nè½¬ç§»é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º 0 çš„é˜Ÿåˆ—ã€‚ä½¿ç”¨ transfer æ–¹æ³•ï¼Œå®ç°æ•°æ®çš„å³æ—¶å¤„ç†ã€‚æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œå°±é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - LinkedTransferQueue\n * è½¬ç§»é˜Ÿåˆ—\n * add - é˜Ÿåˆ—ä¼šä¿å­˜æ•°æ®ï¼Œä¸åšé˜»å¡ç­‰å¾…ã€‚\n * transfer - æ˜¯TransferQueueçš„ç‰¹æœ‰æ–¹æ³•ã€‚å¿…é¡»æœ‰æ¶ˆè´¹è€…ï¼ˆtake()æ–¹æ³•çš„è°ƒç”¨è€…ï¼‰ã€‚\n * å¦‚æœæ²¡æœ‰ä»»æ„çº¿ç¨‹æ¶ˆè´¹æ•°æ®ï¼Œtransferæ–¹æ³•é˜»å¡ã€‚ä¸€èˆ¬ç”¨äºå¤„ç†å³æ—¶æ¶ˆæ¯ã€‚\n */\n\nimport java.util.concurrent.LinkedTransferQueue;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.TransferQueue;\n\npublic class Test_07_TransferQueue {\n\n    TransferQueue<String> queue = new LinkedTransferQueue<>();\n\n    public static void main(String[] args) {\n        final Test_07_TransferQueue t = new Test_07_TransferQueue();\n        \n        /*new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \" );\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n        \n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        \n        try {\n            t.queue.transfer(\"test string\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }*/\n\n        new Thread(new Runnable() {\n\n            @Override\n            public void run() {\n                try {\n                    t.queue.transfer(\"test string\");\n                    // t.queue.add(\"test string\");\n                    System.out.println(\"add ok\");\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            }\n        }).start();\n\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \");\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n\n    }\n\n}\n```\n### 3.6 SynchronusQueue\nåŒæ­¥é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º0çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„TransferQueueã€‚å¿…é¡»ç°æœ‰æ¶ˆè´¹çº¿ç¨‹ç­‰å¾…ï¼Œæ‰èƒ½ä½¿ç”¨çš„é˜Ÿåˆ—ã€‚\nadd æ–¹æ³•ï¼Œæ— é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ \nput æ–¹æ³•ï¼Œæœ‰é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - SynchronousQueue\n */\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.SynchronousQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_08_SynchronusQueue {\n\n    BlockingQueue<String> queue = new SynchronousQueue<>();\n\n    public static void main(String[] args) {\n        final Test_08_SynchronusQueue t = new Test_08_SynchronusQueue();\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \");\n                    try {\n                        TimeUnit.SECONDS.sleep(2);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n        \n        /*try {\n            TimeUnit.SECONDS.sleep(3);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }*/\n        // t.queue.add(\"test add\");\n        try {\n            t.queue.put(\"test put\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(Thread.currentThread().getName() + \" queue size : \" + t.queue.size());\n    }\n\n}\n```","source":"_posts/Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬).md","raw":"---\ntitle: Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬)\ndate: 2022-02-06 17:35:40\ntags:\n---\n\nè§£å†³å¹¶å‘æƒ…å†µä¸‹çš„å®¹å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ã€‚ç»™å¤šçº¿ç¨‹ç¯å¢ƒå‡†å¤‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡ã€‚\nçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡: Vector, Hashtableã€‚çº¿ç¨‹å®‰å…¨å®¹å™¨å¯¹è±¡ï¼Œéƒ½æ˜¯ä½¿ç”¨synchronized æ–¹æ³•å®ç°çš„ã€‚concurrentåŒ…ä¸­çš„åŒæ­¥å®¹å™¨ï¼Œå¤§å¤šæ•°æ˜¯ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çš„çº¿ç¨‹å®‰å…¨ã€‚ç±»ä¼¼nativeã€‚Java8 ä¸­ä½¿ç”¨ CASã€‚\n\n## 1ã€Map/Set\n### 1.1 ConcurrentHashMap/ConcurrentHashSet\nåº•å±‚å“ˆå¸Œå®ç°çš„åŒæ­¥ Map(Set)ã€‚æ•ˆç‡é«˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çº¿ç¨‹å®‰å…¨ã€‚ é‡çº§è¾ƒ synchronized ä½ã€‚key å’Œ value ä¸èƒ½ä¸º nullã€‚\n\n### 1.2 ConcurrentSkipListMap/ConcurrentSkipListSet\nåº•å±‚è·³è¡¨(SkipList)å®ç°çš„åŒæ­¥ Map(Set)ã€‚æœ‰åºï¼Œæ•ˆç‡æ¯” ConcurrentHashMap ç¨ä½ã€‚\n```java\nimport java.util.Map;\nimport java.util.Random;\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.concurrent.CountDownLatch;\n\npublic class Test_01_ConcurrentMap {\n\n    public static void main(String[] args) {\n//        final Map<String, String> map = new Hashtable<>();\n         final Map<String, String> map = new ConcurrentHashMap<>();\n         //ConcurrentSkipListMapè·³è¡¨å®ç°çš„ï¼Œæ˜¯æ’åºçš„ï¼Œæœ€æ…¢\n//         final Map<String, String> map = new ConcurrentSkipListMap<>();\n        final Random r = new Random();\n        Thread[] array = new Thread[100];\n        final CountDownLatch latch = new CountDownLatch(array.length);\n\n        long begin = System.currentTimeMillis();\n        for (int i = 0; i < array.length; i++) {\n            array[i] = new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    for (int j = 0; j < 100000; j++) {\n                        map.put(\"key\" + r.nextInt(100000), \"value\" + r.nextInt(100000));\n                    }\n                    latch.countDown();\n                }\n            });\n        }\n        for (Thread t : array) {\n            t.start();\n        }\n        try {\n            latch.await();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println(\"æ‰§è¡Œæ—¶é—´ä¸º ï¼š \" + (end - begin) + \"æ¯«ç§’ï¼\");\n    }\n\n}\n```\n\n## 2ã€List\n### 2.1 CopyOnWriteArrayList\nå†™æ—¶å¤åˆ¶é›†åˆã€‚å†™å…¥æ•ˆç‡ä½ï¼Œè¯»å–æ•ˆç‡é«˜ã€‚æ¯æ¬¡å†™å…¥æ•°æ®ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ã€‚\n```java\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.CountDownLatch;\n\npublic class Test_02_CopyOnWriteList {\n\n    public static void main(String[] args) {\n         final List<String> list = new ArrayList<>();\n//         final List<String> list = new Vector<>();\n//        final List<String> list = new CopyOnWriteArrayList<>();\n        final Random r = new Random();\n        Thread[] array = new Thread[100];\n        final CountDownLatch latch = new CountDownLatch(array.length);\n\n        long begin = System.currentTimeMillis();\n        for (int i = 0; i < array.length; i++) {\n            array[i] = new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    for (int j = 0; j < 1000; j++) {\n                        list.add(\"value\" + r.nextInt(100000));\n                    }\n                    latch.countDown();\n                }\n            });\n        }\n        for (Thread t : array) {\n            t.start();\n        }\n        try {\n            latch.await();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println(\"æ‰§è¡Œæ—¶é—´ä¸º ï¼š \" + (end - begin) + \"æ¯«ç§’ï¼\");\n        System.out.println(\"List.size() : \" + list.size());\n    }\n\n}\n```\n\n## 3ã€Queue\n### 3.1 ConcurrentLinkedQueue\nåŸºç¡€é“¾è¡¨åŒæ­¥é˜Ÿåˆ—ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - ConcurrentLinkedQueue\n * é˜Ÿåˆ— - é“¾è¡¨å®ç°çš„ã€‚\n */\nimport java.util.Queue;\nimport java.util.concurrent.ConcurrentLinkedQueue;\n\npublic class Test_03_ConcurrentLinkedQueue {\n\n    public static void main(String[] args) {\n        Queue<String> queue = new ConcurrentLinkedQueue<>();\n        for (int i = 0; i < 10; i++) {\n            queue.offer(\"value\" + i);\n        }\n\n        System.out.println(queue);\n        System.out.println(queue.size());\n\n        // peek() -> æŸ¥çœ‹queueä¸­çš„é¦–æ•°æ®\n        System.out.println(queue.peek());\n        System.out.println(queue.size());\n\n        // poll() -> è·å–queueä¸­çš„é¦–æ•°æ®\n        System.out.println(queue.poll());\n        System.out.println(queue.size());\n    }\n\n}\n```\n### 3.2 LinkedBlockingQueue\né˜»å¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å®¹é‡ä¸è¶³è‡ªåŠ¨é˜»å¡ï¼Œé˜Ÿåˆ—å®¹é‡ä¸º 0 è‡ªåŠ¨é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - LinkedBlockingQueue\n * é˜»å¡å®¹å™¨ã€‚\n * put & take - è‡ªåŠ¨é˜»å¡ã€‚\n * putè‡ªåŠ¨é˜»å¡ï¼Œ é˜Ÿåˆ—å®¹é‡æ»¡åï¼Œè‡ªåŠ¨é˜»å¡\n * takeè‡ªåŠ¨é˜»å¡æ–¹æ³•ï¼Œ é˜Ÿåˆ—å®¹é‡ä¸º0åï¼Œè‡ªåŠ¨é˜»å¡ã€‚\n */\n\nimport java.util.Random;\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.LinkedBlockingQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_04_LinkedBlockingQueue {\n\n    final BlockingQueue<String> queue = new LinkedBlockingQueue<>();\n    final Random r = new Random();\n\n    public static void main(String[] args) {\n        final Test_04_LinkedBlockingQueue t = new Test_04_LinkedBlockingQueue();\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                while (true) {\n                    try {\n                        t.queue.put(\"value\" + t.r.nextInt(1000));\n                        TimeUnit.SECONDS.sleep(1);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }, \"producer\").start();\n\n        for (int i = 0; i < 3; i++) {\n            new Thread(new Runnable() {\n                @Override\n                public void run() {\n                    while (true) {\n                        try {\n                            System.out.println(Thread.currentThread().getName() +\n                                    \" - \" + t.queue.take());\n                        } catch (InterruptedException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                }\n            }, \"consumer\" + i).start();\n        }\n    }\n\n}\n```\n### 3.3 ArrayBlockingQueue\nåº•å±‚æ•°ç»„å®ç°çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚è‡ªåŠ¨é˜»å¡ã€‚æ ¹æ®è°ƒç”¨ API(add/put/offer)ä¸åŒï¼Œæœ‰ä¸åŒç‰¹æ€§ã€‚\nå½“å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œæœ‰é˜»å¡èƒ½åŠ›ã€‚\nadd æ–¹æ³•ï¼šåœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚put æ–¹æ³•åœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ç­‰å¾…ã€‚\noffer æ–¹æ³•ï¼šå•å‚æ•° offer æ–¹æ³•ï¼Œä¸é˜»å¡ã€‚å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œè¿”å› falseã€‚å½“å‰æ–°å¢æ•°æ®æ“ä½œæ”¾å¼ƒã€‚ ä¸‰å‚æ•° offer æ–¹æ³•(offer(value,times,timeunit))ï¼Œå®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ times æ—¶é•¿(å•ä½ä¸º timeunit)ï¼Œå¦‚æœåœ¨é˜»å¡æ—¶é•¿å†…ï¼Œæœ‰å®¹é‡ç©ºé—²ï¼Œæ–°å¢æ•°æ®è¿”å› trueã€‚å¦‚æœé˜»å¡æ—¶é•¿èŒƒå›´å†…ï¼Œæ— å®¹é‡ç©ºé—²ï¼Œæ”¾å¼ƒæ–°å¢æ•°æ®ï¼Œè¿”å› falseã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - ArrayBlockingQueue\n * æœ‰ç•Œå®¹å™¨ã€‚\n */\n\nimport java.util.concurrent.ArrayBlockingQueue;\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_05_ArrayBlockingQueue {\n\n    final BlockingQueue<String> queue = new ArrayBlockingQueue<>(3);\n\n    public static void main(String[] args) {\n        final Test_05_ArrayBlockingQueue t = new Test_05_ArrayBlockingQueue();\n\n        for (int i = 0; i < 5; i++) {\n            // System.out.println(\"add method : \" + t.queue.add(\"value\"+i));\n            /*try {\n                t.queue.put(\"put\"+i);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(\"put method : \" + i);*/\n            // System.out.println(\"offer method : \" + t.queue.offer(\"value\"+i));\n            try {\n                System.out.println(\"offer method : \" +\n                        t.queue.offer(\"value\" + i, 1, TimeUnit.SECONDS));\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n\n        System.out.println(t.queue);\n    }\n\n}\n```\n### 3.4 DelayQueue\nå»¶æ—¶é˜Ÿåˆ—ã€‚æ ¹æ®æ¯”è¾ƒæœºåˆ¶ï¼Œå®ç°è‡ªå®šä¹‰å¤„ç†é¡ºåºçš„é˜Ÿåˆ—ã€‚å¸¸ç”¨äºå®šæ—¶ä»»åŠ¡ã€‚\nå¦‚:å®šæ—¶å…³æœºã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - DelayQueue\n * æ— ç•Œå®¹å™¨ã€‚\n */\n\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.DelayQueue;\nimport java.util.concurrent.Delayed;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_06_DelayQueue {\n\n    static BlockingQueue<MyTask_06> queue = new DelayQueue<>();\n\n    public static void main(String[] args) throws InterruptedException {\n        long value = System.currentTimeMillis();\n        MyTask_06 task1 = new MyTask_06(value + 2000);\n        MyTask_06 task2 = new MyTask_06(value + 1000);\n        MyTask_06 task3 = new MyTask_06(value + 3000);\n        MyTask_06 task4 = new MyTask_06(value + 2500);\n        MyTask_06 task5 = new MyTask_06(value + 1500);\n\n        queue.put(task1);\n        queue.put(task2);\n        queue.put(task3);\n        queue.put(task4);\n        queue.put(task5);\n\n        System.out.println(queue);\n        System.out.println(value);\n        for (int i = 0; i < 5; i++) {\n            System.out.println(queue.take());\n        }\n    }\n\n}\n\nclass MyTask_06 implements Delayed {\n\n    private long compareValue;\n\n    public MyTask_06(long compareValue) {\n        this.compareValue = compareValue;\n    }\n\n    /**\n     * æ¯”è¾ƒå¤§å°ã€‚è‡ªåŠ¨å®ç°å‡åº\n     * å»ºè®®å’ŒgetDelayæ–¹æ³•é…åˆå®Œæˆã€‚\n     * å¦‚æœåœ¨DelayQueueæ˜¯éœ€è¦æŒ‰æ—¶é—´å®Œæˆçš„è®¡åˆ’ä»»åŠ¡ï¼Œå¿…é¡»é…åˆgetDelayæ–¹æ³•å®Œæˆã€‚\n     */\n    @Override\n    public int compareTo(Delayed o) {\n        return (int) (this.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));\n    }\n\n    /**\n     * è·å–è®¡åˆ’æ—¶é•¿çš„æ–¹æ³•ã€‚\n     * æ ¹æ®å‚æ•°TimeUnitæ¥å†³å®šï¼Œå¦‚ä½•è¿”å›ç»“æœå€¼ã€‚\n     */\n    @Override\n    public long getDelay(TimeUnit unit) {\n        return unit.convert(compareValue - System.currentTimeMillis(), TimeUnit.MILLISECONDS);\n    }\n\n    @Override\n    public String toString() {\n        return \"Task compare value is : \" + this.compareValue;\n    }\n\n}\n```\n### 3.5 LinkedTransferQueue\nè½¬ç§»é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º 0 çš„é˜Ÿåˆ—ã€‚ä½¿ç”¨ transfer æ–¹æ³•ï¼Œå®ç°æ•°æ®çš„å³æ—¶å¤„ç†ã€‚æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œå°±é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - LinkedTransferQueue\n * è½¬ç§»é˜Ÿåˆ—\n * add - é˜Ÿåˆ—ä¼šä¿å­˜æ•°æ®ï¼Œä¸åšé˜»å¡ç­‰å¾…ã€‚\n * transfer - æ˜¯TransferQueueçš„ç‰¹æœ‰æ–¹æ³•ã€‚å¿…é¡»æœ‰æ¶ˆè´¹è€…ï¼ˆtake()æ–¹æ³•çš„è°ƒç”¨è€…ï¼‰ã€‚\n * å¦‚æœæ²¡æœ‰ä»»æ„çº¿ç¨‹æ¶ˆè´¹æ•°æ®ï¼Œtransferæ–¹æ³•é˜»å¡ã€‚ä¸€èˆ¬ç”¨äºå¤„ç†å³æ—¶æ¶ˆæ¯ã€‚\n */\n\nimport java.util.concurrent.LinkedTransferQueue;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.TransferQueue;\n\npublic class Test_07_TransferQueue {\n\n    TransferQueue<String> queue = new LinkedTransferQueue<>();\n\n    public static void main(String[] args) {\n        final Test_07_TransferQueue t = new Test_07_TransferQueue();\n        \n        /*new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \" );\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n        \n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        \n        try {\n            t.queue.transfer(\"test string\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }*/\n\n        new Thread(new Runnable() {\n\n            @Override\n            public void run() {\n                try {\n                    t.queue.transfer(\"test string\");\n                    // t.queue.add(\"test string\");\n                    System.out.println(\"add ok\");\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            }\n        }).start();\n\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \");\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n\n    }\n\n}\n```\n### 3.6 SynchronusQueue\nåŒæ­¥é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º0çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„TransferQueueã€‚å¿…é¡»ç°æœ‰æ¶ˆè´¹çº¿ç¨‹ç­‰å¾…ï¼Œæ‰èƒ½ä½¿ç”¨çš„é˜Ÿåˆ—ã€‚\nadd æ–¹æ³•ï¼Œæ— é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚ \nput æ–¹æ³•ï¼Œæœ‰é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™é˜»å¡ã€‚\n```java\n/**\n * å¹¶å‘å®¹å™¨ - SynchronousQueue\n */\nimport java.util.concurrent.BlockingQueue;\nimport java.util.concurrent.SynchronousQueue;\nimport java.util.concurrent.TimeUnit;\n\npublic class Test_08_SynchronusQueue {\n\n    BlockingQueue<String> queue = new SynchronousQueue<>();\n\n    public static void main(String[] args) {\n        final Test_08_SynchronusQueue t = new Test_08_SynchronusQueue();\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    System.out.println(Thread.currentThread().getName() + \" thread begin \");\n                    try {\n                        TimeUnit.SECONDS.sleep(2);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    System.out.println(Thread.currentThread().getName() + \" - \" + t.queue.take());\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"output thread\").start();\n        \n        /*try {\n            TimeUnit.SECONDS.sleep(3);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }*/\n        // t.queue.add(\"test add\");\n        try {\n            t.queue.put(\"test put\");\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        System.out.println(Thread.currentThread().getName() + \" queue size : \" + t.queue.size());\n    }\n\n}\n```","slug":"Javaå¹¶å‘ç¼–ç¨‹(å››)ï¼šå¹¶å‘å®¹å™¨(è½¬)","published":1,"updated":"2024-02-07T07:27:45.071Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dk000fwen1c2nq5q6q","content":"<p>è§£å†³å¹¶å‘æƒ…å†µä¸‹çš„å®¹å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ã€‚ç»™å¤šçº¿ç¨‹ç¯å¢ƒå‡†å¤‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡ã€‚<br>çº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡: Vector, Hashtableã€‚çº¿ç¨‹å®‰å…¨å®¹å™¨å¯¹è±¡ï¼Œéƒ½æ˜¯ä½¿ç”¨synchronized æ–¹æ³•å®ç°çš„ã€‚concurrentåŒ…ä¸­çš„åŒæ­¥å®¹å™¨ï¼Œå¤§å¤šæ•°æ˜¯ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çš„çº¿ç¨‹å®‰å…¨ã€‚ç±»ä¼¼nativeã€‚Java8 ä¸­ä½¿ç”¨ CASã€‚</p>\n<h2 id=\"1ã€Map-Set\"><a href=\"#1ã€Map-Set\" class=\"headerlink\" title=\"1ã€Map&#x2F;Set\"></a>1ã€Map&#x2F;Set</h2><h3 id=\"1-1-ConcurrentHashMap-ConcurrentHashSet\"><a href=\"#1-1-ConcurrentHashMap-ConcurrentHashSet\" class=\"headerlink\" title=\"1.1 ConcurrentHashMap&#x2F;ConcurrentHashSet\"></a>1.1 ConcurrentHashMap&#x2F;ConcurrentHashSet</h3><p>åº•å±‚å“ˆå¸Œå®ç°çš„åŒæ­¥ Map(Set)ã€‚æ•ˆç‡é«˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çº¿ç¨‹å®‰å…¨ã€‚ é‡çº§è¾ƒ synchronized ä½ã€‚key å’Œ value ä¸èƒ½ä¸º nullã€‚</p>\n<h3 id=\"1-2-ConcurrentSkipListMap-ConcurrentSkipListSet\"><a href=\"#1-2-ConcurrentSkipListMap-ConcurrentSkipListSet\" class=\"headerlink\" title=\"1.2 ConcurrentSkipListMap&#x2F;ConcurrentSkipListSet\"></a>1.2 ConcurrentSkipListMap&#x2F;ConcurrentSkipListSet</h3><p>åº•å±‚è·³è¡¨(SkipList)å®ç°çš„åŒæ­¥ Map(Set)ã€‚æœ‰åºï¼Œæ•ˆç‡æ¯” ConcurrentHashMap ç¨ä½ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CountDownLatch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_01_ConcurrentMap</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">//        final Map&lt;String, String&gt; map = new Hashtable&lt;&gt;();</span></span><br><span class=\"line\">         <span class=\"keyword\">final</span> Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class=\"line\">         <span class=\"comment\">//ConcurrentSkipListMapè·³è¡¨å®ç°çš„ï¼Œæ˜¯æ’åºçš„ï¼Œæœ€æ…¢</span></span><br><span class=\"line\"><span class=\"comment\">//         final Map&lt;String, String&gt; map = new ConcurrentSkipListMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">        Thread[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>[<span class=\"number\">100</span>];</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">CountDownLatch</span> <span class=\"variable\">latch</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">CountDownLatch</span>(array.length);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">begin</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">            array[i] = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">100000</span>; j++) &#123;</span><br><span class=\"line\">                        map.put(<span class=\"string\">&quot;key&quot;</span> + r.nextInt(<span class=\"number\">100000</span>), <span class=\"string\">&quot;value&quot;</span> + r.nextInt(<span class=\"number\">100000</span>));</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Thread t : array) &#123;</span><br><span class=\"line\">            t.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            latch.await();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‰§è¡Œæ—¶é—´ä¸º ï¼š &quot;</span> + (end - begin) + <span class=\"string\">&quot;æ¯«ç§’ï¼&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2ã€List\"><a href=\"#2ã€List\" class=\"headerlink\" title=\"2ã€List\"></a>2ã€List</h2><h3 id=\"2-1-CopyOnWriteArrayList\"><a href=\"#2-1-CopyOnWriteArrayList\" class=\"headerlink\" title=\"2.1 CopyOnWriteArrayList\"></a>2.1 CopyOnWriteArrayList</h3><p>å†™æ—¶å¤åˆ¶é›†åˆã€‚å†™å…¥æ•ˆç‡ä½ï¼Œè¯»å–æ•ˆç‡é«˜ã€‚æ¯æ¬¡å†™å…¥æ•°æ®ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CountDownLatch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_02_CopyOnWriteList</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">final</span> List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\"><span class=\"comment\">//         final List&lt;String&gt; list = new Vector&lt;&gt;();</span></span><br><span class=\"line\"><span class=\"comment\">//        final List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">        Thread[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>[<span class=\"number\">100</span>];</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">CountDownLatch</span> <span class=\"variable\">latch</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">CountDownLatch</span>(array.length);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">begin</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">            array[i] = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">1000</span>; j++) &#123;</span><br><span class=\"line\">                        list.add(<span class=\"string\">&quot;value&quot;</span> + r.nextInt(<span class=\"number\">100000</span>));</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Thread t : array) &#123;</span><br><span class=\"line\">            t.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            latch.await();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‰§è¡Œæ—¶é—´ä¸º ï¼š &quot;</span> + (end - begin) + <span class=\"string\">&quot;æ¯«ç§’ï¼&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;List.size() : &quot;</span> + list.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3ã€Queue\"><a href=\"#3ã€Queue\" class=\"headerlink\" title=\"3ã€Queue\"></a>3ã€Queue</h2><h3 id=\"3-1-ConcurrentLinkedQueue\"><a href=\"#3-1-ConcurrentLinkedQueue\" class=\"headerlink\" title=\"3.1 ConcurrentLinkedQueue\"></a>3.1 ConcurrentLinkedQueue</h3><p>åŸºç¡€é“¾è¡¨åŒæ­¥é˜Ÿåˆ—ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - ConcurrentLinkedQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * é˜Ÿåˆ— - é“¾è¡¨å®ç°çš„ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Queue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ConcurrentLinkedQueue;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_03_ConcurrentLinkedQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Queue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentLinkedQueue</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            queue.offer(<span class=\"string\">&quot;value&quot;</span> + i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(queue);</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// peek() -&gt; æŸ¥çœ‹queueä¸­çš„é¦–æ•°æ®</span></span><br><span class=\"line\">        System.out.println(queue.peek());</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// poll() -&gt; è·å–queueä¸­çš„é¦–æ•°æ®</span></span><br><span class=\"line\">        System.out.println(queue.poll());</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-LinkedBlockingQueue\"><a href=\"#3-2-LinkedBlockingQueue\" class=\"headerlink\" title=\"3.2 LinkedBlockingQueue\"></a>3.2 LinkedBlockingQueue</h3><p>é˜»å¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å®¹é‡ä¸è¶³è‡ªåŠ¨é˜»å¡ï¼Œé˜Ÿåˆ—å®¹é‡ä¸º 0 è‡ªåŠ¨é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - LinkedBlockingQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * é˜»å¡å®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * put &amp; take - è‡ªåŠ¨é˜»å¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * putè‡ªåŠ¨é˜»å¡ï¼Œ é˜Ÿåˆ—å®¹é‡æ»¡åï¼Œè‡ªåŠ¨é˜»å¡</span></span><br><span class=\"line\"><span class=\"comment\"> * takeè‡ªåŠ¨é˜»å¡æ–¹æ³•ï¼Œ é˜Ÿåˆ—å®¹é‡ä¸º0åï¼Œè‡ªåŠ¨é˜»å¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.LinkedBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_04_LinkedBlockingQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">final</span> BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_04_LinkedBlockingQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_04_LinkedBlockingQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        t.queue.put(<span class=\"string\">&quot;value&quot;</span> + t.r.nextInt(<span class=\"number\">1000</span>));</span><br><span class=\"line\">                        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;producer&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            System.out.println(Thread.currentThread().getName() +</span><br><span class=\"line\">                                    <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;consumer&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-ArrayBlockingQueue\"><a href=\"#3-3-ArrayBlockingQueue\" class=\"headerlink\" title=\"3.3 ArrayBlockingQueue\"></a>3.3 ArrayBlockingQueue</h3><p>åº•å±‚æ•°ç»„å®ç°çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚è‡ªåŠ¨é˜»å¡ã€‚æ ¹æ®è°ƒç”¨ API(add&#x2F;put&#x2F;offer)ä¸åŒï¼Œæœ‰ä¸åŒç‰¹æ€§ã€‚<br>å½“å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œæœ‰é˜»å¡èƒ½åŠ›ã€‚<br>add æ–¹æ³•ï¼šåœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚put æ–¹æ³•åœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ç­‰å¾…ã€‚<br>offer æ–¹æ³•ï¼šå•å‚æ•° offer æ–¹æ³•ï¼Œä¸é˜»å¡ã€‚å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œè¿”å› falseã€‚å½“å‰æ–°å¢æ•°æ®æ“ä½œæ”¾å¼ƒã€‚ ä¸‰å‚æ•° offer æ–¹æ³•(offer(value,times,timeunit))ï¼Œå®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ times æ—¶é•¿(å•ä½ä¸º timeunit)ï¼Œå¦‚æœåœ¨é˜»å¡æ—¶é•¿å†…ï¼Œæœ‰å®¹é‡ç©ºé—²ï¼Œæ–°å¢æ•°æ®è¿”å› trueã€‚å¦‚æœé˜»å¡æ—¶é•¿èŒƒå›´å†…ï¼Œæ— å®¹é‡ç©ºé—²ï¼Œæ”¾å¼ƒæ–°å¢æ•°æ®ï¼Œè¿”å› falseã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - ArrayBlockingQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * æœ‰ç•Œå®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_05_ArrayBlockingQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">final</span> BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_05_ArrayBlockingQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_05_ArrayBlockingQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(&quot;add method : &quot; + t.queue.add(&quot;value&quot;+i));</span></span><br><span class=\"line\">            <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                t.queue.put(&quot;put&quot;+i);</span></span><br><span class=\"line\"><span class=\"comment\">            &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            System.out.println(&quot;put method : &quot; + i);*/</span></span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(&quot;offer method : &quot; + t.queue.offer(&quot;value&quot;+i));</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;offer method : &quot;</span> +</span><br><span class=\"line\">                        t.queue.offer(<span class=\"string\">&quot;value&quot;</span> + i, <span class=\"number\">1</span>, TimeUnit.SECONDS));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(t.queue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-4-DelayQueue\"><a href=\"#3-4-DelayQueue\" class=\"headerlink\" title=\"3.4 DelayQueue\"></a>3.4 DelayQueue</h3><p>å»¶æ—¶é˜Ÿåˆ—ã€‚æ ¹æ®æ¯”è¾ƒæœºåˆ¶ï¼Œå®ç°è‡ªå®šä¹‰å¤„ç†é¡ºåºçš„é˜Ÿåˆ—ã€‚å¸¸ç”¨äºå®šæ—¶ä»»åŠ¡ã€‚<br>å¦‚:å®šæ—¶å…³æœºã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - DelayQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * æ— ç•Œå®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.DelayQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Delayed;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_06_DelayQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> BlockingQueue&lt;MyTask_06&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">DelayQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">2000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">3000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">2500</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">1500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        queue.put(task1);</span><br><span class=\"line\">        queue.put(task2);</span><br><span class=\"line\">        queue.put(task3);</span><br><span class=\"line\">        queue.put(task4);</span><br><span class=\"line\">        queue.put(task5);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(queue);</span><br><span class=\"line\">        System.out.println(value);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            System.out.println(queue.take());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyTask_06</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Delayed</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">long</span> compareValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyTask_06</span><span class=\"params\">(<span class=\"type\">long</span> compareValue)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.compareValue = compareValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ¯”è¾ƒå¤§å°ã€‚è‡ªåŠ¨å®ç°å‡åº</span></span><br><span class=\"line\"><span class=\"comment\">     * å»ºè®®å’ŒgetDelayæ–¹æ³•é…åˆå®Œæˆã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * å¦‚æœåœ¨DelayQueueæ˜¯éœ€è¦æŒ‰æ—¶é—´å®Œæˆçš„è®¡åˆ’ä»»åŠ¡ï¼Œå¿…é¡»é…åˆgetDelayæ–¹æ³•å®Œæˆã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compareTo</span><span class=\"params\">(Delayed o)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"type\">int</span>) (<span class=\"built_in\">this</span>.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–è®¡åˆ’æ—¶é•¿çš„æ–¹æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * æ ¹æ®å‚æ•°TimeUnitæ¥å†³å®šï¼Œå¦‚ä½•è¿”å›ç»“æœå€¼ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unit.convert(compareValue - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Task compare value is : &quot;</span> + <span class=\"built_in\">this</span>.compareValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-5-LinkedTransferQueue\"><a href=\"#3-5-LinkedTransferQueue\" class=\"headerlink\" title=\"3.5 LinkedTransferQueue\"></a>3.5 LinkedTransferQueue</h3><p>è½¬ç§»é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º 0 çš„é˜Ÿåˆ—ã€‚ä½¿ç”¨ transfer æ–¹æ³•ï¼Œå®ç°æ•°æ®çš„å³æ—¶å¤„ç†ã€‚æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œå°±é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - LinkedTransferQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * è½¬ç§»é˜Ÿåˆ—</span></span><br><span class=\"line\"><span class=\"comment\"> * add - é˜Ÿåˆ—ä¼šä¿å­˜æ•°æ®ï¼Œä¸åšé˜»å¡ç­‰å¾…ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * transfer - æ˜¯TransferQueueçš„ç‰¹æœ‰æ–¹æ³•ã€‚å¿…é¡»æœ‰æ¶ˆè´¹è€…ï¼ˆtake()æ–¹æ³•çš„è°ƒç”¨è€…ï¼‰ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * å¦‚æœæ²¡æœ‰ä»»æ„çº¿ç¨‹æ¶ˆè´¹æ•°æ®ï¼Œtransferæ–¹æ³•é˜»å¡ã€‚ä¸€èˆ¬ç”¨äºå¤„ç†å³æ—¶æ¶ˆæ¯ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.LinkedTransferQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TransferQueue;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_07_TransferQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    TransferQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedTransferQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_07_TransferQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_07_TransferQueue</span>();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">/*new Thread(new Runnable() &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            @Override</span></span><br><span class=\"line\"><span class=\"comment\">            public void run() &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(Thread.currentThread().getName() + &quot; thread begin &quot; );</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(Thread.currentThread().getName() + &quot; - &quot; + t.queue.take());</span></span><br><span class=\"line\"><span class=\"comment\">                &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                    e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">                &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;, &quot;output thread&quot;).start();</span></span><br><span class=\"line\"><span class=\"comment\">        </span></span><br><span class=\"line\"><span class=\"comment\">        try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            TimeUnit.SECONDS.sleep(2);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        </span></span><br><span class=\"line\"><span class=\"comment\">        try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            t.queue.transfer(&quot;test string&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    t.queue.transfer(<span class=\"string\">&quot;test string&quot;</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// t.queue.add(&quot;test string&quot;);</span></span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;add ok&quot;</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; thread begin &quot;</span>);</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;output thread&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-6-SynchronusQueue\"><a href=\"#3-6-SynchronusQueue\" class=\"headerlink\" title=\"3.6 SynchronusQueue\"></a>3.6 SynchronusQueue</h3><p>åŒæ­¥é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º0çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„TransferQueueã€‚å¿…é¡»ç°æœ‰æ¶ˆè´¹çº¿ç¨‹ç­‰å¾…ï¼Œæ‰èƒ½ä½¿ç”¨çš„é˜Ÿåˆ—ã€‚<br>add æ–¹æ³•ï¼Œæ— é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<br>put æ–¹æ³•ï¼Œæœ‰é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - SynchronousQueue</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.SynchronousQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_08_SynchronusQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_08_SynchronusQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_08_SynchronusQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; thread begin &quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;output thread&quot;</span>).start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            TimeUnit.SECONDS.sleep(3);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;*/</span></span><br><span class=\"line\">        <span class=\"comment\">// t.queue.add(&quot;test add&quot;);</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            t.queue.put(<span class=\"string\">&quot;test put&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; queue size : &quot;</span> + t.queue.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<p>è§£å†³å¹¶å‘æƒ…å†µä¸‹çš„å®¹å™¨çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ã€‚ç»™å¤šçº¿ç¨‹ç¯å¢ƒå‡†å¤‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡ã€‚<br>çº¿ç¨‹å®‰å…¨çš„å®¹å™¨å¯¹è±¡: Vector, Hashtableã€‚çº¿ç¨‹å®‰å…¨å®¹å™¨å¯¹è±¡ï¼Œéƒ½æ˜¯ä½¿ç”¨synchronized æ–¹æ³•å®ç°çš„ã€‚concurrentåŒ…ä¸­çš„åŒæ­¥å®¹å™¨ï¼Œå¤§å¤šæ•°æ˜¯ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çš„çº¿ç¨‹å®‰å…¨ã€‚ç±»ä¼¼nativeã€‚Java8 ä¸­ä½¿ç”¨ CASã€‚</p>\n<h2 id=\"1ã€Map-Set\"><a href=\"#1ã€Map-Set\" class=\"headerlink\" title=\"1ã€Map&#x2F;Set\"></a>1ã€Map&#x2F;Set</h2><h3 id=\"1-1-ConcurrentHashMap-ConcurrentHashSet\"><a href=\"#1-1-ConcurrentHashMap-ConcurrentHashSet\" class=\"headerlink\" title=\"1.1 ConcurrentHashMap&#x2F;ConcurrentHashSet\"></a>1.1 ConcurrentHashMap&#x2F;ConcurrentHashSet</h3><p>åº•å±‚å“ˆå¸Œå®ç°çš„åŒæ­¥ Map(Set)ã€‚æ•ˆç‡é«˜ï¼Œçº¿ç¨‹å®‰å…¨ã€‚ä½¿ç”¨ç³»ç»Ÿåº•å±‚æŠ€æœ¯å®ç°çº¿ç¨‹å®‰å…¨ã€‚ é‡çº§è¾ƒ synchronized ä½ã€‚key å’Œ value ä¸èƒ½ä¸º nullã€‚</p>\n<h3 id=\"1-2-ConcurrentSkipListMap-ConcurrentSkipListSet\"><a href=\"#1-2-ConcurrentSkipListMap-ConcurrentSkipListSet\" class=\"headerlink\" title=\"1.2 ConcurrentSkipListMap&#x2F;ConcurrentSkipListSet\"></a>1.2 ConcurrentSkipListMap&#x2F;ConcurrentSkipListSet</h3><p>åº•å±‚è·³è¡¨(SkipList)å®ç°çš„åŒæ­¥ Map(Set)ã€‚æœ‰åºï¼Œæ•ˆç‡æ¯” ConcurrentHashMap ç¨ä½ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CountDownLatch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_01_ConcurrentMap</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\"><span class=\"comment\">//        final Map&lt;String, String&gt; map = new Hashtable&lt;&gt;();</span></span><br><span class=\"line\">         <span class=\"keyword\">final</span> Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class=\"line\">         <span class=\"comment\">//ConcurrentSkipListMapè·³è¡¨å®ç°çš„ï¼Œæ˜¯æ’åºçš„ï¼Œæœ€æ…¢</span></span><br><span class=\"line\"><span class=\"comment\">//         final Map&lt;String, String&gt; map = new ConcurrentSkipListMap&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">        Thread[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>[<span class=\"number\">100</span>];</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">CountDownLatch</span> <span class=\"variable\">latch</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">CountDownLatch</span>(array.length);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">begin</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">            array[i] = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">100000</span>; j++) &#123;</span><br><span class=\"line\">                        map.put(<span class=\"string\">&quot;key&quot;</span> + r.nextInt(<span class=\"number\">100000</span>), <span class=\"string\">&quot;value&quot;</span> + r.nextInt(<span class=\"number\">100000</span>));</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Thread t : array) &#123;</span><br><span class=\"line\">            t.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            latch.await();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‰§è¡Œæ—¶é—´ä¸º ï¼š &quot;</span> + (end - begin) + <span class=\"string\">&quot;æ¯«ç§’ï¼&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2ã€List\"><a href=\"#2ã€List\" class=\"headerlink\" title=\"2ã€List\"></a>2ã€List</h2><h3 id=\"2-1-CopyOnWriteArrayList\"><a href=\"#2-1-CopyOnWriteArrayList\" class=\"headerlink\" title=\"2.1 CopyOnWriteArrayList\"></a>2.1 CopyOnWriteArrayList</h3><p>å†™æ—¶å¤åˆ¶é›†åˆã€‚å†™å…¥æ•ˆç‡ä½ï¼Œè¯»å–æ•ˆç‡é«˜ã€‚æ¯æ¬¡å†™å…¥æ•°æ®ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CountDownLatch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_02_CopyOnWriteList</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">         <span class=\"keyword\">final</span> List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\"><span class=\"comment\">//         final List&lt;String&gt; list = new Vector&lt;&gt;();</span></span><br><span class=\"line\"><span class=\"comment\">//        final List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;();</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">        Thread[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>[<span class=\"number\">100</span>];</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">CountDownLatch</span> <span class=\"variable\">latch</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">CountDownLatch</span>(array.length);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">begin</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; array.length; i++) &#123;</span><br><span class=\"line\">            array[i] = <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; <span class=\"number\">1000</span>; j++) &#123;</span><br><span class=\"line\">                        list.add(<span class=\"string\">&quot;value&quot;</span> + r.nextInt(<span class=\"number\">100000</span>));</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Thread t : array) &#123;</span><br><span class=\"line\">            t.start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            latch.await();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;æ‰§è¡Œæ—¶é—´ä¸º ï¼š &quot;</span> + (end - begin) + <span class=\"string\">&quot;æ¯«ç§’ï¼&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;List.size() : &quot;</span> + list.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3ã€Queue\"><a href=\"#3ã€Queue\" class=\"headerlink\" title=\"3ã€Queue\"></a>3ã€Queue</h2><h3 id=\"3-1-ConcurrentLinkedQueue\"><a href=\"#3-1-ConcurrentLinkedQueue\" class=\"headerlink\" title=\"3.1 ConcurrentLinkedQueue\"></a>3.1 ConcurrentLinkedQueue</h3><p>åŸºç¡€é“¾è¡¨åŒæ­¥é˜Ÿåˆ—ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - ConcurrentLinkedQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * é˜Ÿåˆ— - é“¾è¡¨å®ç°çš„ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Queue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ConcurrentLinkedQueue;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_03_ConcurrentLinkedQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Queue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ConcurrentLinkedQueue</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; i++) &#123;</span><br><span class=\"line\">            queue.offer(<span class=\"string\">&quot;value&quot;</span> + i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(queue);</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// peek() -&gt; æŸ¥çœ‹queueä¸­çš„é¦–æ•°æ®</span></span><br><span class=\"line\">        System.out.println(queue.peek());</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// poll() -&gt; è·å–queueä¸­çš„é¦–æ•°æ®</span></span><br><span class=\"line\">        System.out.println(queue.poll());</span><br><span class=\"line\">        System.out.println(queue.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-2-LinkedBlockingQueue\"><a href=\"#3-2-LinkedBlockingQueue\" class=\"headerlink\" title=\"3.2 LinkedBlockingQueue\"></a>3.2 LinkedBlockingQueue</h3><p>é˜»å¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å®¹é‡ä¸è¶³è‡ªåŠ¨é˜»å¡ï¼Œé˜Ÿåˆ—å®¹é‡ä¸º 0 è‡ªåŠ¨é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - LinkedBlockingQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * é˜»å¡å®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * put &amp; take - è‡ªåŠ¨é˜»å¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * putè‡ªåŠ¨é˜»å¡ï¼Œ é˜Ÿåˆ—å®¹é‡æ»¡åï¼Œè‡ªåŠ¨é˜»å¡</span></span><br><span class=\"line\"><span class=\"comment\"> * takeè‡ªåŠ¨é˜»å¡æ–¹æ³•ï¼Œ é˜Ÿåˆ—å®¹é‡ä¸º0åï¼Œè‡ªåŠ¨é˜»å¡ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Random;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.LinkedBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_04_LinkedBlockingQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">final</span> BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedBlockingQueue</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"type\">Random</span> <span class=\"variable\">r</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_04_LinkedBlockingQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_04_LinkedBlockingQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        t.queue.put(<span class=\"string\">&quot;value&quot;</span> + t.r.nextInt(<span class=\"number\">1000</span>));</span><br><span class=\"line\">                        TimeUnit.SECONDS.sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;producer&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            System.out.println(Thread.currentThread().getName() +</span><br><span class=\"line\">                                    <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                            e.printStackTrace();</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;, <span class=\"string\">&quot;consumer&quot;</span> + i).start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-ArrayBlockingQueue\"><a href=\"#3-3-ArrayBlockingQueue\" class=\"headerlink\" title=\"3.3 ArrayBlockingQueue\"></a>3.3 ArrayBlockingQueue</h3><p>åº•å±‚æ•°ç»„å®ç°çš„æœ‰ç•Œé˜Ÿåˆ—ã€‚è‡ªåŠ¨é˜»å¡ã€‚æ ¹æ®è°ƒç”¨ API(add&#x2F;put&#x2F;offer)ä¸åŒï¼Œæœ‰ä¸åŒç‰¹æ€§ã€‚<br>å½“å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œæœ‰é˜»å¡èƒ½åŠ›ã€‚<br>add æ–¹æ³•ï¼šåœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚put æ–¹æ³•åœ¨å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ç­‰å¾…ã€‚<br>offer æ–¹æ³•ï¼šå•å‚æ•° offer æ–¹æ³•ï¼Œä¸é˜»å¡ã€‚å®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œè¿”å› falseã€‚å½“å‰æ–°å¢æ•°æ®æ“ä½œæ”¾å¼ƒã€‚ ä¸‰å‚æ•° offer æ–¹æ³•(offer(value,times,timeunit))ï¼Œå®¹é‡ä¸è¶³çš„æ—¶å€™ï¼Œé˜»å¡ times æ—¶é•¿(å•ä½ä¸º timeunit)ï¼Œå¦‚æœåœ¨é˜»å¡æ—¶é•¿å†…ï¼Œæœ‰å®¹é‡ç©ºé—²ï¼Œæ–°å¢æ•°æ®è¿”å› trueã€‚å¦‚æœé˜»å¡æ—¶é•¿èŒƒå›´å†…ï¼Œæ— å®¹é‡ç©ºé—²ï¼Œæ”¾å¼ƒæ–°å¢æ•°æ®ï¼Œè¿”å› falseã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - ArrayBlockingQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * æœ‰ç•Œå®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_05_ArrayBlockingQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">final</span> BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayBlockingQueue</span>&lt;&gt;(<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_05_ArrayBlockingQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_05_ArrayBlockingQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(&quot;add method : &quot; + t.queue.add(&quot;value&quot;+i));</span></span><br><span class=\"line\">            <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                t.queue.put(&quot;put&quot;+i);</span></span><br><span class=\"line\"><span class=\"comment\">            &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            System.out.println(&quot;put method : &quot; + i);*/</span></span><br><span class=\"line\">            <span class=\"comment\">// System.out.println(&quot;offer method : &quot; + t.queue.offer(&quot;value&quot;+i));</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;offer method : &quot;</span> +</span><br><span class=\"line\">                        t.queue.offer(<span class=\"string\">&quot;value&quot;</span> + i, <span class=\"number\">1</span>, TimeUnit.SECONDS));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(t.queue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-4-DelayQueue\"><a href=\"#3-4-DelayQueue\" class=\"headerlink\" title=\"3.4 DelayQueue\"></a>3.4 DelayQueue</h3><p>å»¶æ—¶é˜Ÿåˆ—ã€‚æ ¹æ®æ¯”è¾ƒæœºåˆ¶ï¼Œå®ç°è‡ªå®šä¹‰å¤„ç†é¡ºåºçš„é˜Ÿåˆ—ã€‚å¸¸ç”¨äºå®šæ—¶ä»»åŠ¡ã€‚<br>å¦‚:å®šæ—¶å…³æœºã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - DelayQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * æ— ç•Œå®¹å™¨ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.DelayQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Delayed;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_06_DelayQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> BlockingQueue&lt;MyTask_06&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">DelayQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">2000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">1000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">3000</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">2500</span>);</span><br><span class=\"line\">        <span class=\"type\">MyTask_06</span> <span class=\"variable\">task5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyTask_06</span>(value + <span class=\"number\">1500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        queue.put(task1);</span><br><span class=\"line\">        queue.put(task2);</span><br><span class=\"line\">        queue.put(task3);</span><br><span class=\"line\">        queue.put(task4);</span><br><span class=\"line\">        queue.put(task5);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(queue);</span><br><span class=\"line\">        System.out.println(value);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++) &#123;</span><br><span class=\"line\">            System.out.println(queue.take());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">MyTask_06</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Delayed</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">long</span> compareValue;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyTask_06</span><span class=\"params\">(<span class=\"type\">long</span> compareValue)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.compareValue = compareValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ¯”è¾ƒå¤§å°ã€‚è‡ªåŠ¨å®ç°å‡åº</span></span><br><span class=\"line\"><span class=\"comment\">     * å»ºè®®å’ŒgetDelayæ–¹æ³•é…åˆå®Œæˆã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * å¦‚æœåœ¨DelayQueueæ˜¯éœ€è¦æŒ‰æ—¶é—´å®Œæˆçš„è®¡åˆ’ä»»åŠ¡ï¼Œå¿…é¡»é…åˆgetDelayæ–¹æ³•å®Œæˆã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">compareTo</span><span class=\"params\">(Delayed o)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"type\">int</span>) (<span class=\"built_in\">this</span>.getDelay(TimeUnit.MILLISECONDS) - o.getDelay(TimeUnit.MILLISECONDS));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–è®¡åˆ’æ—¶é•¿çš„æ–¹æ³•ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     * æ ¹æ®å‚æ•°TimeUnitæ¥å†³å®šï¼Œå¦‚ä½•è¿”å›ç»“æœå€¼ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">long</span> <span class=\"title function_\">getDelay</span><span class=\"params\">(TimeUnit unit)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unit.convert(compareValue - System.currentTimeMillis(), TimeUnit.MILLISECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Task compare value is : &quot;</span> + <span class=\"built_in\">this</span>.compareValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-5-LinkedTransferQueue\"><a href=\"#3-5-LinkedTransferQueue\" class=\"headerlink\" title=\"3.5 LinkedTransferQueue\"></a>3.5 LinkedTransferQueue</h3><p>è½¬ç§»é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º 0 çš„é˜Ÿåˆ—ã€‚ä½¿ç”¨ transfer æ–¹æ³•ï¼Œå®ç°æ•°æ®çš„å³æ—¶å¤„ç†ã€‚æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œå°±é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - LinkedTransferQueue</span></span><br><span class=\"line\"><span class=\"comment\"> * è½¬ç§»é˜Ÿåˆ—</span></span><br><span class=\"line\"><span class=\"comment\"> * add - é˜Ÿåˆ—ä¼šä¿å­˜æ•°æ®ï¼Œä¸åšé˜»å¡ç­‰å¾…ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * transfer - æ˜¯TransferQueueçš„ç‰¹æœ‰æ–¹æ³•ã€‚å¿…é¡»æœ‰æ¶ˆè´¹è€…ï¼ˆtake()æ–¹æ³•çš„è°ƒç”¨è€…ï¼‰ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> * å¦‚æœæ²¡æœ‰ä»»æ„çº¿ç¨‹æ¶ˆè´¹æ•°æ®ï¼Œtransferæ–¹æ³•é˜»å¡ã€‚ä¸€èˆ¬ç”¨äºå¤„ç†å³æ—¶æ¶ˆæ¯ã€‚</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.LinkedTransferQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TransferQueue;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_07_TransferQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    TransferQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedTransferQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_07_TransferQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_07_TransferQueue</span>();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">/*new Thread(new Runnable() &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            @Override</span></span><br><span class=\"line\"><span class=\"comment\">            public void run() &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(Thread.currentThread().getName() + &quot; thread begin &quot; );</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(Thread.currentThread().getName() + &quot; - &quot; + t.queue.take());</span></span><br><span class=\"line\"><span class=\"comment\">                &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                    e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">                &#125;</span></span><br><span class=\"line\"><span class=\"comment\">            &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;, &quot;output thread&quot;).start();</span></span><br><span class=\"line\"><span class=\"comment\">        </span></span><br><span class=\"line\"><span class=\"comment\">        try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            TimeUnit.SECONDS.sleep(2);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;</span></span><br><span class=\"line\"><span class=\"comment\">        </span></span><br><span class=\"line\"><span class=\"comment\">        try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            t.queue.transfer(&quot;test string&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    t.queue.transfer(<span class=\"string\">&quot;test string&quot;</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// t.queue.add(&quot;test string&quot;);</span></span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;add ok&quot;</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;).start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; thread begin &quot;</span>);</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;output thread&quot;</span>).start();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-6-SynchronusQueue\"><a href=\"#3-6-SynchronusQueue\" class=\"headerlink\" title=\"3.6 SynchronusQueue\"></a>3.6 SynchronusQueue</h3><p>åŒæ­¥é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå®¹é‡ä¸º0çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„TransferQueueã€‚å¿…é¡»ç°æœ‰æ¶ˆè´¹çº¿ç¨‹ç­‰å¾…ï¼Œæ‰èƒ½ä½¿ç”¨çš„é˜Ÿåˆ—ã€‚<br>add æ–¹æ³•ï¼Œæ— é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<br>put æ–¹æ³•ï¼Œæœ‰é˜»å¡ã€‚è‹¥æ²¡æœ‰æ¶ˆè´¹çº¿ç¨‹é˜»å¡ç­‰å¾…æ•°æ®ï¼Œåˆ™é˜»å¡ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * å¹¶å‘å®¹å™¨ - SynchronousQueue</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.BlockingQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.SynchronousQueue;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test_08_SynchronusQueue</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    BlockingQueue&lt;String&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">SynchronousQueue</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"type\">Test_08_SynchronusQueue</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Test_08_SynchronusQueue</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Runnable</span>() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; thread begin &quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        TimeUnit.SECONDS.sleep(<span class=\"number\">2</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                        e.printStackTrace();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; - &quot;</span> + t.queue.take());</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;output thread&quot;</span>).start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">/*try &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            TimeUnit.SECONDS.sleep(3);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125; catch (InterruptedException e) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            e.printStackTrace();</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;*/</span></span><br><span class=\"line\">        <span class=\"comment\">// t.queue.add(&quot;test add&quot;);</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            t.queue.put(<span class=\"string\">&quot;test put&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot; queue size : &quot;</span> + t.queue.size());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Linuxç¯å¢ƒä¸‹éƒ¨ç½²node.jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†","date":"2023-12-21T03:43:52.000Z","_content":"\n> node.jsæ˜¯è®©JavaScriptèƒ½è¿è¡Œåœ¨æœåŠ¡ç«¯çš„å¼€å‘å¹³å°ï¼Œpm2æ˜¯ä¸€ä¸ªNode.js å®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨äºç®¡ç†å’Œç›‘æ§Node.js åº”ç”¨ç¨‹åºã€‚\n\n## ä¸€ã€å®‰è£…nodeç¯å¢ƒ\n\n### 1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ <[https://nodejs.org/en/download/current/](https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdownload%2Fcurrent%2F&source=article&objectId=1772306)\n\n- é€šè¿‡wgetæŒ‡ä»¤ä¸‹è½½ï¼š`wget https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz`\n\n- è§£å‹ï¼š`tar -xvf node-v13.11.0-linux-x64.tar.xz`\n- æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸï¼š`cd node-v13.11.0-linux-x64/bin`ï¼Œæ‰§è¡Œï¼š`./node -v`\n\n\n\n### 2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆ**PS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥**ï¼‰ï¼š\n\n- `ln -s /www/node-v13.11.0-linux-x64/bin/node /usr/local/bin/node`\n- `ln -s /www/node-v13.11.0-linux-x64/bin/npm /usr/local/bin/npm`\n\n\n\n### 2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼š`mv node-v13.11.0-linux-x64 /usr/local/node`\n\nå†ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š\n\n```xml\nvim /etc/profile\n\næŒ‰ä½ié”®ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼\n\næ’å…¥ï¼šexport PATH=$PATH:/usr/local/node/bin\n\næŒ‰esc,è¾“å…¥:wqï¼Œé€€å‡ºvimç¼–è¾‘å™¨æ¨¡å¼\n```\n\n\n\n### 3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼š`node -v`å’Œ`npm -v`\n\n\n\n### 4.åŠ é€Ÿnpm\n\n- ä½¿ç”¨æ·˜å®çš„cnpmï¼š`npm install cnpm -g --registry=https://registry.npm.taobao.org`\n- åŠ cnpmè½¯é“¾ï¼š`ln -s /www/node-v13.11.0-linux-x64/bin/cnpm /usr/local/bin/cnpm`\n- éœ€è¦æ³¨æ„ï¼Œä»¥åä½¿ç”¨cnpmå»ä»£æ›¿npmæ¥æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š`cnpm install XXX`\n\n\n\n## äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\n\n> PM2 æ˜¯ä¸€ä¸ªæµè¡Œçš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åå°è¿è¡Œ nodejs çš„é¦–é€‰ã€‚å®ƒæä¾›äº†å¾ˆå¤šçš„åŠŸèƒ½å’Œé€‰é¡¹ï¼ŒåŒ…æ‹¬è¿›ç¨‹ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å¹³è¡¡ç­‰ç­‰ã€‚ä½¿ç”¨ PM2 åï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å°† nodejs åº”ç”¨ç¨‹åºåå°è¿è¡Œã€‚\n\n\n\n### 1.å®‰è£…pm2ï¼š`npm install -g pm2`\n\n\n\n### 2.æ·»åŠ pm2è½¯é“¾ï¼š`ln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/`\n\n\n\n### 3.pm2å¸¸ç”¨å‘½ä»¤ï¼š\n\n- å¯åŠ¨æŒ‡å®šåº”ç”¨ï¼š`pm2 start <script_file|config_file> [options]` ï¼Œå¦‚ï¼š`pm2 start index.js --name httpServer`\n\n- åœæ­¢æŒ‡å®šåº”ç”¨ï¼š`pm2 stop <appName> [options]`ï¼Œå¦‚ï¼š`pm2 stop httpServer`\n\n- æŸ¥çœ‹å…¨éƒ¨å®ä¾‹ï¼š`pm2 list` ï¼Œæ³¨æ„ï¼špm2 stop æŸä¸ªé¡¹ç›®åï¼Œè¯¥é¡¹ç›®è¿˜ä¼šå­˜åœ¨pm2 list çš„åˆ—è¡¨é‡Œé¢ï¼Œ åªæ˜¯çŠ¶æ€æ˜¯ stop, è¦æƒ³å»æ‰è¯¥é¡¹ç›®ï¼Œç”¨pm2 delete\n\n- é‡å¯æŒ‡å®šåº”ç”¨ï¼š`pm2 reload|restart <appName> [options]`ï¼Œå¦‚ï¼š`pm2 restart httpServer`\n\n- æ˜¾ç¤ºæŒ‡å®šåº”ç”¨è¯¦æƒ…ï¼š`pm2 show <appName> [options]`ï¼Œå¦‚ï¼š`pm2 show httpServer`\n\n- åˆ é™¤æŒ‡å®šåº”ç”¨ï¼š`pm2 delete <appName> [options]`ï¼Œå¦‚ï¼š`pm2 delete httpServer`ï¼Œå¦‚æœä¿®æ”¹åº”ç”¨é…ç½®è¡Œä¸ºï¼Œæœ€å¥½å…ˆåˆ é™¤åº”ç”¨åï¼Œé‡æ–°å¯åŠ¨æ–¹æ‰ç”Ÿæ•ˆï¼Œå¦‚ä¿®æ”¹è„šæœ¬å…¥å£æ–‡ä»¶\n\n- æ€æ‰pm2ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹ï¼š`pm2 kill` \n\n- åˆ é™¤pm2æ—¥å¿—ï¼š`pm2 flush`\n\n- æŸ¥çœ‹æŒ‡å®šåº”ç”¨çš„æ—¥å¿—ï¼Œå³æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯`pm2 logs <appName>`\n\n- ç›‘æ§å„ä¸ªåº”ç”¨è¿›ç¨‹cpuå’Œmemoryä½¿ç”¨æƒ…å†µ`pm2 monit`\n\n- å¦‚æœé¡¹ç›®æ²¡æœ‰å¯åŠ¨å°±æ‰§è¡Œ start å¦‚æœé¡¹ç›®æ­£åœ¨è¿è¡Œ å°±æ‰§è¡Œrelaod`pm2 startOrReload <appName>`\n\n\n## ä¸‰ã€è¸©å‘è®°å½•\n\n1. 2024-1-3ï¼šè¯•å›¾åœ¨æœåŠ¡å™¨ä¸Šé¢å®‰è£…node.js18ï¼ŒæŸ¥çœ‹nodeç‰ˆæœ¬çš„æ—¶å€™å‘ç”ŸæŠ¥é”™ï¼š\n\n![image-20240103185224803](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185224803.png)\n\næœç´¢èµ„æ–™å‘ç°æ˜¯å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸æ”¯æŒé«˜ç‰ˆæœ¬çš„node.jsï¼ŒæŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼š\n\n![image-20240103185613533](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185613533.png)\n\n**è§£å†³åŠæ³•é™çº§åˆ°node.js16...**\n\n**å‚è€ƒæ–‡ç« ï¼š**https://juejin.cn/post/7163899309425950751\n\n\n2. 2024-10-18ï¼šåœ¨æœåŠ¡å™¨è¿è¡Œpm2 start index.jså‘½ä»¤æŠ¥é”™\n\né¡¹ç›®åœ¨scriptsé…ç½®è¿è¡Œç¯å¢ƒï¼Œæ— æ³•ç›´æ¥é€šè¿‡è¿è¡Œjsæ–‡ä»¶å¯åŠ¨æœåŠ¡ã€‚\n\nå¯é€šè¿‡pm2å¯åŠ¨ä½ çš„npmè„šæœ¬\n```\npm2 start npm --name \"ä½ çš„åº”ç”¨å\" -- run start\n```\nä¹Ÿå¯ä»¥ä½¿ç”¨pm2å¯åŠ¨pythonè„šæœ¬\n```\npm2 start python3 --name \"ä½ çš„åº”ç”¨å\" -- main.py\n```\n\nè¿™é‡Œçš„--nameå‚æ•°æ˜¯ç»™ä½ çš„åº”ç”¨è®¾ç½®ä¸€ä¸ªåå­—ï¼Œ-- run startæ˜¯å‘Šè¯‰pm2è¿è¡Œpackage.jsonä¸­å®šä¹‰çš„startè„šæœ¬ã€‚\n\nå¦‚æœä½ çš„npmè„šæœ¬æ˜¯ç”¨æ¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆ--nameå‚æ•°éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·ä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€æˆ–è€…é‡å¯æœåŠ¡ã€‚\n\n\n","source":"_posts/Linuxç¯å¢ƒä¸‹éƒ¨ç½²node-jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†.md","raw":"---\ntitle: Linuxç¯å¢ƒä¸‹éƒ¨ç½²node.jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†\ndate: 2023-12-21 11:43:52\ntags:\n---\n\n> node.jsæ˜¯è®©JavaScriptèƒ½è¿è¡Œåœ¨æœåŠ¡ç«¯çš„å¼€å‘å¹³å°ï¼Œpm2æ˜¯ä¸€ä¸ªNode.js å®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨äºç®¡ç†å’Œç›‘æ§Node.js åº”ç”¨ç¨‹åºã€‚\n\n## ä¸€ã€å®‰è£…nodeç¯å¢ƒ\n\n### 1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ <[https://nodejs.org/en/download/current/](https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdownload%2Fcurrent%2F&source=article&objectId=1772306)\n\n- é€šè¿‡wgetæŒ‡ä»¤ä¸‹è½½ï¼š`wget https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz`\n\n- è§£å‹ï¼š`tar -xvf node-v13.11.0-linux-x64.tar.xz`\n- æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸï¼š`cd node-v13.11.0-linux-x64/bin`ï¼Œæ‰§è¡Œï¼š`./node -v`\n\n\n\n### 2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆ**PS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥**ï¼‰ï¼š\n\n- `ln -s /www/node-v13.11.0-linux-x64/bin/node /usr/local/bin/node`\n- `ln -s /www/node-v13.11.0-linux-x64/bin/npm /usr/local/bin/npm`\n\n\n\n### 2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼š`mv node-v13.11.0-linux-x64 /usr/local/node`\n\nå†ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š\n\n```xml\nvim /etc/profile\n\næŒ‰ä½ié”®ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼\n\næ’å…¥ï¼šexport PATH=$PATH:/usr/local/node/bin\n\næŒ‰esc,è¾“å…¥:wqï¼Œé€€å‡ºvimç¼–è¾‘å™¨æ¨¡å¼\n```\n\n\n\n### 3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼š`node -v`å’Œ`npm -v`\n\n\n\n### 4.åŠ é€Ÿnpm\n\n- ä½¿ç”¨æ·˜å®çš„cnpmï¼š`npm install cnpm -g --registry=https://registry.npm.taobao.org`\n- åŠ cnpmè½¯é“¾ï¼š`ln -s /www/node-v13.11.0-linux-x64/bin/cnpm /usr/local/bin/cnpm`\n- éœ€è¦æ³¨æ„ï¼Œä»¥åä½¿ç”¨cnpmå»ä»£æ›¿npmæ¥æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š`cnpm install XXX`\n\n\n\n## äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\n\n> PM2 æ˜¯ä¸€ä¸ªæµè¡Œçš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åå°è¿è¡Œ nodejs çš„é¦–é€‰ã€‚å®ƒæä¾›äº†å¾ˆå¤šçš„åŠŸèƒ½å’Œé€‰é¡¹ï¼ŒåŒ…æ‹¬è¿›ç¨‹ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å¹³è¡¡ç­‰ç­‰ã€‚ä½¿ç”¨ PM2 åï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å°† nodejs åº”ç”¨ç¨‹åºåå°è¿è¡Œã€‚\n\n\n\n### 1.å®‰è£…pm2ï¼š`npm install -g pm2`\n\n\n\n### 2.æ·»åŠ pm2è½¯é“¾ï¼š`ln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/`\n\n\n\n### 3.pm2å¸¸ç”¨å‘½ä»¤ï¼š\n\n- å¯åŠ¨æŒ‡å®šåº”ç”¨ï¼š`pm2 start <script_file|config_file> [options]` ï¼Œå¦‚ï¼š`pm2 start index.js --name httpServer`\n\n- åœæ­¢æŒ‡å®šåº”ç”¨ï¼š`pm2 stop <appName> [options]`ï¼Œå¦‚ï¼š`pm2 stop httpServer`\n\n- æŸ¥çœ‹å…¨éƒ¨å®ä¾‹ï¼š`pm2 list` ï¼Œæ³¨æ„ï¼špm2 stop æŸä¸ªé¡¹ç›®åï¼Œè¯¥é¡¹ç›®è¿˜ä¼šå­˜åœ¨pm2 list çš„åˆ—è¡¨é‡Œé¢ï¼Œ åªæ˜¯çŠ¶æ€æ˜¯ stop, è¦æƒ³å»æ‰è¯¥é¡¹ç›®ï¼Œç”¨pm2 delete\n\n- é‡å¯æŒ‡å®šåº”ç”¨ï¼š`pm2 reload|restart <appName> [options]`ï¼Œå¦‚ï¼š`pm2 restart httpServer`\n\n- æ˜¾ç¤ºæŒ‡å®šåº”ç”¨è¯¦æƒ…ï¼š`pm2 show <appName> [options]`ï¼Œå¦‚ï¼š`pm2 show httpServer`\n\n- åˆ é™¤æŒ‡å®šåº”ç”¨ï¼š`pm2 delete <appName> [options]`ï¼Œå¦‚ï¼š`pm2 delete httpServer`ï¼Œå¦‚æœä¿®æ”¹åº”ç”¨é…ç½®è¡Œä¸ºï¼Œæœ€å¥½å…ˆåˆ é™¤åº”ç”¨åï¼Œé‡æ–°å¯åŠ¨æ–¹æ‰ç”Ÿæ•ˆï¼Œå¦‚ä¿®æ”¹è„šæœ¬å…¥å£æ–‡ä»¶\n\n- æ€æ‰pm2ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹ï¼š`pm2 kill` \n\n- åˆ é™¤pm2æ—¥å¿—ï¼š`pm2 flush`\n\n- æŸ¥çœ‹æŒ‡å®šåº”ç”¨çš„æ—¥å¿—ï¼Œå³æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯`pm2 logs <appName>`\n\n- ç›‘æ§å„ä¸ªåº”ç”¨è¿›ç¨‹cpuå’Œmemoryä½¿ç”¨æƒ…å†µ`pm2 monit`\n\n- å¦‚æœé¡¹ç›®æ²¡æœ‰å¯åŠ¨å°±æ‰§è¡Œ start å¦‚æœé¡¹ç›®æ­£åœ¨è¿è¡Œ å°±æ‰§è¡Œrelaod`pm2 startOrReload <appName>`\n\n\n## ä¸‰ã€è¸©å‘è®°å½•\n\n1. 2024-1-3ï¼šè¯•å›¾åœ¨æœåŠ¡å™¨ä¸Šé¢å®‰è£…node.js18ï¼ŒæŸ¥çœ‹nodeç‰ˆæœ¬çš„æ—¶å€™å‘ç”ŸæŠ¥é”™ï¼š\n\n![image-20240103185224803](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185224803.png)\n\næœç´¢èµ„æ–™å‘ç°æ˜¯å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸æ”¯æŒé«˜ç‰ˆæœ¬çš„node.jsï¼ŒæŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼š\n\n![image-20240103185613533](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185613533.png)\n\n**è§£å†³åŠæ³•é™çº§åˆ°node.js16...**\n\n**å‚è€ƒæ–‡ç« ï¼š**https://juejin.cn/post/7163899309425950751\n\n\n2. 2024-10-18ï¼šåœ¨æœåŠ¡å™¨è¿è¡Œpm2 start index.jså‘½ä»¤æŠ¥é”™\n\né¡¹ç›®åœ¨scriptsé…ç½®è¿è¡Œç¯å¢ƒï¼Œæ— æ³•ç›´æ¥é€šè¿‡è¿è¡Œjsæ–‡ä»¶å¯åŠ¨æœåŠ¡ã€‚\n\nå¯é€šè¿‡pm2å¯åŠ¨ä½ çš„npmè„šæœ¬\n```\npm2 start npm --name \"ä½ çš„åº”ç”¨å\" -- run start\n```\nä¹Ÿå¯ä»¥ä½¿ç”¨pm2å¯åŠ¨pythonè„šæœ¬\n```\npm2 start python3 --name \"ä½ çš„åº”ç”¨å\" -- main.py\n```\n\nè¿™é‡Œçš„--nameå‚æ•°æ˜¯ç»™ä½ çš„åº”ç”¨è®¾ç½®ä¸€ä¸ªåå­—ï¼Œ-- run startæ˜¯å‘Šè¯‰pm2è¿è¡Œpackage.jsonä¸­å®šä¹‰çš„startè„šæœ¬ã€‚\n\nå¦‚æœä½ çš„npmè„šæœ¬æ˜¯ç”¨æ¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆ--nameå‚æ•°éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·ä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€æˆ–è€…é‡å¯æœåŠ¡ã€‚\n\n\n","slug":"Linuxç¯å¢ƒä¸‹éƒ¨ç½²node-jsé¡¹ç›®å¹¶ä½¿ç”¨pm2å¯¹é¡¹ç›®è¿›è¡Œç®¡ç†","published":1,"updated":"2024-11-14T07:09:15.427Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dk000gwen16ffb1d3o","content":"<blockquote>\n<p>node.jsæ˜¯è®©JavaScriptèƒ½è¿è¡Œåœ¨æœåŠ¡ç«¯çš„å¼€å‘å¹³å°ï¼Œpm2æ˜¯ä¸€ä¸ªNode.js å®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨äºç®¡ç†å’Œç›‘æ§Node.js åº”ç”¨ç¨‹åºã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€å®‰è£…nodeç¯å¢ƒ\"><a href=\"#ä¸€ã€å®‰è£…nodeç¯å¢ƒ\" class=\"headerlink\" title=\"ä¸€ã€å®‰è£…nodeç¯å¢ƒ\"></a>ä¸€ã€å®‰è£…nodeç¯å¢ƒ</h2><h3 id=\"1-å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½\"><a href=\"#1-å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½\" class=\"headerlink\" title=\"1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ &lt;https://nodejs.org/en/download/current/\"></a>1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ &lt;<a href=\"https://cloud.tencent.com/developer/tools/blog-entry?target=https://nodejs.org/en/download/current/&source=article&objectId=1772306\">https://nodejs.org/en/download/current/</a></h3><ul>\n<li><p>é€šè¿‡wgetæŒ‡ä»¤ä¸‹è½½ï¼š<code>wget https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz</code></p>\n</li>\n<li><p>è§£å‹ï¼š<code>tar -xvf node-v13.11.0-linux-x64.tar.xz</code></p>\n</li>\n<li><p>æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸï¼š<code>cd node-v13.11.0-linux-x64/bin</code>ï¼Œæ‰§è¡Œï¼š<code>./node -v</code></p>\n</li>\n</ul>\n<h3 id=\"2-æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS-lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\"><a href=\"#2-æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS-lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\" class=\"headerlink\" title=\"2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\"></a>2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆ<strong>PS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥</strong>ï¼‰ï¼š</h3><ul>\n<li><code>ln -s /www/node-v13.11.0-linux-x64/bin/node /usr/local/bin/node</code></li>\n<li><code>ln -s /www/node-v13.11.0-linux-x64/bin/npm /usr/local/bin/npm</code></li>\n</ul>\n<h3 id=\"2-1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv-node-v13-11-0-linux-x64-usr-local-node\"><a href=\"#2-1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv-node-v13-11-0-linux-x64-usr-local-node\" class=\"headerlink\" title=\"2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv node-v13.11.0-linux-x64 /usr/local/node\"></a>2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼š<code>mv node-v13.11.0-linux-x64 /usr/local/node</code></h3><p>å†ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‰ä½ié”®ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼</span><br><span class=\"line\"></span><br><span class=\"line\">æ’å…¥ï¼šexport PATH=$PATH:/usr/local/node/bin</span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‰esc,è¾“å…¥:wqï¼Œé€€å‡ºvimç¼–è¾‘å™¨æ¨¡å¼</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode-vå’Œnpm-v\"><a href=\"#3-ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode-vå’Œnpm-v\" class=\"headerlink\" title=\"3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode -vå’Œnpm -v\"></a>3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼š<code>node -v</code>å’Œ<code>npm -v</code></h3><h3 id=\"4-åŠ é€Ÿnpm\"><a href=\"#4-åŠ é€Ÿnpm\" class=\"headerlink\" title=\"4.åŠ é€Ÿnpm\"></a>4.åŠ é€Ÿnpm</h3><ul>\n<li>ä½¿ç”¨æ·˜å®çš„cnpmï¼š<code>npm install cnpm -g --registry=https://registry.npm.taobao.org</code></li>\n<li>åŠ cnpmè½¯é“¾ï¼š<code>ln -s /www/node-v13.11.0-linux-x64/bin/cnpm /usr/local/bin/cnpm</code></li>\n<li>éœ€è¦æ³¨æ„ï¼Œä»¥åä½¿ç”¨cnpmå»ä»£æ›¿npmæ¥æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š<code>cnpm install XXX</code></li>\n</ul>\n<h2 id=\"äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\"><a href=\"#äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\" class=\"headerlink\" title=\"äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\"></a>äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2</h2><blockquote>\n<p>PM2 æ˜¯ä¸€ä¸ªæµè¡Œçš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åå°è¿è¡Œ nodejs çš„é¦–é€‰ã€‚å®ƒæä¾›äº†å¾ˆå¤šçš„åŠŸèƒ½å’Œé€‰é¡¹ï¼ŒåŒ…æ‹¬è¿›ç¨‹ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å¹³è¡¡ç­‰ç­‰ã€‚ä½¿ç”¨ PM2 åï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å°† nodejs åº”ç”¨ç¨‹åºåå°è¿è¡Œã€‚</p>\n</blockquote>\n<h3 id=\"1-å®‰è£…pm2ï¼šnpm-install-g-pm2\"><a href=\"#1-å®‰è£…pm2ï¼šnpm-install-g-pm2\" class=\"headerlink\" title=\"1.å®‰è£…pm2ï¼šnpm install -g pm2\"></a>1.å®‰è£…pm2ï¼š<code>npm install -g pm2</code></h3><h3 id=\"2-æ·»åŠ pm2è½¯é“¾ï¼šln-s-www-node-v13-11-0-linux-x64-lib-node-modules-pm2-bin-pm2-usr-local-bin\"><a href=\"#2-æ·»åŠ pm2è½¯é“¾ï¼šln-s-www-node-v13-11-0-linux-x64-lib-node-modules-pm2-bin-pm2-usr-local-bin\" class=\"headerlink\" title=\"2.æ·»åŠ pm2è½¯é“¾ï¼šln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/\"></a>2.æ·»åŠ pm2è½¯é“¾ï¼š<code>ln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/</code></h3><h3 id=\"3-pm2å¸¸ç”¨å‘½ä»¤ï¼š\"><a href=\"#3-pm2å¸¸ç”¨å‘½ä»¤ï¼š\" class=\"headerlink\" title=\"3.pm2å¸¸ç”¨å‘½ä»¤ï¼š\"></a>3.pm2å¸¸ç”¨å‘½ä»¤ï¼š</h3><ul>\n<li><p>å¯åŠ¨æŒ‡å®šåº”ç”¨ï¼š<code>pm2 start &lt;script_file|config_file&gt; [options]</code> ï¼Œå¦‚ï¼š<code>pm2 start index.js --name httpServer</code></p>\n</li>\n<li><p>åœæ­¢æŒ‡å®šåº”ç”¨ï¼š<code>pm2 stop &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 stop httpServer</code></p>\n</li>\n<li><p>æŸ¥çœ‹å…¨éƒ¨å®ä¾‹ï¼š<code>pm2 list</code> ï¼Œæ³¨æ„ï¼špm2 stop æŸä¸ªé¡¹ç›®åï¼Œè¯¥é¡¹ç›®è¿˜ä¼šå­˜åœ¨pm2 list çš„åˆ—è¡¨é‡Œé¢ï¼Œ åªæ˜¯çŠ¶æ€æ˜¯ stop, è¦æƒ³å»æ‰è¯¥é¡¹ç›®ï¼Œç”¨pm2 delete</p>\n</li>\n<li><p>é‡å¯æŒ‡å®šåº”ç”¨ï¼š<code>pm2 reload|restart &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 restart httpServer</code></p>\n</li>\n<li><p>æ˜¾ç¤ºæŒ‡å®šåº”ç”¨è¯¦æƒ…ï¼š<code>pm2 show &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 show httpServer</code></p>\n</li>\n<li><p>åˆ é™¤æŒ‡å®šåº”ç”¨ï¼š<code>pm2 delete &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 delete httpServer</code>ï¼Œå¦‚æœä¿®æ”¹åº”ç”¨é…ç½®è¡Œä¸ºï¼Œæœ€å¥½å…ˆåˆ é™¤åº”ç”¨åï¼Œé‡æ–°å¯åŠ¨æ–¹æ‰ç”Ÿæ•ˆï¼Œå¦‚ä¿®æ”¹è„šæœ¬å…¥å£æ–‡ä»¶</p>\n</li>\n<li><p>æ€æ‰pm2ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹ï¼š<code>pm2 kill</code> </p>\n</li>\n<li><p>åˆ é™¤pm2æ—¥å¿—ï¼š<code>pm2 flush</code></p>\n</li>\n<li><p>æŸ¥çœ‹æŒ‡å®šåº”ç”¨çš„æ—¥å¿—ï¼Œå³æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯<code>pm2 logs &lt;appName&gt;</code></p>\n</li>\n<li><p>ç›‘æ§å„ä¸ªåº”ç”¨è¿›ç¨‹cpuå’Œmemoryä½¿ç”¨æƒ…å†µ<code>pm2 monit</code></p>\n</li>\n<li><p>å¦‚æœé¡¹ç›®æ²¡æœ‰å¯åŠ¨å°±æ‰§è¡Œ start å¦‚æœé¡¹ç›®æ­£åœ¨è¿è¡Œ å°±æ‰§è¡Œrelaod<code>pm2 startOrReload &lt;appName&gt;</code></p>\n</li>\n</ul>\n<h2 id=\"ä¸‰ã€è¸©å‘è®°å½•\"><a href=\"#ä¸‰ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"ä¸‰ã€è¸©å‘è®°å½•\"></a>ä¸‰ã€è¸©å‘è®°å½•</h2><ol>\n<li>2024-1-3ï¼šè¯•å›¾åœ¨æœåŠ¡å™¨ä¸Šé¢å®‰è£…node.js18ï¼ŒæŸ¥çœ‹nodeç‰ˆæœ¬çš„æ—¶å€™å‘ç”ŸæŠ¥é”™ï¼š</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185224803.png\" alt=\"image-20240103185224803\"></p>\n<p>æœç´¢èµ„æ–™å‘ç°æ˜¯å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸æ”¯æŒé«˜ç‰ˆæœ¬çš„node.jsï¼ŒæŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185613533.png\" alt=\"image-20240103185613533\"></p>\n<p><strong>è§£å†³åŠæ³•é™çº§åˆ°node.js16â€¦</strong></p>\n<p><strong>å‚è€ƒæ–‡ç« ï¼š</strong><a href=\"https://juejin.cn/post/7163899309425950751\">https://juejin.cn/post/7163899309425950751</a></p>\n<ol start=\"2\">\n<li>2024-10-18ï¼šåœ¨æœåŠ¡å™¨è¿è¡Œpm2 start index.jså‘½ä»¤æŠ¥é”™</li>\n</ol>\n<p>é¡¹ç›®åœ¨scriptsé…ç½®è¿è¡Œç¯å¢ƒï¼Œæ— æ³•ç›´æ¥é€šè¿‡è¿è¡Œjsæ–‡ä»¶å¯åŠ¨æœåŠ¡ã€‚</p>\n<p>å¯é€šè¿‡pm2å¯åŠ¨ä½ çš„npmè„šæœ¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start npm --name &quot;ä½ çš„åº”ç”¨å&quot; -- run start</span><br></pre></td></tr></table></figure>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨pm2å¯åŠ¨pythonè„šæœ¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start python3 --name &quot;ä½ çš„åº”ç”¨å&quot; -- main.py</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œçš„â€“nameå‚æ•°æ˜¯ç»™ä½ çš„åº”ç”¨è®¾ç½®ä¸€ä¸ªåå­—ï¼Œâ€“ run startæ˜¯å‘Šè¯‰pm2è¿è¡Œpackage.jsonä¸­å®šä¹‰çš„startè„šæœ¬ã€‚</p>\n<p>å¦‚æœä½ çš„npmè„šæœ¬æ˜¯ç”¨æ¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆâ€“nameå‚æ•°éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·ä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€æˆ–è€…é‡å¯æœåŠ¡ã€‚</p>\n","excerpt":"","more":"<blockquote>\n<p>node.jsæ˜¯è®©JavaScriptèƒ½è¿è¡Œåœ¨æœåŠ¡ç«¯çš„å¼€å‘å¹³å°ï¼Œpm2æ˜¯ä¸€ä¸ªNode.js å®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨äºç®¡ç†å’Œç›‘æ§Node.js åº”ç”¨ç¨‹åºã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€å®‰è£…nodeç¯å¢ƒ\"><a href=\"#ä¸€ã€å®‰è£…nodeç¯å¢ƒ\" class=\"headerlink\" title=\"ä¸€ã€å®‰è£…nodeç¯å¢ƒ\"></a>ä¸€ã€å®‰è£…nodeç¯å¢ƒ</h2><h3 id=\"1-å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½\"><a href=\"#1-å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½\" class=\"headerlink\" title=\"1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ &lt;https://nodejs.org/en/download/current/\"></a>1.å¯é€šè¿‡ç½‘ç«™ä¸‹è½½ï¼Œè¿›å…¥Nodeæœ€æ–°ç‰ˆä¸‹è½½ &lt;<a href=\"https://cloud.tencent.com/developer/tools/blog-entry?target=https://nodejs.org/en/download/current/&source=article&objectId=1772306\">https://nodejs.org/en/download/current/</a></h3><ul>\n<li><p>é€šè¿‡wgetæŒ‡ä»¤ä¸‹è½½ï¼š<code>wget https://nodejs.org/dist/v13.11.0/node-v13.11.0-linux-x64.tar.xz</code></p>\n</li>\n<li><p>è§£å‹ï¼š<code>tar -xvf node-v13.11.0-linux-x64.tar.xz</code></p>\n</li>\n<li><p>æµ‹è¯•å®‰è£…æ˜¯å¦æˆåŠŸï¼š<code>cd node-v13.11.0-linux-x64/bin</code>ï¼Œæ‰§è¡Œï¼š<code>./node -v</code></p>\n</li>\n</ul>\n<h3 id=\"2-æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS-lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\"><a href=\"#2-æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS-lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\" class=\"headerlink\" title=\"2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆPS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ï¼‰ï¼š\"></a>2.æ·»åŠ nodeå’Œnpmè½¯é“¾å»ºç«‹é“¾æ¥ï¼ˆ<strong>PS:lnå‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥</strong>ï¼‰ï¼š</h3><ul>\n<li><code>ln -s /www/node-v13.11.0-linux-x64/bin/node /usr/local/bin/node</code></li>\n<li><code>ln -s /www/node-v13.11.0-linux-x64/bin/npm /usr/local/bin/npm</code></li>\n</ul>\n<h3 id=\"2-1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv-node-v13-11-0-linux-x64-usr-local-node\"><a href=\"#2-1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv-node-v13-11-0-linux-x64-usr-local-node\" class=\"headerlink\" title=\"2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼šmv node-v13.11.0-linux-x64 /usr/local/node\"></a>2.1æˆ–è€…æ˜¯é€šè¿‡æ”¹å˜nodeåŒ…çš„å­˜æ”¾ä½ç½®è¿›è¡Œæ“ä½œï¼š<code>mv node-v13.11.0-linux-x64 /usr/local/node</code></h3><p>å†ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/profile</span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‰ä½ié”®ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼</span><br><span class=\"line\"></span><br><span class=\"line\">æ’å…¥ï¼šexport PATH=$PATH:/usr/local/node/bin</span><br><span class=\"line\"></span><br><span class=\"line\">æŒ‰esc,è¾“å…¥:wqï¼Œé€€å‡ºvimç¼–è¾‘å™¨æ¨¡å¼</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode-vå’Œnpm-v\"><a href=\"#3-ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode-vå’Œnpm-v\" class=\"headerlink\" title=\"3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼šnode -vå’Œnpm -v\"></a>3.ä½¿ç”¨æµ‹è¯•å‘½ä»¤ï¼š<code>node -v</code>å’Œ<code>npm -v</code></h3><h3 id=\"4-åŠ é€Ÿnpm\"><a href=\"#4-åŠ é€Ÿnpm\" class=\"headerlink\" title=\"4.åŠ é€Ÿnpm\"></a>4.åŠ é€Ÿnpm</h3><ul>\n<li>ä½¿ç”¨æ·˜å®çš„cnpmï¼š<code>npm install cnpm -g --registry=https://registry.npm.taobao.org</code></li>\n<li>åŠ cnpmè½¯é“¾ï¼š<code>ln -s /www/node-v13.11.0-linux-x64/bin/cnpm /usr/local/bin/cnpm</code></li>\n<li>éœ€è¦æ³¨æ„ï¼Œä»¥åä½¿ç”¨cnpmå»ä»£æ›¿npmæ¥æ‰§è¡Œï¼Œæ¯”å¦‚ï¼š<code>cnpm install XXX</code></li>\n</ul>\n<h2 id=\"äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\"><a href=\"#äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\" class=\"headerlink\" title=\"äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2\"></a>äºŒã€å®‰è£…å¹¶ä½¿ç”¨pm2</h2><blockquote>\n<p>PM2 æ˜¯ä¸€ä¸ªæµè¡Œçš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åå°è¿è¡Œ nodejs çš„é¦–é€‰ã€‚å®ƒæä¾›äº†å¾ˆå¤šçš„åŠŸèƒ½å’Œé€‰é¡¹ï¼ŒåŒ…æ‹¬è¿›ç¨‹ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å¹³è¡¡ç­‰ç­‰ã€‚ä½¿ç”¨ PM2 åï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°å°† nodejs åº”ç”¨ç¨‹åºåå°è¿è¡Œã€‚</p>\n</blockquote>\n<h3 id=\"1-å®‰è£…pm2ï¼šnpm-install-g-pm2\"><a href=\"#1-å®‰è£…pm2ï¼šnpm-install-g-pm2\" class=\"headerlink\" title=\"1.å®‰è£…pm2ï¼šnpm install -g pm2\"></a>1.å®‰è£…pm2ï¼š<code>npm install -g pm2</code></h3><h3 id=\"2-æ·»åŠ pm2è½¯é“¾ï¼šln-s-www-node-v13-11-0-linux-x64-lib-node-modules-pm2-bin-pm2-usr-local-bin\"><a href=\"#2-æ·»åŠ pm2è½¯é“¾ï¼šln-s-www-node-v13-11-0-linux-x64-lib-node-modules-pm2-bin-pm2-usr-local-bin\" class=\"headerlink\" title=\"2.æ·»åŠ pm2è½¯é“¾ï¼šln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/\"></a>2.æ·»åŠ pm2è½¯é“¾ï¼š<code>ln -s /www/node-v13.11.0-linux-x64/lib/node_modules/pm2/bin/pm2 /usr/local/bin/</code></h3><h3 id=\"3-pm2å¸¸ç”¨å‘½ä»¤ï¼š\"><a href=\"#3-pm2å¸¸ç”¨å‘½ä»¤ï¼š\" class=\"headerlink\" title=\"3.pm2å¸¸ç”¨å‘½ä»¤ï¼š\"></a>3.pm2å¸¸ç”¨å‘½ä»¤ï¼š</h3><ul>\n<li><p>å¯åŠ¨æŒ‡å®šåº”ç”¨ï¼š<code>pm2 start &lt;script_file|config_file&gt; [options]</code> ï¼Œå¦‚ï¼š<code>pm2 start index.js --name httpServer</code></p>\n</li>\n<li><p>åœæ­¢æŒ‡å®šåº”ç”¨ï¼š<code>pm2 stop &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 stop httpServer</code></p>\n</li>\n<li><p>æŸ¥çœ‹å…¨éƒ¨å®ä¾‹ï¼š<code>pm2 list</code> ï¼Œæ³¨æ„ï¼špm2 stop æŸä¸ªé¡¹ç›®åï¼Œè¯¥é¡¹ç›®è¿˜ä¼šå­˜åœ¨pm2 list çš„åˆ—è¡¨é‡Œé¢ï¼Œ åªæ˜¯çŠ¶æ€æ˜¯ stop, è¦æƒ³å»æ‰è¯¥é¡¹ç›®ï¼Œç”¨pm2 delete</p>\n</li>\n<li><p>é‡å¯æŒ‡å®šåº”ç”¨ï¼š<code>pm2 reload|restart &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 restart httpServer</code></p>\n</li>\n<li><p>æ˜¾ç¤ºæŒ‡å®šåº”ç”¨è¯¦æƒ…ï¼š<code>pm2 show &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 show httpServer</code></p>\n</li>\n<li><p>åˆ é™¤æŒ‡å®šåº”ç”¨ï¼š<code>pm2 delete &lt;appName&gt; [options]</code>ï¼Œå¦‚ï¼š<code>pm2 delete httpServer</code>ï¼Œå¦‚æœä¿®æ”¹åº”ç”¨é…ç½®è¡Œä¸ºï¼Œæœ€å¥½å…ˆåˆ é™¤åº”ç”¨åï¼Œé‡æ–°å¯åŠ¨æ–¹æ‰ç”Ÿæ•ˆï¼Œå¦‚ä¿®æ”¹è„šæœ¬å…¥å£æ–‡ä»¶</p>\n</li>\n<li><p>æ€æ‰pm2ç®¡ç†çš„æ‰€æœ‰è¿›ç¨‹ï¼š<code>pm2 kill</code> </p>\n</li>\n<li><p>åˆ é™¤pm2æ—¥å¿—ï¼š<code>pm2 flush</code></p>\n</li>\n<li><p>æŸ¥çœ‹æŒ‡å®šåº”ç”¨çš„æ—¥å¿—ï¼Œå³æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯<code>pm2 logs &lt;appName&gt;</code></p>\n</li>\n<li><p>ç›‘æ§å„ä¸ªåº”ç”¨è¿›ç¨‹cpuå’Œmemoryä½¿ç”¨æƒ…å†µ<code>pm2 monit</code></p>\n</li>\n<li><p>å¦‚æœé¡¹ç›®æ²¡æœ‰å¯åŠ¨å°±æ‰§è¡Œ start å¦‚æœé¡¹ç›®æ­£åœ¨è¿è¡Œ å°±æ‰§è¡Œrelaod<code>pm2 startOrReload &lt;appName&gt;</code></p>\n</li>\n</ul>\n<h2 id=\"ä¸‰ã€è¸©å‘è®°å½•\"><a href=\"#ä¸‰ã€è¸©å‘è®°å½•\" class=\"headerlink\" title=\"ä¸‰ã€è¸©å‘è®°å½•\"></a>ä¸‰ã€è¸©å‘è®°å½•</h2><ol>\n<li>2024-1-3ï¼šè¯•å›¾åœ¨æœåŠ¡å™¨ä¸Šé¢å®‰è£…node.js18ï¼ŒæŸ¥çœ‹nodeç‰ˆæœ¬çš„æ—¶å€™å‘ç”ŸæŠ¥é”™ï¼š</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185224803.png\" alt=\"image-20240103185224803\"></p>\n<p>æœç´¢èµ„æ–™å‘ç°æ˜¯å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸æ”¯æŒé«˜ç‰ˆæœ¬çš„node.jsï¼ŒæŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240103185613533.png\" alt=\"image-20240103185613533\"></p>\n<p><strong>è§£å†³åŠæ³•é™çº§åˆ°node.js16â€¦</strong></p>\n<p><strong>å‚è€ƒæ–‡ç« ï¼š</strong><a href=\"https://juejin.cn/post/7163899309425950751\">https://juejin.cn/post/7163899309425950751</a></p>\n<ol start=\"2\">\n<li>2024-10-18ï¼šåœ¨æœåŠ¡å™¨è¿è¡Œpm2 start index.jså‘½ä»¤æŠ¥é”™</li>\n</ol>\n<p>é¡¹ç›®åœ¨scriptsé…ç½®è¿è¡Œç¯å¢ƒï¼Œæ— æ³•ç›´æ¥é€šè¿‡è¿è¡Œjsæ–‡ä»¶å¯åŠ¨æœåŠ¡ã€‚</p>\n<p>å¯é€šè¿‡pm2å¯åŠ¨ä½ çš„npmè„šæœ¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start npm --name &quot;ä½ çš„åº”ç”¨å&quot; -- run start</span><br></pre></td></tr></table></figure>\n<p>ä¹Ÿå¯ä»¥ä½¿ç”¨pm2å¯åŠ¨pythonè„šæœ¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start python3 --name &quot;ä½ çš„åº”ç”¨å&quot; -- main.py</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œçš„â€“nameå‚æ•°æ˜¯ç»™ä½ çš„åº”ç”¨è®¾ç½®ä¸€ä¸ªåå­—ï¼Œâ€“ run startæ˜¯å‘Šè¯‰pm2è¿è¡Œpackage.jsonä¸­å®šä¹‰çš„startè„šæœ¬ã€‚</p>\n<p>å¦‚æœä½ çš„npmè„šæœ¬æ˜¯ç”¨æ¥å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆâ€“nameå‚æ•°éå¸¸æœ‰ç”¨ï¼Œè¿™æ ·ä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æœåŠ¡çŠ¶æ€æˆ–è€…é‡å¯æœåŠ¡ã€‚</p>\n"},{"title":"Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm","date":"2024-07-20T08:04:55.000Z","_content":"\n> NVMï¼ˆNode Version Managerï¼‰æ˜¯ä¸€ä¸ªç”¨äºåœ¨åŸºäºLinuxç³»ç»Ÿä¸Šå®‰è£…å’Œç®¡ç†Node.jsçš„shellè„šæœ¬ã€‚macOSç”¨æˆ·å¯ä»¥ä½¿ç”¨`homebrew`æ¥å®‰è£…NVMã€‚\n\nå®‰è£…Homebrewï¼ˆå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ï¼‰ï¼š\n\n```sh\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n```\n\n1. å¸è½½ç°æœ‰nodeç‰ˆæœ¬\n\nå¦‚æœä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº†nodeï¼Œè¯·å…ˆå¸è½½å®ƒã€‚\n\n```bash\nbrew uninstall --ignore-dependencies node \nbrew uninstall --force node \n```\n\n2. ä½¿ç”¨Homebrewå®‰è£…nvmï¼š\n\n```sh\nbrew install nvm\n```\n\n3. å°†nvmåˆå§‹åŒ–è„šæœ¬æ·»åŠ åˆ°ä½ çš„shellé…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯zshï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„`~/.zshrc`æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š\n\n```sh\nexport NVM_DIR=\"$([ -z \"${XDG_CONFIG_HOME-}\" ] && printf %s \"${HOME}/.nvm\" || printf %s \"${XDG_CONFIG_HOME}/nvm\")\"\n[ -s \"$NVM_DIR/nvm.sh\" ] && \\. \"$NVM_DIR/nvm.sh\" # This loads nvm\n```\n\n4. ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼Œä½ å¯ä»¥é‡æ–°å¯åŠ¨ä½ çš„ç»ˆç«¯ï¼Œæˆ–è€…è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n\n```sh\nsource ~/.zshrc\n```\n\n5. éªŒè¯nvmå®‰è£…æˆåŠŸï¼š\n\n```sh\nnvm --version\n```\n\nä»¥ä¸Šæ­¥éª¤å°†ä¼šåœ¨ä½ çš„macOSç³»ç»Ÿä¸Šå®‰è£…nvmï¼Œå¹¶ä¸”è®¾ç½®zshä½¿å…¶èƒ½å¤Ÿè¯†åˆ«nvmå‘½ä»¤ã€‚\n\n\n\n### å¸¸ç”¨å‘½ä»¤\n\n```sh\nnvm -v //æŸ¥çœ‹nvmç‰ˆæœ¬\nnvm ls //æŸ¥çœ‹æœ¬æœºå·²ç»å®‰è£…nodeç‰ˆæœ¬\nnvm use åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬node\nnvm ls-remote //åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…çš„è¿œç¨‹nodeç‰ˆæœ¬\nnvm install stable    //å®‰è£…æœ€æ–°ç‰ˆæœ¬\nnvm install <version> //å®‰è£…æŒ‡å®šç‰ˆæœ¬\nnvm uninstall stable   //å¸è½½æœ€æ–°ç‰ˆæœ¬\nnvm uninstall <version>   //å¸è½½æŒ‡å®šç‰ˆæœ¬\nnvm current //æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„nodeç‰ˆæœ¬\nnpm which [current|<version>] //æ˜¾ç¤ºå·²å®‰è£…nodeçš„å®‰è£…è·¯å¾„ã€‚\nnvm cache dir //æ˜¾ç¤ºnvmçš„ç¼“å­˜ç›®å½•\nnvm cache clear //æ¸…æ¥šnvmçš„ç¼“å­˜ç›®å½•\nnvm node_mirror [url] //è®¾ç½®nodeé•œåƒ\nnvm npm_mirror [url] //è®¾ç½®npmé•œåƒ\nnvm on //å¼€å¯node.jsç‰ˆæœ¬ç®¡ç†\nnvm off //å…³é—­node.jsç‰ˆæœ¬ç®¡ç†\n \n\næ›´æ–°npmåˆ°æœ€æ–°ç‰ˆæœ¬\nnpm install -g npm@latest\n```\n\n\n\n### è¸©å‘è®°å½•ï¼š\n\nç»ˆç«¯å®‰è£…å¥½äº†nvmå’Œnodeï¼Œä½†æ˜¯åœ¨vscodeæ‰“å¼€åæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦åœ¨` vi ~/.zshrc`åŠ å…¥`export PATH=\"~/.composer/vendor/bin:$PATH\"`\n\n\n\n### å‚è€ƒæ–‡ç« ï¼š\n\n[å¦‚ä½•åœ¨macOSä¸Šå®‰è£…NVM](https://juejin.cn/post/7083026831263137800)\n\n[Macä¸‹å®‰è£…nvmåvscodeè¾“å…¥node -vä¸èµ·ä½œç”¨](https://www.cnblogs.com/famensaodiseng/p/10427673.html)\n","source":"_posts/Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm.md","raw":"---\ntitle: Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm\ndate: 2024-07-20 16:04:55\ntags:\n---\n\n> NVMï¼ˆNode Version Managerï¼‰æ˜¯ä¸€ä¸ªç”¨äºåœ¨åŸºäºLinuxç³»ç»Ÿä¸Šå®‰è£…å’Œç®¡ç†Node.jsçš„shellè„šæœ¬ã€‚macOSç”¨æˆ·å¯ä»¥ä½¿ç”¨`homebrew`æ¥å®‰è£…NVMã€‚\n\nå®‰è£…Homebrewï¼ˆå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ï¼‰ï¼š\n\n```sh\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n```\n\n1. å¸è½½ç°æœ‰nodeç‰ˆæœ¬\n\nå¦‚æœä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº†nodeï¼Œè¯·å…ˆå¸è½½å®ƒã€‚\n\n```bash\nbrew uninstall --ignore-dependencies node \nbrew uninstall --force node \n```\n\n2. ä½¿ç”¨Homebrewå®‰è£…nvmï¼š\n\n```sh\nbrew install nvm\n```\n\n3. å°†nvmåˆå§‹åŒ–è„šæœ¬æ·»åŠ åˆ°ä½ çš„shellé…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯zshï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„`~/.zshrc`æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š\n\n```sh\nexport NVM_DIR=\"$([ -z \"${XDG_CONFIG_HOME-}\" ] && printf %s \"${HOME}/.nvm\" || printf %s \"${XDG_CONFIG_HOME}/nvm\")\"\n[ -s \"$NVM_DIR/nvm.sh\" ] && \\. \"$NVM_DIR/nvm.sh\" # This loads nvm\n```\n\n4. ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼Œä½ å¯ä»¥é‡æ–°å¯åŠ¨ä½ çš„ç»ˆç«¯ï¼Œæˆ–è€…è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n\n```sh\nsource ~/.zshrc\n```\n\n5. éªŒè¯nvmå®‰è£…æˆåŠŸï¼š\n\n```sh\nnvm --version\n```\n\nä»¥ä¸Šæ­¥éª¤å°†ä¼šåœ¨ä½ çš„macOSç³»ç»Ÿä¸Šå®‰è£…nvmï¼Œå¹¶ä¸”è®¾ç½®zshä½¿å…¶èƒ½å¤Ÿè¯†åˆ«nvmå‘½ä»¤ã€‚\n\n\n\n### å¸¸ç”¨å‘½ä»¤\n\n```sh\nnvm -v //æŸ¥çœ‹nvmç‰ˆæœ¬\nnvm ls //æŸ¥çœ‹æœ¬æœºå·²ç»å®‰è£…nodeç‰ˆæœ¬\nnvm use åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬node\nnvm ls-remote //åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…çš„è¿œç¨‹nodeç‰ˆæœ¬\nnvm install stable    //å®‰è£…æœ€æ–°ç‰ˆæœ¬\nnvm install <version> //å®‰è£…æŒ‡å®šç‰ˆæœ¬\nnvm uninstall stable   //å¸è½½æœ€æ–°ç‰ˆæœ¬\nnvm uninstall <version>   //å¸è½½æŒ‡å®šç‰ˆæœ¬\nnvm current //æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„nodeç‰ˆæœ¬\nnpm which [current|<version>] //æ˜¾ç¤ºå·²å®‰è£…nodeçš„å®‰è£…è·¯å¾„ã€‚\nnvm cache dir //æ˜¾ç¤ºnvmçš„ç¼“å­˜ç›®å½•\nnvm cache clear //æ¸…æ¥šnvmçš„ç¼“å­˜ç›®å½•\nnvm node_mirror [url] //è®¾ç½®nodeé•œåƒ\nnvm npm_mirror [url] //è®¾ç½®npmé•œåƒ\nnvm on //å¼€å¯node.jsç‰ˆæœ¬ç®¡ç†\nnvm off //å…³é—­node.jsç‰ˆæœ¬ç®¡ç†\n \n\næ›´æ–°npmåˆ°æœ€æ–°ç‰ˆæœ¬\nnpm install -g npm@latest\n```\n\n\n\n### è¸©å‘è®°å½•ï¼š\n\nç»ˆç«¯å®‰è£…å¥½äº†nvmå’Œnodeï¼Œä½†æ˜¯åœ¨vscodeæ‰“å¼€åæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦åœ¨` vi ~/.zshrc`åŠ å…¥`export PATH=\"~/.composer/vendor/bin:$PATH\"`\n\n\n\n### å‚è€ƒæ–‡ç« ï¼š\n\n[å¦‚ä½•åœ¨macOSä¸Šå®‰è£…NVM](https://juejin.cn/post/7083026831263137800)\n\n[Macä¸‹å®‰è£…nvmåvscodeè¾“å…¥node -vä¸èµ·ä½œç”¨](https://www.cnblogs.com/famensaodiseng/p/10427673.html)\n","slug":"Macä¸Šä½¿ç”¨homebrewå®‰è£…nvm","published":1,"updated":"2024-07-20T08:05:33.547Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dl000hwen19m9c6vgx","content":"<blockquote>\n<p>NVMï¼ˆNode Version Managerï¼‰æ˜¯ä¸€ä¸ªç”¨äºåœ¨åŸºäºLinuxç³»ç»Ÿä¸Šå®‰è£…å’Œç®¡ç†Node.jsçš„shellè„šæœ¬ã€‚macOSç”¨æˆ·å¯ä»¥ä½¿ç”¨<code>homebrew</code>æ¥å®‰è£…NVMã€‚</p>\n</blockquote>\n<p>å®‰è£…Homebrewï¼ˆå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ï¼‰ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/bash -c <span class=\"string\">&quot;<span class=\"subst\">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>å¸è½½ç°æœ‰nodeç‰ˆæœ¬</li>\n</ol>\n<p>å¦‚æœä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº†nodeï¼Œè¯·å…ˆå¸è½½å®ƒã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew uninstall --ignore-dependencies node </span><br><span class=\"line\">brew uninstall --force node </span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>ä½¿ç”¨Homebrewå®‰è£…nvmï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install nvm</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>å°†nvmåˆå§‹åŒ–è„šæœ¬æ·»åŠ åˆ°ä½ çš„shellé…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯zshï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„<code>~/.zshrc</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> NVM_DIR=<span class=\"string\">&quot;<span class=\"subst\">$([ -z <span class=\"string\">&quot;<span class=\"variable\">$&#123;XDG_CONFIG_HOME-&#125;</span>&quot;</span> ] &amp;&amp; printf %s <span class=\"string\">&quot;<span class=\"variable\">$&#123;HOME&#125;</span>/.nvm&quot;</span> || printf %s <span class=\"string\">&quot;<span class=\"variable\">$&#123;XDG_CONFIG_HOME&#125;</span>/nvm&quot;</span>)</span>&quot;</span></span><br><span class=\"line\">[ -s <span class=\"string\">&quot;<span class=\"variable\">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \\. <span class=\"string\">&quot;<span class=\"variable\">$NVM_DIR</span>/nvm.sh&quot;</span> <span class=\"comment\"># This loads nvm</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼Œä½ å¯ä»¥é‡æ–°å¯åŠ¨ä½ çš„ç»ˆç«¯ï¼Œæˆ–è€…è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>éªŒè¯nvmå®‰è£…æˆåŠŸï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm --version</span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šæ­¥éª¤å°†ä¼šåœ¨ä½ çš„macOSç³»ç»Ÿä¸Šå®‰è£…nvmï¼Œå¹¶ä¸”è®¾ç½®zshä½¿å…¶èƒ½å¤Ÿè¯†åˆ«nvmå‘½ä»¤ã€‚</p>\n<h3 id=\"å¸¸ç”¨å‘½ä»¤\"><a href=\"#å¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"å¸¸ç”¨å‘½ä»¤\"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm -v //æŸ¥çœ‹nvmç‰ˆæœ¬</span><br><span class=\"line\">nvm <span class=\"built_in\">ls</span> //æŸ¥çœ‹æœ¬æœºå·²ç»å®‰è£…nodeç‰ˆæœ¬</span><br><span class=\"line\">nvm use åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬node</span><br><span class=\"line\">nvm ls-remote //åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…çš„è¿œç¨‹nodeç‰ˆæœ¬</span><br><span class=\"line\">nvm install stable    //å®‰è£…æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">nvm install &lt;version&gt; //å®‰è£…æŒ‡å®šç‰ˆæœ¬</span><br><span class=\"line\">nvm uninstall stable   //å¸è½½æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">nvm uninstall &lt;version&gt;   //å¸è½½æŒ‡å®šç‰ˆæœ¬</span><br><span class=\"line\">nvm current //æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„nodeç‰ˆæœ¬</span><br><span class=\"line\">npm <span class=\"built_in\">which</span> [current|&lt;version&gt;] //æ˜¾ç¤ºå·²å®‰è£…nodeçš„å®‰è£…è·¯å¾„ã€‚</span><br><span class=\"line\">nvm cache <span class=\"built_in\">dir</span> //æ˜¾ç¤ºnvmçš„ç¼“å­˜ç›®å½•</span><br><span class=\"line\">nvm cache clear //æ¸…æ¥šnvmçš„ç¼“å­˜ç›®å½•</span><br><span class=\"line\">nvm node_mirror [url] //è®¾ç½®nodeé•œåƒ</span><br><span class=\"line\">nvm npm_mirror [url] //è®¾ç½®npmé•œåƒ</span><br><span class=\"line\">nvm on //å¼€å¯node.jsç‰ˆæœ¬ç®¡ç†</span><br><span class=\"line\">nvm off //å…³é—­node.jsç‰ˆæœ¬ç®¡ç†</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">æ›´æ–°npmåˆ°æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">npm install -g npm@latest</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"è¸©å‘è®°å½•ï¼š\"><a href=\"#è¸©å‘è®°å½•ï¼š\" class=\"headerlink\" title=\"è¸©å‘è®°å½•ï¼š\"></a>è¸©å‘è®°å½•ï¼š</h3><p>ç»ˆç«¯å®‰è£…å¥½äº†nvmå’Œnodeï¼Œä½†æ˜¯åœ¨vscodeæ‰“å¼€åæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦åœ¨<code> vi ~/.zshrc</code>åŠ å…¥<code>export PATH=&quot;~/.composer/vendor/bin:$PATH&quot;</code></p>\n<h3 id=\"å‚è€ƒæ–‡ç« ï¼š\"><a href=\"#å‚è€ƒæ–‡ç« ï¼š\" class=\"headerlink\" title=\"å‚è€ƒæ–‡ç« ï¼š\"></a>å‚è€ƒæ–‡ç« ï¼š</h3><p><a href=\"https://juejin.cn/post/7083026831263137800\">å¦‚ä½•åœ¨macOSä¸Šå®‰è£…NVM</a></p>\n<p><a href=\"https://www.cnblogs.com/famensaodiseng/p/10427673.html\">Macä¸‹å®‰è£…nvmåvscodeè¾“å…¥node -vä¸èµ·ä½œç”¨</a></p>\n","excerpt":"","more":"<blockquote>\n<p>NVMï¼ˆNode Version Managerï¼‰æ˜¯ä¸€ä¸ªç”¨äºåœ¨åŸºäºLinuxç³»ç»Ÿä¸Šå®‰è£…å’Œç®¡ç†Node.jsçš„shellè„šæœ¬ã€‚macOSç”¨æˆ·å¯ä»¥ä½¿ç”¨<code>homebrew</code>æ¥å®‰è£…NVMã€‚</p>\n</blockquote>\n<p>å®‰è£…Homebrewï¼ˆå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…ï¼‰ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/bash -c <span class=\"string\">&quot;<span class=\"subst\">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>å¸è½½ç°æœ‰nodeç‰ˆæœ¬</li>\n</ol>\n<p>å¦‚æœä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº†nodeï¼Œè¯·å…ˆå¸è½½å®ƒã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew uninstall --ignore-dependencies node </span><br><span class=\"line\">brew uninstall --force node </span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>ä½¿ç”¨Homebrewå®‰è£…nvmï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install nvm</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>å°†nvmåˆå§‹åŒ–è„šæœ¬æ·»åŠ åˆ°ä½ çš„shellé…ç½®æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯zshï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨ä½ çš„<code>~/.zshrc</code>æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> NVM_DIR=<span class=\"string\">&quot;<span class=\"subst\">$([ -z <span class=\"string\">&quot;<span class=\"variable\">$&#123;XDG_CONFIG_HOME-&#125;</span>&quot;</span> ] &amp;&amp; printf %s <span class=\"string\">&quot;<span class=\"variable\">$&#123;HOME&#125;</span>/.nvm&quot;</span> || printf %s <span class=\"string\">&quot;<span class=\"variable\">$&#123;XDG_CONFIG_HOME&#125;</span>/nvm&quot;</span>)</span>&quot;</span></span><br><span class=\"line\">[ -s <span class=\"string\">&quot;<span class=\"variable\">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; \\. <span class=\"string\">&quot;<span class=\"variable\">$NVM_DIR</span>/nvm.sh&quot;</span> <span class=\"comment\"># This loads nvm</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼Œä½ å¯ä»¥é‡æ–°å¯åŠ¨ä½ çš„ç»ˆç«¯ï¼Œæˆ–è€…è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>éªŒè¯nvmå®‰è£…æˆåŠŸï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm --version</span><br></pre></td></tr></table></figure>\n\n<p>ä»¥ä¸Šæ­¥éª¤å°†ä¼šåœ¨ä½ çš„macOSç³»ç»Ÿä¸Šå®‰è£…nvmï¼Œå¹¶ä¸”è®¾ç½®zshä½¿å…¶èƒ½å¤Ÿè¯†åˆ«nvmå‘½ä»¤ã€‚</p>\n<h3 id=\"å¸¸ç”¨å‘½ä»¤\"><a href=\"#å¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"å¸¸ç”¨å‘½ä»¤\"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nvm -v //æŸ¥çœ‹nvmç‰ˆæœ¬</span><br><span class=\"line\">nvm <span class=\"built_in\">ls</span> //æŸ¥çœ‹æœ¬æœºå·²ç»å®‰è£…nodeç‰ˆæœ¬</span><br><span class=\"line\">nvm use åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬node</span><br><span class=\"line\">nvm ls-remote //åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…çš„è¿œç¨‹nodeç‰ˆæœ¬</span><br><span class=\"line\">nvm install stable    //å®‰è£…æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">nvm install &lt;version&gt; //å®‰è£…æŒ‡å®šç‰ˆæœ¬</span><br><span class=\"line\">nvm uninstall stable   //å¸è½½æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">nvm uninstall &lt;version&gt;   //å¸è½½æŒ‡å®šç‰ˆæœ¬</span><br><span class=\"line\">nvm current //æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„nodeç‰ˆæœ¬</span><br><span class=\"line\">npm <span class=\"built_in\">which</span> [current|&lt;version&gt;] //æ˜¾ç¤ºå·²å®‰è£…nodeçš„å®‰è£…è·¯å¾„ã€‚</span><br><span class=\"line\">nvm cache <span class=\"built_in\">dir</span> //æ˜¾ç¤ºnvmçš„ç¼“å­˜ç›®å½•</span><br><span class=\"line\">nvm cache clear //æ¸…æ¥šnvmçš„ç¼“å­˜ç›®å½•</span><br><span class=\"line\">nvm node_mirror [url] //è®¾ç½®nodeé•œåƒ</span><br><span class=\"line\">nvm npm_mirror [url] //è®¾ç½®npmé•œåƒ</span><br><span class=\"line\">nvm on //å¼€å¯node.jsç‰ˆæœ¬ç®¡ç†</span><br><span class=\"line\">nvm off //å…³é—­node.jsç‰ˆæœ¬ç®¡ç†</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">æ›´æ–°npmåˆ°æœ€æ–°ç‰ˆæœ¬</span><br><span class=\"line\">npm install -g npm@latest</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"è¸©å‘è®°å½•ï¼š\"><a href=\"#è¸©å‘è®°å½•ï¼š\" class=\"headerlink\" title=\"è¸©å‘è®°å½•ï¼š\"></a>è¸©å‘è®°å½•ï¼š</h3><p>ç»ˆç«¯å®‰è£…å¥½äº†nvmå’Œnodeï¼Œä½†æ˜¯åœ¨vscodeæ‰“å¼€åæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦åœ¨<code> vi ~/.zshrc</code>åŠ å…¥<code>export PATH=&quot;~/.composer/vendor/bin:$PATH&quot;</code></p>\n<h3 id=\"å‚è€ƒæ–‡ç« ï¼š\"><a href=\"#å‚è€ƒæ–‡ç« ï¼š\" class=\"headerlink\" title=\"å‚è€ƒæ–‡ç« ï¼š\"></a>å‚è€ƒæ–‡ç« ï¼š</h3><p><a href=\"https://juejin.cn/post/7083026831263137800\">å¦‚ä½•åœ¨macOSä¸Šå®‰è£…NVM</a></p>\n<p><a href=\"https://www.cnblogs.com/famensaodiseng/p/10427673.html\">Macä¸‹å®‰è£…nvmåvscodeè¾“å…¥node -vä¸èµ·ä½œç”¨</a></p>\n"},{"title":"Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024","date":"2024-02-07T07:49:30.000Z","_content":"\n> Mac mç³»åˆ—èŠ¯ç‰‡ä½¿ç”¨çš„æ˜¯armæ¶æ„ï¼Œå¾ˆå¤šè½¯ä»¶éƒ½æœ‰æ¨å‡ºè®¾é…ç‰ˆæœ¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…è¿‡ç¨‹ã€‚\n\n## ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\n\nzuluæ¨å‡ºäº†è®¾é…armæ¶æ„çš„jdkç‰ˆæœ¬ï¼Œä¸‹è½½åœ°å€[zulu jdk](https://www.azul.com/downloads/?package=jdk#zulu)ï¼Œä¸‹è½½åç›´æ¥å®‰è£…å°±å¯ä»¥ã€‚\n\n![image-20240206133833207](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206133833207.png)\n\n\n\n## äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\n\nä¸‹è½½jetbaraå’Œç ´è§£åŒ…ï¼Œç ´è§£åŒ…å¯ä»¥é€šè¿‡[ç½‘ç«™](https://3.jetbra.in/)ä¸‹è½½ï¼Œæ¿€æ´»ç ä¹Ÿåœ¨è¿™ä¸ªç½‘ç«™ä¸Šé¢ï¼Œä¸‹è½½jaråè§£å‹ï¼Œå¾…ä¼šéœ€è¦ç”¨åˆ°srcptsè„šæœ¬è¿˜æœ‰æ¿€æ´»ç ã€‚\n\n![image-20240206134345771](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206134345771.png)\n\næ‰“å¼€ç»ˆç«¯è¿›å…¥scriptsæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œinstall.shè„šæœ¬ã€‚\n\n![image-20240206135441039](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206135441039.png)\n\néƒ¨åˆ†ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½ä¼šå’Œæˆ‘ä¸€æ ·å‡ºç°äº†`Operation not permitted`ã€‚\n\nåŸå› ï¼šmacç”µè„‘å¯ç”¨äº†SIPï¼ˆSystem Integrity Protectionï¼‰ï¼Œå¢åŠ äº†rootlessæœºåˆ¶ï¼Œå¯¼è‡´å³ä½¿åœ¨rootæƒé™ä¸‹ä¾ç„¶æ— æ³•ä¿®æ”¹æ–‡ä»¶ï¼Œå…³é—­è¯¥ä¿æŠ¤æœºåˆ¶æ‰èƒ½è¿›è¡Œä¿®æ”¹ã€‚\nå‚è€ƒæ–‡æ¡£ï¼š[macOS å¼€å¯æˆ–å…³é—­ SIP](https://sspai.com/post/55066)ï¼ˆm1éœ€è¦ä¸€ç›´æŒ‰ç€å¼€æœºé”®è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼‰\n\n![image-20240206143034823](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143034823.png)\n\n\n\n![image-20240206143847348](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143847348.png)\n\næ­¤æ—¶å·²ç»æˆåŠŸå…³é—­ï¼Œé‡æ–°æ‰§è¡Œinstall.jsè„šæœ¬ï¼Œæ˜¾ç¤º`done`è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚\n\nåœ¨ideaè¾“å…¥æ¿€æ´»ç å³å¯ï¼Œå¦‚æœå‡ºç°`Key is invalid`å»ºè®®é‡æ–°ä¸€ä¸‹ç”µè„‘æˆ–è€…é‡æ–°å®‰è£…è½¯ä»¶ã€‚\n\n### âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\n\nè¯·æ‰§è¡Œ`sudo sh uninstall.sh`å†æ‰§è¡Œ`sudo sh install.sh`\n\n\n## ä¸‰ã€é…ç½®Maven\n\nä¸ªäººä¹ æƒ¯ä½¿ç”¨ideaè‡ªå¸¦çš„mavenï¼Œç‰ˆæœ¬3.9.5ï¼Œåªéœ€è¦ä¿®æ”¹æˆé˜¿é‡Œäº‘é•œåƒå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚\n\n![image-20240206181908542](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206181908542.png)\n\nè¿›å…¥.m2æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æŒ‰ä½`command`+`shift`+`.`æ˜¾ç¤ºéšè—æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°.m2æ–‡ä»¶å¤¹ï¼Œè¿›å…¥ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤`touch settings.xml`æ–°å»ºxmlæ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<settings xmlns=\"http://maven.apache.org/SETTINGS/1.0.0\"\n          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n          xsi:schemaLocation=\"http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\">\n\t<!-- æœ¬åœ°ä¸‹è½½çš„jaråŒ…åœ°å€ é…ç½®æˆ‘ä»¬çš„æ•°æ®ç›˜å³å¯-->\n\t<localRepository>/Users/raychen/.m2/repository</localRepository>\n    <mirrors>\n        <!-- é˜¿é‡Œäº‘ä»“åº“ -->\n        <mirror>\n            <id>alimaven</id>\n            <mirrorOf>central</mirrorOf>\n            <name>aliyun maven</name>\n            <url>http://maven.aliyun.com/nexus/content/repositories/central/</url>\n        </mirror>\n    \n        <!-- ä¸­å¤®ä»“åº“1 -->\n        <mirror>\n            <id>repo1</id>\n            <mirrorOf>central</mirrorOf>\n            <name>Human Readable Name for this Mirror.</name>\n            <url>http://repo1.maven.org/maven2/</url>\n        </mirror>\n    \n        <!-- ä¸­å¤®ä»“åº“2 -->\n        <mirror>\n            <id>repo2</id>\n            <mirrorOf>central</mirrorOf>\n            <name>Human Readable Name for this Mirror.</name>\n            <url>http://repo2.maven.org/maven2/</url>\n        </mirror>\n\t<!-- é˜¿é‡Œäº‘çš„mavenè·¯å¾„, -->\n\t<mirror>\n\t\t<id>nexus-aliyun</id>\n\t\t<mirrorOf>*</mirrorOf>\n\t\t<name>Nexus aliyun</name>\n\t\t<url>http://maven.aliyun.com/nexus/content/groups/public</url>\n\t</mirror>\n    </mirrors> \n</settings>\n```\n\n\n\n## å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\n\n> Homebrewæ˜¯ä¸€æ¬¾Mac OSå¹³å°ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œæ‹¥æœ‰å®‰è£…ã€å¸è½½ã€æ›´æ–°ã€æŸ¥çœ‹ã€æœç´¢ç­‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ã€‚\n\n1.Homebrewä½¿ç”¨\n\n```xml\nbrew -v æŸ¥çœ‹å½“å‰ç‰ˆæœ¬\nbrew list â€”åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶\nbrew update â€”æ›´æ–°Homebrew\nbrew install è½¯ä»¶å â€”å®‰è£…è½¯ä»¶\nbrew search è½¯ä»¶å â€”æœç´¢è½¯ä»¶\nbrew uninstall è½¯ä»¶å â€”å¸è½½è½¯ä»¶\nbrew update â€”æ›´æ–°æ‰€æœ‰è½¯ä»¶\nbrew upgrade è½¯ä»¶å â€”æ›´æ–°å…·ä½“è½¯ä»¶\nbrew outdated â€”æŸ¥çœ‹å“ªäº›å·²å®‰è£…çš„ç¨‹åºéœ€è¦æ›´æ–°\n```\n\n2.å®‰è£…Homebrewçš„å›½å†…é•œåƒ\n\n```xml\n/bin/bash -c \"$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)\"\n```\n\n![image-20240206212509503](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206212509503.png)\n\n3.å®‰è£…gitï¼š\n\n```xml\nbrew install git\n```\n\n4.éªŒè¯gitæ˜¯å¦å®‰è£…æˆåŠŸï¼š\n\n```xml\ngit --version\n```\n\n5.è®¾ç½®gitè´¦æˆ·åç§°å’Œé‚®ç®±\n\n```xml\ngit config --global user.name \"ç”¨æˆ·å\"\ngit config --global user.email \"é‚®ç®±\" \n```\n\n6.æŸ¥çœ‹gitè´¦æˆ·åç§°å’Œé‚®ç®±\n\n```xml\ngit config user.name\ngit config user.email\n```\n\n7.sshå¯†é’¥çš„ç”Ÿæˆå’Œé…ç½®\n\nsshæŒ‡secure shell(ä¸€ç§å®‰å…¨çš„ç½‘ç»œåè®®)ï¼Œgitä½¿ç”¨è¿™ç§åè®®è¿›è¡Œè¿œç¨‹åŠ å¯†ç™»å½•ã€‚\n\n```xml\nssh-keygen -t rsa -C \"é‚®ç®±\"\n```\n\n![image-20240206214423691](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214423691.png)\n\nç„¶ååœ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥`cat id_rsa.pub `å¤åˆ¶å¯†é’¥ã€‚\n\n![image-20240206214940022](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214940022.png)\n\n\n\n## äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\n\n1.å»[å®˜ç½‘](https://dev.mysql.com/downloads/mysql/)ä¸‹è½½Mysqlå®‰è£…åŒ…\n\n![image-20240206221554629](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206221554629.png)\n\nå®‰è£…æˆåŠŸåå‘ç°è¿˜æ˜¯æ²¡æ³•ç›´æ¥ä½¿ç”¨mysqlï¼š\n\n![image-20240206222851331](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206222851331.png)\n\nè¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡\n\n2.å…³äºmacç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®ï¼š\n\n- open/vim /etc/profileï¼ˆä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œä¸ç®¡æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œç™»é™†æ—¶éƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚\n- /etc/bashrc ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œbash shellæ‰§è¡Œæ—¶ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚\n- ~/.bash_profile ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼‰ï¼ˆæ³¨ï¼šLinuxé‡Œé¢æ—¶.bashrcè€Œmacæ˜¯.bash_proofileï¼‰è‹¥bash shellæ˜¯ä»¥loginæ–¹å¼æ‰§è¡Œæ—¶ï¼Œæ‰ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€‚\n\n3.é…ç½®mysqlçš„ç¯å¢ƒå˜é‡\n\n```xml\nvim ~/.bash_profile\n```\n\n![image-20240206224929440](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206224929440.png)\n\nåœ¨æ–‡ä»¶åæ·»åŠ ï¼š\n\n```xml\nexport PATH=$PATH:/usr/locol/mysql/bin\nexport PATH=$PATH:/usr/local/mysql/support-files\n```\n\nå¦‚æœä½ å’Œæˆ‘ä¸€æ ·è¯¥æ–‡ä»¶æ˜¾ç¤ºreadonlyï¼Œé€€å‡ºæ—¶`:wq!`ä¿å­˜ï¼Œè®°å¾—è¦åŠ æ„Ÿå¹å·ã€‚\n\nåˆ·æ–°é…ç½®æ–‡ä»¶ï¼š\n\n```xml\nsource ~/.bash_profile\n```\n\nå¦‚æœæ‰§è¡Œå®Œä¸Šè¿°æ“ä½œï¼Œè¿˜æ˜¯æŠ¥é”™ï¼šzsh:command not found: mysql\n\n4.è®¾ç½®æŒ‡ä»¤åˆ«å\n\n```xml\nvim ~/.bashrc\n```\n\nå†™å…¥ï¼š\n\n```xml\nalias mysql=/usr/local/mysql/bin/mysql\n```\n\nåˆ·æ–°é…ç½®ï¼š\n\n```xml\nsource ~/.bashrc\n```\n\n![image-20240206231528311](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206231528311.png)\n\n\n\n## å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\n\nhttps://macwk.cn/ä¸­æœç´¢Navicatç ´è§£ç‰ˆï¼Œç„¶åä¸‹è½½æ‰“å¼€ï¼Œå¦‚æœå’Œæˆ‘ä¸€æ ·æ˜¯æ–°ç³»ç»Ÿï¼Œå¯èƒ½ä¼šé‡åˆ°æç¤ºæ–‡ä»¶å·²æŸåï¼Œéœ€è¦è¾“å…¥å‘½ä»¤ï¼š\n\n```xml\nsudo xattr -r -d com.apple.quarantine /Applications/Navicat\\ Premium.app\n```\n\nç„¶åè¿æ¥æˆ‘ä»¬çš„mysqlå°±OKäº†ã€‚\n\n\n\n## ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\n\nå‡†å¤‡é€šè¿‡homebrewå®‰è£…nodeï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š\n\n```xml\nbrew install node #é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ\n```\n\næŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š\n\n```xml\nnpm -v #æŸ¥çœ‹npmç‰ˆæœ¬\nnode -v #æŸ¥çœ‹nodeç‰ˆæœ¬\nbrew list #æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶\n```\n\nå®‰è£…å›½å†…æ·˜å®é•œåƒæºï¼ˆæ³¨æ„âš ï¸ï¼š2024å¹´1 æœˆ 22 æ—¥ï¼Œæ·˜å®åŸé•œåƒåŸŸåï¼ˆregistry.npm.taobao.orgï¼‰çš„ HTTPS [è¯ä¹¦](https://so.csdn.net/so/search?q=è¯ä¹¦&spm=1001.2101.3001.7020)æ­£å¼åˆ°æœŸï¼Œæ”¹ç”¨æ–°çš„åŸŸååœ°å€æ‰§è¡Œå‘½ä»¤ï¼‰ï¼š\n\n```xml\nnpm install -g cnpm --registry=https://registry.npmmirror.com\ncnpm -v #æŸ¥çœ‹cnpmç‰ˆæœ¬\n```\n\n![image-20240207120554050](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207120554050.png)\n\n\n\n## å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\n\n1.å»[å®˜ç½‘](https://www.docker.com/products/docker-desktop/)ä¸‹è½½dockerå®¢æˆ·ç«¯\n\n2.ä¸‹è½½å®‰è£…åï¼Œå¯é€šè¿‡å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š\n\n```xml\ndocker -v\n```\n\n![image-20240207135505696](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207135505696.png)\n\n3.ä¸ºäº†æ–¹ä¾¿åç»­æ‹‰å–é•œåƒï¼Œ æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹dockeré•œåƒæºï¼ˆ[é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)ï¼‰\n\n4.https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°\"registry-mirrors\"çš„æ•°ç»„é‡Œï¼Œç‚¹å‡» Apply & RestartæŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dd5ae043bebb49158d6d295101b508ac.png)\n\nå…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š[Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®](http://ruiyeclub.cn/2022/02/01/Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E9%83%A8%E7%BD%B2SpringBoot%E9%A1%B9%E7%9B%AE/)\n\n\n\n## ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\n\n1.é€šè¿‡homebrewå®‰è£…ï¼š\n\n```xml\nbrew install redis\n```\n\n2.å¯åŠ¨å’Œå…³é—­redisï¼š\n\n1.å®˜æ–¹å¯åŠ¨æ–¹å¼ï¼ˆä¸æ¨èï¼Œé‡å¯åéœ€è¦å†æ¬¡æ‰“å¼€æœåŠ¡ï¼‰ï¼š\n```xml\n  redis-server \t\t\t #å¯åŠ¨RedisæœåŠ¡\n  redis-cli shutdown     #åœæ­¢redisæœåŠ¡\n```\n\n2.ä½¿ç”¨brewå‘½ä»¤\n```xml\n  brew services start redis \t#å¯åŠ¨redisæœåŠ¡\n  brew services stop redis \t\t#å…³é—­redisæœåŠ¡\n  brew services restart redis   #é‡å¯redisæœåŠ¡\n```\n\n![image-20240207143540188](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207143540188.png)\n\n3.å¯åŠ¨åè¾“å…¥`redis-cli`æ‰“å¼€å®¢æˆ·ç«¯ã€‚\n\n4.å®‰è£…rediså¯è§†åŒ–è½¯ä»¶ï¼Œæœ‰å¾ˆå¤šå¯è§†åŒ–è½¯ä»¶å¯ä»¥é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯[Tiny RDMã€‚\n\n**å¦‚æœåœ¨ macOS ä¸Šå®‰è£…åæ— æ³•æ‰“å¼€ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç„¶åé‡æ–°æ‰“å¼€ï¼š**\n\n```xml\n sudo xattr -d com.apple.quarantine /Applications/Tiny\\ RDM.app \n```\n\n![image-20240207151046489](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151046489.png)\n\n\n\n## åã€Typoraçš„å®‰è£…å’Œç ´è§£\n\n1.å»å®˜ç½‘é€‰æ‹©macç‰ˆæœ¬ä¸‹è½½å®‰è£… [typoraä¸‹è½½](https://www.typoraio.cn/)ã€‚\n\n2.é€šè¿‡ä¿®æ”¹typoraæ–‡ä»¶è¿›è¡Œç ´è§£ï¼Œæˆ‘çš„æ–‡ä»¶è·¯å¾„åœ¨`/Applications/Typora.app/Contents/Resources/TypeMark/page-dist/static/js`æ‰¾åˆ°æ–‡ä»¶ï¼š\n\n![image-20240207151712209](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151712209.png)\n\n3.è¾“å…¥ hasActivated=\"true\"==e.hasActivated è¿›è¡Œæœç´¢ï¼Œç„¶åå°†å®ƒæ”¹ä¸º hasActivated=\"true\"==\"true\"ã€‚\n\n![image-20240207152013022](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207152013022.png)\n\n4.é‡æ–°æ‰“å¼€è½¯ä»¶ï¼Œæ¿€æ´»æˆåŠŸï¼š\n\n![image-20240207151955004](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151955004.png)\n\nå…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š[å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)](http://ruiyeclub.cn/2024/01/04/%E5%BC%80%E5%8F%91%E5%BF%85%E5%A4%87%E8%BD%AF%E4%BB%B6-Typora%E9%85%8D%E5%90%88PicGo%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE(%E8%BD%AC)/)\n\n\n\nå‚è€ƒè§†é¢‘ï¼š[Mac M1 ç¨‹åºå‘˜å¼€å‘ç¯å¢ƒçš„å®‰è£…ä¸é…ç½®](https://www.bilibili.com/video/BV16L4y1b75R/?share_source=copy_web&vd_source=c31decb11361be9e30ea99abeef3e302)\n","source":"_posts/Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024.md","raw":"---\ntitle: Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024\ndate: 2024-02-07 15:49:30\ntags:\n---\n\n> Mac mç³»åˆ—èŠ¯ç‰‡ä½¿ç”¨çš„æ˜¯armæ¶æ„ï¼Œå¾ˆå¤šè½¯ä»¶éƒ½æœ‰æ¨å‡ºè®¾é…ç‰ˆæœ¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…è¿‡ç¨‹ã€‚\n\n## ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\n\nzuluæ¨å‡ºäº†è®¾é…armæ¶æ„çš„jdkç‰ˆæœ¬ï¼Œä¸‹è½½åœ°å€[zulu jdk](https://www.azul.com/downloads/?package=jdk#zulu)ï¼Œä¸‹è½½åç›´æ¥å®‰è£…å°±å¯ä»¥ã€‚\n\n![image-20240206133833207](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206133833207.png)\n\n\n\n## äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\n\nä¸‹è½½jetbaraå’Œç ´è§£åŒ…ï¼Œç ´è§£åŒ…å¯ä»¥é€šè¿‡[ç½‘ç«™](https://3.jetbra.in/)ä¸‹è½½ï¼Œæ¿€æ´»ç ä¹Ÿåœ¨è¿™ä¸ªç½‘ç«™ä¸Šé¢ï¼Œä¸‹è½½jaråè§£å‹ï¼Œå¾…ä¼šéœ€è¦ç”¨åˆ°srcptsè„šæœ¬è¿˜æœ‰æ¿€æ´»ç ã€‚\n\n![image-20240206134345771](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206134345771.png)\n\næ‰“å¼€ç»ˆç«¯è¿›å…¥scriptsæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œinstall.shè„šæœ¬ã€‚\n\n![image-20240206135441039](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206135441039.png)\n\néƒ¨åˆ†ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½ä¼šå’Œæˆ‘ä¸€æ ·å‡ºç°äº†`Operation not permitted`ã€‚\n\nåŸå› ï¼šmacç”µè„‘å¯ç”¨äº†SIPï¼ˆSystem Integrity Protectionï¼‰ï¼Œå¢åŠ äº†rootlessæœºåˆ¶ï¼Œå¯¼è‡´å³ä½¿åœ¨rootæƒé™ä¸‹ä¾ç„¶æ— æ³•ä¿®æ”¹æ–‡ä»¶ï¼Œå…³é—­è¯¥ä¿æŠ¤æœºåˆ¶æ‰èƒ½è¿›è¡Œä¿®æ”¹ã€‚\nå‚è€ƒæ–‡æ¡£ï¼š[macOS å¼€å¯æˆ–å…³é—­ SIP](https://sspai.com/post/55066)ï¼ˆm1éœ€è¦ä¸€ç›´æŒ‰ç€å¼€æœºé”®è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼‰\n\n![image-20240206143034823](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143034823.png)\n\n\n\n![image-20240206143847348](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143847348.png)\n\næ­¤æ—¶å·²ç»æˆåŠŸå…³é—­ï¼Œé‡æ–°æ‰§è¡Œinstall.jsè„šæœ¬ï¼Œæ˜¾ç¤º`done`è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚\n\nåœ¨ideaè¾“å…¥æ¿€æ´»ç å³å¯ï¼Œå¦‚æœå‡ºç°`Key is invalid`å»ºè®®é‡æ–°ä¸€ä¸‹ç”µè„‘æˆ–è€…é‡æ–°å®‰è£…è½¯ä»¶ã€‚\n\n### âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\n\nè¯·æ‰§è¡Œ`sudo sh uninstall.sh`å†æ‰§è¡Œ`sudo sh install.sh`\n\n\n## ä¸‰ã€é…ç½®Maven\n\nä¸ªäººä¹ æƒ¯ä½¿ç”¨ideaè‡ªå¸¦çš„mavenï¼Œç‰ˆæœ¬3.9.5ï¼Œåªéœ€è¦ä¿®æ”¹æˆé˜¿é‡Œäº‘é•œåƒå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚\n\n![image-20240206181908542](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206181908542.png)\n\nè¿›å…¥.m2æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æŒ‰ä½`command`+`shift`+`.`æ˜¾ç¤ºéšè—æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°.m2æ–‡ä»¶å¤¹ï¼Œè¿›å…¥ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤`touch settings.xml`æ–°å»ºxmlæ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<settings xmlns=\"http://maven.apache.org/SETTINGS/1.0.0\"\n          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n          xsi:schemaLocation=\"http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd\">\n\t<!-- æœ¬åœ°ä¸‹è½½çš„jaråŒ…åœ°å€ é…ç½®æˆ‘ä»¬çš„æ•°æ®ç›˜å³å¯-->\n\t<localRepository>/Users/raychen/.m2/repository</localRepository>\n    <mirrors>\n        <!-- é˜¿é‡Œäº‘ä»“åº“ -->\n        <mirror>\n            <id>alimaven</id>\n            <mirrorOf>central</mirrorOf>\n            <name>aliyun maven</name>\n            <url>http://maven.aliyun.com/nexus/content/repositories/central/</url>\n        </mirror>\n    \n        <!-- ä¸­å¤®ä»“åº“1 -->\n        <mirror>\n            <id>repo1</id>\n            <mirrorOf>central</mirrorOf>\n            <name>Human Readable Name for this Mirror.</name>\n            <url>http://repo1.maven.org/maven2/</url>\n        </mirror>\n    \n        <!-- ä¸­å¤®ä»“åº“2 -->\n        <mirror>\n            <id>repo2</id>\n            <mirrorOf>central</mirrorOf>\n            <name>Human Readable Name for this Mirror.</name>\n            <url>http://repo2.maven.org/maven2/</url>\n        </mirror>\n\t<!-- é˜¿é‡Œäº‘çš„mavenè·¯å¾„, -->\n\t<mirror>\n\t\t<id>nexus-aliyun</id>\n\t\t<mirrorOf>*</mirrorOf>\n\t\t<name>Nexus aliyun</name>\n\t\t<url>http://maven.aliyun.com/nexus/content/groups/public</url>\n\t</mirror>\n    </mirrors> \n</settings>\n```\n\n\n\n## å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\n\n> Homebrewæ˜¯ä¸€æ¬¾Mac OSå¹³å°ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œæ‹¥æœ‰å®‰è£…ã€å¸è½½ã€æ›´æ–°ã€æŸ¥çœ‹ã€æœç´¢ç­‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ã€‚\n\n1.Homebrewä½¿ç”¨\n\n```xml\nbrew -v æŸ¥çœ‹å½“å‰ç‰ˆæœ¬\nbrew list â€”åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶\nbrew update â€”æ›´æ–°Homebrew\nbrew install è½¯ä»¶å â€”å®‰è£…è½¯ä»¶\nbrew search è½¯ä»¶å â€”æœç´¢è½¯ä»¶\nbrew uninstall è½¯ä»¶å â€”å¸è½½è½¯ä»¶\nbrew update â€”æ›´æ–°æ‰€æœ‰è½¯ä»¶\nbrew upgrade è½¯ä»¶å â€”æ›´æ–°å…·ä½“è½¯ä»¶\nbrew outdated â€”æŸ¥çœ‹å“ªäº›å·²å®‰è£…çš„ç¨‹åºéœ€è¦æ›´æ–°\n```\n\n2.å®‰è£…Homebrewçš„å›½å†…é•œåƒ\n\n```xml\n/bin/bash -c \"$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)\"\n```\n\n![image-20240206212509503](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206212509503.png)\n\n3.å®‰è£…gitï¼š\n\n```xml\nbrew install git\n```\n\n4.éªŒè¯gitæ˜¯å¦å®‰è£…æˆåŠŸï¼š\n\n```xml\ngit --version\n```\n\n5.è®¾ç½®gitè´¦æˆ·åç§°å’Œé‚®ç®±\n\n```xml\ngit config --global user.name \"ç”¨æˆ·å\"\ngit config --global user.email \"é‚®ç®±\" \n```\n\n6.æŸ¥çœ‹gitè´¦æˆ·åç§°å’Œé‚®ç®±\n\n```xml\ngit config user.name\ngit config user.email\n```\n\n7.sshå¯†é’¥çš„ç”Ÿæˆå’Œé…ç½®\n\nsshæŒ‡secure shell(ä¸€ç§å®‰å…¨çš„ç½‘ç»œåè®®)ï¼Œgitä½¿ç”¨è¿™ç§åè®®è¿›è¡Œè¿œç¨‹åŠ å¯†ç™»å½•ã€‚\n\n```xml\nssh-keygen -t rsa -C \"é‚®ç®±\"\n```\n\n![image-20240206214423691](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214423691.png)\n\nç„¶ååœ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥`cat id_rsa.pub `å¤åˆ¶å¯†é’¥ã€‚\n\n![image-20240206214940022](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214940022.png)\n\n\n\n## äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\n\n1.å»[å®˜ç½‘](https://dev.mysql.com/downloads/mysql/)ä¸‹è½½Mysqlå®‰è£…åŒ…\n\n![image-20240206221554629](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206221554629.png)\n\nå®‰è£…æˆåŠŸåå‘ç°è¿˜æ˜¯æ²¡æ³•ç›´æ¥ä½¿ç”¨mysqlï¼š\n\n![image-20240206222851331](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206222851331.png)\n\nè¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡\n\n2.å…³äºmacç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®ï¼š\n\n- open/vim /etc/profileï¼ˆä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œä¸ç®¡æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œç™»é™†æ—¶éƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚\n- /etc/bashrc ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œbash shellæ‰§è¡Œæ—¶ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚\n- ~/.bash_profile ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼‰ï¼ˆæ³¨ï¼šLinuxé‡Œé¢æ—¶.bashrcè€Œmacæ˜¯.bash_proofileï¼‰è‹¥bash shellæ˜¯ä»¥loginæ–¹å¼æ‰§è¡Œæ—¶ï¼Œæ‰ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€‚\n\n3.é…ç½®mysqlçš„ç¯å¢ƒå˜é‡\n\n```xml\nvim ~/.bash_profile\n```\n\n![image-20240206224929440](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206224929440.png)\n\nåœ¨æ–‡ä»¶åæ·»åŠ ï¼š\n\n```xml\nexport PATH=$PATH:/usr/locol/mysql/bin\nexport PATH=$PATH:/usr/local/mysql/support-files\n```\n\nå¦‚æœä½ å’Œæˆ‘ä¸€æ ·è¯¥æ–‡ä»¶æ˜¾ç¤ºreadonlyï¼Œé€€å‡ºæ—¶`:wq!`ä¿å­˜ï¼Œè®°å¾—è¦åŠ æ„Ÿå¹å·ã€‚\n\nåˆ·æ–°é…ç½®æ–‡ä»¶ï¼š\n\n```xml\nsource ~/.bash_profile\n```\n\nå¦‚æœæ‰§è¡Œå®Œä¸Šè¿°æ“ä½œï¼Œè¿˜æ˜¯æŠ¥é”™ï¼šzsh:command not found: mysql\n\n4.è®¾ç½®æŒ‡ä»¤åˆ«å\n\n```xml\nvim ~/.bashrc\n```\n\nå†™å…¥ï¼š\n\n```xml\nalias mysql=/usr/local/mysql/bin/mysql\n```\n\nåˆ·æ–°é…ç½®ï¼š\n\n```xml\nsource ~/.bashrc\n```\n\n![image-20240206231528311](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206231528311.png)\n\n\n\n## å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\n\nhttps://macwk.cn/ä¸­æœç´¢Navicatç ´è§£ç‰ˆï¼Œç„¶åä¸‹è½½æ‰“å¼€ï¼Œå¦‚æœå’Œæˆ‘ä¸€æ ·æ˜¯æ–°ç³»ç»Ÿï¼Œå¯èƒ½ä¼šé‡åˆ°æç¤ºæ–‡ä»¶å·²æŸåï¼Œéœ€è¦è¾“å…¥å‘½ä»¤ï¼š\n\n```xml\nsudo xattr -r -d com.apple.quarantine /Applications/Navicat\\ Premium.app\n```\n\nç„¶åè¿æ¥æˆ‘ä»¬çš„mysqlå°±OKäº†ã€‚\n\n\n\n## ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\n\nå‡†å¤‡é€šè¿‡homebrewå®‰è£…nodeï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š\n\n```xml\nbrew install node #é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ\n```\n\næŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š\n\n```xml\nnpm -v #æŸ¥çœ‹npmç‰ˆæœ¬\nnode -v #æŸ¥çœ‹nodeç‰ˆæœ¬\nbrew list #æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶\n```\n\nå®‰è£…å›½å†…æ·˜å®é•œåƒæºï¼ˆæ³¨æ„âš ï¸ï¼š2024å¹´1 æœˆ 22 æ—¥ï¼Œæ·˜å®åŸé•œåƒåŸŸåï¼ˆregistry.npm.taobao.orgï¼‰çš„ HTTPS [è¯ä¹¦](https://so.csdn.net/so/search?q=è¯ä¹¦&spm=1001.2101.3001.7020)æ­£å¼åˆ°æœŸï¼Œæ”¹ç”¨æ–°çš„åŸŸååœ°å€æ‰§è¡Œå‘½ä»¤ï¼‰ï¼š\n\n```xml\nnpm install -g cnpm --registry=https://registry.npmmirror.com\ncnpm -v #æŸ¥çœ‹cnpmç‰ˆæœ¬\n```\n\n![image-20240207120554050](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207120554050.png)\n\n\n\n## å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\n\n1.å»[å®˜ç½‘](https://www.docker.com/products/docker-desktop/)ä¸‹è½½dockerå®¢æˆ·ç«¯\n\n2.ä¸‹è½½å®‰è£…åï¼Œå¯é€šè¿‡å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š\n\n```xml\ndocker -v\n```\n\n![image-20240207135505696](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207135505696.png)\n\n3.ä¸ºäº†æ–¹ä¾¿åç»­æ‹‰å–é•œåƒï¼Œ æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹dockeré•œåƒæºï¼ˆ[é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)ï¼‰\n\n4.https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°\"registry-mirrors\"çš„æ•°ç»„é‡Œï¼Œç‚¹å‡» Apply & RestartæŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dd5ae043bebb49158d6d295101b508ac.png)\n\nå…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š[Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®](http://ruiyeclub.cn/2022/02/01/Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E9%83%A8%E7%BD%B2SpringBoot%E9%A1%B9%E7%9B%AE/)\n\n\n\n## ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\n\n1.é€šè¿‡homebrewå®‰è£…ï¼š\n\n```xml\nbrew install redis\n```\n\n2.å¯åŠ¨å’Œå…³é—­redisï¼š\n\n1.å®˜æ–¹å¯åŠ¨æ–¹å¼ï¼ˆä¸æ¨èï¼Œé‡å¯åéœ€è¦å†æ¬¡æ‰“å¼€æœåŠ¡ï¼‰ï¼š\n```xml\n  redis-server \t\t\t #å¯åŠ¨RedisæœåŠ¡\n  redis-cli shutdown     #åœæ­¢redisæœåŠ¡\n```\n\n2.ä½¿ç”¨brewå‘½ä»¤\n```xml\n  brew services start redis \t#å¯åŠ¨redisæœåŠ¡\n  brew services stop redis \t\t#å…³é—­redisæœåŠ¡\n  brew services restart redis   #é‡å¯redisæœåŠ¡\n```\n\n![image-20240207143540188](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207143540188.png)\n\n3.å¯åŠ¨åè¾“å…¥`redis-cli`æ‰“å¼€å®¢æˆ·ç«¯ã€‚\n\n4.å®‰è£…rediså¯è§†åŒ–è½¯ä»¶ï¼Œæœ‰å¾ˆå¤šå¯è§†åŒ–è½¯ä»¶å¯ä»¥é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯[Tiny RDMã€‚\n\n**å¦‚æœåœ¨ macOS ä¸Šå®‰è£…åæ— æ³•æ‰“å¼€ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç„¶åé‡æ–°æ‰“å¼€ï¼š**\n\n```xml\n sudo xattr -d com.apple.quarantine /Applications/Tiny\\ RDM.app \n```\n\n![image-20240207151046489](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151046489.png)\n\n\n\n## åã€Typoraçš„å®‰è£…å’Œç ´è§£\n\n1.å»å®˜ç½‘é€‰æ‹©macç‰ˆæœ¬ä¸‹è½½å®‰è£… [typoraä¸‹è½½](https://www.typoraio.cn/)ã€‚\n\n2.é€šè¿‡ä¿®æ”¹typoraæ–‡ä»¶è¿›è¡Œç ´è§£ï¼Œæˆ‘çš„æ–‡ä»¶è·¯å¾„åœ¨`/Applications/Typora.app/Contents/Resources/TypeMark/page-dist/static/js`æ‰¾åˆ°æ–‡ä»¶ï¼š\n\n![image-20240207151712209](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151712209.png)\n\n3.è¾“å…¥ hasActivated=\"true\"==e.hasActivated è¿›è¡Œæœç´¢ï¼Œç„¶åå°†å®ƒæ”¹ä¸º hasActivated=\"true\"==\"true\"ã€‚\n\n![image-20240207152013022](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207152013022.png)\n\n4.é‡æ–°æ‰“å¼€è½¯ä»¶ï¼Œæ¿€æ´»æˆåŠŸï¼š\n\n![image-20240207151955004](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151955004.png)\n\nå…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š[å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)](http://ruiyeclub.cn/2024/01/04/%E5%BC%80%E5%8F%91%E5%BF%85%E5%A4%87%E8%BD%AF%E4%BB%B6-Typora%E9%85%8D%E5%90%88PicGo%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE(%E8%BD%AC)/)\n\n\n\nå‚è€ƒè§†é¢‘ï¼š[Mac M1 ç¨‹åºå‘˜å¼€å‘ç¯å¢ƒçš„å®‰è£…ä¸é…ç½®](https://www.bilibili.com/video/BV16L4y1b75R/?share_source=copy_web&vd_source=c31decb11361be9e30ea99abeef3e302)\n","slug":"Mac m1ç¨‹åºå‘˜å¼€å‘è½¯ä»¶çš„å®‰è£…å’Œé…ç½®2024","published":1,"updated":"2025-01-15T06:19:55.290Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dl000iwen165fna72y","content":"<blockquote>\n<p>Mac mç³»åˆ—èŠ¯ç‰‡ä½¿ç”¨çš„æ˜¯armæ¶æ„ï¼Œå¾ˆå¤šè½¯ä»¶éƒ½æœ‰æ¨å‡ºè®¾é…ç‰ˆæœ¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…è¿‡ç¨‹ã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\"><a href=\"#ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\"></a>ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®</h2><p>zuluæ¨å‡ºäº†è®¾é…armæ¶æ„çš„jdkç‰ˆæœ¬ï¼Œä¸‹è½½åœ°å€<a href=\"https://www.azul.com/downloads/?package=jdk#zulu\">zulu jdk</a>ï¼Œä¸‹è½½åç›´æ¥å®‰è£…å°±å¯ä»¥ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206133833207.png\" alt=\"image-20240206133833207\"></p>\n<h2 id=\"äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\"><a href=\"#äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\" class=\"headerlink\" title=\"äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\"></a>äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£</h2><p>ä¸‹è½½jetbaraå’Œç ´è§£åŒ…ï¼Œç ´è§£åŒ…å¯ä»¥é€šè¿‡<a href=\"https://3.jetbra.in/\">ç½‘ç«™</a>ä¸‹è½½ï¼Œæ¿€æ´»ç ä¹Ÿåœ¨è¿™ä¸ªç½‘ç«™ä¸Šé¢ï¼Œä¸‹è½½jaråè§£å‹ï¼Œå¾…ä¼šéœ€è¦ç”¨åˆ°srcptsè„šæœ¬è¿˜æœ‰æ¿€æ´»ç ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206134345771.png\" alt=\"image-20240206134345771\"></p>\n<p>æ‰“å¼€ç»ˆç«¯è¿›å…¥scriptsæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œinstall.shè„šæœ¬ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206135441039.png\" alt=\"image-20240206135441039\"></p>\n<p>éƒ¨åˆ†ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½ä¼šå’Œæˆ‘ä¸€æ ·å‡ºç°äº†<code>Operation not permitted</code>ã€‚</p>\n<p>åŸå› ï¼šmacç”µè„‘å¯ç”¨äº†SIPï¼ˆSystem Integrity Protectionï¼‰ï¼Œå¢åŠ äº†rootlessæœºåˆ¶ï¼Œå¯¼è‡´å³ä½¿åœ¨rootæƒé™ä¸‹ä¾ç„¶æ— æ³•ä¿®æ”¹æ–‡ä»¶ï¼Œå…³é—­è¯¥ä¿æŠ¤æœºåˆ¶æ‰èƒ½è¿›è¡Œä¿®æ”¹ã€‚<br>å‚è€ƒæ–‡æ¡£ï¼š<a href=\"https://sspai.com/post/55066\">macOS å¼€å¯æˆ–å…³é—­ SIP</a>ï¼ˆm1éœ€è¦ä¸€ç›´æŒ‰ç€å¼€æœºé”®è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼‰</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143034823.png\" alt=\"image-20240206143034823\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143847348.png\" alt=\"image-20240206143847348\"></p>\n<p>æ­¤æ—¶å·²ç»æˆåŠŸå…³é—­ï¼Œé‡æ–°æ‰§è¡Œinstall.jsè„šæœ¬ï¼Œæ˜¾ç¤º<code>done</code>è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚</p>\n<p>åœ¨ideaè¾“å…¥æ¿€æ´»ç å³å¯ï¼Œå¦‚æœå‡ºç°<code>Key is invalid</code>å»ºè®®é‡æ–°ä¸€ä¸‹ç”µè„‘æˆ–è€…é‡æ–°å®‰è£…è½¯ä»¶ã€‚</p>\n<h3 id=\"âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\"><a href=\"#âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\" class=\"headerlink\" title=\"âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\"></a>âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ</h3><p>è¯·æ‰§è¡Œ<code>sudo sh uninstall.sh</code>å†æ‰§è¡Œ<code>sudo sh install.sh</code></p>\n<h2 id=\"ä¸‰ã€é…ç½®Maven\"><a href=\"#ä¸‰ã€é…ç½®Maven\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®Maven\"></a>ä¸‰ã€é…ç½®Maven</h2><p>ä¸ªäººä¹ æƒ¯ä½¿ç”¨ideaè‡ªå¸¦çš„mavenï¼Œç‰ˆæœ¬3.9.5ï¼Œåªéœ€è¦ä¿®æ”¹æˆé˜¿é‡Œäº‘é•œåƒå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206181908542.png\" alt=\"image-20240206181908542\"></p>\n<p>è¿›å…¥.m2æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æŒ‰ä½<code>command</code>+<code>shift</code>+<code>.</code>æ˜¾ç¤ºéšè—æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°.m2æ–‡ä»¶å¤¹ï¼Œè¿›å…¥ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤<code>touch settings.xml</code>æ–°å»ºxmlæ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- æœ¬åœ°ä¸‹è½½çš„jaråŒ…åœ°å€ é…ç½®æˆ‘ä»¬çš„æ•°æ®ç›˜å³å¯--&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">localRepository</span>&gt;</span>/Users/raychen/.m2/repository<span class=\"tag\">&lt;/<span class=\"name\">localRepository</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mirrors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- é˜¿é‡Œäº‘ä»“åº“ --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>alimaven<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>aliyun maven<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- ä¸­å¤®ä»“åº“1 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>repo1<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Human Readable Name for this Mirror.<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://repo1.maven.org/maven2/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- ä¸­å¤®ä»“åº“2 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>repo2<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Human Readable Name for this Mirror.<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://repo2.maven.org/maven2/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- é˜¿é‡Œäº‘çš„mavenè·¯å¾„, --&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>nexus-aliyun<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>*<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus aliyun<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">mirrors</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\"><a href=\"#å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\"></a>å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®</h2><blockquote>\n<p>Homebrewæ˜¯ä¸€æ¬¾Mac OSå¹³å°ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œæ‹¥æœ‰å®‰è£…ã€å¸è½½ã€æ›´æ–°ã€æŸ¥çœ‹ã€æœç´¢ç­‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ã€‚</p>\n</blockquote>\n<p>1.Homebrewä½¿ç”¨</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew -v æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</span><br><span class=\"line\">brew list â€”åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶</span><br><span class=\"line\">brew update â€”æ›´æ–°Homebrew</span><br><span class=\"line\">brew install è½¯ä»¶å â€”å®‰è£…è½¯ä»¶</span><br><span class=\"line\">brew search è½¯ä»¶å â€”æœç´¢è½¯ä»¶</span><br><span class=\"line\">brew uninstall è½¯ä»¶å â€”å¸è½½è½¯ä»¶</span><br><span class=\"line\">brew update â€”æ›´æ–°æ‰€æœ‰è½¯ä»¶</span><br><span class=\"line\">brew upgrade è½¯ä»¶å â€”æ›´æ–°å…·ä½“è½¯ä»¶</span><br><span class=\"line\">brew outdated â€”æŸ¥çœ‹å“ªäº›å·²å®‰è£…çš„ç¨‹åºéœ€è¦æ›´æ–°</span><br></pre></td></tr></table></figure>\n\n<p>2.å®‰è£…Homebrewçš„å›½å†…é•œåƒ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/bash -c &quot;$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206212509503.png\" alt=\"image-20240206212509503\"></p>\n<p>3.å®‰è£…gitï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install git</span><br></pre></td></tr></table></figure>\n\n<p>4.éªŒè¯gitæ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git --version</span><br></pre></td></tr></table></figure>\n\n<p>5.è®¾ç½®gitè´¦æˆ·åç§°å’Œé‚®ç®±</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;ç”¨æˆ·å&quot;</span><br><span class=\"line\">git config --global user.email &quot;é‚®ç®±&quot; </span><br></pre></td></tr></table></figure>\n\n<p>6.æŸ¥çœ‹gitè´¦æˆ·åç§°å’Œé‚®ç®±</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n\n<p>7.sshå¯†é’¥çš„ç”Ÿæˆå’Œé…ç½®</p>\n<p>sshæŒ‡secure shell(ä¸€ç§å®‰å…¨çš„ç½‘ç»œåè®®)ï¼Œgitä½¿ç”¨è¿™ç§åè®®è¿›è¡Œè¿œç¨‹åŠ å¯†ç™»å½•ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214423691.png\" alt=\"image-20240206214423691\"></p>\n<p>ç„¶ååœ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥<code>cat id_rsa.pub </code>å¤åˆ¶å¯†é’¥ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214940022.png\" alt=\"image-20240206214940022\"></p>\n<h2 id=\"äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\"><a href=\"#äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\"></a>äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®</h2><p>1.å»<a href=\"https://dev.mysql.com/downloads/mysql/\">å®˜ç½‘</a>ä¸‹è½½Mysqlå®‰è£…åŒ…</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206221554629.png\" alt=\"image-20240206221554629\"></p>\n<p>å®‰è£…æˆåŠŸåå‘ç°è¿˜æ˜¯æ²¡æ³•ç›´æ¥ä½¿ç”¨mysqlï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206222851331.png\" alt=\"image-20240206222851331\"></p>\n<p>è¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡</p>\n<p>2.å…³äºmacç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®ï¼š</p>\n<ul>\n<li>open&#x2F;vim &#x2F;etc&#x2F;profileï¼ˆä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œä¸ç®¡æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œç™»é™†æ—¶éƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚</li>\n<li>&#x2F;etc&#x2F;bashrc ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œbash shellæ‰§è¡Œæ—¶ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚</li>\n<li>~&#x2F;.bash_profile ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼‰ï¼ˆæ³¨ï¼šLinuxé‡Œé¢æ—¶.bashrcè€Œmacæ˜¯.bash_proofileï¼‰è‹¥bash shellæ˜¯ä»¥loginæ–¹å¼æ‰§è¡Œæ—¶ï¼Œæ‰ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€‚</li>\n</ul>\n<p>3.é…ç½®mysqlçš„ç¯å¢ƒå˜é‡</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bash_profile</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206224929440.png\" alt=\"image-20240206224929440\"></p>\n<p>åœ¨æ–‡ä»¶åæ·»åŠ ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export PATH=$PATH:/usr/locol/mysql/bin</span><br><span class=\"line\">export PATH=$PATH:/usr/local/mysql/support-files</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœä½ å’Œæˆ‘ä¸€æ ·è¯¥æ–‡ä»¶æ˜¾ç¤ºreadonlyï¼Œé€€å‡ºæ—¶<code>:wq!</code>ä¿å­˜ï¼Œè®°å¾—è¦åŠ æ„Ÿå¹å·ã€‚</p>\n<p>åˆ·æ–°é…ç½®æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source ~/.bash_profile</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæ‰§è¡Œå®Œä¸Šè¿°æ“ä½œï¼Œè¿˜æ˜¯æŠ¥é”™ï¼šzsh:command not found: mysql</p>\n<p>4.è®¾ç½®æŒ‡ä»¤åˆ«å</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bashrc</span><br></pre></td></tr></table></figure>\n\n<p>å†™å…¥ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alias mysql=/usr/local/mysql/bin/mysql</span><br></pre></td></tr></table></figure>\n\n<p>åˆ·æ–°é…ç½®ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source ~/.bashrc</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206231528311.png\" alt=\"image-20240206231528311\"></p>\n<h2 id=\"å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\"><a href=\"#å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\" class=\"headerlink\" title=\"å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\"></a>å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨</h2><p><a href=\"https://macwk.cn/%E4%B8%AD%E6%90%9C%E7%B4%A2Navicat%E7%A0%B4%E8%A7%A3%E7%89%88%EF%BC%8C%E7%84%B6%E5%90%8E%E4%B8%8B%E8%BD%BD%E6%89%93%E5%BC%80%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%92%8C%E6%88%91%E4%B8%80%E6%A0%B7%E6%98%AF%E6%96%B0%E7%B3%BB%E7%BB%9F%EF%BC%8C%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E6%8F%90%E7%A4%BA%E6%96%87%E4%BB%B6%E5%B7%B2%E6%8D%9F%E5%9D%8F%EF%BC%8C%E9%9C%80%E8%A6%81%E8%BE%93%E5%85%A5%E5%91%BD%E4%BB%A4%EF%BC%9A\">https://macwk.cn/ä¸­æœç´¢Navicatç ´è§£ç‰ˆï¼Œç„¶åä¸‹è½½æ‰“å¼€ï¼Œå¦‚æœå’Œæˆ‘ä¸€æ ·æ˜¯æ–°ç³»ç»Ÿï¼Œå¯èƒ½ä¼šé‡åˆ°æç¤ºæ–‡ä»¶å·²æŸåï¼Œéœ€è¦è¾“å…¥å‘½ä»¤ï¼š</a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -r -d com.apple.quarantine /Applications/Navicat\\ Premium.app</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åè¿æ¥æˆ‘ä»¬çš„mysqlå°±OKäº†ã€‚</p>\n<h2 id=\"ä¸ƒã€Node-jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"><a href=\"#ä¸ƒã€Node-jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\" class=\"headerlink\" title=\"ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"></a>ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨</h2><p>å‡†å¤‡é€šè¿‡homebrewå®‰è£…nodeï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node #é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm -v #æŸ¥çœ‹npmç‰ˆæœ¬</span><br><span class=\"line\">node -v #æŸ¥çœ‹nodeç‰ˆæœ¬</span><br><span class=\"line\">brew list #æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>å®‰è£…å›½å†…æ·˜å®é•œåƒæºï¼ˆæ³¨æ„âš ï¸ï¼š2024å¹´1 æœˆ 22 æ—¥ï¼Œæ·˜å®åŸé•œåƒåŸŸåï¼ˆregistry.npm.taobao.orgï¼‰çš„ HTTPS <a href=\"https://so.csdn.net/so/search?q=%E8%AF%81%E4%B9%A6&spm=1001.2101.3001.7020\">è¯ä¹¦</a>æ­£å¼åˆ°æœŸï¼Œæ”¹ç”¨æ–°çš„åŸŸååœ°å€æ‰§è¡Œå‘½ä»¤ï¼‰ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br><span class=\"line\">cnpm -v #æŸ¥çœ‹cnpmç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207120554050.png\" alt=\"image-20240207120554050\"></p>\n<h2 id=\"å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"><a href=\"#å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\" class=\"headerlink\" title=\"å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"></a>å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨</h2><p>1.å»<a href=\"https://www.docker.com/products/docker-desktop/\">å®˜ç½‘</a>ä¸‹è½½dockerå®¢æˆ·ç«¯</p>\n<p>2.ä¸‹è½½å®‰è£…åï¼Œå¯é€šè¿‡å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207135505696.png\" alt=\"image-20240207135505696\"></p>\n<p>3.ä¸ºäº†æ–¹ä¾¿åç»­æ‹‰å–é•œåƒï¼Œ æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹dockeré•œåƒæºï¼ˆ<a href=\"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors\">é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨</a>ï¼‰</p>\n<p>4.<a href=\"https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°\"registry-mirrors\"çš„æ•°ç»„é‡Œ,ç‚¹å‡»/\">https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°&quot;registry-mirrors&quot;çš„æ•°ç»„é‡Œï¼Œç‚¹å‡»</a> Apply &amp; RestartæŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dd5ae043bebb49158d6d295101b508ac.png\" alt=\"img\"></p>\n<p>å…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š<a href=\"http://ruiyeclub.cn/2022/02/01/Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E9%83%A8%E7%BD%B2SpringBoot%E9%A1%B9%E7%9B%AE/\">Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®</a></p>\n<h2 id=\"ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\"><a href=\"#ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\"></a>ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®</h2><p>1.é€šè¿‡homebrewå®‰è£…ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install redis</span><br></pre></td></tr></table></figure>\n\n<p>2.å¯åŠ¨å’Œå…³é—­redisï¼š</p>\n<p>1.å®˜æ–¹å¯åŠ¨æ–¹å¼ï¼ˆä¸æ¨èï¼Œé‡å¯åéœ€è¦å†æ¬¡æ‰“å¼€æœåŠ¡ï¼‰ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-server \t\t\t #å¯åŠ¨RedisæœåŠ¡</span><br><span class=\"line\">redis-cli shutdown     #åœæ­¢redisæœåŠ¡</span><br></pre></td></tr></table></figure>\n\n<p>2.ä½¿ç”¨brewå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew services start redis \t#å¯åŠ¨redisæœåŠ¡</span><br><span class=\"line\">brew services stop redis \t\t#å…³é—­redisæœåŠ¡</span><br><span class=\"line\">brew services restart redis   #é‡å¯redisæœåŠ¡</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207143540188.png\" alt=\"image-20240207143540188\"></p>\n<p>3.å¯åŠ¨åè¾“å…¥<code>redis-cli</code>æ‰“å¼€å®¢æˆ·ç«¯ã€‚</p>\n<p>4.å®‰è£…rediså¯è§†åŒ–è½¯ä»¶ï¼Œæœ‰å¾ˆå¤šå¯è§†åŒ–è½¯ä»¶å¯ä»¥é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯[Tiny RDMã€‚</p>\n<p><strong>å¦‚æœåœ¨ macOS ä¸Šå®‰è£…åæ— æ³•æ‰“å¼€ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç„¶åé‡æ–°æ‰“å¼€ï¼š</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -d com.apple.quarantine /Applications/Tiny\\ RDM.app </span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151046489.png\" alt=\"image-20240207151046489\"></p>\n<h2 id=\"åã€Typoraçš„å®‰è£…å’Œç ´è§£\"><a href=\"#åã€Typoraçš„å®‰è£…å’Œç ´è§£\" class=\"headerlink\" title=\"åã€Typoraçš„å®‰è£…å’Œç ´è§£\"></a>åã€Typoraçš„å®‰è£…å’Œç ´è§£</h2><p>1.å»å®˜ç½‘é€‰æ‹©macç‰ˆæœ¬ä¸‹è½½å®‰è£… <a href=\"https://www.typoraio.cn/\">typoraä¸‹è½½</a>ã€‚</p>\n<p>2.é€šè¿‡ä¿®æ”¹typoraæ–‡ä»¶è¿›è¡Œç ´è§£ï¼Œæˆ‘çš„æ–‡ä»¶è·¯å¾„åœ¨<code>/Applications/Typora.app/Contents/Resources/TypeMark/page-dist/static/js</code>æ‰¾åˆ°æ–‡ä»¶ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151712209.png\" alt=\"image-20240207151712209\"></p>\n<p>3.è¾“å…¥ hasActivated&#x3D;â€trueâ€&#x3D;&#x3D;e.hasActivated è¿›è¡Œæœç´¢ï¼Œç„¶åå°†å®ƒæ”¹ä¸º hasActivated&#x3D;â€trueâ€&#x3D;&#x3D;â€trueâ€ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207152013022.png\" alt=\"image-20240207152013022\"></p>\n<p>4.é‡æ–°æ‰“å¼€è½¯ä»¶ï¼Œæ¿€æ´»æˆåŠŸï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151955004.png\" alt=\"image-20240207151955004\"></p>\n<p>å…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š<a href=\"http://ruiyeclub.cn/2024/01/04/%E5%BC%80%E5%8F%91%E5%BF%85%E5%A4%87%E8%BD%AF%E4%BB%B6-Typora%E9%85%8D%E5%90%88PicGo%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE(%E8%BD%AC)/\">å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)</a></p>\n<p>å‚è€ƒè§†é¢‘ï¼š<a href=\"https://www.bilibili.com/video/BV16L4y1b75R/?share_source=copy_web&vd_source=c31decb11361be9e30ea99abeef3e302\">Mac M1 ç¨‹åºå‘˜å¼€å‘ç¯å¢ƒçš„å®‰è£…ä¸é…ç½®</a></p>\n","excerpt":"","more":"<blockquote>\n<p>Mac mç³»åˆ—èŠ¯ç‰‡ä½¿ç”¨çš„æ˜¯armæ¶æ„ï¼Œå¾ˆå¤šè½¯ä»¶éƒ½æœ‰æ¨å‡ºè®¾é…ç‰ˆæœ¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…è¿‡ç¨‹ã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\"><a href=\"#ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®\"></a>ä¸€ã€Jdkçš„å®‰è£…å’Œé…ç½®</h2><p>zuluæ¨å‡ºäº†è®¾é…armæ¶æ„çš„jdkç‰ˆæœ¬ï¼Œä¸‹è½½åœ°å€<a href=\"https://www.azul.com/downloads/?package=jdk#zulu\">zulu jdk</a>ï¼Œä¸‹è½½åç›´æ¥å®‰è£…å°±å¯ä»¥ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206133833207.png\" alt=\"image-20240206133833207\"></p>\n<h2 id=\"äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\"><a href=\"#äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\" class=\"headerlink\" title=\"äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£\"></a>äºŒã€Ideaçš„å®‰è£…å’Œç ´è§£</h2><p>ä¸‹è½½jetbaraå’Œç ´è§£åŒ…ï¼Œç ´è§£åŒ…å¯ä»¥é€šè¿‡<a href=\"https://3.jetbra.in/\">ç½‘ç«™</a>ä¸‹è½½ï¼Œæ¿€æ´»ç ä¹Ÿåœ¨è¿™ä¸ªç½‘ç«™ä¸Šé¢ï¼Œä¸‹è½½jaråè§£å‹ï¼Œå¾…ä¼šéœ€è¦ç”¨åˆ°srcptsè„šæœ¬è¿˜æœ‰æ¿€æ´»ç ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206134345771.png\" alt=\"image-20240206134345771\"></p>\n<p>æ‰“å¼€ç»ˆç«¯è¿›å…¥scriptsæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œinstall.shè„šæœ¬ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206135441039.png\" alt=\"image-20240206135441039\"></p>\n<p>éƒ¨åˆ†ç³»ç»Ÿç‰ˆæœ¬å¯èƒ½ä¼šå’Œæˆ‘ä¸€æ ·å‡ºç°äº†<code>Operation not permitted</code>ã€‚</p>\n<p>åŸå› ï¼šmacç”µè„‘å¯ç”¨äº†SIPï¼ˆSystem Integrity Protectionï¼‰ï¼Œå¢åŠ äº†rootlessæœºåˆ¶ï¼Œå¯¼è‡´å³ä½¿åœ¨rootæƒé™ä¸‹ä¾ç„¶æ— æ³•ä¿®æ”¹æ–‡ä»¶ï¼Œå…³é—­è¯¥ä¿æŠ¤æœºåˆ¶æ‰èƒ½è¿›è¡Œä¿®æ”¹ã€‚<br>å‚è€ƒæ–‡æ¡£ï¼š<a href=\"https://sspai.com/post/55066\">macOS å¼€å¯æˆ–å…³é—­ SIP</a>ï¼ˆm1éœ€è¦ä¸€ç›´æŒ‰ç€å¼€æœºé”®è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼‰</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143034823.png\" alt=\"image-20240206143034823\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206143847348.png\" alt=\"image-20240206143847348\"></p>\n<p>æ­¤æ—¶å·²ç»æˆåŠŸå…³é—­ï¼Œé‡æ–°æ‰§è¡Œinstall.jsè„šæœ¬ï¼Œæ˜¾ç¤º<code>done</code>è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚</p>\n<p>åœ¨ideaè¾“å…¥æ¿€æ´»ç å³å¯ï¼Œå¦‚æœå‡ºç°<code>Key is invalid</code>å»ºè®®é‡æ–°ä¸€ä¸‹ç”µè„‘æˆ–è€…é‡æ–°å®‰è£…è½¯ä»¶ã€‚</p>\n<h3 id=\"âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\"><a href=\"#âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\" class=\"headerlink\" title=\"âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ\"></a>âš ï¸é‡å¯ç”µè„‘åï¼Œå¯èƒ½ä¼šå‡ºç°ideaéœ€è¦é‡æ–°æ¿€æ´»çš„æƒ…å†µ</h3><p>è¯·æ‰§è¡Œ<code>sudo sh uninstall.sh</code>å†æ‰§è¡Œ<code>sudo sh install.sh</code></p>\n<h2 id=\"ä¸‰ã€é…ç½®Maven\"><a href=\"#ä¸‰ã€é…ç½®Maven\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®Maven\"></a>ä¸‰ã€é…ç½®Maven</h2><p>ä¸ªäººä¹ æƒ¯ä½¿ç”¨ideaè‡ªå¸¦çš„mavenï¼Œç‰ˆæœ¬3.9.5ï¼Œåªéœ€è¦ä¿®æ”¹æˆé˜¿é‡Œäº‘é•œåƒå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206181908542.png\" alt=\"image-20240206181908542\"></p>\n<p>è¿›å…¥.m2æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æŒ‰ä½<code>command</code>+<code>shift</code>+<code>.</code>æ˜¾ç¤ºéšè—æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°.m2æ–‡ä»¶å¤¹ï¼Œè¿›å…¥ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤<code>touch settings.xml</code>æ–°å»ºxmlæ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">          <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- æœ¬åœ°ä¸‹è½½çš„jaråŒ…åœ°å€ é…ç½®æˆ‘ä»¬çš„æ•°æ®ç›˜å³å¯--&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">localRepository</span>&gt;</span>/Users/raychen/.m2/repository<span class=\"tag\">&lt;/<span class=\"name\">localRepository</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mirrors</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- é˜¿é‡Œäº‘ä»“åº“ --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>alimaven<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>aliyun maven<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/repositories/central/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- ä¸­å¤®ä»“åº“1 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>repo1<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Human Readable Name for this Mirror.<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://repo1.maven.org/maven2/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- ä¸­å¤®ä»“åº“2 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>repo2<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Human Readable Name for this Mirror.<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://repo2.maven.org/maven2/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- é˜¿é‡Œäº‘çš„mavenè·¯å¾„, --&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>nexus-aliyun<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>*<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus aliyun<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">mirrors</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\"><a href=\"#å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®\"></a>å››ã€Homebrewçš„å®‰è£…å’Œé…ç½®</h2><blockquote>\n<p>Homebrewæ˜¯ä¸€æ¬¾Mac OSå¹³å°ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼Œæ‹¥æœ‰å®‰è£…ã€å¸è½½ã€æ›´æ–°ã€æŸ¥çœ‹ã€æœç´¢ç­‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ã€‚</p>\n</blockquote>\n<p>1.Homebrewä½¿ç”¨</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew -v æŸ¥çœ‹å½“å‰ç‰ˆæœ¬</span><br><span class=\"line\">brew list â€”åˆ—å‡ºå·²å®‰è£…çš„è½¯ä»¶</span><br><span class=\"line\">brew update â€”æ›´æ–°Homebrew</span><br><span class=\"line\">brew install è½¯ä»¶å â€”å®‰è£…è½¯ä»¶</span><br><span class=\"line\">brew search è½¯ä»¶å â€”æœç´¢è½¯ä»¶</span><br><span class=\"line\">brew uninstall è½¯ä»¶å â€”å¸è½½è½¯ä»¶</span><br><span class=\"line\">brew update â€”æ›´æ–°æ‰€æœ‰è½¯ä»¶</span><br><span class=\"line\">brew upgrade è½¯ä»¶å â€”æ›´æ–°å…·ä½“è½¯ä»¶</span><br><span class=\"line\">brew outdated â€”æŸ¥çœ‹å“ªäº›å·²å®‰è£…çš„ç¨‹åºéœ€è¦æ›´æ–°</span><br></pre></td></tr></table></figure>\n\n<p>2.å®‰è£…Homebrewçš„å›½å†…é•œåƒ</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/bash -c &quot;$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206212509503.png\" alt=\"image-20240206212509503\"></p>\n<p>3.å®‰è£…gitï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install git</span><br></pre></td></tr></table></figure>\n\n<p>4.éªŒè¯gitæ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git --version</span><br></pre></td></tr></table></figure>\n\n<p>5.è®¾ç½®gitè´¦æˆ·åç§°å’Œé‚®ç®±</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name &quot;ç”¨æˆ·å&quot;</span><br><span class=\"line\">git config --global user.email &quot;é‚®ç®±&quot; </span><br></pre></td></tr></table></figure>\n\n<p>6.æŸ¥çœ‹gitè´¦æˆ·åç§°å’Œé‚®ç®±</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config user.name</span><br><span class=\"line\">git config user.email</span><br></pre></td></tr></table></figure>\n\n<p>7.sshå¯†é’¥çš„ç”Ÿæˆå’Œé…ç½®</p>\n<p>sshæŒ‡secure shell(ä¸€ç§å®‰å…¨çš„ç½‘ç»œåè®®)ï¼Œgitä½¿ç”¨è¿™ç§åè®®è¿›è¡Œè¿œç¨‹åŠ å¯†ç™»å½•ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214423691.png\" alt=\"image-20240206214423691\"></p>\n<p>ç„¶ååœ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥<code>cat id_rsa.pub </code>å¤åˆ¶å¯†é’¥ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206214940022.png\" alt=\"image-20240206214940022\"></p>\n<h2 id=\"äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\"><a href=\"#äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®\"></a>äº”ã€Mysqlçš„å®‰è£…å’Œé…ç½®</h2><p>1.å»<a href=\"https://dev.mysql.com/downloads/mysql/\">å®˜ç½‘</a>ä¸‹è½½Mysqlå®‰è£…åŒ…</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206221554629.png\" alt=\"image-20240206221554629\"></p>\n<p>å®‰è£…æˆåŠŸåå‘ç°è¿˜æ˜¯æ²¡æ³•ç›´æ¥ä½¿ç”¨mysqlï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206222851331.png\" alt=\"image-20240206222851331\"></p>\n<p>è¿™é‡Œéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡</p>\n<p>2.å…³äºmacç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®ï¼š</p>\n<ul>\n<li>open&#x2F;vim &#x2F;etc&#x2F;profileï¼ˆä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œä¸ç®¡æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œç™»é™†æ—¶éƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ã€‚</li>\n<li>&#x2F;etc&#x2F;bashrc ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼‰å…¨å±€ï¼ˆå…¬æœ‰ï¼‰é…ç½®ï¼Œbash shellæ‰§è¡Œæ—¶ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚</li>\n<li>~&#x2F;.bash_profile ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼‰ï¼ˆæ³¨ï¼šLinuxé‡Œé¢æ—¶.bashrcè€Œmacæ˜¯.bash_proofileï¼‰è‹¥bash shellæ˜¯ä»¥loginæ–¹å¼æ‰§è¡Œæ—¶ï¼Œæ‰ä¼šè¯»å–æ­¤æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–è®¾ç½®ä¸€äº›ç¯å¢ƒå˜é‡ã€‚</li>\n</ul>\n<p>3.é…ç½®mysqlçš„ç¯å¢ƒå˜é‡</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bash_profile</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206224929440.png\" alt=\"image-20240206224929440\"></p>\n<p>åœ¨æ–‡ä»¶åæ·»åŠ ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export PATH=$PATH:/usr/locol/mysql/bin</span><br><span class=\"line\">export PATH=$PATH:/usr/local/mysql/support-files</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœä½ å’Œæˆ‘ä¸€æ ·è¯¥æ–‡ä»¶æ˜¾ç¤ºreadonlyï¼Œé€€å‡ºæ—¶<code>:wq!</code>ä¿å­˜ï¼Œè®°å¾—è¦åŠ æ„Ÿå¹å·ã€‚</p>\n<p>åˆ·æ–°é…ç½®æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source ~/.bash_profile</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚æœæ‰§è¡Œå®Œä¸Šè¿°æ“ä½œï¼Œè¿˜æ˜¯æŠ¥é”™ï¼šzsh:command not found: mysql</p>\n<p>4.è®¾ç½®æŒ‡ä»¤åˆ«å</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bashrc</span><br></pre></td></tr></table></figure>\n\n<p>å†™å…¥ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">alias mysql=/usr/local/mysql/bin/mysql</span><br></pre></td></tr></table></figure>\n\n<p>åˆ·æ–°é…ç½®ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source ~/.bashrc</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240206231528311.png\" alt=\"image-20240206231528311\"></p>\n<h2 id=\"å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\"><a href=\"#å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\" class=\"headerlink\" title=\"å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨\"></a>å…­ã€Navicatçš„å®‰è£…å’Œä½¿ç”¨</h2><p><a href=\"https://macwk.cn/%E4%B8%AD%E6%90%9C%E7%B4%A2Navicat%E7%A0%B4%E8%A7%A3%E7%89%88%EF%BC%8C%E7%84%B6%E5%90%8E%E4%B8%8B%E8%BD%BD%E6%89%93%E5%BC%80%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%92%8C%E6%88%91%E4%B8%80%E6%A0%B7%E6%98%AF%E6%96%B0%E7%B3%BB%E7%BB%9F%EF%BC%8C%E5%8F%AF%E8%83%BD%E4%BC%9A%E9%81%87%E5%88%B0%E6%8F%90%E7%A4%BA%E6%96%87%E4%BB%B6%E5%B7%B2%E6%8D%9F%E5%9D%8F%EF%BC%8C%E9%9C%80%E8%A6%81%E8%BE%93%E5%85%A5%E5%91%BD%E4%BB%A4%EF%BC%9A\">https://macwk.cn/ä¸­æœç´¢Navicatç ´è§£ç‰ˆï¼Œç„¶åä¸‹è½½æ‰“å¼€ï¼Œå¦‚æœå’Œæˆ‘ä¸€æ ·æ˜¯æ–°ç³»ç»Ÿï¼Œå¯èƒ½ä¼šé‡åˆ°æç¤ºæ–‡ä»¶å·²æŸåï¼Œéœ€è¦è¾“å…¥å‘½ä»¤ï¼š</a></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -r -d com.apple.quarantine /Applications/Navicat\\ Premium.app</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åè¿æ¥æˆ‘ä»¬çš„mysqlå°±OKäº†ã€‚</p>\n<h2 id=\"ä¸ƒã€Node-jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"><a href=\"#ä¸ƒã€Node-jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\" class=\"headerlink\" title=\"ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"></a>ä¸ƒã€Node.jsçš„å®‰è£…é…ç½®å’Œä½¿ç”¨</h2><p>å‡†å¤‡é€šè¿‡homebrewå®‰è£…nodeï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install node #é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ</span><br></pre></td></tr></table></figure>\n\n<p>æŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm -v #æŸ¥çœ‹npmç‰ˆæœ¬</span><br><span class=\"line\">node -v #æŸ¥çœ‹nodeç‰ˆæœ¬</span><br><span class=\"line\">brew list #æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶</span><br></pre></td></tr></table></figure>\n\n<p>å®‰è£…å›½å†…æ·˜å®é•œåƒæºï¼ˆæ³¨æ„âš ï¸ï¼š2024å¹´1 æœˆ 22 æ—¥ï¼Œæ·˜å®åŸé•œåƒåŸŸåï¼ˆregistry.npm.taobao.orgï¼‰çš„ HTTPS <a href=\"https://so.csdn.net/so/search?q=%E8%AF%81%E4%B9%A6&spm=1001.2101.3001.7020\">è¯ä¹¦</a>æ­£å¼åˆ°æœŸï¼Œæ”¹ç”¨æ–°çš„åŸŸååœ°å€æ‰§è¡Œå‘½ä»¤ï¼‰ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br><span class=\"line\">cnpm -v #æŸ¥çœ‹cnpmç‰ˆæœ¬</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207120554050.png\" alt=\"image-20240207120554050\"></p>\n<h2 id=\"å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"><a href=\"#å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\" class=\"headerlink\" title=\"å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨\"></a>å…«ã€Dockerçš„å®‰è£…é…ç½®å’Œä½¿ç”¨</h2><p>1.å»<a href=\"https://www.docker.com/products/docker-desktop/\">å®˜ç½‘</a>ä¸‹è½½dockerå®¢æˆ·ç«¯</p>\n<p>2.ä¸‹è½½å®‰è£…åï¼Œå¯é€šè¿‡å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207135505696.png\" alt=\"image-20240207135505696\"></p>\n<p>3.ä¸ºäº†æ–¹ä¾¿åç»­æ‹‰å–é•œåƒï¼Œ æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹dockeré•œåƒæºï¼ˆ<a href=\"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors\">é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨</a>ï¼‰</p>\n<p>4.<a href=\"https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°\"registry-mirrors\"çš„æ•°ç»„é‡Œ,ç‚¹å‡»/\">https://fzxzd0ha.mirror.aliyuncs.comåŠ åˆ°&quot;registry-mirrors&quot;çš„æ•°ç»„é‡Œï¼Œç‚¹å‡»</a> Apply &amp; RestartæŒ‰é’®ï¼Œç­‰å¾…Dockeré‡å¯å¹¶åº”ç”¨é…ç½®çš„é•œåƒåŠ é€Ÿå™¨ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dd5ae043bebb49158d6d295101b508ac.png\" alt=\"img\"></p>\n<p>å…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š<a href=\"http://ruiyeclub.cn/2022/02/01/Docker%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E4%B9%8B%E9%83%A8%E7%BD%B2SpringBoot%E9%A1%B9%E7%9B%AE/\">Dockerå¿«é€Ÿä¸Šæ‰‹ä¹‹éƒ¨ç½²SpringBooté¡¹ç›®</a></p>\n<h2 id=\"ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\"><a href=\"#ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\" class=\"headerlink\" title=\"ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®\"></a>ä¹ã€Redisçš„å®‰è£…å’Œé…ç½®</h2><p>1.é€šè¿‡homebrewå®‰è£…ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install redis</span><br></pre></td></tr></table></figure>\n\n<p>2.å¯åŠ¨å’Œå…³é—­redisï¼š</p>\n<p>1.å®˜æ–¹å¯åŠ¨æ–¹å¼ï¼ˆä¸æ¨èï¼Œé‡å¯åéœ€è¦å†æ¬¡æ‰“å¼€æœåŠ¡ï¼‰ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-server \t\t\t #å¯åŠ¨RedisæœåŠ¡</span><br><span class=\"line\">redis-cli shutdown     #åœæ­¢redisæœåŠ¡</span><br></pre></td></tr></table></figure>\n\n<p>2.ä½¿ç”¨brewå‘½ä»¤</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew services start redis \t#å¯åŠ¨redisæœåŠ¡</span><br><span class=\"line\">brew services stop redis \t\t#å…³é—­redisæœåŠ¡</span><br><span class=\"line\">brew services restart redis   #é‡å¯redisæœåŠ¡</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207143540188.png\" alt=\"image-20240207143540188\"></p>\n<p>3.å¯åŠ¨åè¾“å…¥<code>redis-cli</code>æ‰“å¼€å®¢æˆ·ç«¯ã€‚</p>\n<p>4.å®‰è£…rediså¯è§†åŒ–è½¯ä»¶ï¼Œæœ‰å¾ˆå¤šå¯è§†åŒ–è½¯ä»¶å¯ä»¥é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯[Tiny RDMã€‚</p>\n<p><strong>å¦‚æœåœ¨ macOS ä¸Šå®‰è£…åæ— æ³•æ‰“å¼€ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç„¶åé‡æ–°æ‰“å¼€ï¼š</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -d com.apple.quarantine /Applications/Tiny\\ RDM.app </span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151046489.png\" alt=\"image-20240207151046489\"></p>\n<h2 id=\"åã€Typoraçš„å®‰è£…å’Œç ´è§£\"><a href=\"#åã€Typoraçš„å®‰è£…å’Œç ´è§£\" class=\"headerlink\" title=\"åã€Typoraçš„å®‰è£…å’Œç ´è§£\"></a>åã€Typoraçš„å®‰è£…å’Œç ´è§£</h2><p>1.å»å®˜ç½‘é€‰æ‹©macç‰ˆæœ¬ä¸‹è½½å®‰è£… <a href=\"https://www.typoraio.cn/\">typoraä¸‹è½½</a>ã€‚</p>\n<p>2.é€šè¿‡ä¿®æ”¹typoraæ–‡ä»¶è¿›è¡Œç ´è§£ï¼Œæˆ‘çš„æ–‡ä»¶è·¯å¾„åœ¨<code>/Applications/Typora.app/Contents/Resources/TypeMark/page-dist/static/js</code>æ‰¾åˆ°æ–‡ä»¶ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151712209.png\" alt=\"image-20240207151712209\"></p>\n<p>3.è¾“å…¥ hasActivated&#x3D;â€trueâ€&#x3D;&#x3D;e.hasActivated è¿›è¡Œæœç´¢ï¼Œç„¶åå°†å®ƒæ”¹ä¸º hasActivated&#x3D;â€trueâ€&#x3D;&#x3D;â€trueâ€ã€‚</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207152013022.png\" alt=\"image-20240207152013022\"></p>\n<p>4.é‡æ–°æ‰“å¼€è½¯ä»¶ï¼Œæ¿€æ´»æˆåŠŸï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240207151955004.png\" alt=\"image-20240207151955004\"></p>\n<p>å…·ä½“çš„ä½¿ç”¨å¯æŸ¥çœ‹ï¼š<a href=\"http://ruiyeclub.cn/2024/01/04/%E5%BC%80%E5%8F%91%E5%BF%85%E5%A4%87%E8%BD%AF%E4%BB%B6-Typora%E9%85%8D%E5%90%88PicGo%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE(%E8%BD%AC)/\">å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)</a></p>\n<p>å‚è€ƒè§†é¢‘ï¼š<a href=\"https://www.bilibili.com/video/BV16L4y1b75R/?share_source=copy_web&vd_source=c31decb11361be9e30ea99abeef3e302\">Mac M1 ç¨‹åºå‘˜å¼€å‘ç¯å¢ƒçš„å®‰è£…ä¸é…ç½®</a></p>\n"},{"title":"Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium","date":"2024-05-27T09:03:33.000Z","_content":"\n> ä½¿ç”¨ [selenium](https://baike.baidu.com/item/Selenium/18266) æ¨¡æ‹Ÿæµè§ˆå™¨æ¸²æŸ“æ•°æ®ï¼Œéœ€è¦ä¾èµ–å„æµè§ˆå™¨çš„é©±åŠ¨æ‰èƒ½å®Œæˆï¼Œå› æ­¤éœ€è¦å•ç‹¬å®‰è£…chrome driverã€‚\n\n### ä¸€ã€ä¸‹è½½å¯¹åº”`chrome`æµè§ˆå™¨é©±åŠ¨\n\n1. ä¸‹è½½åœ°å€ï¼š[chrome driver](https://googlechromelabs.github.io/chrome-for-testing/)\n\n![image-20240527155408011](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240527155408011.png)\n\n2. å®‰è£… chrome driver\n\n3. è§£å‹å®Œ zip å‹ç¼©åŒ…ä¹‹åï¼Œæ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶åˆ° /usr/local/bin ç›®å½•ä¸‹å³å¯\n\n   ```shell\n   # æ‹·è´\n   cp chromedriver-mac-arm64/chromedriver /usr/local/bin\n    \n   # æˆæƒ\n   cd /usr/local/bin\n   xattr -d com.apple.quarantine chromedriver\n   ```\n\n### äºŒã€pythonè°ƒç”¨selenium\n\n1. å®‰è£…selenium\n\n```python\npip install selenium\n```\n\n2. å”¤èµ·è°·æ­Œæµè§ˆå™¨\n\n```python\nfrom selenium import webdriver\n# å¯åŠ¨è°·æ­Œæµè§ˆå™¨\ndriver=webdriver.Chrome() \n# è®¿é—®ä¸€ä¸ªç½‘é¡µ\ndriver.get(\"http://www.zhihu.com\") \n# é€€å‡ºæµè§ˆå™¨\ndriver.quit() \n```\n\n3. è°ƒç”¨é¡µé¢æ¥å£\n\n```python\nfrom selenium import webdriver\n\n# åˆ›å»ºä¸€ä¸ªChromeOptionså¯¹è±¡ï¼Œç”¨äºè®¾ç½®Chromeæµè§ˆå™¨çš„å¯åŠ¨é€‰é¡¹ã€‚\noptions = webdriver.ChromeOptions()\n# ä½¿Chromeä»¥æ— å¤´æ¨¡å¼è¿è¡Œï¼ˆå³ä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼‰ã€‚è¿™é€šå¸¸ç”¨äºåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚\noptions.add_argument('--headless')\n# ç¦ç”¨GPUç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ˜¯ä¸ºäº†åœ¨æŸäº›æ— å¤´æ¨¡å¼çš„æƒ…å†µä¸‹é¿å…ä¸€äº›bugã€‚\noptions.add_argument('--disable-gpu')\n# ç¦ç”¨æ²™ç›’æ¨¡å¼ã€‚æ²™ç›’æ¨¡å¼é€šå¸¸ç”¨äºå®‰å…¨æ€§ï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå› æ­¤è¿™é‡Œå°†å…¶ç¦ç”¨ã€‚\noptions.add_argument('--no-sandbox')\n# è®¾ç½®æµè§ˆå™¨çš„user-agentå­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—è¯·æ±‚çœ‹èµ·æ¥åƒæ˜¯æ¥è‡ªä¸€ä¸ªæ­£å¸¸çš„æ¡Œé¢æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä»è€Œå‡å°‘è¢«åçˆ¬è™«æœºåˆ¶è¯†åˆ«çš„é£é™©ã€‚\noptions.add_argument('user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36')\n\ndriver = webdriver.Chrome(options=options)\n# è®©æµè§ˆå™¨è®¿é—®æŒ‡å®šçš„URLï¼Œå³https://investing.comã€‚\ndriver.get('https://investing.com')\n# ä½¿ç”¨æµè§ˆå™¨æ‰§è¡ŒJavaScriptä»£ç ï¼Œé€šè¿‡fetch APIå‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æŒ‡å®šçš„API endpointï¼Œå¹¶è¿”å›å…¶å“åº”ã€‚è¯¥å“åº”å°†è¢«è§£æä¸ºJSONæ ¼å¼å¹¶å­˜å‚¨åœ¨responseå˜é‡ä¸­ã€‚\nresponse = driver.execute_script(\"return fetch('https://api.investing.com/api/financialdata/7310/historical/chart/?interval=P1D&pointscount=160').then(res => res.json())\")\nprint(response)\n\ndriver.quit()\n```\n\n","source":"_posts/Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium.md","raw":"---\ntitle: Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium\ndate: 2024-05-27 17:03:33\ntags:\n---\n\n> ä½¿ç”¨ [selenium](https://baike.baidu.com/item/Selenium/18266) æ¨¡æ‹Ÿæµè§ˆå™¨æ¸²æŸ“æ•°æ®ï¼Œéœ€è¦ä¾èµ–å„æµè§ˆå™¨çš„é©±åŠ¨æ‰èƒ½å®Œæˆï¼Œå› æ­¤éœ€è¦å•ç‹¬å®‰è£…chrome driverã€‚\n\n### ä¸€ã€ä¸‹è½½å¯¹åº”`chrome`æµè§ˆå™¨é©±åŠ¨\n\n1. ä¸‹è½½åœ°å€ï¼š[chrome driver](https://googlechromelabs.github.io/chrome-for-testing/)\n\n![image-20240527155408011](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240527155408011.png)\n\n2. å®‰è£… chrome driver\n\n3. è§£å‹å®Œ zip å‹ç¼©åŒ…ä¹‹åï¼Œæ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶åˆ° /usr/local/bin ç›®å½•ä¸‹å³å¯\n\n   ```shell\n   # æ‹·è´\n   cp chromedriver-mac-arm64/chromedriver /usr/local/bin\n    \n   # æˆæƒ\n   cd /usr/local/bin\n   xattr -d com.apple.quarantine chromedriver\n   ```\n\n### äºŒã€pythonè°ƒç”¨selenium\n\n1. å®‰è£…selenium\n\n```python\npip install selenium\n```\n\n2. å”¤èµ·è°·æ­Œæµè§ˆå™¨\n\n```python\nfrom selenium import webdriver\n# å¯åŠ¨è°·æ­Œæµè§ˆå™¨\ndriver=webdriver.Chrome() \n# è®¿é—®ä¸€ä¸ªç½‘é¡µ\ndriver.get(\"http://www.zhihu.com\") \n# é€€å‡ºæµè§ˆå™¨\ndriver.quit() \n```\n\n3. è°ƒç”¨é¡µé¢æ¥å£\n\n```python\nfrom selenium import webdriver\n\n# åˆ›å»ºä¸€ä¸ªChromeOptionså¯¹è±¡ï¼Œç”¨äºè®¾ç½®Chromeæµè§ˆå™¨çš„å¯åŠ¨é€‰é¡¹ã€‚\noptions = webdriver.ChromeOptions()\n# ä½¿Chromeä»¥æ— å¤´æ¨¡å¼è¿è¡Œï¼ˆå³ä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼‰ã€‚è¿™é€šå¸¸ç”¨äºåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚\noptions.add_argument('--headless')\n# ç¦ç”¨GPUç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ˜¯ä¸ºäº†åœ¨æŸäº›æ— å¤´æ¨¡å¼çš„æƒ…å†µä¸‹é¿å…ä¸€äº›bugã€‚\noptions.add_argument('--disable-gpu')\n# ç¦ç”¨æ²™ç›’æ¨¡å¼ã€‚æ²™ç›’æ¨¡å¼é€šå¸¸ç”¨äºå®‰å…¨æ€§ï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå› æ­¤è¿™é‡Œå°†å…¶ç¦ç”¨ã€‚\noptions.add_argument('--no-sandbox')\n# è®¾ç½®æµè§ˆå™¨çš„user-agentå­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—è¯·æ±‚çœ‹èµ·æ¥åƒæ˜¯æ¥è‡ªä¸€ä¸ªæ­£å¸¸çš„æ¡Œé¢æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä»è€Œå‡å°‘è¢«åçˆ¬è™«æœºåˆ¶è¯†åˆ«çš„é£é™©ã€‚\noptions.add_argument('user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36')\n\ndriver = webdriver.Chrome(options=options)\n# è®©æµè§ˆå™¨è®¿é—®æŒ‡å®šçš„URLï¼Œå³https://investing.comã€‚\ndriver.get('https://investing.com')\n# ä½¿ç”¨æµè§ˆå™¨æ‰§è¡ŒJavaScriptä»£ç ï¼Œé€šè¿‡fetch APIå‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æŒ‡å®šçš„API endpointï¼Œå¹¶è¿”å›å…¶å“åº”ã€‚è¯¥å“åº”å°†è¢«è§£æä¸ºJSONæ ¼å¼å¹¶å­˜å‚¨åœ¨responseå˜é‡ä¸­ã€‚\nresponse = driver.execute_script(\"return fetch('https://api.investing.com/api/financialdata/7310/historical/chart/?interval=P1D&pointscount=160').then(res => res.json())\")\nprint(response)\n\ndriver.quit()\n```\n\n","slug":"Macä½¿ç”¨Webçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·selenium","published":1,"updated":"2024-05-27T09:04:25.386Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dl000jwen14azw575t","content":"<blockquote>\n<p>ä½¿ç”¨ <a href=\"https://baike.baidu.com/item/Selenium/18266\">selenium</a> æ¨¡æ‹Ÿæµè§ˆå™¨æ¸²æŸ“æ•°æ®ï¼Œéœ€è¦ä¾èµ–å„æµè§ˆå™¨çš„é©±åŠ¨æ‰èƒ½å®Œæˆï¼Œå› æ­¤éœ€è¦å•ç‹¬å®‰è£…chrome driverã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\"><a href=\"#ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\" class=\"headerlink\" title=\"ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\"></a>ä¸€ã€ä¸‹è½½å¯¹åº”<code>chrome</code>æµè§ˆå™¨é©±åŠ¨</h3><ol>\n<li>ä¸‹è½½åœ°å€ï¼š<a href=\"https://googlechromelabs.github.io/chrome-for-testing/\">chrome driver</a></li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240527155408011.png\" alt=\"image-20240527155408011\"></p>\n<ol start=\"2\">\n<li><p>å®‰è£… chrome driver</p>\n</li>\n<li><p>è§£å‹å®Œ zip å‹ç¼©åŒ…ä¹‹åï¼Œæ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local&#x2F;bin ç›®å½•ä¸‹å³å¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æ‹·è´</span></span><br><span class=\"line\">cp chromedriver-mac-arm64/chromedriver /usr/local/bin</span><br><span class=\"line\"><span class=\"meta prompt_\"> </span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æˆæƒ</span></span><br><span class=\"line\">cd /usr/local/bin</span><br><span class=\"line\">xattr -d com.apple.quarantine chromedriver</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"äºŒã€pythonè°ƒç”¨selenium\"><a href=\"#äºŒã€pythonè°ƒç”¨selenium\" class=\"headerlink\" title=\"äºŒã€pythonè°ƒç”¨selenium\"></a>äºŒã€pythonè°ƒç”¨selenium</h3><ol>\n<li>å®‰è£…selenium</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install selenium</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>å”¤èµ·è°·æ­Œæµè§ˆå™¨</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"comment\"># å¯åŠ¨è°·æ­Œæµè§ˆå™¨</span></span><br><span class=\"line\">driver=webdriver.Chrome() </span><br><span class=\"line\"><span class=\"comment\"># è®¿é—®ä¸€ä¸ªç½‘é¡µ</span></span><br><span class=\"line\">driver.get(<span class=\"string\">&quot;http://www.zhihu.com&quot;</span>) </span><br><span class=\"line\"><span class=\"comment\"># é€€å‡ºæµè§ˆå™¨</span></span><br><span class=\"line\">driver.quit() </span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>è°ƒç”¨é¡µé¢æ¥å£</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºä¸€ä¸ªChromeOptionså¯¹è±¡ï¼Œç”¨äºè®¾ç½®Chromeæµè§ˆå™¨çš„å¯åŠ¨é€‰é¡¹ã€‚</span></span><br><span class=\"line\">options = webdriver.ChromeOptions()</span><br><span class=\"line\"><span class=\"comment\"># ä½¿Chromeä»¥æ— å¤´æ¨¡å¼è¿è¡Œï¼ˆå³ä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼‰ã€‚è¿™é€šå¸¸ç”¨äºåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--headless&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç¦ç”¨GPUç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ˜¯ä¸ºäº†åœ¨æŸäº›æ— å¤´æ¨¡å¼çš„æƒ…å†µä¸‹é¿å…ä¸€äº›bugã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--disable-gpu&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç¦ç”¨æ²™ç›’æ¨¡å¼ã€‚æ²™ç›’æ¨¡å¼é€šå¸¸ç”¨äºå®‰å…¨æ€§ï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå› æ­¤è¿™é‡Œå°†å…¶ç¦ç”¨ã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--no-sandbox&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®æµè§ˆå™¨çš„user-agentå­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—è¯·æ±‚çœ‹èµ·æ¥åƒæ˜¯æ¥è‡ªä¸€ä¸ªæ­£å¸¸çš„æ¡Œé¢æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä»è€Œå‡å°‘è¢«åçˆ¬è™«æœºåˆ¶è¯†åˆ«çš„é£é™©ã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">driver = webdriver.Chrome(options=options)</span><br><span class=\"line\"><span class=\"comment\"># è®©æµè§ˆå™¨è®¿é—®æŒ‡å®šçš„URLï¼Œå³https://investing.comã€‚</span></span><br><span class=\"line\">driver.get(<span class=\"string\">&#x27;https://investing.com&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨æµè§ˆå™¨æ‰§è¡ŒJavaScriptä»£ç ï¼Œé€šè¿‡fetch APIå‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æŒ‡å®šçš„API endpointï¼Œå¹¶è¿”å›å…¶å“åº”ã€‚è¯¥å“åº”å°†è¢«è§£æä¸ºJSONæ ¼å¼å¹¶å­˜å‚¨åœ¨responseå˜é‡ä¸­ã€‚</span></span><br><span class=\"line\">response = driver.execute_script(<span class=\"string\">&quot;return fetch(&#x27;https://api.investing.com/api/financialdata/7310/historical/chart/?interval=P1D&amp;pointscount=160&#x27;).then(res =&gt; res.json())&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response)</span><br><span class=\"line\"></span><br><span class=\"line\">driver.quit()</span><br></pre></td></tr></table></figure>\n\n","excerpt":"","more":"<blockquote>\n<p>ä½¿ç”¨ <a href=\"https://baike.baidu.com/item/Selenium/18266\">selenium</a> æ¨¡æ‹Ÿæµè§ˆå™¨æ¸²æŸ“æ•°æ®ï¼Œéœ€è¦ä¾èµ–å„æµè§ˆå™¨çš„é©±åŠ¨æ‰èƒ½å®Œæˆï¼Œå› æ­¤éœ€è¦å•ç‹¬å®‰è£…chrome driverã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\"><a href=\"#ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\" class=\"headerlink\" title=\"ä¸€ã€ä¸‹è½½å¯¹åº”chromeæµè§ˆå™¨é©±åŠ¨\"></a>ä¸€ã€ä¸‹è½½å¯¹åº”<code>chrome</code>æµè§ˆå™¨é©±åŠ¨</h3><ol>\n<li>ä¸‹è½½åœ°å€ï¼š<a href=\"https://googlechromelabs.github.io/chrome-for-testing/\">chrome driver</a></li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240527155408011.png\" alt=\"image-20240527155408011\"></p>\n<ol start=\"2\">\n<li><p>å®‰è£… chrome driver</p>\n</li>\n<li><p>è§£å‹å®Œ zip å‹ç¼©åŒ…ä¹‹åï¼Œæ‹·è´äºŒè¿›åˆ¶æ–‡ä»¶åˆ° &#x2F;usr&#x2F;local&#x2F;bin ç›®å½•ä¸‹å³å¯</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æ‹·è´</span></span><br><span class=\"line\">cp chromedriver-mac-arm64/chromedriver /usr/local/bin</span><br><span class=\"line\"><span class=\"meta prompt_\"> </span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">æˆæƒ</span></span><br><span class=\"line\">cd /usr/local/bin</span><br><span class=\"line\">xattr -d com.apple.quarantine chromedriver</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h3 id=\"äºŒã€pythonè°ƒç”¨selenium\"><a href=\"#äºŒã€pythonè°ƒç”¨selenium\" class=\"headerlink\" title=\"äºŒã€pythonè°ƒç”¨selenium\"></a>äºŒã€pythonè°ƒç”¨selenium</h3><ol>\n<li>å®‰è£…selenium</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install selenium</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>å”¤èµ·è°·æ­Œæµè§ˆå™¨</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"><span class=\"comment\"># å¯åŠ¨è°·æ­Œæµè§ˆå™¨</span></span><br><span class=\"line\">driver=webdriver.Chrome() </span><br><span class=\"line\"><span class=\"comment\"># è®¿é—®ä¸€ä¸ªç½‘é¡µ</span></span><br><span class=\"line\">driver.get(<span class=\"string\">&quot;http://www.zhihu.com&quot;</span>) </span><br><span class=\"line\"><span class=\"comment\"># é€€å‡ºæµè§ˆå™¨</span></span><br><span class=\"line\">driver.quit() </span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>è°ƒç”¨é¡µé¢æ¥å£</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> selenium <span class=\"keyword\">import</span> webdriver</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºä¸€ä¸ªChromeOptionså¯¹è±¡ï¼Œç”¨äºè®¾ç½®Chromeæµè§ˆå™¨çš„å¯åŠ¨é€‰é¡¹ã€‚</span></span><br><span class=\"line\">options = webdriver.ChromeOptions()</span><br><span class=\"line\"><span class=\"comment\"># ä½¿Chromeä»¥æ— å¤´æ¨¡å¼è¿è¡Œï¼ˆå³ä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼‰ã€‚è¿™é€šå¸¸ç”¨äºåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­è¿›è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--headless&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç¦ç”¨GPUç¡¬ä»¶åŠ é€Ÿã€‚è¿™æ˜¯ä¸ºäº†åœ¨æŸäº›æ— å¤´æ¨¡å¼çš„æƒ…å†µä¸‹é¿å…ä¸€äº›bugã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--disable-gpu&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ç¦ç”¨æ²™ç›’æ¨¡å¼ã€‚æ²™ç›’æ¨¡å¼é€šå¸¸ç”¨äºå®‰å…¨æ€§ï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ï¼Œå› æ­¤è¿™é‡Œå°†å…¶ç¦ç”¨ã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;--no-sandbox&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®æµè§ˆå™¨çš„user-agentå­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—è¯·æ±‚çœ‹èµ·æ¥åƒæ˜¯æ¥è‡ªä¸€ä¸ªæ­£å¸¸çš„æ¡Œé¢æµè§ˆå™¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œä»è€Œå‡å°‘è¢«åçˆ¬è™«æœºåˆ¶è¯†åˆ«çš„é£é™©ã€‚</span></span><br><span class=\"line\">options.add_argument(<span class=\"string\">&#x27;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">driver = webdriver.Chrome(options=options)</span><br><span class=\"line\"><span class=\"comment\"># è®©æµè§ˆå™¨è®¿é—®æŒ‡å®šçš„URLï¼Œå³https://investing.comã€‚</span></span><br><span class=\"line\">driver.get(<span class=\"string\">&#x27;https://investing.com&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨æµè§ˆå™¨æ‰§è¡ŒJavaScriptä»£ç ï¼Œé€šè¿‡fetch APIå‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°æŒ‡å®šçš„API endpointï¼Œå¹¶è¿”å›å…¶å“åº”ã€‚è¯¥å“åº”å°†è¢«è§£æä¸ºJSONæ ¼å¼å¹¶å­˜å‚¨åœ¨responseå˜é‡ä¸­ã€‚</span></span><br><span class=\"line\">response = driver.execute_script(<span class=\"string\">&quot;return fetch(&#x27;https://api.investing.com/api/financialdata/7310/historical/chart/?interval=P1D&amp;pointscount=160&#x27;).then(res =&gt; res.json())&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response)</span><br><span class=\"line\"></span><br><span class=\"line\">driver.quit()</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜","date":"2024-09-18T03:24:46.000Z","_content":"\n**é—®é¢˜è§£é‡Šï¼š**\n\n> åœ¨ä½¿ç”¨pandasè½¬æ¢DataFrameåˆ°JSONæ ¼å¼æ—¶ï¼Œå¦‚æœDataFrameä¸­å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯èƒ½ä¼šé‡åˆ°æ— æ³•æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œpandasä¼šå°†å­—ç¬¦ä¸²ç¼–ç ä¸ºUnicode Escapeå½¢å¼ï¼Œè¿™ä¸æ˜¯JSONçš„æ ‡å‡†æ ¼å¼ï¼Œè€Œæ˜¯Pythonå†…éƒ¨çš„è¡¨ç°å½¢å¼ã€‚\n\n**è§£å†³æ–¹æ³•ï¼š**\n\n1. åœ¨è½¬æ¢ä¸ºJSONä¹‹å‰ï¼Œç¡®ä¿DataFrameçš„ç¼–ç æ˜¯æ­£ç¡®çš„ï¼Œé€šå¸¸ä½¿ç”¨UTF-8ç¼–ç ã€‚\n\n2. ä½¿ç”¨to_jsonæ–¹æ³•æ—¶ï¼Œè®¾ç½®å‚æ•°ensure_ascii=Falseï¼Œè¿™æ ·å¯ä»¥é¿å…ASCIIç¼–ç çš„é—®é¢˜ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡ã€‚\n\n**ç¤ºä¾‹ä»£ç ï¼š**\n\n```python\nimport pandas as pd\n\n# åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrame\n\ndf = pd.DataFrame({'data': ['ä¸­æ–‡å†…å®¹', 'æ›´å¤šä¸­æ–‡', 'æœ€åä¸€æ¡']})\n\n# è½¬æ¢ä¸ºJSONï¼Œç¡®ä¿ä½¿ç”¨utf-8ç¼–ç ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ASCIIç¼–ç \n\njson_str = df.to_json(orient='records', force_ascii=False)\n\nprint(json_str)\n```\n\nè¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrameï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºJSONæ ¼å¼ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦ã€‚\n\n\n","source":"_posts/Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜.md","raw":"---\ntitle: Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜\ndate: 2024-09-18 11:24:46\ntags:\n---\n\n**é—®é¢˜è§£é‡Šï¼š**\n\n> åœ¨ä½¿ç”¨pandasè½¬æ¢DataFrameåˆ°JSONæ ¼å¼æ—¶ï¼Œå¦‚æœDataFrameä¸­å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯èƒ½ä¼šé‡åˆ°æ— æ³•æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œpandasä¼šå°†å­—ç¬¦ä¸²ç¼–ç ä¸ºUnicode Escapeå½¢å¼ï¼Œè¿™ä¸æ˜¯JSONçš„æ ‡å‡†æ ¼å¼ï¼Œè€Œæ˜¯Pythonå†…éƒ¨çš„è¡¨ç°å½¢å¼ã€‚\n\n**è§£å†³æ–¹æ³•ï¼š**\n\n1. åœ¨è½¬æ¢ä¸ºJSONä¹‹å‰ï¼Œç¡®ä¿DataFrameçš„ç¼–ç æ˜¯æ­£ç¡®çš„ï¼Œé€šå¸¸ä½¿ç”¨UTF-8ç¼–ç ã€‚\n\n2. ä½¿ç”¨to_jsonæ–¹æ³•æ—¶ï¼Œè®¾ç½®å‚æ•°ensure_ascii=Falseï¼Œè¿™æ ·å¯ä»¥é¿å…ASCIIç¼–ç çš„é—®é¢˜ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡ã€‚\n\n**ç¤ºä¾‹ä»£ç ï¼š**\n\n```python\nimport pandas as pd\n\n# åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrame\n\ndf = pd.DataFrame({'data': ['ä¸­æ–‡å†…å®¹', 'æ›´å¤šä¸­æ–‡', 'æœ€åä¸€æ¡']})\n\n# è½¬æ¢ä¸ºJSONï¼Œç¡®ä¿ä½¿ç”¨utf-8ç¼–ç ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ASCIIç¼–ç \n\njson_str = df.to_json(orient='records', force_ascii=False)\n\nprint(json_str)\n```\n\nè¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrameï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºJSONæ ¼å¼ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦ã€‚\n\n\n","slug":"Pandasè½¬JSONæ— æ³•æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜","published":1,"updated":"2024-09-18T03:25:05.971Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dl000kwen164b61vd8","content":"<p><strong>é—®é¢˜è§£é‡Šï¼š</strong></p>\n<blockquote>\n<p>åœ¨ä½¿ç”¨pandasè½¬æ¢DataFrameåˆ°JSONæ ¼å¼æ—¶ï¼Œå¦‚æœDataFrameä¸­å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯èƒ½ä¼šé‡åˆ°æ— æ³•æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œpandasä¼šå°†å­—ç¬¦ä¸²ç¼–ç ä¸ºUnicode Escapeå½¢å¼ï¼Œè¿™ä¸æ˜¯JSONçš„æ ‡å‡†æ ¼å¼ï¼Œè€Œæ˜¯Pythonå†…éƒ¨çš„è¡¨ç°å½¢å¼ã€‚</p>\n</blockquote>\n<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>\n<ol>\n<li><p>åœ¨è½¬æ¢ä¸ºJSONä¹‹å‰ï¼Œç¡®ä¿DataFrameçš„ç¼–ç æ˜¯æ­£ç¡®çš„ï¼Œé€šå¸¸ä½¿ç”¨UTF-8ç¼–ç ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨to_jsonæ–¹æ³•æ—¶ï¼Œè®¾ç½®å‚æ•°ensure_ascii&#x3D;Falseï¼Œè¿™æ ·å¯ä»¥é¿å…ASCIIç¼–ç çš„é—®é¢˜ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡ã€‚</p>\n</li>\n</ol>\n<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrame</span></span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.DataFrame(&#123;<span class=\"string\">&#x27;data&#x27;</span>: [<span class=\"string\">&#x27;ä¸­æ–‡å†…å®¹&#x27;</span>, <span class=\"string\">&#x27;æ›´å¤šä¸­æ–‡&#x27;</span>, <span class=\"string\">&#x27;æœ€åä¸€æ¡&#x27;</span>]&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½¬æ¢ä¸ºJSONï¼Œç¡®ä¿ä½¿ç”¨utf-8ç¼–ç ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ASCIIç¼–ç </span></span><br><span class=\"line\"></span><br><span class=\"line\">json_str = df.to_json(orient=<span class=\"string\">&#x27;records&#x27;</span>, force_ascii=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(json_str)</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrameï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºJSONæ ¼å¼ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦ã€‚</p>\n","excerpt":"","more":"<p><strong>é—®é¢˜è§£é‡Šï¼š</strong></p>\n<blockquote>\n<p>åœ¨ä½¿ç”¨pandasè½¬æ¢DataFrameåˆ°JSONæ ¼å¼æ—¶ï¼Œå¦‚æœDataFrameä¸­å«æœ‰ä¸­æ–‡å­—ç¬¦ï¼Œå¯èƒ½ä¼šé‡åˆ°æ— æ³•æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œpandasä¼šå°†å­—ç¬¦ä¸²ç¼–ç ä¸ºUnicode Escapeå½¢å¼ï¼Œè¿™ä¸æ˜¯JSONçš„æ ‡å‡†æ ¼å¼ï¼Œè€Œæ˜¯Pythonå†…éƒ¨çš„è¡¨ç°å½¢å¼ã€‚</p>\n</blockquote>\n<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>\n<ol>\n<li><p>åœ¨è½¬æ¢ä¸ºJSONä¹‹å‰ï¼Œç¡®ä¿DataFrameçš„ç¼–ç æ˜¯æ­£ç¡®çš„ï¼Œé€šå¸¸ä½¿ç”¨UTF-8ç¼–ç ã€‚</p>\n</li>\n<li><p>ä½¿ç”¨to_jsonæ–¹æ³•æ—¶ï¼Œè®¾ç½®å‚æ•°ensure_ascii&#x3D;Falseï¼Œè¿™æ ·å¯ä»¥é¿å…ASCIIç¼–ç çš„é—®é¢˜ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡ã€‚</p>\n</li>\n</ol>\n<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrame</span></span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.DataFrame(&#123;<span class=\"string\">&#x27;data&#x27;</span>: [<span class=\"string\">&#x27;ä¸­æ–‡å†…å®¹&#x27;</span>, <span class=\"string\">&#x27;æ›´å¤šä¸­æ–‡&#x27;</span>, <span class=\"string\">&#x27;æœ€åä¸€æ¡&#x27;</span>]&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è½¬æ¢ä¸ºJSONï¼Œç¡®ä¿ä½¿ç”¨utf-8ç¼–ç ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ASCIIç¼–ç </span></span><br><span class=\"line\"></span><br><span class=\"line\">json_str = df.to_json(orient=<span class=\"string\">&#x27;records&#x27;</span>, force_ascii=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(json_str)</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸­æ–‡çš„DataFrameï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºJSONæ ¼å¼ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦ã€‚</p>\n"},{"title":"Node.jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6","date":"2023-12-28T10:03:40.000Z","_content":"\n> Node.js ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿæ˜¯åŸºäº CommonJS çš„ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒES6 æ¨¡å—ä¹Ÿå¾—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„æ”¯æŒã€‚ä»¥ä¸‹æ˜¯å…³äº CommonJS å’Œ ES6 æ¨¡å—çš„ç®€è¦æ¦‚è¿°ï¼š\n\n1.**CommonJS**ï¼š\n\n- æœ€åˆä¸º Node.js è®¾è®¡ï¼Œæ‰€ä»¥åˆç§° Node.js æ¨¡å—ç³»ç»Ÿã€‚\n- ä½¿ç”¨ `require()` å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ `module.exports` æˆ– `exports` å¯¹è±¡æ¥å¯¼å‡ºæ¨¡å—ã€‚\n\n2.**ES6 æ¨¡å—**ï¼š\n\n- æ˜¯ ECMAScript 6 (ES2015) ä¸­å¼•å…¥çš„æ–°æ¨¡å—ç³»ç»Ÿã€‚\n- ä½¿ç”¨ `import` è¯­å¥æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ `export` è¯­å¥æ¥å¯¼å‡ºæ¨¡å—ã€‚\n- æœ‰é™æ€å’ŒåŠ¨æ€ä¸¤ç§å¯¼å…¥æ–¹å¼ï¼Œæä¾›æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œä»£ç ç¼–è¯‘æ—¶ä¼˜åŒ–ã€‚\n\n> è¯·æ³¨æ„ï¼Œéšç€Node.jsçš„å‘å±•ï¼Œè®¸å¤šåº“å·²ç»è¿ç§»åˆ°ESæ¨¡å—ï¼Œå› æ­¤ç¡®ä¿ä½ ä½¿ç”¨çš„åº“ä¸ä½ å½“å‰çš„Node.jsç‰ˆæœ¬å…¼å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚\n\n\n\n### ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\n\n1.æŠŠéœ€è¦æ›´æ¢çš„`require`å…¨éƒ¨æ¢æˆ`import`\n\n2.åœ¨srcä¸‹åˆ›å»ºä¸€ä¸ª.babelrcæ–‡ä»¶\n\n```js\n{\n  \"presets\":[\"es2015\"]\n}\n```\n\n3.åœ¨package.jsonä¸­çš„ä¸€æ®µåŠ ä¸Š`--exec babel-node`\n\n```js\n{\n  \"name\": \"api\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"type\": \"module\", // æ·»åŠ typeç±»å‹\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"dev\": \"nodemon ./src/main.js --exec babel-node\",\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1 --exec babel-node\"\n  },\n```\n\n4.å®‰è£…æ’ä»¶ `npm install babel-preset-es2015`\n\n\n\n### äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\n\n1.Commonjsï¼š\n\n```js\n// moduleA.js  \nconst message = 'Hello from CommonJS';  \nmodule.exports = message;\n```\n\n```js\n// main.js  \nconst moduleA = require('./moduleA');  \nconsole.log(moduleA); // è¾“å‡º 'Hello from CommonJS'\n```\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonJS çš„ `require` å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§å¯¹åº”äºæ¨¡å—å¯¼å‡ºçš„å†…å®¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`moduleA` æ˜¯ä¸€ä¸ªåŒ…å« `message` å±æ€§çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `moduleA.message` æ¥è®¿é—®å¯¼å‡ºçš„å†…å®¹ã€‚**\n\n2.ES6ï¼š\n\n```js\n// moduleA.js  \nexport const message = 'Hello from ES6';\n```\n\n```js\n// main.js  \nimport { message } from './moduleA';  \nconsole.log(message); // è¾“å‡º 'Hello from ES6'\n```\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 çš„ `import` è¯­å¥è¿”å›çš„æ˜¯å¯¼å‡ºçš„å†…å®¹æœ¬èº«ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„å†…å®¹ï¼Œè€Œä¸éœ€è¦é€šè¿‡å±æ€§æ¥è®¿é—®ã€‚**\n\n","source":"_posts/Node-jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6.md","raw":"---\ntitle: Node.jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6\ndate: 2023-12-28 18:03:40\ntags:\n---\n\n> Node.js ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿæ˜¯åŸºäº CommonJS çš„ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒES6 æ¨¡å—ä¹Ÿå¾—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„æ”¯æŒã€‚ä»¥ä¸‹æ˜¯å…³äº CommonJS å’Œ ES6 æ¨¡å—çš„ç®€è¦æ¦‚è¿°ï¼š\n\n1.**CommonJS**ï¼š\n\n- æœ€åˆä¸º Node.js è®¾è®¡ï¼Œæ‰€ä»¥åˆç§° Node.js æ¨¡å—ç³»ç»Ÿã€‚\n- ä½¿ç”¨ `require()` å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ `module.exports` æˆ– `exports` å¯¹è±¡æ¥å¯¼å‡ºæ¨¡å—ã€‚\n\n2.**ES6 æ¨¡å—**ï¼š\n\n- æ˜¯ ECMAScript 6 (ES2015) ä¸­å¼•å…¥çš„æ–°æ¨¡å—ç³»ç»Ÿã€‚\n- ä½¿ç”¨ `import` è¯­å¥æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ `export` è¯­å¥æ¥å¯¼å‡ºæ¨¡å—ã€‚\n- æœ‰é™æ€å’ŒåŠ¨æ€ä¸¤ç§å¯¼å…¥æ–¹å¼ï¼Œæä¾›æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œä»£ç ç¼–è¯‘æ—¶ä¼˜åŒ–ã€‚\n\n> è¯·æ³¨æ„ï¼Œéšç€Node.jsçš„å‘å±•ï¼Œè®¸å¤šåº“å·²ç»è¿ç§»åˆ°ESæ¨¡å—ï¼Œå› æ­¤ç¡®ä¿ä½ ä½¿ç”¨çš„åº“ä¸ä½ å½“å‰çš„Node.jsç‰ˆæœ¬å…¼å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚\n\n\n\n### ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\n\n1.æŠŠéœ€è¦æ›´æ¢çš„`require`å…¨éƒ¨æ¢æˆ`import`\n\n2.åœ¨srcä¸‹åˆ›å»ºä¸€ä¸ª.babelrcæ–‡ä»¶\n\n```js\n{\n  \"presets\":[\"es2015\"]\n}\n```\n\n3.åœ¨package.jsonä¸­çš„ä¸€æ®µåŠ ä¸Š`--exec babel-node`\n\n```js\n{\n  \"name\": \"api\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"type\": \"module\", // æ·»åŠ typeç±»å‹\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"dev\": \"nodemon ./src/main.js --exec babel-node\",\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1 --exec babel-node\"\n  },\n```\n\n4.å®‰è£…æ’ä»¶ `npm install babel-preset-es2015`\n\n\n\n### äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\n\n1.Commonjsï¼š\n\n```js\n// moduleA.js  \nconst message = 'Hello from CommonJS';  \nmodule.exports = message;\n```\n\n```js\n// main.js  \nconst moduleA = require('./moduleA');  \nconsole.log(moduleA); // è¾“å‡º 'Hello from CommonJS'\n```\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonJS çš„ `require` å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§å¯¹åº”äºæ¨¡å—å¯¼å‡ºçš„å†…å®¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`moduleA` æ˜¯ä¸€ä¸ªåŒ…å« `message` å±æ€§çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `moduleA.message` æ¥è®¿é—®å¯¼å‡ºçš„å†…å®¹ã€‚**\n\n2.ES6ï¼š\n\n```js\n// moduleA.js  \nexport const message = 'Hello from ES6';\n```\n\n```js\n// main.js  \nimport { message } from './moduleA';  \nconsole.log(message); // è¾“å‡º 'Hello from ES6'\n```\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 çš„ `import` è¯­å¥è¿”å›çš„æ˜¯å¯¼å‡ºçš„å†…å®¹æœ¬èº«ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„å†…å®¹ï¼Œè€Œä¸éœ€è¦é€šè¿‡å±æ€§æ¥è®¿é—®ã€‚**\n\n","slug":"Node-jsæ¨¡å—åŒ–é€‰æ‹©Commonjså’ŒES6","published":1,"updated":"2024-02-07T07:27:45.071Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dm000lwen176nl3jsp","content":"<blockquote>\n<p>Node.js ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿæ˜¯åŸºäº CommonJS çš„ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒES6 æ¨¡å—ä¹Ÿå¾—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„æ”¯æŒã€‚ä»¥ä¸‹æ˜¯å…³äº CommonJS å’Œ ES6 æ¨¡å—çš„ç®€è¦æ¦‚è¿°ï¼š</p>\n</blockquote>\n<p>1.<strong>CommonJS</strong>ï¼š</p>\n<ul>\n<li>æœ€åˆä¸º Node.js è®¾è®¡ï¼Œæ‰€ä»¥åˆç§° Node.js æ¨¡å—ç³»ç»Ÿã€‚</li>\n<li>ä½¿ç”¨ <code>require()</code> å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ <code>module.exports</code> æˆ– <code>exports</code> å¯¹è±¡æ¥å¯¼å‡ºæ¨¡å—ã€‚</li>\n</ul>\n<p>2.<strong>ES6 æ¨¡å—</strong>ï¼š</p>\n<ul>\n<li>æ˜¯ ECMAScript 6 (ES2015) ä¸­å¼•å…¥çš„æ–°æ¨¡å—ç³»ç»Ÿã€‚</li>\n<li>ä½¿ç”¨ <code>import</code> è¯­å¥æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ <code>export</code> è¯­å¥æ¥å¯¼å‡ºæ¨¡å—ã€‚</li>\n<li>æœ‰é™æ€å’ŒåŠ¨æ€ä¸¤ç§å¯¼å…¥æ–¹å¼ï¼Œæä¾›æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œä»£ç ç¼–è¯‘æ—¶ä¼˜åŒ–ã€‚</li>\n</ul>\n<blockquote>\n<p>è¯·æ³¨æ„ï¼Œéšç€Node.jsçš„å‘å±•ï¼Œè®¸å¤šåº“å·²ç»è¿ç§»åˆ°ESæ¨¡å—ï¼Œå› æ­¤ç¡®ä¿ä½ ä½¿ç”¨çš„åº“ä¸ä½ å½“å‰çš„Node.jsç‰ˆæœ¬å…¼å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\"><a href=\"#ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\" class=\"headerlink\" title=\"ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\"></a>ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ</h3><p>1.æŠŠéœ€è¦æ›´æ¢çš„<code>require</code>å…¨éƒ¨æ¢æˆ<code>import</code></p>\n<p>2.åœ¨srcä¸‹åˆ›å»ºä¸€ä¸ª.babelrcæ–‡ä»¶</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;presets&quot;</span>:[<span class=\"string\">&quot;es2015&quot;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3.åœ¨package.jsonä¸­çš„ä¸€æ®µåŠ ä¸Š<code>--exec babel-node</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;api&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;version&quot;</span>: <span class=\"string\">&quot;1.0.0&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;description&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;module&quot;</span>, <span class=\"comment\">// æ·»åŠ typeç±»å‹</span></span><br><span class=\"line\">  <span class=\"string\">&quot;main&quot;</span>: <span class=\"string\">&quot;index.js&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;scripts&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;dev&quot;</span>: <span class=\"string\">&quot;nodemon ./src/main.js --exec babel-node&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;test&quot;</span>: <span class=\"string\">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1 --exec babel-node&quot;</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>4.å®‰è£…æ’ä»¶ <code>npm install babel-preset-es2015</code></p>\n<h3 id=\"äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\"><a href=\"#äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\" class=\"headerlink\" title=\"äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\"></a>äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«</h3><p>1.Commonjsï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// moduleA.js  </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> message = <span class=\"string\">&#x27;Hello from CommonJS&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = message;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.js  </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> moduleA = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;./moduleA&#x27;</span>);  </span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(moduleA); <span class=\"comment\">// è¾“å‡º &#x27;Hello from CommonJS&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonJS çš„ <code>require</code> å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§å¯¹åº”äºæ¨¡å—å¯¼å‡ºçš„å†…å®¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>moduleA</code> æ˜¯ä¸€ä¸ªåŒ…å« <code>message</code> å±æ€§çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>moduleA.message</code> æ¥è®¿é—®å¯¼å‡ºçš„å†…å®¹ã€‚</strong></p>\n<p>2.ES6ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// moduleA.js  </span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> message = <span class=\"string\">&#x27;Hello from ES6&#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.js  </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; message &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./moduleA&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(message); <span class=\"comment\">// è¾“å‡º &#x27;Hello from ES6&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 çš„ <code>import</code> è¯­å¥è¿”å›çš„æ˜¯å¯¼å‡ºçš„å†…å®¹æœ¬èº«ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„å†…å®¹ï¼Œè€Œä¸éœ€è¦é€šè¿‡å±æ€§æ¥è®¿é—®ã€‚</strong></p>\n","excerpt":"","more":"<blockquote>\n<p>Node.js ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿæ˜¯åŸºäº CommonJS çš„ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒES6 æ¨¡å—ä¹Ÿå¾—åˆ°äº†è¶Šæ¥è¶Šå¤šçš„æ”¯æŒã€‚ä»¥ä¸‹æ˜¯å…³äº CommonJS å’Œ ES6 æ¨¡å—çš„ç®€è¦æ¦‚è¿°ï¼š</p>\n</blockquote>\n<p>1.<strong>CommonJS</strong>ï¼š</p>\n<ul>\n<li>æœ€åˆä¸º Node.js è®¾è®¡ï¼Œæ‰€ä»¥åˆç§° Node.js æ¨¡å—ç³»ç»Ÿã€‚</li>\n<li>ä½¿ç”¨ <code>require()</code> å‡½æ•°æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ <code>module.exports</code> æˆ– <code>exports</code> å¯¹è±¡æ¥å¯¼å‡ºæ¨¡å—ã€‚</li>\n</ul>\n<p>2.<strong>ES6 æ¨¡å—</strong>ï¼š</p>\n<ul>\n<li>æ˜¯ ECMAScript 6 (ES2015) ä¸­å¼•å…¥çš„æ–°æ¨¡å—ç³»ç»Ÿã€‚</li>\n<li>ä½¿ç”¨ <code>import</code> è¯­å¥æ¥å¯¼å…¥æ¨¡å—ï¼Œä½¿ç”¨ <code>export</code> è¯­å¥æ¥å¯¼å‡ºæ¨¡å—ã€‚</li>\n<li>æœ‰é™æ€å’ŒåŠ¨æ€ä¸¤ç§å¯¼å…¥æ–¹å¼ï¼Œæä¾›æ›´å¼ºçš„ç±»å‹æ£€æŸ¥å’Œä»£ç ç¼–è¯‘æ—¶ä¼˜åŒ–ã€‚</li>\n</ul>\n<blockquote>\n<p>è¯·æ³¨æ„ï¼Œéšç€Node.jsçš„å‘å±•ï¼Œè®¸å¤šåº“å·²ç»è¿ç§»åˆ°ESæ¨¡å—ï¼Œå› æ­¤ç¡®ä¿ä½ ä½¿ç”¨çš„åº“ä¸ä½ å½“å‰çš„Node.jsç‰ˆæœ¬å…¼å®¹æ˜¯å¾ˆé‡è¦çš„ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\"><a href=\"#ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\" class=\"headerlink\" title=\"ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ\"></a>ä¸€ã€æ­å»ºES6æ¨¡å—ç³»ç»Ÿ</h3><p>1.æŠŠéœ€è¦æ›´æ¢çš„<code>require</code>å…¨éƒ¨æ¢æˆ<code>import</code></p>\n<p>2.åœ¨srcä¸‹åˆ›å»ºä¸€ä¸ª.babelrcæ–‡ä»¶</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;presets&quot;</span>:[<span class=\"string\">&quot;es2015&quot;</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3.åœ¨package.jsonä¸­çš„ä¸€æ®µåŠ ä¸Š<code>--exec babel-node</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;api&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;version&quot;</span>: <span class=\"string\">&quot;1.0.0&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;description&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;module&quot;</span>, <span class=\"comment\">// æ·»åŠ typeç±»å‹</span></span><br><span class=\"line\">  <span class=\"string\">&quot;main&quot;</span>: <span class=\"string\">&quot;index.js&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;scripts&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;dev&quot;</span>: <span class=\"string\">&quot;nodemon ./src/main.js --exec babel-node&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;test&quot;</span>: <span class=\"string\">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1 --exec babel-node&quot;</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n\n<p>4.å®‰è£…æ’ä»¶ <code>npm install babel-preset-es2015</code></p>\n<h3 id=\"äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\"><a href=\"#äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\" class=\"headerlink\" title=\"äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«\"></a>äºŒã€å…³äºä¸¤è€…çš„å¼•ç”¨åŒºåˆ«</h3><p>1.Commonjsï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// moduleA.js  </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> message = <span class=\"string\">&#x27;Hello from CommonJS&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = message;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.js  </span></span><br><span class=\"line\"><span class=\"keyword\">const</span> moduleA = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;./moduleA&#x27;</span>);  </span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(moduleA); <span class=\"comment\">// è¾“å‡º &#x27;Hello from CommonJS&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCommonJS çš„ <code>require</code> å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„å±æ€§å¯¹åº”äºæ¨¡å—å¯¼å‡ºçš„å†…å®¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>moduleA</code> æ˜¯ä¸€ä¸ªåŒ…å« <code>message</code> å±æ€§çš„å¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>moduleA.message</code> æ¥è®¿é—®å¯¼å‡ºçš„å†…å®¹ã€‚</strong></p>\n<p>2.ES6ï¼š</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// moduleA.js  </span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> message = <span class=\"string\">&#x27;Hello from ES6&#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// main.js  </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; message &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./moduleA&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(message); <span class=\"comment\">// è¾“å‡º &#x27;Hello from ES6&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 çš„ <code>import</code> è¯­å¥è¿”å›çš„æ˜¯å¯¼å‡ºçš„å†…å®¹æœ¬èº«ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„å†…å®¹ï¼Œè€Œä¸éœ€è¦é€šè¿‡å±æ€§æ¥è®¿é—®ã€‚</strong></p>\n"},{"title":"RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£","date":"2025-02-07T06:16:21.000Z","_content":"\n# RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\n\n---\n\n## **ä¸€ã€åŸºç¡€æ¦‚å¿µ**\n### 1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \næ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§**å¼‚æ­¥é€šä¿¡æœºåˆ¶**ï¼Œç”¨äºè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ç°ç³»ç»Ÿé—´å¯é çš„æ¶ˆæ¯ä¼ é€’ã€‚  \nRabbitMQ çš„æ ¸å¿ƒä½œç”¨åŒ…æ‹¬ï¼š\n- **å¼‚æ­¥å¤„ç†**ï¼šæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œååé‡ã€‚\n- **åº”ç”¨è§£è€¦**ï¼šé€šè¿‡ä¸­é—´ä»¶éš”ç¦»æœåŠ¡é—´çš„ç›´æ¥ä¾èµ–ã€‚\n- **æµé‡å‰Šå³°**ï¼šç¼“å†²çªå‘æµé‡ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½ã€‚\n- **æ¶ˆæ¯å¹¿æ’­**ï¼šæ”¯æŒä¸€å¯¹å¤šæ¶ˆæ¯åˆ†å‘æ¨¡å¼ã€‚\n\n### 2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \nAMQPï¼ˆAdvanced Message Queuing Protocolï¼‰æ˜¯**åº”ç”¨å±‚åè®®**ï¼Œå®šä¹‰äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„ç»Ÿä¸€é€šä¿¡æ ‡å‡†ã€‚  \nRabbitMQ åŸºäº AMQP æ¨¡å‹ï¼š\n- **ç”Ÿäº§è€…**ï¼ˆProducerï¼‰å‘é€æ¶ˆæ¯åˆ° Exchangeã€‚\n- **Exchange** æ ¹æ®è·¯ç”±è§„åˆ™ï¼ˆBinding Keyï¼‰å°†æ¶ˆæ¯åˆ†å‘åˆ° Queueã€‚\n- **æ¶ˆè´¹è€…**ï¼ˆConsumerï¼‰ä» Queue ä¸­è·å–æ¶ˆæ¯ã€‚\n\n---\n\n## **äºŒã€æ ¸å¿ƒç»„ä»¶**\n### 3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **Exchange**ï¼šæ¶ˆæ¯è·¯ç”±ä¸­å¿ƒï¼Œå†³å®šæ¶ˆæ¯å¦‚ä½•åˆ†å‘åˆ°é˜Ÿåˆ—ã€‚\n- **Queue**ï¼šå­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ä¸­è®¢é˜…æ¶ˆæ¯ã€‚\n- **Binding**ï¼šå®šä¹‰ Exchange å’Œ Queue ä¹‹é—´çš„æ˜ å°„è§„åˆ™ã€‚\n- **Channel**ï¼šå¤ç”¨ TCP è¿æ¥çš„è½»é‡çº§é€šä¿¡é€šé“ã€‚\n- **Virtual Host**ï¼šé€»è¾‘éš”ç¦»å•å…ƒï¼Œç±»ä¼¼å‘½åç©ºé—´ã€‚\n\n### 4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \n| ç±»å‹        | è·¯ç”±è§„åˆ™                          | å…¸å‹åœºæ™¯                     |  \n|-------------|-----------------------------------|------------------------------|  \n| **Direct**  | ç²¾ç¡®åŒ¹é… Routing Key              | ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆå¦‚è®¢å•å¤„ç†ï¼‰     |  \n| **Topic**   | é€šé…ç¬¦åŒ¹é… Routing Keyï¼ˆ* å’Œ #ï¼‰  | åˆ†ç±»æ¶ˆæ¯å¹¿æ’­ï¼ˆå¦‚æ—¥å¿—åˆ†ç±»ï¼‰   |  \n| **Fanout**  | å¿½ç•¥ Routing Keyï¼Œå¹¿æ’­åˆ°æ‰€æœ‰é˜Ÿåˆ—  | å…¨å±€é€šçŸ¥ï¼ˆå¦‚ç³»ç»Ÿé…ç½®æ›´æ–°ï¼‰   |  \n| **Headers** | åŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…              | å¤æ‚è·¯ç”±é€»è¾‘ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰     |\n\n---\n\n## **ä¸‰ã€æ¶ˆæ¯æœºåˆ¶**\n### 5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **ç”Ÿäº§è€…ç¡®è®¤æ¨¡å¼**ï¼ˆPublisher Confirmï¼‰ï¼šç¡®ä¿æ¶ˆæ¯åˆ°è¾¾ Brokerã€‚\n- **æ¶ˆæ¯æŒä¹…åŒ–**ï¼šExchangeã€Queue å’Œæ¶ˆæ¯å‡è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼ˆ`durable=true`ï¼‰ã€‚\n- **æ¶ˆè´¹è€…æ‰‹åŠ¨åº”ç­”**ï¼ˆManual Acknowledgementï¼‰ï¼šæ¶ˆæ¯å¤„ç†å®Œæˆåå‘é€ ACKã€‚\n\n### 6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \næ­»ä¿¡é˜Ÿåˆ—ç”¨äºå­˜å‚¨æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚è§¦å‘æ¡ä»¶ï¼š\n1. æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»ï¼ˆ`basic.reject` æˆ– `basic.nack`ï¼‰ä¸”ä¸é‡æ–°å…¥é˜Ÿã€‚\n2. æ¶ˆæ¯ TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰è¿‡æœŸã€‚\n3. é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦é™åˆ¶ã€‚\n\n---\n\n## **å››ã€é«˜çº§ç‰¹æ€§**\n### 7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \nRabbitMQ åŸç”Ÿä¸æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š\n1. **æ¶ˆæ¯ TTL + æ­»ä¿¡é˜Ÿåˆ—**ï¼šè®¾ç½®æ¶ˆæ¯çš„ TTLï¼Œè¿‡æœŸåè½¬å‘åˆ° DLQã€‚\n2. **æ’ä»¶**ï¼ˆå¦‚ `rabbitmq-delayed-message-exchange`ï¼‰ï¼šä½¿ç”¨å»¶è¿Ÿäº¤æ¢æœºã€‚\n\n### 8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å¹‚ç­‰æ€§è®¾è®¡**ï¼šä¸šåŠ¡é€»è¾‘å¤©ç„¶æ”¯æŒé‡å¤å¤„ç†ï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€çº¦æŸï¼‰ã€‚\n- **å»é‡è¡¨**ï¼šè®°å½•å·²å¤„ç†æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ¶ˆæ¯ IDï¼‰ã€‚\n- **Redis åˆ†å¸ƒå¼é”**ï¼šåœ¨æ¶ˆè´¹å‰åŠ é”ã€‚\n\n---\n\n## **äº”ã€å¯é æ€§ä¸æ€§èƒ½**\n### 9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **æ™®é€šé›†ç¾¤**ï¼šé˜Ÿåˆ—å…ƒæ•°æ®åŒæ­¥ï¼Œä½†æ¶ˆæ¯å­˜å‚¨åœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆæ— é«˜å¯ç”¨ï¼‰ã€‚\n- **é•œåƒé˜Ÿåˆ—**ï¼ˆMirrored Queuesï¼‰ï¼šé˜Ÿåˆ—æ•°æ®è·¨èŠ‚ç‚¹å¤åˆ¶ï¼Œå®ç°é«˜å¯ç”¨ã€‚\n\n### 10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **æ‰¹é‡å‘é€**ï¼ˆBatch Publishï¼‰ã€‚\n- **å¤šçº¿ç¨‹ Channel**ï¼ˆé¿å…å• Channel é˜»å¡ï¼‰ã€‚\n- **ä¼˜åŒ– ACK æœºåˆ¶**ï¼šæ‰¹é‡ç¡®è®¤æˆ–å¼‚æ­¥ç¡®è®¤ã€‚\n- **è°ƒæ•´é¢„å–æ•°é‡**ï¼ˆprefetchCountï¼‰æå‡æ¶ˆè´¹è€…å¹¶å‘èƒ½åŠ›ã€‚\n\n---\n\n## **å…­ã€å®æˆ˜åœºæ™¯**\n### 11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å•é˜Ÿåˆ—å•æ¶ˆè´¹è€…**ï¼šç‰ºç‰²å¹¶å‘æ€§ä¿è¯é¡ºåºã€‚\n- **æ¶ˆæ¯åˆ†ç»„**ï¼šé€šè¿‡ Routing Key å°†éœ€è¦é¡ºåºçš„æ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ã€‚\n\n### 12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å‰Šå³°å¡«è°·**ï¼šå°†è¯·æ±‚å†™å…¥é˜Ÿåˆ—ï¼Œåç«¯æœåŠ¡æŒ‰å¤„ç†èƒ½åŠ›æ¶ˆè´¹ã€‚\n- **é˜Ÿåˆ—å®¹é‡é™åˆ¶**ï¼šé¿å…å†…å­˜æº¢å‡ºã€‚\n- **å¿«é€Ÿå¤±è´¥æœºåˆ¶**ï¼šé˜Ÿåˆ—æ»¡æ—¶ç›´æ¥æ‹’ç»æ–°è¯·æ±‚ã€‚\n\n---\n\n## **ä¸ƒã€ç›‘æ§ä¸ç®¡ç†**\n### 13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **ç®¡ç†ç•Œé¢**ï¼šé€šè¿‡ Web UI æŸ¥çœ‹è¿æ¥ã€é˜Ÿåˆ—ã€ååé‡ç­‰æŒ‡æ ‡ã€‚\n- **å‘½ä»¤è¡Œå·¥å…·**ï¼š`rabbitmqctl list_queues`ã€‚\n- **Prometheus + Grafana**ï¼šé›†æˆç›‘æ§å‘Šè­¦ã€‚\n\n---\n\n## **å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶**\n### 14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \n| **ç»´åº¦**       | **RabbitMQ**                     | **Kafka**                     |  \n|----------------|----------------------------------|-------------------------------|  \n| è®¾è®¡ç›®æ ‡       | æ¶ˆæ¯å¯é ä¼ è¾“ä¸å¤æ‚è·¯ç”±           | é«˜ååé‡æ—¥å¿—æµå¤„ç†            |  \n| æ¶ˆæ¯ä¿ç•™       | æ¶ˆè´¹ååˆ é™¤                       | æŒ‰æ—¶é—´æˆ–å¤§å°ä¿ç•™              |  \n| ååé‡         | ä¸‡çº§ QPS                        | ç™¾ä¸‡çº§ QPS                    |  \n| é€‚ç”¨åœºæ™¯       | ä¸šåŠ¡è§£è€¦ã€å»¶è¿Ÿæ¶ˆæ¯               | æ—¥å¿—æ”¶é›†ã€å®æ—¶æµå¤„ç†          |\n\n---\n\n## **æ–‡æ¡£è¯´æ˜**\næœ¬æ–‡æ¡£æ¶µç›– RabbitMQ çš„æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œæœºåˆ¶åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼Œé€‚ç”¨äºé¢è¯•å‡†å¤‡æˆ–æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å‚è€ƒã€‚  \n**æŒç»­æ›´æ–°å»ºè®®**ï¼šç»“åˆ RabbitMQ å®˜æ–¹æ–‡æ¡£ï¼ˆhttps://www.rabbitmq.comï¼‰å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹ã€‚\n\nPS: è¯¥å†…å®¹æœ‰DeepSeek R1æ·±åº¦å­¦ä¹ æ€»ç»“ï¼ˆdeepseekç‰›é€¼ï¼ï¼ï¼ï¼‰\n","source":"_posts/RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£.md","raw":"---\ntitle: RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\ndate: 2025-02-07 14:16:21\ntags:\n---\n\n# RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\n\n---\n\n## **ä¸€ã€åŸºç¡€æ¦‚å¿µ**\n### 1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \næ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§**å¼‚æ­¥é€šä¿¡æœºåˆ¶**ï¼Œç”¨äºè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ç°ç³»ç»Ÿé—´å¯é çš„æ¶ˆæ¯ä¼ é€’ã€‚  \nRabbitMQ çš„æ ¸å¿ƒä½œç”¨åŒ…æ‹¬ï¼š\n- **å¼‚æ­¥å¤„ç†**ï¼šæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œååé‡ã€‚\n- **åº”ç”¨è§£è€¦**ï¼šé€šè¿‡ä¸­é—´ä»¶éš”ç¦»æœåŠ¡é—´çš„ç›´æ¥ä¾èµ–ã€‚\n- **æµé‡å‰Šå³°**ï¼šç¼“å†²çªå‘æµé‡ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½ã€‚\n- **æ¶ˆæ¯å¹¿æ’­**ï¼šæ”¯æŒä¸€å¯¹å¤šæ¶ˆæ¯åˆ†å‘æ¨¡å¼ã€‚\n\n### 2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \nAMQPï¼ˆAdvanced Message Queuing Protocolï¼‰æ˜¯**åº”ç”¨å±‚åè®®**ï¼Œå®šä¹‰äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„ç»Ÿä¸€é€šä¿¡æ ‡å‡†ã€‚  \nRabbitMQ åŸºäº AMQP æ¨¡å‹ï¼š\n- **ç”Ÿäº§è€…**ï¼ˆProducerï¼‰å‘é€æ¶ˆæ¯åˆ° Exchangeã€‚\n- **Exchange** æ ¹æ®è·¯ç”±è§„åˆ™ï¼ˆBinding Keyï¼‰å°†æ¶ˆæ¯åˆ†å‘åˆ° Queueã€‚\n- **æ¶ˆè´¹è€…**ï¼ˆConsumerï¼‰ä» Queue ä¸­è·å–æ¶ˆæ¯ã€‚\n\n---\n\n## **äºŒã€æ ¸å¿ƒç»„ä»¶**\n### 3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **Exchange**ï¼šæ¶ˆæ¯è·¯ç”±ä¸­å¿ƒï¼Œå†³å®šæ¶ˆæ¯å¦‚ä½•åˆ†å‘åˆ°é˜Ÿåˆ—ã€‚\n- **Queue**ï¼šå­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ä¸­è®¢é˜…æ¶ˆæ¯ã€‚\n- **Binding**ï¼šå®šä¹‰ Exchange å’Œ Queue ä¹‹é—´çš„æ˜ å°„è§„åˆ™ã€‚\n- **Channel**ï¼šå¤ç”¨ TCP è¿æ¥çš„è½»é‡çº§é€šä¿¡é€šé“ã€‚\n- **Virtual Host**ï¼šé€»è¾‘éš”ç¦»å•å…ƒï¼Œç±»ä¼¼å‘½åç©ºé—´ã€‚\n\n### 4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \n| ç±»å‹        | è·¯ç”±è§„åˆ™                          | å…¸å‹åœºæ™¯                     |  \n|-------------|-----------------------------------|------------------------------|  \n| **Direct**  | ç²¾ç¡®åŒ¹é… Routing Key              | ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆå¦‚è®¢å•å¤„ç†ï¼‰     |  \n| **Topic**   | é€šé…ç¬¦åŒ¹é… Routing Keyï¼ˆ* å’Œ #ï¼‰  | åˆ†ç±»æ¶ˆæ¯å¹¿æ’­ï¼ˆå¦‚æ—¥å¿—åˆ†ç±»ï¼‰   |  \n| **Fanout**  | å¿½ç•¥ Routing Keyï¼Œå¹¿æ’­åˆ°æ‰€æœ‰é˜Ÿåˆ—  | å…¨å±€é€šçŸ¥ï¼ˆå¦‚ç³»ç»Ÿé…ç½®æ›´æ–°ï¼‰   |  \n| **Headers** | åŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…              | å¤æ‚è·¯ç”±é€»è¾‘ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰     |\n\n---\n\n## **ä¸‰ã€æ¶ˆæ¯æœºåˆ¶**\n### 5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **ç”Ÿäº§è€…ç¡®è®¤æ¨¡å¼**ï¼ˆPublisher Confirmï¼‰ï¼šç¡®ä¿æ¶ˆæ¯åˆ°è¾¾ Brokerã€‚\n- **æ¶ˆæ¯æŒä¹…åŒ–**ï¼šExchangeã€Queue å’Œæ¶ˆæ¯å‡è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼ˆ`durable=true`ï¼‰ã€‚\n- **æ¶ˆè´¹è€…æ‰‹åŠ¨åº”ç­”**ï¼ˆManual Acknowledgementï¼‰ï¼šæ¶ˆæ¯å¤„ç†å®Œæˆåå‘é€ ACKã€‚\n\n### 6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \næ­»ä¿¡é˜Ÿåˆ—ç”¨äºå­˜å‚¨æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚è§¦å‘æ¡ä»¶ï¼š\n1. æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»ï¼ˆ`basic.reject` æˆ– `basic.nack`ï¼‰ä¸”ä¸é‡æ–°å…¥é˜Ÿã€‚\n2. æ¶ˆæ¯ TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰è¿‡æœŸã€‚\n3. é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦é™åˆ¶ã€‚\n\n---\n\n## **å››ã€é«˜çº§ç‰¹æ€§**\n### 7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \nRabbitMQ åŸç”Ÿä¸æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š\n1. **æ¶ˆæ¯ TTL + æ­»ä¿¡é˜Ÿåˆ—**ï¼šè®¾ç½®æ¶ˆæ¯çš„ TTLï¼Œè¿‡æœŸåè½¬å‘åˆ° DLQã€‚\n2. **æ’ä»¶**ï¼ˆå¦‚ `rabbitmq-delayed-message-exchange`ï¼‰ï¼šä½¿ç”¨å»¶è¿Ÿäº¤æ¢æœºã€‚\n\n### 8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å¹‚ç­‰æ€§è®¾è®¡**ï¼šä¸šåŠ¡é€»è¾‘å¤©ç„¶æ”¯æŒé‡å¤å¤„ç†ï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€çº¦æŸï¼‰ã€‚\n- **å»é‡è¡¨**ï¼šè®°å½•å·²å¤„ç†æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ¶ˆæ¯ IDï¼‰ã€‚\n- **Redis åˆ†å¸ƒå¼é”**ï¼šåœ¨æ¶ˆè´¹å‰åŠ é”ã€‚\n\n---\n\n## **äº”ã€å¯é æ€§ä¸æ€§èƒ½**\n### 9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **æ™®é€šé›†ç¾¤**ï¼šé˜Ÿåˆ—å…ƒæ•°æ®åŒæ­¥ï¼Œä½†æ¶ˆæ¯å­˜å‚¨åœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆæ— é«˜å¯ç”¨ï¼‰ã€‚\n- **é•œåƒé˜Ÿåˆ—**ï¼ˆMirrored Queuesï¼‰ï¼šé˜Ÿåˆ—æ•°æ®è·¨èŠ‚ç‚¹å¤åˆ¶ï¼Œå®ç°é«˜å¯ç”¨ã€‚\n\n### 10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **æ‰¹é‡å‘é€**ï¼ˆBatch Publishï¼‰ã€‚\n- **å¤šçº¿ç¨‹ Channel**ï¼ˆé¿å…å• Channel é˜»å¡ï¼‰ã€‚\n- **ä¼˜åŒ– ACK æœºåˆ¶**ï¼šæ‰¹é‡ç¡®è®¤æˆ–å¼‚æ­¥ç¡®è®¤ã€‚\n- **è°ƒæ•´é¢„å–æ•°é‡**ï¼ˆprefetchCountï¼‰æå‡æ¶ˆè´¹è€…å¹¶å‘èƒ½åŠ›ã€‚\n\n---\n\n## **å…­ã€å®æˆ˜åœºæ™¯**\n### 11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å•é˜Ÿåˆ—å•æ¶ˆè´¹è€…**ï¼šç‰ºç‰²å¹¶å‘æ€§ä¿è¯é¡ºåºã€‚\n- **æ¶ˆæ¯åˆ†ç»„**ï¼šé€šè¿‡ Routing Key å°†éœ€è¦é¡ºåºçš„æ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ã€‚\n\n### 12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **å‰Šå³°å¡«è°·**ï¼šå°†è¯·æ±‚å†™å…¥é˜Ÿåˆ—ï¼Œåç«¯æœåŠ¡æŒ‰å¤„ç†èƒ½åŠ›æ¶ˆè´¹ã€‚\n- **é˜Ÿåˆ—å®¹é‡é™åˆ¶**ï¼šé¿å…å†…å­˜æº¢å‡ºã€‚\n- **å¿«é€Ÿå¤±è´¥æœºåˆ¶**ï¼šé˜Ÿåˆ—æ»¡æ—¶ç›´æ¥æ‹’ç»æ–°è¯·æ±‚ã€‚\n\n---\n\n## **ä¸ƒã€ç›‘æ§ä¸ç®¡ç†**\n### 13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\n**ç­”æ¡ˆ**ï¼š\n- **ç®¡ç†ç•Œé¢**ï¼šé€šè¿‡ Web UI æŸ¥çœ‹è¿æ¥ã€é˜Ÿåˆ—ã€ååé‡ç­‰æŒ‡æ ‡ã€‚\n- **å‘½ä»¤è¡Œå·¥å…·**ï¼š`rabbitmqctl list_queues`ã€‚\n- **Prometheus + Grafana**ï¼šé›†æˆç›‘æ§å‘Šè­¦ã€‚\n\n---\n\n## **å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶**\n### 14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\n**ç­”æ¡ˆ**ï¼š  \n| **ç»´åº¦**       | **RabbitMQ**                     | **Kafka**                     |  \n|----------------|----------------------------------|-------------------------------|  \n| è®¾è®¡ç›®æ ‡       | æ¶ˆæ¯å¯é ä¼ è¾“ä¸å¤æ‚è·¯ç”±           | é«˜ååé‡æ—¥å¿—æµå¤„ç†            |  \n| æ¶ˆæ¯ä¿ç•™       | æ¶ˆè´¹ååˆ é™¤                       | æŒ‰æ—¶é—´æˆ–å¤§å°ä¿ç•™              |  \n| ååé‡         | ä¸‡çº§ QPS                        | ç™¾ä¸‡çº§ QPS                    |  \n| é€‚ç”¨åœºæ™¯       | ä¸šåŠ¡è§£è€¦ã€å»¶è¿Ÿæ¶ˆæ¯               | æ—¥å¿—æ”¶é›†ã€å®æ—¶æµå¤„ç†          |\n\n---\n\n## **æ–‡æ¡£è¯´æ˜**\næœ¬æ–‡æ¡£æ¶µç›– RabbitMQ çš„æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œæœºåˆ¶åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼Œé€‚ç”¨äºé¢è¯•å‡†å¤‡æˆ–æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å‚è€ƒã€‚  \n**æŒç»­æ›´æ–°å»ºè®®**ï¼šç»“åˆ RabbitMQ å®˜æ–¹æ–‡æ¡£ï¼ˆhttps://www.rabbitmq.comï¼‰å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹ã€‚\n\nPS: è¯¥å†…å®¹æœ‰DeepSeek R1æ·±åº¦å­¦ä¹ æ€»ç»“ï¼ˆdeepseekç‰›é€¼ï¼ï¼ï¼ï¼‰\n","slug":"RabbitMQå¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£","published":1,"updated":"2025-02-07T06:18:26.429Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dm000mwen128ni1zpo","content":"<h1 id=\"RabbitMQ-å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\"><a href=\"#RabbitMQ-å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\" class=\"headerlink\" title=\"RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\"></a>RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£</h1><hr>\n<h2 id=\"ä¸€ã€åŸºç¡€æ¦‚å¿µ\"><a href=\"#ä¸€ã€åŸºç¡€æ¦‚å¿µ\" class=\"headerlink\" title=\"ä¸€ã€åŸºç¡€æ¦‚å¿µ\"></a><strong>ä¸€ã€åŸºç¡€æ¦‚å¿µ</strong></h2><h3 id=\"1-ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage-Queueï¼‰ï¼ŸRabbitMQ-çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#1-ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage-Queueï¼‰ï¼ŸRabbitMQ-çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§<strong>å¼‚æ­¥é€šä¿¡æœºåˆ¶</strong>ï¼Œç”¨äºè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ç°ç³»ç»Ÿé—´å¯é çš„æ¶ˆæ¯ä¼ é€’ã€‚<br>RabbitMQ çš„æ ¸å¿ƒä½œç”¨åŒ…æ‹¬ï¼š</p>\n<ul>\n<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œååé‡ã€‚</li>\n<li><strong>åº”ç”¨è§£è€¦</strong>ï¼šé€šè¿‡ä¸­é—´ä»¶éš”ç¦»æœåŠ¡é—´çš„ç›´æ¥ä¾èµ–ã€‚</li>\n<li><strong>æµé‡å‰Šå³°</strong>ï¼šç¼“å†²çªå‘æµé‡ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½ã€‚</li>\n<li><strong>æ¶ˆæ¯å¹¿æ’­</strong>ï¼šæ”¯æŒä¸€å¯¹å¤šæ¶ˆæ¯åˆ†å‘æ¨¡å¼ã€‚</li>\n</ul>\n<h3 id=\"2-AMQP-åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ-å¦‚ä½•åŸºäº-AMQP-å·¥ä½œï¼Ÿ\"><a href=\"#2-AMQP-åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ-å¦‚ä½•åŸºäº-AMQP-å·¥ä½œï¼Ÿ\" class=\"headerlink\" title=\"2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ\"></a>2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰æ˜¯<strong>åº”ç”¨å±‚åè®®</strong>ï¼Œå®šä¹‰äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„ç»Ÿä¸€é€šä¿¡æ ‡å‡†ã€‚<br>RabbitMQ åŸºäº AMQP æ¨¡å‹ï¼š</p>\n<ul>\n<li><strong>ç”Ÿäº§è€…</strong>ï¼ˆProducerï¼‰å‘é€æ¶ˆæ¯åˆ° Exchangeã€‚</li>\n<li><strong>Exchange</strong> æ ¹æ®è·¯ç”±è§„åˆ™ï¼ˆBinding Keyï¼‰å°†æ¶ˆæ¯åˆ†å‘åˆ° Queueã€‚</li>\n<li><strong>æ¶ˆè´¹è€…</strong>ï¼ˆConsumerï¼‰ä» Queue ä¸­è·å–æ¶ˆæ¯ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"äºŒã€æ ¸å¿ƒç»„ä»¶\"><a href=\"#äºŒã€æ ¸å¿ƒç»„ä»¶\" class=\"headerlink\" title=\"äºŒã€æ ¸å¿ƒç»„ä»¶\"></a><strong>äºŒã€æ ¸å¿ƒç»„ä»¶</strong></h2><h3 id=\"3-RabbitMQ-çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#3-RabbitMQ-çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\"></a>3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>Exchange</strong>ï¼šæ¶ˆæ¯è·¯ç”±ä¸­å¿ƒï¼Œå†³å®šæ¶ˆæ¯å¦‚ä½•åˆ†å‘åˆ°é˜Ÿåˆ—ã€‚</li>\n<li><strong>Queue</strong>ï¼šå­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ä¸­è®¢é˜…æ¶ˆæ¯ã€‚</li>\n<li><strong>Binding</strong>ï¼šå®šä¹‰ Exchange å’Œ Queue ä¹‹é—´çš„æ˜ å°„è§„åˆ™ã€‚</li>\n<li><strong>Channel</strong>ï¼šå¤ç”¨ TCP è¿æ¥çš„è½»é‡çº§é€šä¿¡é€šé“ã€‚</li>\n<li><strong>Virtual Host</strong>ï¼šé€»è¾‘éš”ç¦»å•å…ƒï¼Œç±»ä¼¼å‘½åç©ºé—´ã€‚</li>\n</ul>\n<h3 id=\"4-Exchange-çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\"><a href=\"#4-Exchange-çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\"></a>4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š  </p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>è·¯ç”±è§„åˆ™</th>\n<th>å…¸å‹åœºæ™¯</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>Direct</strong></td>\n<td>ç²¾ç¡®åŒ¹é… Routing Key</td>\n<td>ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆå¦‚è®¢å•å¤„ç†ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Topic</strong></td>\n<td>é€šé…ç¬¦åŒ¹é… Routing Keyï¼ˆ* å’Œ #ï¼‰</td>\n<td>åˆ†ç±»æ¶ˆæ¯å¹¿æ’­ï¼ˆå¦‚æ—¥å¿—åˆ†ç±»ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Fanout</strong></td>\n<td>å¿½ç•¥ Routing Keyï¼Œå¹¿æ’­åˆ°æ‰€æœ‰é˜Ÿåˆ—</td>\n<td>å…¨å±€é€šçŸ¥ï¼ˆå¦‚ç³»ç»Ÿé…ç½®æ›´æ–°ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Headers</strong></td>\n<td>åŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…</td>\n<td>å¤æ‚è·¯ç”±é€»è¾‘ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\"><a href=\"#ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\" class=\"headerlink\" title=\"ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\"></a><strong>ä¸‰ã€æ¶ˆæ¯æœºåˆ¶</strong></h2><h3 id=\"5-RabbitMQ-å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\"><a href=\"#5-RabbitMQ-å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\" class=\"headerlink\" title=\"5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\"></a>5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>ç”Ÿäº§è€…ç¡®è®¤æ¨¡å¼</strong>ï¼ˆPublisher Confirmï¼‰ï¼šç¡®ä¿æ¶ˆæ¯åˆ°è¾¾ Brokerã€‚</li>\n<li><strong>æ¶ˆæ¯æŒä¹…åŒ–</strong>ï¼šExchangeã€Queue å’Œæ¶ˆæ¯å‡è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼ˆ<code>durable=true</code>ï¼‰ã€‚</li>\n<li><strong>æ¶ˆè´¹è€…æ‰‹åŠ¨åº”ç­”</strong>ï¼ˆManual Acknowledgementï¼‰ï¼šæ¶ˆæ¯å¤„ç†å®Œæˆåå‘é€ ACKã€‚</li>\n</ul>\n<h3 id=\"6-ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead-Letter-Queue-DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\"><a href=\"#6-ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead-Letter-Queue-DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\" class=\"headerlink\" title=\"6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\"></a>6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>æ­»ä¿¡é˜Ÿåˆ—ç”¨äºå­˜å‚¨æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚è§¦å‘æ¡ä»¶ï¼š</p>\n<ol>\n<li>æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»ï¼ˆ<code>basic.reject</code> æˆ– <code>basic.nack</code>ï¼‰ä¸”ä¸é‡æ–°å…¥é˜Ÿã€‚</li>\n<li>æ¶ˆæ¯ TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰è¿‡æœŸã€‚</li>\n<li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦é™åˆ¶ã€‚</li>\n</ol>\n<hr>\n<h2 id=\"å››ã€é«˜çº§ç‰¹æ€§\"><a href=\"#å››ã€é«˜çº§ç‰¹æ€§\" class=\"headerlink\" title=\"å››ã€é«˜çº§ç‰¹æ€§\"></a><strong>å››ã€é«˜çº§ç‰¹æ€§</strong></h2><h3 id=\"7-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\"><a href=\"#7-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\" class=\"headerlink\" title=\"7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\"></a>7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>RabbitMQ åŸç”Ÿä¸æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š</p>\n<ol>\n<li><strong>æ¶ˆæ¯ TTL + æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼šè®¾ç½®æ¶ˆæ¯çš„ TTLï¼Œè¿‡æœŸåè½¬å‘åˆ° DLQã€‚</li>\n<li><strong>æ’ä»¶</strong>ï¼ˆå¦‚ <code>rabbitmq-delayed-message-exchange</code>ï¼‰ï¼šä½¿ç”¨å»¶è¿Ÿäº¤æ¢æœºã€‚</li>\n</ol>\n<h3 id=\"8-å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\"><a href=\"#8-å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\" class=\"headerlink\" title=\"8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\"></a>8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å¹‚ç­‰æ€§è®¾è®¡</strong>ï¼šä¸šåŠ¡é€»è¾‘å¤©ç„¶æ”¯æŒé‡å¤å¤„ç†ï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€çº¦æŸï¼‰ã€‚</li>\n<li><strong>å»é‡è¡¨</strong>ï¼šè®°å½•å·²å¤„ç†æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ¶ˆæ¯ IDï¼‰ã€‚</li>\n<li><strong>Redis åˆ†å¸ƒå¼é”</strong>ï¼šåœ¨æ¶ˆè´¹å‰åŠ é”ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"äº”ã€å¯é æ€§ä¸æ€§èƒ½\"><a href=\"#äº”ã€å¯é æ€§ä¸æ€§èƒ½\" class=\"headerlink\" title=\"äº”ã€å¯é æ€§ä¸æ€§èƒ½\"></a><strong>äº”ã€å¯é æ€§ä¸æ€§èƒ½</strong></h2><h3 id=\"9-RabbitMQ-çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#9-RabbitMQ-çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\"></a>9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>æ™®é€šé›†ç¾¤</strong>ï¼šé˜Ÿåˆ—å…ƒæ•°æ®åŒæ­¥ï¼Œä½†æ¶ˆæ¯å­˜å‚¨åœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆæ— é«˜å¯ç”¨ï¼‰ã€‚</li>\n<li><strong>é•œåƒé˜Ÿåˆ—</strong>ï¼ˆMirrored Queuesï¼‰ï¼šé˜Ÿåˆ—æ•°æ®è·¨èŠ‚ç‚¹å¤åˆ¶ï¼Œå®ç°é«˜å¯ç”¨ã€‚</li>\n</ul>\n<h3 id=\"10-å¦‚ä½•æå‡-RabbitMQ-çš„ååé‡ï¼Ÿ\"><a href=\"#10-å¦‚ä½•æå‡-RabbitMQ-çš„ååé‡ï¼Ÿ\" class=\"headerlink\" title=\"10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ\"></a>10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>æ‰¹é‡å‘é€</strong>ï¼ˆBatch Publishï¼‰ã€‚</li>\n<li><strong>å¤šçº¿ç¨‹ Channel</strong>ï¼ˆé¿å…å• Channel é˜»å¡ï¼‰ã€‚</li>\n<li><strong>ä¼˜åŒ– ACK æœºåˆ¶</strong>ï¼šæ‰¹é‡ç¡®è®¤æˆ–å¼‚æ­¥ç¡®è®¤ã€‚</li>\n<li><strong>è°ƒæ•´é¢„å–æ•°é‡</strong>ï¼ˆprefetchCountï¼‰æå‡æ¶ˆè´¹è€…å¹¶å‘èƒ½åŠ›ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"å…­ã€å®æˆ˜åœºæ™¯\"><a href=\"#å…­ã€å®æˆ˜åœºæ™¯\" class=\"headerlink\" title=\"å…­ã€å®æˆ˜åœºæ™¯\"></a><strong>å…­ã€å®æˆ˜åœºæ™¯</strong></h2><h3 id=\"11-å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\"><a href=\"#11-å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\" class=\"headerlink\" title=\"11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\"></a>11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å•é˜Ÿåˆ—å•æ¶ˆè´¹è€…</strong>ï¼šç‰ºç‰²å¹¶å‘æ€§ä¿è¯é¡ºåºã€‚</li>\n<li><strong>æ¶ˆæ¯åˆ†ç»„</strong>ï¼šé€šè¿‡ Routing Key å°†éœ€è¦é¡ºåºçš„æ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ã€‚</li>\n</ul>\n<h3 id=\"12-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨-RabbitMQ-åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\"><a href=\"#12-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨-RabbitMQ-åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\" class=\"headerlink\" title=\"12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\"></a>12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å‰Šå³°å¡«è°·</strong>ï¼šå°†è¯·æ±‚å†™å…¥é˜Ÿåˆ—ï¼Œåç«¯æœåŠ¡æŒ‰å¤„ç†èƒ½åŠ›æ¶ˆè´¹ã€‚</li>\n<li><strong>é˜Ÿåˆ—å®¹é‡é™åˆ¶</strong>ï¼šé¿å…å†…å­˜æº¢å‡ºã€‚</li>\n<li><strong>å¿«é€Ÿå¤±è´¥æœºåˆ¶</strong>ï¼šé˜Ÿåˆ—æ»¡æ—¶ç›´æ¥æ‹’ç»æ–°è¯·æ±‚ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\"><a href=\"#ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\" class=\"headerlink\" title=\"ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\"></a><strong>ä¸ƒã€ç›‘æ§ä¸ç®¡ç†</strong></h2><h3 id=\"13-å¦‚ä½•ç›‘æ§-RabbitMQ-çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\"><a href=\"#13-å¦‚ä½•ç›‘æ§-RabbitMQ-çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\" class=\"headerlink\" title=\"13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\"></a>13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>ç®¡ç†ç•Œé¢</strong>ï¼šé€šè¿‡ Web UI æŸ¥çœ‹è¿æ¥ã€é˜Ÿåˆ—ã€ååé‡ç­‰æŒ‡æ ‡ã€‚</li>\n<li><strong>å‘½ä»¤è¡Œå·¥å…·</strong>ï¼š<code>rabbitmqctl list_queues</code>ã€‚</li>\n<li><strong>Prometheus + Grafana</strong>ï¼šé›†æˆç›‘æ§å‘Šè­¦ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\"><a href=\"#å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\" class=\"headerlink\" title=\"å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\"></a><strong>å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶</strong></h2><h3 id=\"14-RabbitMQ-ä¸-Kafka-çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#14-RabbitMQ-ä¸-Kafka-çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š  </p>\n<table>\n<thead>\n<tr>\n<th><strong>ç»´åº¦</strong></th>\n<th><strong>RabbitMQ</strong></th>\n<th><strong>Kafka</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è®¾è®¡ç›®æ ‡</td>\n<td>æ¶ˆæ¯å¯é ä¼ è¾“ä¸å¤æ‚è·¯ç”±</td>\n<td>é«˜ååé‡æ—¥å¿—æµå¤„ç†</td>\n</tr>\n<tr>\n<td>æ¶ˆæ¯ä¿ç•™</td>\n<td>æ¶ˆè´¹ååˆ é™¤</td>\n<td>æŒ‰æ—¶é—´æˆ–å¤§å°ä¿ç•™</td>\n</tr>\n<tr>\n<td>ååé‡</td>\n<td>ä¸‡çº§ QPS</td>\n<td>ç™¾ä¸‡çº§ QPS</td>\n</tr>\n<tr>\n<td>é€‚ç”¨åœºæ™¯</td>\n<td>ä¸šåŠ¡è§£è€¦ã€å»¶è¿Ÿæ¶ˆæ¯</td>\n<td>æ—¥å¿—æ”¶é›†ã€å®æ—¶æµå¤„ç†</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"æ–‡æ¡£è¯´æ˜\"><a href=\"#æ–‡æ¡£è¯´æ˜\" class=\"headerlink\" title=\"æ–‡æ¡£è¯´æ˜\"></a><strong>æ–‡æ¡£è¯´æ˜</strong></h2><p>æœ¬æ–‡æ¡£æ¶µç›– RabbitMQ çš„æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œæœºåˆ¶åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼Œé€‚ç”¨äºé¢è¯•å‡†å¤‡æˆ–æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å‚è€ƒã€‚<br><strong>æŒç»­æ›´æ–°å»ºè®®</strong>ï¼šç»“åˆ RabbitMQ å®˜æ–¹æ–‡æ¡£ï¼ˆ<a href=\"https://www.rabbitmq.com)å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹./\">https://www.rabbitmq.comï¼‰å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹ã€‚</a></p>\n<p>PS: è¯¥å†…å®¹æœ‰DeepSeek R1æ·±åº¦å­¦ä¹ æ€»ç»“ï¼ˆdeepseekç‰›é€¼ï¼ï¼ï¼ï¼‰</p>\n","excerpt":"","more":"<h1 id=\"RabbitMQ-å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\"><a href=\"#RabbitMQ-å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\" class=\"headerlink\" title=\"RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£\"></a>RabbitMQ å¸¸è§é¢è¯•é¢˜æŠ€æœ¯æ–‡æ¡£</h1><hr>\n<h2 id=\"ä¸€ã€åŸºç¡€æ¦‚å¿µ\"><a href=\"#ä¸€ã€åŸºç¡€æ¦‚å¿µ\" class=\"headerlink\" title=\"ä¸€ã€åŸºç¡€æ¦‚å¿µ\"></a><strong>ä¸€ã€åŸºç¡€æ¦‚å¿µ</strong></h2><h3 id=\"1-ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage-Queueï¼‰ï¼ŸRabbitMQ-çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#1-ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage-Queueï¼‰ï¼ŸRabbitMQ-çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼ŸRabbitMQ çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§<strong>å¼‚æ­¥é€šä¿¡æœºåˆ¶</strong>ï¼Œç”¨äºè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ç°ç³»ç»Ÿé—´å¯é çš„æ¶ˆæ¯ä¼ é€’ã€‚<br>RabbitMQ çš„æ ¸å¿ƒä½œç”¨åŒ…æ‹¬ï¼š</p>\n<ul>\n<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œååé‡ã€‚</li>\n<li><strong>åº”ç”¨è§£è€¦</strong>ï¼šé€šè¿‡ä¸­é—´ä»¶éš”ç¦»æœåŠ¡é—´çš„ç›´æ¥ä¾èµ–ã€‚</li>\n<li><strong>æµé‡å‰Šå³°</strong>ï¼šç¼“å†²çªå‘æµé‡ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½ã€‚</li>\n<li><strong>æ¶ˆæ¯å¹¿æ’­</strong>ï¼šæ”¯æŒä¸€å¯¹å¤šæ¶ˆæ¯åˆ†å‘æ¨¡å¼ã€‚</li>\n</ul>\n<h3 id=\"2-AMQP-åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ-å¦‚ä½•åŸºäº-AMQP-å·¥ä½œï¼Ÿ\"><a href=\"#2-AMQP-åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ-å¦‚ä½•åŸºäº-AMQP-å·¥ä½œï¼Ÿ\" class=\"headerlink\" title=\"2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ\"></a>2. AMQP åè®®æ˜¯ä»€ä¹ˆï¼ŸRabbitMQ å¦‚ä½•åŸºäº AMQP å·¥ä½œï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰æ˜¯<strong>åº”ç”¨å±‚åè®®</strong>ï¼Œå®šä¹‰äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„ç»Ÿä¸€é€šä¿¡æ ‡å‡†ã€‚<br>RabbitMQ åŸºäº AMQP æ¨¡å‹ï¼š</p>\n<ul>\n<li><strong>ç”Ÿäº§è€…</strong>ï¼ˆProducerï¼‰å‘é€æ¶ˆæ¯åˆ° Exchangeã€‚</li>\n<li><strong>Exchange</strong> æ ¹æ®è·¯ç”±è§„åˆ™ï¼ˆBinding Keyï¼‰å°†æ¶ˆæ¯åˆ†å‘åˆ° Queueã€‚</li>\n<li><strong>æ¶ˆè´¹è€…</strong>ï¼ˆConsumerï¼‰ä» Queue ä¸­è·å–æ¶ˆæ¯ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"äºŒã€æ ¸å¿ƒç»„ä»¶\"><a href=\"#äºŒã€æ ¸å¿ƒç»„ä»¶\" class=\"headerlink\" title=\"äºŒã€æ ¸å¿ƒç»„ä»¶\"></a><strong>äºŒã€æ ¸å¿ƒç»„ä»¶</strong></h2><h3 id=\"3-RabbitMQ-çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#3-RabbitMQ-çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ\"></a>3. RabbitMQ çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>Exchange</strong>ï¼šæ¶ˆæ¯è·¯ç”±ä¸­å¿ƒï¼Œå†³å®šæ¶ˆæ¯å¦‚ä½•åˆ†å‘åˆ°é˜Ÿåˆ—ã€‚</li>\n<li><strong>Queue</strong>ï¼šå­˜å‚¨æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…ä»ä¸­è®¢é˜…æ¶ˆæ¯ã€‚</li>\n<li><strong>Binding</strong>ï¼šå®šä¹‰ Exchange å’Œ Queue ä¹‹é—´çš„æ˜ å°„è§„åˆ™ã€‚</li>\n<li><strong>Channel</strong>ï¼šå¤ç”¨ TCP è¿æ¥çš„è½»é‡çº§é€šä¿¡é€šé“ã€‚</li>\n<li><strong>Virtual Host</strong>ï¼šé€»è¾‘éš”ç¦»å•å…ƒï¼Œç±»ä¼¼å‘½åç©ºé—´ã€‚</li>\n</ul>\n<h3 id=\"4-Exchange-çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\"><a href=\"#4-Exchange-çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ\"></a>4. Exchange çš„å››ç§ç±»å‹åŠå…¶åŒºåˆ«ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š  </p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>è·¯ç”±è§„åˆ™</th>\n<th>å…¸å‹åœºæ™¯</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><strong>Direct</strong></td>\n<td>ç²¾ç¡®åŒ¹é… Routing Key</td>\n<td>ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆå¦‚è®¢å•å¤„ç†ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Topic</strong></td>\n<td>é€šé…ç¬¦åŒ¹é… Routing Keyï¼ˆ* å’Œ #ï¼‰</td>\n<td>åˆ†ç±»æ¶ˆæ¯å¹¿æ’­ï¼ˆå¦‚æ—¥å¿—åˆ†ç±»ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Fanout</strong></td>\n<td>å¿½ç•¥ Routing Keyï¼Œå¹¿æ’­åˆ°æ‰€æœ‰é˜Ÿåˆ—</td>\n<td>å…¨å±€é€šçŸ¥ï¼ˆå¦‚ç³»ç»Ÿé…ç½®æ›´æ–°ï¼‰</td>\n</tr>\n<tr>\n<td><strong>Headers</strong></td>\n<td>åŸºäºæ¶ˆæ¯å¤´é”®å€¼å¯¹åŒ¹é…</td>\n<td>å¤æ‚è·¯ç”±é€»è¾‘ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\"><a href=\"#ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\" class=\"headerlink\" title=\"ä¸‰ã€æ¶ˆæ¯æœºåˆ¶\"></a><strong>ä¸‰ã€æ¶ˆæ¯æœºåˆ¶</strong></h2><h3 id=\"5-RabbitMQ-å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\"><a href=\"#5-RabbitMQ-å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\" class=\"headerlink\" title=\"5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ\"></a>5. RabbitMQ å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>ç”Ÿäº§è€…ç¡®è®¤æ¨¡å¼</strong>ï¼ˆPublisher Confirmï¼‰ï¼šç¡®ä¿æ¶ˆæ¯åˆ°è¾¾ Brokerã€‚</li>\n<li><strong>æ¶ˆæ¯æŒä¹…åŒ–</strong>ï¼šExchangeã€Queue å’Œæ¶ˆæ¯å‡è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼ˆ<code>durable=true</code>ï¼‰ã€‚</li>\n<li><strong>æ¶ˆè´¹è€…æ‰‹åŠ¨åº”ç­”</strong>ï¼ˆManual Acknowledgementï¼‰ï¼šæ¶ˆæ¯å¤„ç†å®Œæˆåå‘é€ ACKã€‚</li>\n</ul>\n<h3 id=\"6-ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead-Letter-Queue-DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\"><a href=\"#6-ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead-Letter-Queue-DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\" class=\"headerlink\" title=\"6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ\"></a>6. ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queue, DLQï¼‰ï¼Ÿå¦‚ä½•è§¦å‘ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>æ­»ä¿¡é˜Ÿåˆ—ç”¨äºå­˜å‚¨æ— æ³•è¢«æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚è§¦å‘æ¡ä»¶ï¼š</p>\n<ol>\n<li>æ¶ˆæ¯è¢«æ¶ˆè´¹è€…æ‹’ç»ï¼ˆ<code>basic.reject</code> æˆ– <code>basic.nack</code>ï¼‰ä¸”ä¸é‡æ–°å…¥é˜Ÿã€‚</li>\n<li>æ¶ˆæ¯ TTLï¼ˆå­˜æ´»æ—¶é—´ï¼‰è¿‡æœŸã€‚</li>\n<li>é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦é™åˆ¶ã€‚</li>\n</ol>\n<hr>\n<h2 id=\"å››ã€é«˜çº§ç‰¹æ€§\"><a href=\"#å››ã€é«˜çº§ç‰¹æ€§\" class=\"headerlink\" title=\"å››ã€é«˜çº§ç‰¹æ€§\"></a><strong>å››ã€é«˜çº§ç‰¹æ€§</strong></h2><h3 id=\"7-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\"><a href=\"#7-å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\" class=\"headerlink\" title=\"7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ\"></a>7. å¦‚ä½•å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š<br>RabbitMQ åŸç”Ÿä¸æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œä½†å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š</p>\n<ol>\n<li><strong>æ¶ˆæ¯ TTL + æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼šè®¾ç½®æ¶ˆæ¯çš„ TTLï¼Œè¿‡æœŸåè½¬å‘åˆ° DLQã€‚</li>\n<li><strong>æ’ä»¶</strong>ï¼ˆå¦‚ <code>rabbitmq-delayed-message-exchange</code>ï¼‰ï¼šä½¿ç”¨å»¶è¿Ÿäº¤æ¢æœºã€‚</li>\n</ol>\n<h3 id=\"8-å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\"><a href=\"#8-å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\" class=\"headerlink\" title=\"8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ\"></a>8. å¦‚ä½•é¿å…æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å¹‚ç­‰æ€§è®¾è®¡</strong>ï¼šä¸šåŠ¡é€»è¾‘å¤©ç„¶æ”¯æŒé‡å¤å¤„ç†ï¼ˆå¦‚æ•°æ®åº“å”¯ä¸€çº¦æŸï¼‰ã€‚</li>\n<li><strong>å»é‡è¡¨</strong>ï¼šè®°å½•å·²å¤„ç†æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ¶ˆæ¯ IDï¼‰ã€‚</li>\n<li><strong>Redis åˆ†å¸ƒå¼é”</strong>ï¼šåœ¨æ¶ˆè´¹å‰åŠ é”ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"äº”ã€å¯é æ€§ä¸æ€§èƒ½\"><a href=\"#äº”ã€å¯é æ€§ä¸æ€§èƒ½\" class=\"headerlink\" title=\"äº”ã€å¯é æ€§ä¸æ€§èƒ½\"></a><strong>äº”ã€å¯é æ€§ä¸æ€§èƒ½</strong></h2><h3 id=\"9-RabbitMQ-çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\"><a href=\"#9-RabbitMQ-çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\" class=\"headerlink\" title=\"9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ\"></a>9. RabbitMQ çš„é›†ç¾¤æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>æ™®é€šé›†ç¾¤</strong>ï¼šé˜Ÿåˆ—å…ƒæ•°æ®åŒæ­¥ï¼Œä½†æ¶ˆæ¯å­˜å‚¨åœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆæ— é«˜å¯ç”¨ï¼‰ã€‚</li>\n<li><strong>é•œåƒé˜Ÿåˆ—</strong>ï¼ˆMirrored Queuesï¼‰ï¼šé˜Ÿåˆ—æ•°æ®è·¨èŠ‚ç‚¹å¤åˆ¶ï¼Œå®ç°é«˜å¯ç”¨ã€‚</li>\n</ul>\n<h3 id=\"10-å¦‚ä½•æå‡-RabbitMQ-çš„ååé‡ï¼Ÿ\"><a href=\"#10-å¦‚ä½•æå‡-RabbitMQ-çš„ååé‡ï¼Ÿ\" class=\"headerlink\" title=\"10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ\"></a>10. å¦‚ä½•æå‡ RabbitMQ çš„ååé‡ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>æ‰¹é‡å‘é€</strong>ï¼ˆBatch Publishï¼‰ã€‚</li>\n<li><strong>å¤šçº¿ç¨‹ Channel</strong>ï¼ˆé¿å…å• Channel é˜»å¡ï¼‰ã€‚</li>\n<li><strong>ä¼˜åŒ– ACK æœºåˆ¶</strong>ï¼šæ‰¹é‡ç¡®è®¤æˆ–å¼‚æ­¥ç¡®è®¤ã€‚</li>\n<li><strong>è°ƒæ•´é¢„å–æ•°é‡</strong>ï¼ˆprefetchCountï¼‰æå‡æ¶ˆè´¹è€…å¹¶å‘èƒ½åŠ›ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"å…­ã€å®æˆ˜åœºæ™¯\"><a href=\"#å…­ã€å®æˆ˜åœºæ™¯\" class=\"headerlink\" title=\"å…­ã€å®æˆ˜åœºæ™¯\"></a><strong>å…­ã€å®æˆ˜åœºæ™¯</strong></h2><h3 id=\"11-å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\"><a href=\"#11-å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\" class=\"headerlink\" title=\"11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ\"></a>11. å¦‚ä½•ä¿è¯æ¶ˆæ¯é¡ºåºæ€§ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å•é˜Ÿåˆ—å•æ¶ˆè´¹è€…</strong>ï¼šç‰ºç‰²å¹¶å‘æ€§ä¿è¯é¡ºåºã€‚</li>\n<li><strong>æ¶ˆæ¯åˆ†ç»„</strong>ï¼šé€šè¿‡ Routing Key å°†éœ€è¦é¡ºåºçš„æ¶ˆæ¯è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ã€‚</li>\n</ul>\n<h3 id=\"12-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨-RabbitMQ-åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\"><a href=\"#12-è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨-RabbitMQ-åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\" class=\"headerlink\" title=\"12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ\"></a>12. è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•ç”¨ RabbitMQ åº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>å‰Šå³°å¡«è°·</strong>ï¼šå°†è¯·æ±‚å†™å…¥é˜Ÿåˆ—ï¼Œåç«¯æœåŠ¡æŒ‰å¤„ç†èƒ½åŠ›æ¶ˆè´¹ã€‚</li>\n<li><strong>é˜Ÿåˆ—å®¹é‡é™åˆ¶</strong>ï¼šé¿å…å†…å­˜æº¢å‡ºã€‚</li>\n<li><strong>å¿«é€Ÿå¤±è´¥æœºåˆ¶</strong>ï¼šé˜Ÿåˆ—æ»¡æ—¶ç›´æ¥æ‹’ç»æ–°è¯·æ±‚ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\"><a href=\"#ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\" class=\"headerlink\" title=\"ä¸ƒã€ç›‘æ§ä¸ç®¡ç†\"></a><strong>ä¸ƒã€ç›‘æ§ä¸ç®¡ç†</strong></h2><h3 id=\"13-å¦‚ä½•ç›‘æ§-RabbitMQ-çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\"><a href=\"#13-å¦‚ä½•ç›‘æ§-RabbitMQ-çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\" class=\"headerlink\" title=\"13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ\"></a>13. å¦‚ä½•ç›‘æ§ RabbitMQ çš„è¿è¡ŒçŠ¶æ€ï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š</p>\n<ul>\n<li><strong>ç®¡ç†ç•Œé¢</strong>ï¼šé€šè¿‡ Web UI æŸ¥çœ‹è¿æ¥ã€é˜Ÿåˆ—ã€ååé‡ç­‰æŒ‡æ ‡ã€‚</li>\n<li><strong>å‘½ä»¤è¡Œå·¥å…·</strong>ï¼š<code>rabbitmqctl list_queues</code>ã€‚</li>\n<li><strong>Prometheus + Grafana</strong>ï¼šé›†æˆç›‘æ§å‘Šè­¦ã€‚</li>\n</ul>\n<hr>\n<h2 id=\"å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\"><a href=\"#å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\" class=\"headerlink\" title=\"å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶\"></a><strong>å…«ã€å¯¹æ¯”ä¸å…¶ä»–ä¸­é—´ä»¶</strong></h2><h3 id=\"14-RabbitMQ-ä¸-Kafka-çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#14-RabbitMQ-ä¸-Kafka-çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>14. RabbitMQ ä¸ Kafka çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ç­”æ¡ˆ</strong>ï¼š  </p>\n<table>\n<thead>\n<tr>\n<th><strong>ç»´åº¦</strong></th>\n<th><strong>RabbitMQ</strong></th>\n<th><strong>Kafka</strong></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è®¾è®¡ç›®æ ‡</td>\n<td>æ¶ˆæ¯å¯é ä¼ è¾“ä¸å¤æ‚è·¯ç”±</td>\n<td>é«˜ååé‡æ—¥å¿—æµå¤„ç†</td>\n</tr>\n<tr>\n<td>æ¶ˆæ¯ä¿ç•™</td>\n<td>æ¶ˆè´¹ååˆ é™¤</td>\n<td>æŒ‰æ—¶é—´æˆ–å¤§å°ä¿ç•™</td>\n</tr>\n<tr>\n<td>ååé‡</td>\n<td>ä¸‡çº§ QPS</td>\n<td>ç™¾ä¸‡çº§ QPS</td>\n</tr>\n<tr>\n<td>é€‚ç”¨åœºæ™¯</td>\n<td>ä¸šåŠ¡è§£è€¦ã€å»¶è¿Ÿæ¶ˆæ¯</td>\n<td>æ—¥å¿—æ”¶é›†ã€å®æ—¶æµå¤„ç†</td>\n</tr>\n</tbody></table>\n<hr>\n<h2 id=\"æ–‡æ¡£è¯´æ˜\"><a href=\"#æ–‡æ¡£è¯´æ˜\" class=\"headerlink\" title=\"æ–‡æ¡£è¯´æ˜\"></a><strong>æ–‡æ¡£è¯´æ˜</strong></h2><p>æœ¬æ–‡æ¡£æ¶µç›– RabbitMQ çš„æ ¸å¿ƒæ¦‚å¿µã€å·¥ä½œæœºåˆ¶åŠå…¸å‹åº”ç”¨åœºæ™¯ï¼Œé€‚ç”¨äºé¢è¯•å‡†å¤‡æˆ–æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å‚è€ƒã€‚<br><strong>æŒç»­æ›´æ–°å»ºè®®</strong>ï¼šç»“åˆ RabbitMQ å®˜æ–¹æ–‡æ¡£ï¼ˆ<a href=\"https://www.rabbitmq.com)å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹./\">https://www.rabbitmq.comï¼‰å’Œå®é™…é¡¹ç›®ç»éªŒè¡¥å……æ¡ˆä¾‹ã€‚</a></p>\n<p>PS: è¯¥å†…å®¹æœ‰DeepSeek R1æ·±åº¦å­¦ä¹ æ€»ç»“ï¼ˆdeepseekç‰›é€¼ï¼ï¼ï¼ï¼‰</p>\n"},{"title":"Shiroæ•´åˆRedis:ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘","date":"2022-06-01T01:36:13.000Z","_content":"\nã€€ã€€ä¸€ç›´æƒ³åœ¨shiroæƒé™è¿™å—åŠ å…¥ç¼“å­˜ï¼Œä½¿ç”¨redisæ˜¯å†åˆé€‚ä¸è¿‡äº†ï¼Œæ°å·§å·²ç»æœ‰å¤§ä½¬å°†shiroå’Œredisæ•´åˆåœ¨ä¸€èµ·ä½¿ç”¨äº†ï¼Œåªéœ€åœ¨å¼•å…¥pomæ–‡ä»¶ä¸­å¼•å…¥å³å¯ã€‚\n\n```xml\n<dependency>\n      <groupId>org.crazycake</groupId>\n      <artifactId>shiro-redis</artifactId>\n      <version>3.2.3</version>\n</dependency>\n```\nä½†æ˜¯æ˜¯ä½¿ç”¨çš„æ—¶å€™ï¼Œæƒé™é…ç½®è¿™å—ï¼Œä¹Ÿå°±æ˜¯é‡å†™shiroçš„doGetAuthorizationInfoæ–¹æ³•è¿™é‡Œï¼Œä¸€ç›´è¿›ä¸æ¥ï¼Œå®Œæ•´çš„æ§åˆ¶å°å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```xml\norg.crazycake.shiro.exception.PrincipalInstanceException: class com.company.project.manage.entity.UserInfo must has getter for field: id\nWe need a field to identify this Cache Object in Redis. So you need to defined an id field which you can get unique id to identify this principal. For example, if you use UserInfo as Principal class, the id field maybe userId, userName, email, etc. For example, getUserId(), getUserName(), getEmail(), etc.\nDefault value is \"id\", that means your principal object has a method called \"getId()\"\n```\nå¤§æ¦‚æ„æ€å°±æ˜¯UserInfoå¯¹è±¡ä¸­å¿…é¡»è¦æœ‰idå±æ€§ï¼Œå¹¶ä¸”è¦æœ‰å¯¹åº”çš„getæ–¹æ³•ã€‚åœ¨èº«ä»½éªŒè¯çš„æ—¶å€™å°±å·²ç»å°†userinfoä¿¡æ¯ä¼ é€’ç»™äº†shiroï¼Œç„¶åredisåšç¼“å­˜çš„æ—¶å€™éœ€è¦keyï¼Œkeyçš„å€¼å°±ä¸userinfoé‡Œé¢çš„idå€¼æœ‰å…³ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/5d634f7823c441ee80b9356c5024cce4.png)\nç‚¹å¼€UserInfoå¯¹è±¡ä¸€çœ‹ï¼Œå°´äº†ä¸ªå°¬ï¼Œä¸»é”®çš„å‘½åä½¿ç”¨çš„æ˜¯uid\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/256e8900fd2c9cc5dfbb6629910f5775.png)\næœ€åæŠŠä¸»é”®æ¢æˆidï¼Œå°±è¿è¡Œæ­£å¸¸äº†ã€‚\n\næ¼”ç¤ºé¡¹ç›®åœ¨æˆ‘çš„githubä¸Šé¢ï¼Œshiro-redisæ’ä»¶çš„æ•´åˆå¯ä»¥æŸ¥çœ‹ï¼š\n[https://mrbird.cc/Spring-Boot-Shiro%20cache.html](https://mrbird.cc/Spring-Boot-Shiro%20cache.html)","source":"_posts/Shiroæ•´åˆRedis-ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘.md","raw":"---\ntitle: Shiroæ•´åˆRedis:ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘\ndate: 2022-06-01 09:36:13\ntags:\n---\n\nã€€ã€€ä¸€ç›´æƒ³åœ¨shiroæƒé™è¿™å—åŠ å…¥ç¼“å­˜ï¼Œä½¿ç”¨redisæ˜¯å†åˆé€‚ä¸è¿‡äº†ï¼Œæ°å·§å·²ç»æœ‰å¤§ä½¬å°†shiroå’Œredisæ•´åˆåœ¨ä¸€èµ·ä½¿ç”¨äº†ï¼Œåªéœ€åœ¨å¼•å…¥pomæ–‡ä»¶ä¸­å¼•å…¥å³å¯ã€‚\n\n```xml\n<dependency>\n      <groupId>org.crazycake</groupId>\n      <artifactId>shiro-redis</artifactId>\n      <version>3.2.3</version>\n</dependency>\n```\nä½†æ˜¯æ˜¯ä½¿ç”¨çš„æ—¶å€™ï¼Œæƒé™é…ç½®è¿™å—ï¼Œä¹Ÿå°±æ˜¯é‡å†™shiroçš„doGetAuthorizationInfoæ–¹æ³•è¿™é‡Œï¼Œä¸€ç›´è¿›ä¸æ¥ï¼Œå®Œæ•´çš„æ§åˆ¶å°å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```xml\norg.crazycake.shiro.exception.PrincipalInstanceException: class com.company.project.manage.entity.UserInfo must has getter for field: id\nWe need a field to identify this Cache Object in Redis. So you need to defined an id field which you can get unique id to identify this principal. For example, if you use UserInfo as Principal class, the id field maybe userId, userName, email, etc. For example, getUserId(), getUserName(), getEmail(), etc.\nDefault value is \"id\", that means your principal object has a method called \"getId()\"\n```\nå¤§æ¦‚æ„æ€å°±æ˜¯UserInfoå¯¹è±¡ä¸­å¿…é¡»è¦æœ‰idå±æ€§ï¼Œå¹¶ä¸”è¦æœ‰å¯¹åº”çš„getæ–¹æ³•ã€‚åœ¨èº«ä»½éªŒè¯çš„æ—¶å€™å°±å·²ç»å°†userinfoä¿¡æ¯ä¼ é€’ç»™äº†shiroï¼Œç„¶åredisåšç¼“å­˜çš„æ—¶å€™éœ€è¦keyï¼Œkeyçš„å€¼å°±ä¸userinfoé‡Œé¢çš„idå€¼æœ‰å…³ã€‚\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/5d634f7823c441ee80b9356c5024cce4.png)\nç‚¹å¼€UserInfoå¯¹è±¡ä¸€çœ‹ï¼Œå°´äº†ä¸ªå°¬ï¼Œä¸»é”®çš„å‘½åä½¿ç”¨çš„æ˜¯uid\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/256e8900fd2c9cc5dfbb6629910f5775.png)\næœ€åæŠŠä¸»é”®æ¢æˆidï¼Œå°±è¿è¡Œæ­£å¸¸äº†ã€‚\n\næ¼”ç¤ºé¡¹ç›®åœ¨æˆ‘çš„githubä¸Šé¢ï¼Œshiro-redisæ’ä»¶çš„æ•´åˆå¯ä»¥æŸ¥çœ‹ï¼š\n[https://mrbird.cc/Spring-Boot-Shiro%20cache.html](https://mrbird.cc/Spring-Boot-Shiro%20cache.html)","slug":"Shiroæ•´åˆRedis-ä½¿ç”¨shiro-redisæ’ä»¶è¸©çš„å‘","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dm000nwen12v313ll0","content":"<p>ã€€ã€€ä¸€ç›´æƒ³åœ¨shiroæƒé™è¿™å—åŠ å…¥ç¼“å­˜ï¼Œä½¿ç”¨redisæ˜¯å†åˆé€‚ä¸è¿‡äº†ï¼Œæ°å·§å·²ç»æœ‰å¤§ä½¬å°†shiroå’Œredisæ•´åˆåœ¨ä¸€èµ·ä½¿ç”¨äº†ï¼Œåªéœ€åœ¨å¼•å…¥pomæ–‡ä»¶ä¸­å¼•å…¥å³å¯ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.crazycake<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>shiro-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯æ˜¯ä½¿ç”¨çš„æ—¶å€™ï¼Œæƒé™é…ç½®è¿™å—ï¼Œä¹Ÿå°±æ˜¯é‡å†™shiroçš„doGetAuthorizationInfoæ–¹æ³•è¿™é‡Œï¼Œä¸€ç›´è¿›ä¸æ¥ï¼Œå®Œæ•´çš„æ§åˆ¶å°å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.crazycake.shiro.exception.PrincipalInstanceException: class com.company.project.manage.entity.UserInfo must has getter for field: id</span><br><span class=\"line\">We need a field to identify this Cache Object in Redis. So you need to defined an id field which you can get unique id to identify this principal. For example, if you use UserInfo as Principal class, the id field maybe userId, userName, email, etc. For example, getUserId(), getUserName(), getEmail(), etc.</span><br><span class=\"line\">Default value is &quot;id&quot;, that means your principal object has a method called &quot;getId()&quot;</span><br></pre></td></tr></table></figure>\n<p>å¤§æ¦‚æ„æ€å°±æ˜¯UserInfoå¯¹è±¡ä¸­å¿…é¡»è¦æœ‰idå±æ€§ï¼Œå¹¶ä¸”è¦æœ‰å¯¹åº”çš„getæ–¹æ³•ã€‚åœ¨èº«ä»½éªŒè¯çš„æ—¶å€™å°±å·²ç»å°†userinfoä¿¡æ¯ä¼ é€’ç»™äº†shiroï¼Œç„¶åredisåšç¼“å­˜çš„æ—¶å€™éœ€è¦keyï¼Œkeyçš„å€¼å°±ä¸userinfoé‡Œé¢çš„idå€¼æœ‰å…³ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/5d634f7823c441ee80b9356c5024cce4.png\" alt=\"image.png\"><br>ç‚¹å¼€UserInfoå¯¹è±¡ä¸€çœ‹ï¼Œå°´äº†ä¸ªå°¬ï¼Œä¸»é”®çš„å‘½åä½¿ç”¨çš„æ˜¯uid<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/256e8900fd2c9cc5dfbb6629910f5775.png\" alt=\"image.png\"><br>æœ€åæŠŠä¸»é”®æ¢æˆidï¼Œå°±è¿è¡Œæ­£å¸¸äº†ã€‚</p>\n<p>æ¼”ç¤ºé¡¹ç›®åœ¨æˆ‘çš„githubä¸Šé¢ï¼Œshiro-redisæ’ä»¶çš„æ•´åˆå¯ä»¥æŸ¥çœ‹ï¼š<br><a href=\"https://mrbird.cc/Spring-Boot-Shiro%20cache.html\">https://mrbird.cc/Spring-Boot-Shiro%20cache.html</a></p>\n","excerpt":"","more":"<p>ã€€ã€€ä¸€ç›´æƒ³åœ¨shiroæƒé™è¿™å—åŠ å…¥ç¼“å­˜ï¼Œä½¿ç”¨redisæ˜¯å†åˆé€‚ä¸è¿‡äº†ï¼Œæ°å·§å·²ç»æœ‰å¤§ä½¬å°†shiroå’Œredisæ•´åˆåœ¨ä¸€èµ·ä½¿ç”¨äº†ï¼Œåªéœ€åœ¨å¼•å…¥pomæ–‡ä»¶ä¸­å¼•å…¥å³å¯ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.crazycake<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>shiro-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯æ˜¯ä½¿ç”¨çš„æ—¶å€™ï¼Œæƒé™é…ç½®è¿™å—ï¼Œä¹Ÿå°±æ˜¯é‡å†™shiroçš„doGetAuthorizationInfoæ–¹æ³•è¿™é‡Œï¼Œä¸€ç›´è¿›ä¸æ¥ï¼Œå®Œæ•´çš„æ§åˆ¶å°å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.crazycake.shiro.exception.PrincipalInstanceException: class com.company.project.manage.entity.UserInfo must has getter for field: id</span><br><span class=\"line\">We need a field to identify this Cache Object in Redis. So you need to defined an id field which you can get unique id to identify this principal. For example, if you use UserInfo as Principal class, the id field maybe userId, userName, email, etc. For example, getUserId(), getUserName(), getEmail(), etc.</span><br><span class=\"line\">Default value is &quot;id&quot;, that means your principal object has a method called &quot;getId()&quot;</span><br></pre></td></tr></table></figure>\n<p>å¤§æ¦‚æ„æ€å°±æ˜¯UserInfoå¯¹è±¡ä¸­å¿…é¡»è¦æœ‰idå±æ€§ï¼Œå¹¶ä¸”è¦æœ‰å¯¹åº”çš„getæ–¹æ³•ã€‚åœ¨èº«ä»½éªŒè¯çš„æ—¶å€™å°±å·²ç»å°†userinfoä¿¡æ¯ä¼ é€’ç»™äº†shiroï¼Œç„¶åredisåšç¼“å­˜çš„æ—¶å€™éœ€è¦keyï¼Œkeyçš„å€¼å°±ä¸userinfoé‡Œé¢çš„idå€¼æœ‰å…³ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/5d634f7823c441ee80b9356c5024cce4.png\" alt=\"image.png\"><br>ç‚¹å¼€UserInfoå¯¹è±¡ä¸€çœ‹ï¼Œå°´äº†ä¸ªå°¬ï¼Œä¸»é”®çš„å‘½åä½¿ç”¨çš„æ˜¯uid<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/256e8900fd2c9cc5dfbb6629910f5775.png\" alt=\"image.png\"><br>æœ€åæŠŠä¸»é”®æ¢æˆidï¼Œå°±è¿è¡Œæ­£å¸¸äº†ã€‚</p>\n<p>æ¼”ç¤ºé¡¹ç›®åœ¨æˆ‘çš„githubä¸Šé¢ï¼Œshiro-redisæ’ä»¶çš„æ•´åˆå¯ä»¥æŸ¥çœ‹ï¼š<br><a href=\"https://mrbird.cc/Spring-Boot-Shiro%20cache.html\">https://mrbird.cc/Spring-Boot-Shiro%20cache.html</a></p>\n"},{"title":"SpringBoot+Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬)","date":"2022-06-01T01:39:56.000Z","_content":"\n## 1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\næ‰“å¼€pom.xmlæ–‡ä»¶ï¼Œä¿®æ”¹packagingæ–¹å¼ä¸ºjar\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1b2cb327efd7ff924aed08f1b823c4a4.png)\n\nç‚¹å‡»å³ä¾§mavenæ’ä»¶ -> package\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/13824b79027f796b472c606e9fd34358.png)\n\næ‰“åŒ…æˆåŠŸåä¼šåœ¨targetç›®å½•ä¸‹ç”ŸæˆjaråŒ…\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/56a039e0a216ddb1119aea33946b87e0.png)\n\n## 2.ç¼–å†™Dockerfileæ–‡ä»¶\n```sh\nFROM java:8\nVOLUME /tmp\nADD blog-springboot-0.0.1.jar blog.jar       \nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/blog.jar\"] \nsh\nFROM java:8\nVOLUME /tmp\nADD blog-springboot-0.0.1.jar blog.jar       \nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/blog.jar\"] \n```\npsï¼šDockerfileæ–‡ä»¶ä¸éœ€è¦åç¼€ï¼Œç›´æ¥ä¸ºæ–‡ä»¶æ ¼å¼\n\n## 3.ç¼–å†™blog-start.shè„šæœ¬\n```sh\n#æºjarè·¯å¾„  \nSOURCE_PATH=/usr/local/docker\n#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª\nSERVER_NAME=blog-springboot-0.0.1.jar\nTAG=latest\nSERVER_PORT=8080\n#å®¹å™¨id\nCID=$(docker ps | grep \"$SERVER_NAME\" | awk '{print $1}')\n#é•œåƒid\nIID=$(docker images | grep \"$SERVER_NAME:$TAG\" | awk '{print $3}')\nif [ -n \"$CID\" ]; then\n  echo \"å­˜åœ¨å®¹å™¨$SERVER_NAME, CID-$CID\"\n  docker stop $SERVER_NAME\n  docker rm $SERVER_NAME\nfi\n# æ„å»ºdockeré•œåƒ\nif [ -n \"$IID\" ]; then\n  echo \"å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼ŒIID=$IID\"\n  docker rmi $SERVER_NAME:$TAG\nelse\n  echo \"ä¸å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ\"\n  cd $SOURCE_PATH\n  docker build -t $SERVER_NAME:$TAG .\nfi\n# è¿è¡Œdockerå®¹å™¨\ndocker run --name $SERVER_NAME -v /usr/local/upload:/usr/local/upload -d -p $SERVER_PORT:$SERVER_PORT $SERVER_NAME:$TAG\necho \"$SERVER_NAMEå®¹å™¨åˆ›å»ºå®Œæˆ\"\nsh\n#æºjarè·¯å¾„  \nSOURCE_PATH=/usr/local/docker\n#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª\nSERVER_NAME=blog-springboot-0.0.1.jar\nTAG=latest\nSERVER_PORT=8080\n#å®¹å™¨id\nCID=$(docker ps | grep \"$SERVER_NAME\" | awk '{print $1}')\n#é•œåƒid\nIID=$(docker images | grep \"$SERVER_NAME:$TAG\" | awk '{print $3}')\nif [ -n \"$CID\" ]; then\n  echo \"å­˜åœ¨å®¹å™¨$SERVER_NAME, CID-$CID\"\n  docker stop $SERVER_NAME\n  docker rm $SERVER_NAME\nfi\n# æ„å»ºdockeré•œåƒ\nif [ -n \"$IID\" ]; then\n  echo \"å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼ŒIID=$IID\"\n  docker rmi $SERVER_NAME:$TAG\nelse\n  echo \"ä¸å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ\"\n  cd $SOURCE_PATH\n  docker build -t $SERVER_NAME:$TAG .\nfi\n# è¿è¡Œdockerå®¹å™¨\ndocker run --name $SERVER_NAME -v /usr/local/upload:/usr/local/upload -d -p $SERVER_PORT:$SERVER_PORT $SERVER_NAME:$TAG\necho \"$SERVER_NAMEå®¹å™¨åˆ›å»ºå®Œæˆ\"\n```\npsï¼šshæ–‡ä»¶éœ€è¦ç”¨notepad++è½¬ä¸ºUnixæ ¼å¼\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/aaed807d8df80aae11a94ea00df2264c.png)\n\n## 4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/183030180db2eb36f8949a2c81cb02ea.png)\n\nå°†ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶ä¼ è¾“åˆ°/usr/local/dockerä¸‹ï¼ˆæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ï¼‰\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d84ab03c0e7b56ee01dce5f89d30d554.png)\n\n## 5.dockerè¿è¡Œåç«¯é¡¹ç›®\nè¿›å…¥æœåŠ¡å™¨/usr/local/dockerä¸‹ï¼Œæ„å»ºåç«¯é•œåƒ\n```sh\nsh ./blog-start.sh \n```\n\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9a59bf2c7c8c465b707e5645a4b175b1.png)\npsï¼šç¬¬ä¸€æ¬¡æ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€å¿ƒç­‰å¾…å³å¯\n\næŸ¥çœ‹æ˜¯å¦æ„å»ºæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1096233de4147cd81b65728a495914a7.png)\n\nå¯ä»¥å»æµ‹è¯•ä¸‹æ¥å£æ˜¯å¦è¿è¡ŒæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a91b807200f73c0c406eae9ffb1e4297.png)\npsï¼šéœ€è¦é‡æ–°éƒ¨ç½²åªéœ€é‡æ–°ä¼ jaråŒ…ï¼Œæ‰§è¡Œshè„šæœ¬å³å¯\n\n## 6.æ‰“åŒ…å‰ç«¯é¡¹ç›®\næ‰“å¼€cmdï¼Œè¿›å…¥Vueé¡¹ç›®è·¯å¾„ -> npm run build\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/718358e5cc8e32b6ed1b0e0788dd7e22.png)\n\næ‰“åŒ…æˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆdistæ–‡ä»¶\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0b0b7a9a815eeef02e658c15ea0b564b.png)\n\nå°†Vueæ‰“åŒ…é¡¹ç›®ä¼ è¾“åˆ°/usr/local/vueä¸‹ï¼ˆç”±äºæˆ‘å‰å°å’Œåå°åˆ†ä¸ºä¸¤ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æ”¹ådistæ–‡ä»¶ï¼‰\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d8eb85b7f7bd34b93b1d2ac9b24142fb.png)\n\n## 7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)\nåœ¨/usr/local/nginxä¸‹åˆ›å»ºnginx.confæ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹\n```sh\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    client_max_body_size     50m;\n    client_body_buffer_size  10m; \n    client_header_timeout    1m;\n    client_body_timeout      1m;\n\n    gzip on;\n    gzip_min_length  1k;\n    gzip_buffers     4 16k;\n    gzip_comp_level  4;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n    gzip_vary on;\n\nserver {\n        listen       80;\n        server_name  å‰å°åŸŸå;\n     \n        location / {\t\t\n            root   /usr/local/vue/blog;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\t\nserver {\n        listen       80;\n        server_name  åå°å­åŸŸå;\n     \n        location / {\t\t\n            root   /usr/local/vue/admin;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\nserver {\n        listen       80;\n        server_name  websocketå­åŸŸå;\n     \n        location / {\n          proxy_pass http://ä½ çš„ip:8080/websocket;\n          proxy_http_version 1.1;\n          proxy_set_header Upgrade $http_upgrade;\n          proxy_set_header Connection \"Upgrade\";\n          proxy_set_header Host $host:$server_port;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n\t\n    }\n\nserver {\n        listen       80;\n        server_name  ä¸Šä¼ æ–‡ä»¶å­åŸŸå;\n     \n        location / {\t\t\n          alias /usr/local/upload/; \n          autoindex on;\n          autoindex_exact_size on;\n          autoindex_localtime on;\n        }\t\t\n\t\t\n    }\n \n }\n```\npsï¼šæˆ‘å‰å°å’Œåå°æ—¶åˆ†ä¸ºä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥å†™äº†ä¸¤ä¸ªserverï¼Œå‰ç«¯é¡¹ç›®è·¯å¾„ä¸ºä¹‹å‰ä¼ è¾“çš„è·¯å¾„ï¼Œå…¶ä»–ä¸¤ä¸ªä¸ºæ–‡ä»¶ä¸Šä¼ åŸŸåå’Œwebsocketè½¬å‘åŸŸåã€‚\n\ndockerå¯åŠ¨nginxæœåŠ¡\n```sh\ndocker run --name nginx --restart=always -p 80:80 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx \n```\n\n## 8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)\n```sh\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    client_max_body_size     50m;\n    client_body_buffer_size  10m; \n    client_header_timeout    1m;\n    client_body_timeout      1m;\n\n    gzip on;\n    gzip_min_length  1k;\n    gzip_buffers     4 16k;\n    gzip_comp_level  4;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n    gzip_vary on;\n\nserver {\n        listen       80;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n            root   /usr/local/vue/blog;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\t\nserver {\n        listen       81;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n            root   /usr/local/vue/admin;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\nserver {\n        listen       82;\n        server_name  ä½ çš„ip;\n     \n        location / {\n          proxy_pass http://ä½ çš„ip:8080/websocket;\n          proxy_http_version 1.1;\n          proxy_set_header Upgrade $http_upgrade;\n          proxy_set_header Connection \"Upgrade\";\n          proxy_set_header Host $host:$server_port;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n\t\n    }\n\nserver {\n        listen       83;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n          alias /usr/local/upload/; \n          autoindex on;\n          autoindex_exact_size on;\n          autoindex_localtime on;\n        }\t\t\n\t\t\n    }\n \n }\n```\ndockerå¯åŠ¨nginxæœåŠ¡\n```sh\ndocker run --name nginx --restart=always -p 80:80 -p 81:81 -p 82:82 -p 83:83 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx \n```\npsï¼šéœ€è¦é€šè¿‡ip + ç«¯å£å·è®¿é—®é¡¹ç›®\n\n## 9.è¿è¡Œæµ‹è¯•\nå»æµè§ˆå™¨æµ‹è¯•ä¸‹æ˜¯å¦è¿è¡ŒæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/66732d08619276eea4be2f8ab7f32551.png)\n\n## 10.å…¶ä»–è®¾ç½®\nè¿›å…¥åå°ç®¡ç† -> ç½‘ç«™ç®¡ç† -> å…¶ä»–è®¾ç½®ï¼Œé…ç½®websocketåŸŸå\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a97b2594f13b2928072728067ac68968.png)\n\n## 11.æ€»ç»“\næ•´ä¸ªå‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ•™ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸå•¦ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡åé¢å°±è½»è½¦ç†Ÿè·¯äº†ï¼Œæœ‰é—®é¢˜çš„å¯ä»¥ç§èŠé—®æˆ‘æˆ–è€…åœ¨è¯„è®ºåŒºç•™è¨€ã€‚","source":"_posts/SpringBoot-Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬).md","raw":"---\ntitle: SpringBoot+Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬)\ndate: 2022-06-01 09:39:56\ntags:\n---\n\n## 1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\næ‰“å¼€pom.xmlæ–‡ä»¶ï¼Œä¿®æ”¹packagingæ–¹å¼ä¸ºjar\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1b2cb327efd7ff924aed08f1b823c4a4.png)\n\nç‚¹å‡»å³ä¾§mavenæ’ä»¶ -> package\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/13824b79027f796b472c606e9fd34358.png)\n\næ‰“åŒ…æˆåŠŸåä¼šåœ¨targetç›®å½•ä¸‹ç”ŸæˆjaråŒ…\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/56a039e0a216ddb1119aea33946b87e0.png)\n\n## 2.ç¼–å†™Dockerfileæ–‡ä»¶\n```sh\nFROM java:8\nVOLUME /tmp\nADD blog-springboot-0.0.1.jar blog.jar       \nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/blog.jar\"] \nsh\nFROM java:8\nVOLUME /tmp\nADD blog-springboot-0.0.1.jar blog.jar       \nENTRYPOINT [\"java\",\"-Djava.security.egd=file:/dev/./urandom\",\"-jar\",\"/blog.jar\"] \n```\npsï¼šDockerfileæ–‡ä»¶ä¸éœ€è¦åç¼€ï¼Œç›´æ¥ä¸ºæ–‡ä»¶æ ¼å¼\n\n## 3.ç¼–å†™blog-start.shè„šæœ¬\n```sh\n#æºjarè·¯å¾„  \nSOURCE_PATH=/usr/local/docker\n#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª\nSERVER_NAME=blog-springboot-0.0.1.jar\nTAG=latest\nSERVER_PORT=8080\n#å®¹å™¨id\nCID=$(docker ps | grep \"$SERVER_NAME\" | awk '{print $1}')\n#é•œåƒid\nIID=$(docker images | grep \"$SERVER_NAME:$TAG\" | awk '{print $3}')\nif [ -n \"$CID\" ]; then\n  echo \"å­˜åœ¨å®¹å™¨$SERVER_NAME, CID-$CID\"\n  docker stop $SERVER_NAME\n  docker rm $SERVER_NAME\nfi\n# æ„å»ºdockeré•œåƒ\nif [ -n \"$IID\" ]; then\n  echo \"å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼ŒIID=$IID\"\n  docker rmi $SERVER_NAME:$TAG\nelse\n  echo \"ä¸å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ\"\n  cd $SOURCE_PATH\n  docker build -t $SERVER_NAME:$TAG .\nfi\n# è¿è¡Œdockerå®¹å™¨\ndocker run --name $SERVER_NAME -v /usr/local/upload:/usr/local/upload -d -p $SERVER_PORT:$SERVER_PORT $SERVER_NAME:$TAG\necho \"$SERVER_NAMEå®¹å™¨åˆ›å»ºå®Œæˆ\"\nsh\n#æºjarè·¯å¾„  \nSOURCE_PATH=/usr/local/docker\n#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª\nSERVER_NAME=blog-springboot-0.0.1.jar\nTAG=latest\nSERVER_PORT=8080\n#å®¹å™¨id\nCID=$(docker ps | grep \"$SERVER_NAME\" | awk '{print $1}')\n#é•œåƒid\nIID=$(docker images | grep \"$SERVER_NAME:$TAG\" | awk '{print $3}')\nif [ -n \"$CID\" ]; then\n  echo \"å­˜åœ¨å®¹å™¨$SERVER_NAME, CID-$CID\"\n  docker stop $SERVER_NAME\n  docker rm $SERVER_NAME\nfi\n# æ„å»ºdockeré•œåƒ\nif [ -n \"$IID\" ]; then\n  echo \"å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼ŒIID=$IID\"\n  docker rmi $SERVER_NAME:$TAG\nelse\n  echo \"ä¸å­˜åœ¨$SERVER_NAME:$TAGé•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ\"\n  cd $SOURCE_PATH\n  docker build -t $SERVER_NAME:$TAG .\nfi\n# è¿è¡Œdockerå®¹å™¨\ndocker run --name $SERVER_NAME -v /usr/local/upload:/usr/local/upload -d -p $SERVER_PORT:$SERVER_PORT $SERVER_NAME:$TAG\necho \"$SERVER_NAMEå®¹å™¨åˆ›å»ºå®Œæˆ\"\n```\npsï¼šshæ–‡ä»¶éœ€è¦ç”¨notepad++è½¬ä¸ºUnixæ ¼å¼\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/aaed807d8df80aae11a94ea00df2264c.png)\n\n## 4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/183030180db2eb36f8949a2c81cb02ea.png)\n\nå°†ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶ä¼ è¾“åˆ°/usr/local/dockerä¸‹ï¼ˆæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ï¼‰\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d84ab03c0e7b56ee01dce5f89d30d554.png)\n\n## 5.dockerè¿è¡Œåç«¯é¡¹ç›®\nè¿›å…¥æœåŠ¡å™¨/usr/local/dockerä¸‹ï¼Œæ„å»ºåç«¯é•œåƒ\n```sh\nsh ./blog-start.sh \n```\n\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9a59bf2c7c8c465b707e5645a4b175b1.png)\npsï¼šç¬¬ä¸€æ¬¡æ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€å¿ƒç­‰å¾…å³å¯\n\næŸ¥çœ‹æ˜¯å¦æ„å»ºæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1096233de4147cd81b65728a495914a7.png)\n\nå¯ä»¥å»æµ‹è¯•ä¸‹æ¥å£æ˜¯å¦è¿è¡ŒæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a91b807200f73c0c406eae9ffb1e4297.png)\npsï¼šéœ€è¦é‡æ–°éƒ¨ç½²åªéœ€é‡æ–°ä¼ jaråŒ…ï¼Œæ‰§è¡Œshè„šæœ¬å³å¯\n\n## 6.æ‰“åŒ…å‰ç«¯é¡¹ç›®\næ‰“å¼€cmdï¼Œè¿›å…¥Vueé¡¹ç›®è·¯å¾„ -> npm run build\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/718358e5cc8e32b6ed1b0e0788dd7e22.png)\n\næ‰“åŒ…æˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆdistæ–‡ä»¶\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0b0b7a9a815eeef02e658c15ea0b564b.png)\n\nå°†Vueæ‰“åŒ…é¡¹ç›®ä¼ è¾“åˆ°/usr/local/vueä¸‹ï¼ˆç”±äºæˆ‘å‰å°å’Œåå°åˆ†ä¸ºä¸¤ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æ”¹ådistæ–‡ä»¶ï¼‰\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d8eb85b7f7bd34b93b1d2ac9b24142fb.png)\n\n## 7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)\nåœ¨/usr/local/nginxä¸‹åˆ›å»ºnginx.confæ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹\n```sh\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    client_max_body_size     50m;\n    client_body_buffer_size  10m; \n    client_header_timeout    1m;\n    client_body_timeout      1m;\n\n    gzip on;\n    gzip_min_length  1k;\n    gzip_buffers     4 16k;\n    gzip_comp_level  4;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n    gzip_vary on;\n\nserver {\n        listen       80;\n        server_name  å‰å°åŸŸå;\n     \n        location / {\t\t\n            root   /usr/local/vue/blog;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\t\nserver {\n        listen       80;\n        server_name  åå°å­åŸŸå;\n     \n        location / {\t\t\n            root   /usr/local/vue/admin;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\nserver {\n        listen       80;\n        server_name  websocketå­åŸŸå;\n     \n        location / {\n          proxy_pass http://ä½ çš„ip:8080/websocket;\n          proxy_http_version 1.1;\n          proxy_set_header Upgrade $http_upgrade;\n          proxy_set_header Connection \"Upgrade\";\n          proxy_set_header Host $host:$server_port;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n\t\n    }\n\nserver {\n        listen       80;\n        server_name  ä¸Šä¼ æ–‡ä»¶å­åŸŸå;\n     \n        location / {\t\t\n          alias /usr/local/upload/; \n          autoindex on;\n          autoindex_exact_size on;\n          autoindex_localtime on;\n        }\t\t\n\t\t\n    }\n \n }\n```\npsï¼šæˆ‘å‰å°å’Œåå°æ—¶åˆ†ä¸ºä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥å†™äº†ä¸¤ä¸ªserverï¼Œå‰ç«¯é¡¹ç›®è·¯å¾„ä¸ºä¹‹å‰ä¼ è¾“çš„è·¯å¾„ï¼Œå…¶ä»–ä¸¤ä¸ªä¸ºæ–‡ä»¶ä¸Šä¼ åŸŸåå’Œwebsocketè½¬å‘åŸŸåã€‚\n\ndockerå¯åŠ¨nginxæœåŠ¡\n```sh\ndocker run --name nginx --restart=always -p 80:80 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx \n```\n\n## 8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)\n```sh\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n    sendfile        on;\n    keepalive_timeout  65;\n\n    client_max_body_size     50m;\n    client_body_buffer_size  10m; \n    client_header_timeout    1m;\n    client_body_timeout      1m;\n\n    gzip on;\n    gzip_min_length  1k;\n    gzip_buffers     4 16k;\n    gzip_comp_level  4;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n    gzip_vary on;\n\nserver {\n        listen       80;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n            root   /usr/local/vue/blog;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\t\nserver {\n        listen       81;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n            root   /usr/local/vue/admin;\n            index  index.html index.htm; \n            try_files $uri $uri/ /index.html;\t\n        }\n\t\t\t\n\tlocation ^~ /api/ {\t\t\n            proxy_pass http://ä½ çš„ip:8080/;\n\t    proxy_set_header   Host             $host;\n            proxy_set_header   X-Real-IP        $remote_addr;\t\t\t\t\t\t\n            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n        }\n\t\t\n    }\n\nserver {\n        listen       82;\n        server_name  ä½ çš„ip;\n     \n        location / {\n          proxy_pass http://ä½ çš„ip:8080/websocket;\n          proxy_http_version 1.1;\n          proxy_set_header Upgrade $http_upgrade;\n          proxy_set_header Connection \"Upgrade\";\n          proxy_set_header Host $host:$server_port;\n          proxy_set_header X-Real-IP $remote_addr;\n          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto $scheme;\n       }\n\t\n    }\n\nserver {\n        listen       83;\n        server_name  ä½ çš„ip;\n     \n        location / {\t\t\n          alias /usr/local/upload/; \n          autoindex on;\n          autoindex_exact_size on;\n          autoindex_localtime on;\n        }\t\t\n\t\t\n    }\n \n }\n```\ndockerå¯åŠ¨nginxæœåŠ¡\n```sh\ndocker run --name nginx --restart=always -p 80:80 -p 81:81 -p 82:82 -p 83:83 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx \n```\npsï¼šéœ€è¦é€šè¿‡ip + ç«¯å£å·è®¿é—®é¡¹ç›®\n\n## 9.è¿è¡Œæµ‹è¯•\nå»æµè§ˆå™¨æµ‹è¯•ä¸‹æ˜¯å¦è¿è¡ŒæˆåŠŸ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/66732d08619276eea4be2f8ab7f32551.png)\n\n## 10.å…¶ä»–è®¾ç½®\nè¿›å…¥åå°ç®¡ç† -> ç½‘ç«™ç®¡ç† -> å…¶ä»–è®¾ç½®ï¼Œé…ç½®websocketåŸŸå\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a97b2594f13b2928072728067ac68968.png)\n\n## 11.æ€»ç»“\næ•´ä¸ªå‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ•™ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸå•¦ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡åé¢å°±è½»è½¦ç†Ÿè·¯äº†ï¼Œæœ‰é—®é¢˜çš„å¯ä»¥ç§èŠé—®æˆ‘æˆ–è€…åœ¨è¯„è®ºåŒºç•™è¨€ã€‚","slug":"SpringBoot-Vueå‰åç«¯åˆ†ç¦»é¡¹ç›®éƒ¨ç½²æ•™ç¨‹(è½¬)","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dm000owen10kx31cth","content":"<h2 id=\"1-æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\"><a href=\"#1-æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\" class=\"headerlink\" title=\"1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\"></a>1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…</h2><p>æ‰“å¼€pom.xmlæ–‡ä»¶ï¼Œä¿®æ”¹packagingæ–¹å¼ä¸ºjar<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1b2cb327efd7ff924aed08f1b823c4a4.png\" alt=\"image.png\"></p>\n<p>ç‚¹å‡»å³ä¾§mavenæ’ä»¶ -&gt; package<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/13824b79027f796b472c606e9fd34358.png\" alt=\"image.png\"></p>\n<p>æ‰“åŒ…æˆåŠŸåä¼šåœ¨targetç›®å½•ä¸‹ç”ŸæˆjaråŒ…<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/56a039e0a216ddb1119aea33946b87e0.png\" alt=\"image.png\"></p>\n<h2 id=\"2-ç¼–å†™Dockerfileæ–‡ä»¶\"><a href=\"#2-ç¼–å†™Dockerfileæ–‡ä»¶\" class=\"headerlink\" title=\"2.ç¼–å†™Dockerfileæ–‡ä»¶\"></a>2.ç¼–å†™Dockerfileæ–‡ä»¶</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM java:8</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\">ADD blog-springboot-0.0.1.jar blog.jar       </span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/blog.jar&quot;</span>] </span><br><span class=\"line\">sh</span><br><span class=\"line\">FROM java:8</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\">ADD blog-springboot-0.0.1.jar blog.jar       </span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/blog.jar&quot;</span>] </span><br></pre></td></tr></table></figure>\n<p>psï¼šDockerfileæ–‡ä»¶ä¸éœ€è¦åç¼€ï¼Œç›´æ¥ä¸ºæ–‡ä»¶æ ¼å¼</p>\n<h2 id=\"3-ç¼–å†™blog-start-shè„šæœ¬\"><a href=\"#3-ç¼–å†™blog-start-shè„šæœ¬\" class=\"headerlink\" title=\"3.ç¼–å†™blog-start.shè„šæœ¬\"></a>3.ç¼–å†™blog-start.shè„šæœ¬</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#æºjarè·¯å¾„  </span></span><br><span class=\"line\">SOURCE_PATH=/usr/local/docker</span><br><span class=\"line\"><span class=\"comment\">#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª</span></span><br><span class=\"line\">SERVER_NAME=blog-springboot-0.0.1.jar</span><br><span class=\"line\">TAG=latest</span><br><span class=\"line\">SERVER_PORT=8080</span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨id</span></span><br><span class=\"line\">CID=$(docker ps | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#é•œåƒid</span></span><br><span class=\"line\">IID=$(docker images | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $3&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$CID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨å®¹å™¨<span class=\"variable\">$SERVER_NAME</span>, CID-<span class=\"variable\">$CID</span>&quot;</span></span><br><span class=\"line\">  docker stop <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\">  docker <span class=\"built_in\">rm</span> <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># æ„å»ºdockeré•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$IID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼ŒIID=<span class=\"variable\">$IID</span>&quot;</span></span><br><span class=\"line\">  docker rmi <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;ä¸å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ&quot;</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> <span class=\"variable\">$SOURCE_PATH</span></span><br><span class=\"line\">  docker build -t <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span> .</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œdockerå®¹å™¨</span></span><br><span class=\"line\">docker run --name <span class=\"variable\">$SERVER_NAME</span> -v /usr/local/upload:/usr/local/upload -d -p <span class=\"variable\">$SERVER_PORT</span>:<span class=\"variable\">$SERVER_PORT</span> <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>å®¹å™¨åˆ›å»ºå®Œæˆ&quot;</span></span><br><span class=\"line\">sh</span><br><span class=\"line\"><span class=\"comment\">#æºjarè·¯å¾„  </span></span><br><span class=\"line\">SOURCE_PATH=/usr/local/docker</span><br><span class=\"line\"><span class=\"comment\">#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª</span></span><br><span class=\"line\">SERVER_NAME=blog-springboot-0.0.1.jar</span><br><span class=\"line\">TAG=latest</span><br><span class=\"line\">SERVER_PORT=8080</span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨id</span></span><br><span class=\"line\">CID=$(docker ps | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#é•œåƒid</span></span><br><span class=\"line\">IID=$(docker images | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $3&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$CID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨å®¹å™¨<span class=\"variable\">$SERVER_NAME</span>, CID-<span class=\"variable\">$CID</span>&quot;</span></span><br><span class=\"line\">  docker stop <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\">  docker <span class=\"built_in\">rm</span> <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># æ„å»ºdockeré•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$IID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼ŒIID=<span class=\"variable\">$IID</span>&quot;</span></span><br><span class=\"line\">  docker rmi <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;ä¸å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ&quot;</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> <span class=\"variable\">$SOURCE_PATH</span></span><br><span class=\"line\">  docker build -t <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span> .</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œdockerå®¹å™¨</span></span><br><span class=\"line\">docker run --name <span class=\"variable\">$SERVER_NAME</span> -v /usr/local/upload:/usr/local/upload -d -p <span class=\"variable\">$SERVER_PORT</span>:<span class=\"variable\">$SERVER_PORT</span> <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>å®¹å™¨åˆ›å»ºå®Œæˆ&quot;</span></span><br></pre></td></tr></table></figure>\n<p>psï¼šshæ–‡ä»¶éœ€è¦ç”¨notepad++è½¬ä¸ºUnixæ ¼å¼<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/aaed807d8df80aae11a94ea00df2264c.png\" alt=\"image.png\"></p>\n<h2 id=\"4-å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\"><a href=\"#4-å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\" class=\"headerlink\" title=\"4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\"></a>4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/183030180db2eb36f8949a2c81cb02ea.png\" alt=\"image.png\"></p>\n<p>å°†ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶ä¼ è¾“åˆ°&#x2F;usr&#x2F;local&#x2F;dockerä¸‹ï¼ˆæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ï¼‰<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d84ab03c0e7b56ee01dce5f89d30d554.png\" alt=\"image.png\"></p>\n<h2 id=\"5-dockerè¿è¡Œåç«¯é¡¹ç›®\"><a href=\"#5-dockerè¿è¡Œåç«¯é¡¹ç›®\" class=\"headerlink\" title=\"5.dockerè¿è¡Œåç«¯é¡¹ç›®\"></a>5.dockerè¿è¡Œåç«¯é¡¹ç›®</h2><p>è¿›å…¥æœåŠ¡å™¨&#x2F;usr&#x2F;local&#x2F;dockerä¸‹ï¼Œæ„å»ºåç«¯é•œåƒ</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh ./blog-start.sh </span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9a59bf2c7c8c465b707e5645a4b175b1.png\" alt=\"image.png\"><br>psï¼šç¬¬ä¸€æ¬¡æ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€å¿ƒç­‰å¾…å³å¯</p>\n<p>æŸ¥çœ‹æ˜¯å¦æ„å»ºæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1096233de4147cd81b65728a495914a7.png\" alt=\"image.png\"></p>\n<p>å¯ä»¥å»æµ‹è¯•ä¸‹æ¥å£æ˜¯å¦è¿è¡ŒæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a91b807200f73c0c406eae9ffb1e4297.png\" alt=\"image.png\"><br>psï¼šéœ€è¦é‡æ–°éƒ¨ç½²åªéœ€é‡æ–°ä¼ jaråŒ…ï¼Œæ‰§è¡Œshè„šæœ¬å³å¯</p>\n<h2 id=\"6-æ‰“åŒ…å‰ç«¯é¡¹ç›®\"><a href=\"#6-æ‰“åŒ…å‰ç«¯é¡¹ç›®\" class=\"headerlink\" title=\"6.æ‰“åŒ…å‰ç«¯é¡¹ç›®\"></a>6.æ‰“åŒ…å‰ç«¯é¡¹ç›®</h2><p>æ‰“å¼€cmdï¼Œè¿›å…¥Vueé¡¹ç›®è·¯å¾„ -&gt; npm run build<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/718358e5cc8e32b6ed1b0e0788dd7e22.png\" alt=\"image.png\"></p>\n<p>æ‰“åŒ…æˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆdistæ–‡ä»¶<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0b0b7a9a815eeef02e658c15ea0b564b.png\" alt=\"image.png\"></p>\n<p>å°†Vueæ‰“åŒ…é¡¹ç›®ä¼ è¾“åˆ°&#x2F;usr&#x2F;local&#x2F;vueä¸‹ï¼ˆç”±äºæˆ‘å‰å°å’Œåå°åˆ†ä¸ºä¸¤ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æ”¹ådistæ–‡ä»¶ï¼‰<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d8eb85b7f7bd34b93b1d2ac9b24142fb.png\" alt=\"image.png\"></p>\n<h2 id=\"7-nginxé…ç½®-æœ‰åŸŸåé€‰è¿™ä¸ª\"><a href=\"#7-nginxé…ç½®-æœ‰åŸŸåé€‰è¿™ä¸ª\" class=\"headerlink\" title=\"7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)\"></a>7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)</h2><p>åœ¨&#x2F;usr&#x2F;local&#x2F;nginxä¸‹åˆ›å»ºnginx.confæ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    client_max_body_size     50m;</span><br><span class=\"line\">    client_body_buffer_size  10m; </span><br><span class=\"line\">    client_header_timeout    1m;</span><br><span class=\"line\">    client_body_timeout      1m;</span><br><span class=\"line\"></span><br><span class=\"line\">    gzip on;</span><br><span class=\"line\">    gzip_min_length  1k;</span><br><span class=\"line\">    gzip_buffers     4 16k;</span><br><span class=\"line\">    gzip_comp_level  4;</span><br><span class=\"line\">    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  å‰å°åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/blog;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  åå°å­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/admin;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  websocketå­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">          proxy_pass http://ä½ çš„ip:8080/websocket;</span><br><span class=\"line\">          proxy_http_version 1.1;</span><br><span class=\"line\">          proxy_set_header Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">          proxy_set_header Connection <span class=\"string\">&quot;Upgrade&quot;</span>;</span><br><span class=\"line\">          proxy_set_header Host <span class=\"variable\">$host</span>:<span class=\"variable\">$server_port</span>;</span><br><span class=\"line\">          proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  ä¸Šä¼ æ–‡ä»¶å­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">          <span class=\"built_in\">alias</span> /usr/local/upload/; </span><br><span class=\"line\">          autoindex on;</span><br><span class=\"line\">          autoindex_exact_size on;</span><br><span class=\"line\">          autoindex_localtime on;</span><br><span class=\"line\">        &#125;\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>psï¼šæˆ‘å‰å°å’Œåå°æ—¶åˆ†ä¸ºä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥å†™äº†ä¸¤ä¸ªserverï¼Œå‰ç«¯é¡¹ç›®è·¯å¾„ä¸ºä¹‹å‰ä¼ è¾“çš„è·¯å¾„ï¼Œå…¶ä»–ä¸¤ä¸ªä¸ºæ–‡ä»¶ä¸Šä¼ åŸŸåå’Œwebsocketè½¬å‘åŸŸåã€‚</p>\n<p>dockerå¯åŠ¨nginxæœåŠ¡</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nginx --restart=always -p 80:80 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8-nginxé…ç½®-æ— åŸŸåé€‰è¿™ä¸ª\"><a href=\"#8-nginxé…ç½®-æ— åŸŸåé€‰è¿™ä¸ª\" class=\"headerlink\" title=\"8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)\"></a>8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    client_max_body_size     50m;</span><br><span class=\"line\">    client_body_buffer_size  10m; </span><br><span class=\"line\">    client_header_timeout    1m;</span><br><span class=\"line\">    client_body_timeout      1m;</span><br><span class=\"line\"></span><br><span class=\"line\">    gzip on;</span><br><span class=\"line\">    gzip_min_length  1k;</span><br><span class=\"line\">    gzip_buffers     4 16k;</span><br><span class=\"line\">    gzip_comp_level  4;</span><br><span class=\"line\">    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/blog;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       81;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/admin;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       82;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">          proxy_pass http://ä½ çš„ip:8080/websocket;</span><br><span class=\"line\">          proxy_http_version 1.1;</span><br><span class=\"line\">          proxy_set_header Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">          proxy_set_header Connection <span class=\"string\">&quot;Upgrade&quot;</span>;</span><br><span class=\"line\">          proxy_set_header Host <span class=\"variable\">$host</span>:<span class=\"variable\">$server_port</span>;</span><br><span class=\"line\">          proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       83;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">          <span class=\"built_in\">alias</span> /usr/local/upload/; </span><br><span class=\"line\">          autoindex on;</span><br><span class=\"line\">          autoindex_exact_size on;</span><br><span class=\"line\">          autoindex_localtime on;</span><br><span class=\"line\">        &#125;\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>dockerå¯åŠ¨nginxæœåŠ¡</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nginx --restart=always -p 80:80 -p 81:81 -p 82:82 -p 83:83 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx </span><br></pre></td></tr></table></figure>\n<p>psï¼šéœ€è¦é€šè¿‡ip + ç«¯å£å·è®¿é—®é¡¹ç›®</p>\n<h2 id=\"9-è¿è¡Œæµ‹è¯•\"><a href=\"#9-è¿è¡Œæµ‹è¯•\" class=\"headerlink\" title=\"9.è¿è¡Œæµ‹è¯•\"></a>9.è¿è¡Œæµ‹è¯•</h2><p>å»æµè§ˆå™¨æµ‹è¯•ä¸‹æ˜¯å¦è¿è¡ŒæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/66732d08619276eea4be2f8ab7f32551.png\" alt=\"image.png\"></p>\n<h2 id=\"10-å…¶ä»–è®¾ç½®\"><a href=\"#10-å…¶ä»–è®¾ç½®\" class=\"headerlink\" title=\"10.å…¶ä»–è®¾ç½®\"></a>10.å…¶ä»–è®¾ç½®</h2><p>è¿›å…¥åå°ç®¡ç† -&gt; ç½‘ç«™ç®¡ç† -&gt; å…¶ä»–è®¾ç½®ï¼Œé…ç½®websocketåŸŸå<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a97b2594f13b2928072728067ac68968.png\" alt=\"image.png\"></p>\n<h2 id=\"11-æ€»ç»“\"><a href=\"#11-æ€»ç»“\" class=\"headerlink\" title=\"11.æ€»ç»“\"></a>11.æ€»ç»“</h2><p>æ•´ä¸ªå‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ•™ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸå•¦ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡åé¢å°±è½»è½¦ç†Ÿè·¯äº†ï¼Œæœ‰é—®é¢˜çš„å¯ä»¥ç§èŠé—®æˆ‘æˆ–è€…åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>\n","excerpt":"","more":"<h2 id=\"1-æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\"><a href=\"#1-æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\" class=\"headerlink\" title=\"1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…\"></a>1.æ‰“åŒ…åç«¯é¡¹ç›®jaråŒ…</h2><p>æ‰“å¼€pom.xmlæ–‡ä»¶ï¼Œä¿®æ”¹packagingæ–¹å¼ä¸ºjar<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1b2cb327efd7ff924aed08f1b823c4a4.png\" alt=\"image.png\"></p>\n<p>ç‚¹å‡»å³ä¾§mavenæ’ä»¶ -&gt; package<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/13824b79027f796b472c606e9fd34358.png\" alt=\"image.png\"></p>\n<p>æ‰“åŒ…æˆåŠŸåä¼šåœ¨targetç›®å½•ä¸‹ç”ŸæˆjaråŒ…<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/56a039e0a216ddb1119aea33946b87e0.png\" alt=\"image.png\"></p>\n<h2 id=\"2-ç¼–å†™Dockerfileæ–‡ä»¶\"><a href=\"#2-ç¼–å†™Dockerfileæ–‡ä»¶\" class=\"headerlink\" title=\"2.ç¼–å†™Dockerfileæ–‡ä»¶\"></a>2.ç¼–å†™Dockerfileæ–‡ä»¶</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM java:8</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\">ADD blog-springboot-0.0.1.jar blog.jar       </span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/blog.jar&quot;</span>] </span><br><span class=\"line\">sh</span><br><span class=\"line\">FROM java:8</span><br><span class=\"line\">VOLUME /tmp</span><br><span class=\"line\">ADD blog-springboot-0.0.1.jar blog.jar       </span><br><span class=\"line\">ENTRYPOINT [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-Djava.security.egd=file:/dev/./urandom&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/blog.jar&quot;</span>] </span><br></pre></td></tr></table></figure>\n<p>psï¼šDockerfileæ–‡ä»¶ä¸éœ€è¦åç¼€ï¼Œç›´æ¥ä¸ºæ–‡ä»¶æ ¼å¼</p>\n<h2 id=\"3-ç¼–å†™blog-start-shè„šæœ¬\"><a href=\"#3-ç¼–å†™blog-start-shè„šæœ¬\" class=\"headerlink\" title=\"3.ç¼–å†™blog-start.shè„šæœ¬\"></a>3.ç¼–å†™blog-start.shè„šæœ¬</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#æºjarè·¯å¾„  </span></span><br><span class=\"line\">SOURCE_PATH=/usr/local/docker</span><br><span class=\"line\"><span class=\"comment\">#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª</span></span><br><span class=\"line\">SERVER_NAME=blog-springboot-0.0.1.jar</span><br><span class=\"line\">TAG=latest</span><br><span class=\"line\">SERVER_PORT=8080</span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨id</span></span><br><span class=\"line\">CID=$(docker ps | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#é•œåƒid</span></span><br><span class=\"line\">IID=$(docker images | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $3&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$CID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨å®¹å™¨<span class=\"variable\">$SERVER_NAME</span>, CID-<span class=\"variable\">$CID</span>&quot;</span></span><br><span class=\"line\">  docker stop <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\">  docker <span class=\"built_in\">rm</span> <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># æ„å»ºdockeré•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$IID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼ŒIID=<span class=\"variable\">$IID</span>&quot;</span></span><br><span class=\"line\">  docker rmi <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;ä¸å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ&quot;</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> <span class=\"variable\">$SOURCE_PATH</span></span><br><span class=\"line\">  docker build -t <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span> .</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œdockerå®¹å™¨</span></span><br><span class=\"line\">docker run --name <span class=\"variable\">$SERVER_NAME</span> -v /usr/local/upload:/usr/local/upload -d -p <span class=\"variable\">$SERVER_PORT</span>:<span class=\"variable\">$SERVER_PORT</span> <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>å®¹å™¨åˆ›å»ºå®Œæˆ&quot;</span></span><br><span class=\"line\">sh</span><br><span class=\"line\"><span class=\"comment\">#æºjarè·¯å¾„  </span></span><br><span class=\"line\">SOURCE_PATH=/usr/local/docker</span><br><span class=\"line\"><span class=\"comment\">#docker é•œåƒ/å®¹å™¨åå­—æˆ–è€…jaråå­— è¿™é‡Œéƒ½å‘½åä¸ºè¿™ä¸ª</span></span><br><span class=\"line\">SERVER_NAME=blog-springboot-0.0.1.jar</span><br><span class=\"line\">TAG=latest</span><br><span class=\"line\">SERVER_PORT=8080</span><br><span class=\"line\"><span class=\"comment\">#å®¹å™¨id</span></span><br><span class=\"line\">CID=$(docker ps | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#é•œåƒid</span></span><br><span class=\"line\">IID=$(docker images | grep <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>&quot;</span> | awk <span class=\"string\">&#x27;&#123;print $3&#125;&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$CID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨å®¹å™¨<span class=\"variable\">$SERVER_NAME</span>, CID-<span class=\"variable\">$CID</span>&quot;</span></span><br><span class=\"line\">  docker stop <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\">  docker <span class=\"built_in\">rm</span> <span class=\"variable\">$SERVER_NAME</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># æ„å»ºdockeré•œåƒ</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -n <span class=\"string\">&quot;<span class=\"variable\">$IID</span>&quot;</span> ]; <span class=\"keyword\">then</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼ŒIID=<span class=\"variable\">$IID</span>&quot;</span></span><br><span class=\"line\">  docker rmi <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">&quot;ä¸å­˜åœ¨<span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span>é•œåƒï¼Œå¼€å§‹æ„å»ºé•œåƒ&quot;</span></span><br><span class=\"line\">  <span class=\"built_in\">cd</span> <span class=\"variable\">$SOURCE_PATH</span></span><br><span class=\"line\">  docker build -t <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span> .</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"comment\"># è¿è¡Œdockerå®¹å™¨</span></span><br><span class=\"line\">docker run --name <span class=\"variable\">$SERVER_NAME</span> -v /usr/local/upload:/usr/local/upload -d -p <span class=\"variable\">$SERVER_PORT</span>:<span class=\"variable\">$SERVER_PORT</span> <span class=\"variable\">$SERVER_NAME</span>:<span class=\"variable\">$TAG</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;<span class=\"variable\">$SERVER_NAME</span>å®¹å™¨åˆ›å»ºå®Œæˆ&quot;</span></span><br></pre></td></tr></table></figure>\n<p>psï¼šshæ–‡ä»¶éœ€è¦ç”¨notepad++è½¬ä¸ºUnixæ ¼å¼<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/aaed807d8df80aae11a94ea00df2264c.png\" alt=\"image.png\"></p>\n<h2 id=\"4-å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\"><a href=\"#4-å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\" class=\"headerlink\" title=\"4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨\"></a>4.å°†æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡å™¨</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/183030180db2eb36f8949a2c81cb02ea.png\" alt=\"image.png\"></p>\n<p>å°†ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶ä¼ è¾“åˆ°&#x2F;usr&#x2F;local&#x2F;dockerä¸‹ï¼ˆæ‰‹åŠ¨åˆ›å»ºæ–‡ä»¶å¤¹ï¼‰<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d84ab03c0e7b56ee01dce5f89d30d554.png\" alt=\"image.png\"></p>\n<h2 id=\"5-dockerè¿è¡Œåç«¯é¡¹ç›®\"><a href=\"#5-dockerè¿è¡Œåç«¯é¡¹ç›®\" class=\"headerlink\" title=\"5.dockerè¿è¡Œåç«¯é¡¹ç›®\"></a>5.dockerè¿è¡Œåç«¯é¡¹ç›®</h2><p>è¿›å…¥æœåŠ¡å™¨&#x2F;usr&#x2F;local&#x2F;dockerä¸‹ï¼Œæ„å»ºåç«¯é•œåƒ</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sh ./blog-start.sh </span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/9a59bf2c7c8c465b707e5645a4b175b1.png\" alt=\"image.png\"><br>psï¼šç¬¬ä¸€æ¬¡æ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€å¿ƒç­‰å¾…å³å¯</p>\n<p>æŸ¥çœ‹æ˜¯å¦æ„å»ºæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/1096233de4147cd81b65728a495914a7.png\" alt=\"image.png\"></p>\n<p>å¯ä»¥å»æµ‹è¯•ä¸‹æ¥å£æ˜¯å¦è¿è¡ŒæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a91b807200f73c0c406eae9ffb1e4297.png\" alt=\"image.png\"><br>psï¼šéœ€è¦é‡æ–°éƒ¨ç½²åªéœ€é‡æ–°ä¼ jaråŒ…ï¼Œæ‰§è¡Œshè„šæœ¬å³å¯</p>\n<h2 id=\"6-æ‰“åŒ…å‰ç«¯é¡¹ç›®\"><a href=\"#6-æ‰“åŒ…å‰ç«¯é¡¹ç›®\" class=\"headerlink\" title=\"6.æ‰“åŒ…å‰ç«¯é¡¹ç›®\"></a>6.æ‰“åŒ…å‰ç«¯é¡¹ç›®</h2><p>æ‰“å¼€cmdï¼Œè¿›å…¥Vueé¡¹ç›®è·¯å¾„ -&gt; npm run build<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/718358e5cc8e32b6ed1b0e0788dd7e22.png\" alt=\"image.png\"></p>\n<p>æ‰“åŒ…æˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆdistæ–‡ä»¶<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0b0b7a9a815eeef02e658c15ea0b564b.png\" alt=\"image.png\"></p>\n<p>å°†Vueæ‰“åŒ…é¡¹ç›®ä¼ è¾“åˆ°&#x2F;usr&#x2F;local&#x2F;vueä¸‹ï¼ˆç”±äºæˆ‘å‰å°å’Œåå°åˆ†ä¸ºä¸¤ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥æ”¹ådistæ–‡ä»¶ï¼‰<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/d8eb85b7f7bd34b93b1d2ac9b24142fb.png\" alt=\"image.png\"></p>\n<h2 id=\"7-nginxé…ç½®-æœ‰åŸŸåé€‰è¿™ä¸ª\"><a href=\"#7-nginxé…ç½®-æœ‰åŸŸåé€‰è¿™ä¸ª\" class=\"headerlink\" title=\"7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)\"></a>7.nginxé…ç½®(æœ‰åŸŸåé€‰è¿™ä¸ª)</h2><p>åœ¨&#x2F;usr&#x2F;local&#x2F;nginxä¸‹åˆ›å»ºnginx.confæ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    client_max_body_size     50m;</span><br><span class=\"line\">    client_body_buffer_size  10m; </span><br><span class=\"line\">    client_header_timeout    1m;</span><br><span class=\"line\">    client_body_timeout      1m;</span><br><span class=\"line\"></span><br><span class=\"line\">    gzip on;</span><br><span class=\"line\">    gzip_min_length  1k;</span><br><span class=\"line\">    gzip_buffers     4 16k;</span><br><span class=\"line\">    gzip_comp_level  4;</span><br><span class=\"line\">    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  å‰å°åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/blog;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  åå°å­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/admin;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  websocketå­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">          proxy_pass http://ä½ çš„ip:8080/websocket;</span><br><span class=\"line\">          proxy_http_version 1.1;</span><br><span class=\"line\">          proxy_set_header Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">          proxy_set_header Connection <span class=\"string\">&quot;Upgrade&quot;</span>;</span><br><span class=\"line\">          proxy_set_header Host <span class=\"variable\">$host</span>:<span class=\"variable\">$server_port</span>;</span><br><span class=\"line\">          proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  ä¸Šä¼ æ–‡ä»¶å­åŸŸå;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">          <span class=\"built_in\">alias</span> /usr/local/upload/; </span><br><span class=\"line\">          autoindex on;</span><br><span class=\"line\">          autoindex_exact_size on;</span><br><span class=\"line\">          autoindex_localtime on;</span><br><span class=\"line\">        &#125;\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>psï¼šæˆ‘å‰å°å’Œåå°æ—¶åˆ†ä¸ºä¸¤ä¸ªåŸŸåï¼Œæ‰€ä»¥å†™äº†ä¸¤ä¸ªserverï¼Œå‰ç«¯é¡¹ç›®è·¯å¾„ä¸ºä¹‹å‰ä¼ è¾“çš„è·¯å¾„ï¼Œå…¶ä»–ä¸¤ä¸ªä¸ºæ–‡ä»¶ä¸Šä¼ åŸŸåå’Œwebsocketè½¬å‘åŸŸåã€‚</p>\n<p>dockerå¯åŠ¨nginxæœåŠ¡</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nginx --restart=always -p 80:80 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8-nginxé…ç½®-æ— åŸŸåé€‰è¿™ä¸ª\"><a href=\"#8-nginxé…ç½®-æ— åŸŸåé€‰è¿™ä¸ª\" class=\"headerlink\" title=\"8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)\"></a>8.nginxé…ç½®(æ— åŸŸåé€‰è¿™ä¸ª)</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    client_max_body_size     50m;</span><br><span class=\"line\">    client_body_buffer_size  10m; </span><br><span class=\"line\">    client_header_timeout    1m;</span><br><span class=\"line\">    client_body_timeout      1m;</span><br><span class=\"line\"></span><br><span class=\"line\">    gzip on;</span><br><span class=\"line\">    gzip_min_length  1k;</span><br><span class=\"line\">    gzip_buffers     4 16k;</span><br><span class=\"line\">    gzip_comp_level  4;</span><br><span class=\"line\">    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/blog;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       81;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">            root   /usr/local/vue/admin;</span><br><span class=\"line\">            index  index.html index.htm; </span><br><span class=\"line\">            try_files <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.html;\t</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\tlocation ^~ /api/ &#123;\t\t</span><br><span class=\"line\">            proxy_pass http://ä½ çš„ip:8080/;</span><br><span class=\"line\">\t    proxy_set_header   Host             <span class=\"variable\">$host</span>;</span><br><span class=\"line\">            proxy_set_header   X-Real-IP        <span class=\"variable\">$remote_addr</span>;\t\t\t\t\t\t</span><br><span class=\"line\">            proxy_set_header   X-Forwarded-For  <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       82;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">          proxy_pass http://ä½ çš„ip:8080/websocket;</span><br><span class=\"line\">          proxy_http_version 1.1;</span><br><span class=\"line\">          proxy_set_header Upgrade <span class=\"variable\">$http_upgrade</span>;</span><br><span class=\"line\">          proxy_set_header Connection <span class=\"string\">&quot;Upgrade&quot;</span>;</span><br><span class=\"line\">          proxy_set_header Host <span class=\"variable\">$host</span>:<span class=\"variable\">$server_port</span>;</span><br><span class=\"line\">          proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">          proxy_set_header X-Forwarded-Proto <span class=\"variable\">$scheme</span>;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">        listen       83;</span><br><span class=\"line\">        server_name  ä½ çš„ip;</span><br><span class=\"line\">     </span><br><span class=\"line\">        location / &#123;\t\t</span><br><span class=\"line\">          <span class=\"built_in\">alias</span> /usr/local/upload/; </span><br><span class=\"line\">          autoindex on;</span><br><span class=\"line\">          autoindex_exact_size on;</span><br><span class=\"line\">          autoindex_localtime on;</span><br><span class=\"line\">        &#125;\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>dockerå¯åŠ¨nginxæœåŠ¡</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --name nginx --restart=always -p 80:80 -p 81:81 -p 82:82 -p 83:83 -d -v /usr/local/nginx/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/vue:/usr/local/vue -v /usr/local/upload:/usr/local/upload nginx </span><br></pre></td></tr></table></figure>\n<p>psï¼šéœ€è¦é€šè¿‡ip + ç«¯å£å·è®¿é—®é¡¹ç›®</p>\n<h2 id=\"9-è¿è¡Œæµ‹è¯•\"><a href=\"#9-è¿è¡Œæµ‹è¯•\" class=\"headerlink\" title=\"9.è¿è¡Œæµ‹è¯•\"></a>9.è¿è¡Œæµ‹è¯•</h2><p>å»æµè§ˆå™¨æµ‹è¯•ä¸‹æ˜¯å¦è¿è¡ŒæˆåŠŸ<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/66732d08619276eea4be2f8ab7f32551.png\" alt=\"image.png\"></p>\n<h2 id=\"10-å…¶ä»–è®¾ç½®\"><a href=\"#10-å…¶ä»–è®¾ç½®\" class=\"headerlink\" title=\"10.å…¶ä»–è®¾ç½®\"></a>10.å…¶ä»–è®¾ç½®</h2><p>è¿›å…¥åå°ç®¡ç† -&gt; ç½‘ç«™ç®¡ç† -&gt; å…¶ä»–è®¾ç½®ï¼Œé…ç½®websocketåŸŸå<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a97b2594f13b2928072728067ac68968.png\" alt=\"image.png\"></p>\n<h2 id=\"11-æ€»ç»“\"><a href=\"#11-æ€»ç»“\" class=\"headerlink\" title=\"11.æ€»ç»“\"></a>11.æ€»ç»“</h2><p>æ•´ä¸ªå‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ•™ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸå•¦ï¼Œç¬¬ä¸€æ¬¡éƒ¨ç½²å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡åé¢å°±è½»è½¦ç†Ÿè·¯äº†ï¼Œæœ‰é—®é¢˜çš„å¯ä»¥ç§èŠé—®æˆ‘æˆ–è€…åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>\n"},{"title":"SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜","date":"2022-02-14T09:35:40.000Z","_content":"\nã€€ã€€åœ¨å‰åç«¯å¼€å‘æ—¶ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·è®¤è¯å‘¢ï¼ŸåŸå› æ˜¯ç”±äºHTTPåå®šæ˜¯ä¸å­˜å‚¨çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€å½“æˆ‘ä»¬é€è¿‡è´¦å·å¯†ç éªŒè¯ä¸€ä¸ªä½¿ç”¨è€…æ—¶ï¼Œå½“ä¸‹ä¸€ä¸ªrequestè¯·æ±‚æ—¶ä»–å°±æŠŠåˆšåˆšçš„èµ„æ–™å¿˜è®°äº†ã€‚äºæ˜¯æˆ‘ä»¬çš„ç¨‹åºå°±ä¸çŸ¥é“è°æ˜¯è°äº†ã€‚ æ‰€ä»¥ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å®‰å…¨ï¼Œå°±éœ€è¦éªŒè¯ç”¨æˆ·æ˜¯å¦å¤„äºç™»é™†çŠ¶æ€ã€‚\n\n# ä¸€ã€JWTçš„ç»„æˆ\n\nJWTç”±Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ç”¨.åˆ†éš”ã€‚\n\nä¸‹é¢å°±æ˜¯ä¸€ä¸ªjwtçœŸå®çš„æ ·å­ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯é‡Œé¢å´å­˜å‚¨äº†å¾ˆé‡è¦çš„ä¿¡æ¯ã€‚\n\n```java\neyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyYXljaGVuIiwiaWQiOjIsIm5hbWUiOiJyYXkiLCJwYXNzd29yZCI6IjMyMSIsImlhdCI6MTU5MDI5OTU0OCwiZXhwIjoxNTkwMzg1OTQ4fQ.ORJNldDIfffg7D3_xu0_dBWb16y4fPLtw_r6qgScFpQ\n```\nHeaderï¼š\n> ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œalgä¸typ,ç¬¬ä¸€ä¸ªæŒ‡å®šçš„æ˜¯ç®—æ³•ï¼Œç¬¬äºŒæŒ‡å®šçš„æ˜¯ç±»å‹ã€‚\n\nPayload\n> ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸»ä½“ä¿¡æ¯ç»„æˆ,ç”¨æ¥å­˜å‚¨JWTåŸºæœ¬ä¿¡æ¯ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬çš„ä¿¡æ¯ã€‚\n\nSignature\n> ç¬¬ä¸‰éƒ¨åˆ†ä¸»è¦æ˜¯ç»™ç¬¬ä¸€éƒ¨åˆ†è·Ÿç¬¬äºŒéƒ¨è¿›è¡Œç­¾åä½¿ç”¨çš„,ç”¨æ¥éªŒè¯æ˜¯å¦æ˜¯æˆ‘ä»¬æœåŠ¡å™¨å‘èµ·çš„Tokenï¼Œsecretæ˜¯æˆ‘ä»¬çš„å¯†é’¥ã€‚\n\n# äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\n\nå…·ä½“æµç¨‹ï¼š\n\n-  æŠŠç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å‘åˆ°åç«¯\n-  åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸä¼šç”Ÿæˆtoken, æŠŠtokenå‘é€ç»™å®¢æˆ·ç«¯\n-  å®¢æˆ·ç«¯è‡ªå·±ä¿å­˜token, å†æ¬¡è¯·æ±‚å°±è¦åœ¨Httpåè®®çš„è¯·æ±‚å¤´ä¸­å¸¦ç€tokenå»è®¿é—®æœåŠ¡ç«¯ï¼Œå’Œåœ¨æœåŠ¡ç«¯ä¿å­˜çš„tokenä¿¡æ¯è¿›è¡Œæ¯”å¯¹æ ¡éªŒã€‚\n\n1.å…ˆå¼•å…¥jaråŒ…\n```xml\n<dependency>\n   <groupId>io.jsonwebtoken</groupId>\n   <artifactId>jjwt</artifactId>\n   <version>0.9.1</version>\n</dependency>\n```\n2.ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenå’ŒéªŒè¯tokenï¼ˆç”Ÿæˆtokenæ–¹æ³•ä¸­å­˜å…¥äº†ç”¨æˆ·çš„ä¿¡æ¯ï¼‰\n\n```java\npublic class JwtUtils {\n\n    //å‘è¡Œè€…\n    public static final String SUBJECT=\"raychen\";\n    //è¿‡æœŸæ—¶é—´ ä¸€å¤©\n    public static final long EXPIRE=1000*60*60*24;\n    //å¯†é’¥\n    public static final String APPSECRET=\"raychen11\";\n\n    /**\n     * ç”Ÿæˆjwt\n     * @param user\n     * @return\n     */\n    public static String geneJsonWebToken(User user){\n        if(user==null || user.getId()==null || user.getName()==null || user.getPassword()==null){\n            return null;\n        }\n        String token=Jwts.builder().setSubject(SUBJECT)\n                .claim(\"id\",user.getId())\n                .claim(\"name\",user.getName())\n                .claim(\"password\",user.getPassword())\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis()+EXPIRE))\n                .signWith(SignatureAlgorithm.HS256,APPSECRET).compact();\n\n        return token;\n    }\n\n    /**\n     * æ ¡éªŒtoken\n     * @param token\n     * @return\n     */\n    public static Claims checkJWT(String token){\n        //ä»¿é€ çš„tokenæˆ–è€…å·²è¿‡æœŸå°±ä¼šæŠ¥é”™\n        try {\n            final Claims claims=Jwts.parser().setSigningKey(APPSECRET).parseClaimsJws(token).getBody();\n            return claims;\n        }catch (Exception e){\n            System.out.println(\"catch...\");\n        }\n        return null;\n    }\n}\n```\n3.è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¿›è¡ŒtokenéªŒè¯ï¼‰\n```java\n@Target({ElementType.METHOD, ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface CheckToken {\n    boolean required() default true;\n}\n```\n4.ç¼–å†™configï¼Œå°†åå°æ‰€æœ‰è¯·æ±‚å…ˆå»æ‹¦æˆªå™¨ï¼ˆæ‹¦æˆªå™¨è¿”å›äº†trueï¼Œç”¨æˆ·æ‰å¯ä»¥è¯·æ±‚åˆ°æ¥å£ï¼‰\n```java\n@Configuration\npublic class InterceptorConfig implements WebMvcConfigurer {\n\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(authenticationInterceptor())\n                .addPathPatterns(\"/**\");    // æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•\n    }\n\n    @Bean\n    public AuthenticationInterceptor authenticationInterceptor() {\n        return new AuthenticationInterceptor();\n    }\n}\n```\n5.å®šä¹‰æ‹¦æˆªå™¨ï¼ˆå¯¹éœ€è¦tokenéªŒè¯çš„è¯·æ±‚ï¼Œè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›falseæ— æ³•è¯·æ±‚åˆ°æ¥å£ï¼‰\n```java\npublic class AuthenticationInterceptor implements HandlerInterceptor {\n\n    public static final Gson gson=new Gson();\n    /**\n     * è¿›å…¥controllerä¹‹å‰è¿›è¡Œæ‹¦æˆª\n     * @param request\n     * @param response\n     * @param object\n     * @return\n     */\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object object) throws Exception {\n        // å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡\n        if (!(object instanceof HandlerMethod)) {\n            return true;\n        }\n\n        HandlerMethod handlerMethod = (HandlerMethod) object;\n        Method method = handlerMethod.getMethod();\n        //æ£€æŸ¥æ˜¯å¦æœ‰LoginTokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯\n        if (method.isAnnotationPresent(LoginToken.class)) {\n            LoginToken loginToken = method.getAnnotation(LoginToken.class);\n            if (loginToken.required()) {\n                return true;\n            }\n        }\n\n        //å‰é¢æ˜¯ä¸éœ€è¦tokenéªŒè¯çš„ ä» http è¯·æ±‚å¤´ä¸­å–å‡º token\n        String token = request.getHeader(\"token\");\n        //æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£\n        if (method.isAnnotationPresent(CheckToken.class)) {\n            CheckToken checkToken = method.getAnnotation(CheckToken.class);\n            if (checkToken.required()) {\n                if(token!=null){\n                    Claims claims= JwtUtils.checkJWT(token);\n                    if(null==claims){\n                        sendJsonMessage(response, JsonData.buildError(\"tokenæœ‰è¯¯\"));\n                        return false;\n                    }\n                    Integer userId= (Integer) claims.get(\"id\");\n                    String name = (String) claims.get(\"name\");\n\n                    request.setAttribute(\"userId\",userId);\n                    request.setAttribute(\"name\",name);\n                    return true;\n                }\n                //tokenä¸ºnullçš„è¯ è¿”å›ä¸€æ®µjsonç»™å‰ç«¯\n                sendJsonMessage(response, JsonData.buildError(\"è¯·ç™»å½•\"));\n                return false;\n            }\n        }\n        //æ²¡æœ‰ä½¿ç”¨æ³¨è§£çš„æ–¹æ³• ç›´æ¥è¿”å›true\n        return true;\n    }\n\n        /**\n         * å“åº”æ•°æ®ç»™å‰ç«¯\n         * @param response\n         * @param obj\n         * @throws IOException\n         */\n        public static void sendJsonMessage (HttpServletResponse response, Object obj) throws IOException {\n            response.setContentType(\"application/json; charset=utf-8\");\n            PrintWriter writer = response.getWriter();\n            writer.print(gson.toJson(obj));\n            writer.close();\n            response.flushBuffer();\n        }\n}\n```\nç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenã€‚tokenåœ¨æœåŠ¡ç«¯ä¸åšå­˜å‚¨ï¼Œç›´æ¥å°†tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œä½¿ç”¨å·¥å…·ç±»æ¥éªŒè¯headeré‡Œçš„tokenæ˜¯å¦åˆæ³•ã€‚\n\né¡¹ç›®ä»£ç åœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)\n","source":"_posts/SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜.md","raw":"---\ntitle: SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜\ndate: 2022-02-14 17:35:40\ntags:\n---\n\nã€€ã€€åœ¨å‰åç«¯å¼€å‘æ—¶ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·è®¤è¯å‘¢ï¼ŸåŸå› æ˜¯ç”±äºHTTPåå®šæ˜¯ä¸å­˜å‚¨çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€å½“æˆ‘ä»¬é€è¿‡è´¦å·å¯†ç éªŒè¯ä¸€ä¸ªä½¿ç”¨è€…æ—¶ï¼Œå½“ä¸‹ä¸€ä¸ªrequestè¯·æ±‚æ—¶ä»–å°±æŠŠåˆšåˆšçš„èµ„æ–™å¿˜è®°äº†ã€‚äºæ˜¯æˆ‘ä»¬çš„ç¨‹åºå°±ä¸çŸ¥é“è°æ˜¯è°äº†ã€‚ æ‰€ä»¥ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å®‰å…¨ï¼Œå°±éœ€è¦éªŒè¯ç”¨æˆ·æ˜¯å¦å¤„äºç™»é™†çŠ¶æ€ã€‚\n\n# ä¸€ã€JWTçš„ç»„æˆ\n\nJWTç”±Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ç”¨.åˆ†éš”ã€‚\n\nä¸‹é¢å°±æ˜¯ä¸€ä¸ªjwtçœŸå®çš„æ ·å­ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯é‡Œé¢å´å­˜å‚¨äº†å¾ˆé‡è¦çš„ä¿¡æ¯ã€‚\n\n```java\neyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyYXljaGVuIiwiaWQiOjIsIm5hbWUiOiJyYXkiLCJwYXNzd29yZCI6IjMyMSIsImlhdCI6MTU5MDI5OTU0OCwiZXhwIjoxNTkwMzg1OTQ4fQ.ORJNldDIfffg7D3_xu0_dBWb16y4fPLtw_r6qgScFpQ\n```\nHeaderï¼š\n> ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œalgä¸typ,ç¬¬ä¸€ä¸ªæŒ‡å®šçš„æ˜¯ç®—æ³•ï¼Œç¬¬äºŒæŒ‡å®šçš„æ˜¯ç±»å‹ã€‚\n\nPayload\n> ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸»ä½“ä¿¡æ¯ç»„æˆ,ç”¨æ¥å­˜å‚¨JWTåŸºæœ¬ä¿¡æ¯ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬çš„ä¿¡æ¯ã€‚\n\nSignature\n> ç¬¬ä¸‰éƒ¨åˆ†ä¸»è¦æ˜¯ç»™ç¬¬ä¸€éƒ¨åˆ†è·Ÿç¬¬äºŒéƒ¨è¿›è¡Œç­¾åä½¿ç”¨çš„,ç”¨æ¥éªŒè¯æ˜¯å¦æ˜¯æˆ‘ä»¬æœåŠ¡å™¨å‘èµ·çš„Tokenï¼Œsecretæ˜¯æˆ‘ä»¬çš„å¯†é’¥ã€‚\n\n# äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\n\nå…·ä½“æµç¨‹ï¼š\n\n-  æŠŠç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å‘åˆ°åç«¯\n-  åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸä¼šç”Ÿæˆtoken, æŠŠtokenå‘é€ç»™å®¢æˆ·ç«¯\n-  å®¢æˆ·ç«¯è‡ªå·±ä¿å­˜token, å†æ¬¡è¯·æ±‚å°±è¦åœ¨Httpåè®®çš„è¯·æ±‚å¤´ä¸­å¸¦ç€tokenå»è®¿é—®æœåŠ¡ç«¯ï¼Œå’Œåœ¨æœåŠ¡ç«¯ä¿å­˜çš„tokenä¿¡æ¯è¿›è¡Œæ¯”å¯¹æ ¡éªŒã€‚\n\n1.å…ˆå¼•å…¥jaråŒ…\n```xml\n<dependency>\n   <groupId>io.jsonwebtoken</groupId>\n   <artifactId>jjwt</artifactId>\n   <version>0.9.1</version>\n</dependency>\n```\n2.ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenå’ŒéªŒè¯tokenï¼ˆç”Ÿæˆtokenæ–¹æ³•ä¸­å­˜å…¥äº†ç”¨æˆ·çš„ä¿¡æ¯ï¼‰\n\n```java\npublic class JwtUtils {\n\n    //å‘è¡Œè€…\n    public static final String SUBJECT=\"raychen\";\n    //è¿‡æœŸæ—¶é—´ ä¸€å¤©\n    public static final long EXPIRE=1000*60*60*24;\n    //å¯†é’¥\n    public static final String APPSECRET=\"raychen11\";\n\n    /**\n     * ç”Ÿæˆjwt\n     * @param user\n     * @return\n     */\n    public static String geneJsonWebToken(User user){\n        if(user==null || user.getId()==null || user.getName()==null || user.getPassword()==null){\n            return null;\n        }\n        String token=Jwts.builder().setSubject(SUBJECT)\n                .claim(\"id\",user.getId())\n                .claim(\"name\",user.getName())\n                .claim(\"password\",user.getPassword())\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis()+EXPIRE))\n                .signWith(SignatureAlgorithm.HS256,APPSECRET).compact();\n\n        return token;\n    }\n\n    /**\n     * æ ¡éªŒtoken\n     * @param token\n     * @return\n     */\n    public static Claims checkJWT(String token){\n        //ä»¿é€ çš„tokenæˆ–è€…å·²è¿‡æœŸå°±ä¼šæŠ¥é”™\n        try {\n            final Claims claims=Jwts.parser().setSigningKey(APPSECRET).parseClaimsJws(token).getBody();\n            return claims;\n        }catch (Exception e){\n            System.out.println(\"catch...\");\n        }\n        return null;\n    }\n}\n```\n3.è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¿›è¡ŒtokenéªŒè¯ï¼‰\n```java\n@Target({ElementType.METHOD, ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface CheckToken {\n    boolean required() default true;\n}\n```\n4.ç¼–å†™configï¼Œå°†åå°æ‰€æœ‰è¯·æ±‚å…ˆå»æ‹¦æˆªå™¨ï¼ˆæ‹¦æˆªå™¨è¿”å›äº†trueï¼Œç”¨æˆ·æ‰å¯ä»¥è¯·æ±‚åˆ°æ¥å£ï¼‰\n```java\n@Configuration\npublic class InterceptorConfig implements WebMvcConfigurer {\n\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(authenticationInterceptor())\n                .addPathPatterns(\"/**\");    // æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•\n    }\n\n    @Bean\n    public AuthenticationInterceptor authenticationInterceptor() {\n        return new AuthenticationInterceptor();\n    }\n}\n```\n5.å®šä¹‰æ‹¦æˆªå™¨ï¼ˆå¯¹éœ€è¦tokenéªŒè¯çš„è¯·æ±‚ï¼Œè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›falseæ— æ³•è¯·æ±‚åˆ°æ¥å£ï¼‰\n```java\npublic class AuthenticationInterceptor implements HandlerInterceptor {\n\n    public static final Gson gson=new Gson();\n    /**\n     * è¿›å…¥controllerä¹‹å‰è¿›è¡Œæ‹¦æˆª\n     * @param request\n     * @param response\n     * @param object\n     * @return\n     */\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object object) throws Exception {\n        // å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡\n        if (!(object instanceof HandlerMethod)) {\n            return true;\n        }\n\n        HandlerMethod handlerMethod = (HandlerMethod) object;\n        Method method = handlerMethod.getMethod();\n        //æ£€æŸ¥æ˜¯å¦æœ‰LoginTokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯\n        if (method.isAnnotationPresent(LoginToken.class)) {\n            LoginToken loginToken = method.getAnnotation(LoginToken.class);\n            if (loginToken.required()) {\n                return true;\n            }\n        }\n\n        //å‰é¢æ˜¯ä¸éœ€è¦tokenéªŒè¯çš„ ä» http è¯·æ±‚å¤´ä¸­å–å‡º token\n        String token = request.getHeader(\"token\");\n        //æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£\n        if (method.isAnnotationPresent(CheckToken.class)) {\n            CheckToken checkToken = method.getAnnotation(CheckToken.class);\n            if (checkToken.required()) {\n                if(token!=null){\n                    Claims claims= JwtUtils.checkJWT(token);\n                    if(null==claims){\n                        sendJsonMessage(response, JsonData.buildError(\"tokenæœ‰è¯¯\"));\n                        return false;\n                    }\n                    Integer userId= (Integer) claims.get(\"id\");\n                    String name = (String) claims.get(\"name\");\n\n                    request.setAttribute(\"userId\",userId);\n                    request.setAttribute(\"name\",name);\n                    return true;\n                }\n                //tokenä¸ºnullçš„è¯ è¿”å›ä¸€æ®µjsonç»™å‰ç«¯\n                sendJsonMessage(response, JsonData.buildError(\"è¯·ç™»å½•\"));\n                return false;\n            }\n        }\n        //æ²¡æœ‰ä½¿ç”¨æ³¨è§£çš„æ–¹æ³• ç›´æ¥è¿”å›true\n        return true;\n    }\n\n        /**\n         * å“åº”æ•°æ®ç»™å‰ç«¯\n         * @param response\n         * @param obj\n         * @throws IOException\n         */\n        public static void sendJsonMessage (HttpServletResponse response, Object obj) throws IOException {\n            response.setContentType(\"application/json; charset=utf-8\");\n            PrintWriter writer = response.getWriter();\n            writer.print(gson.toJson(obj));\n            writer.close();\n            response.flushBuffer();\n        }\n}\n```\nç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenã€‚tokenåœ¨æœåŠ¡ç«¯ä¸åšå­˜å‚¨ï¼Œç›´æ¥å°†tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œä½¿ç”¨å·¥å…·ç±»æ¥éªŒè¯headeré‡Œçš„tokenæ˜¯å¦åˆæ³•ã€‚\n\né¡¹ç›®ä»£ç åœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)\n","slug":"SpringBootä½¿ç”¨Jwtå¤„ç†è·¨åŸŸè®¤è¯é—®é¢˜","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dm000pwen1fyob8be4","content":"<p>ã€€ã€€åœ¨å‰åç«¯å¼€å‘æ—¶ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·è®¤è¯å‘¢ï¼ŸåŸå› æ˜¯ç”±äºHTTPåå®šæ˜¯ä¸å­˜å‚¨çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€å½“æˆ‘ä»¬é€è¿‡è´¦å·å¯†ç éªŒè¯ä¸€ä¸ªä½¿ç”¨è€…æ—¶ï¼Œå½“ä¸‹ä¸€ä¸ªrequestè¯·æ±‚æ—¶ä»–å°±æŠŠåˆšåˆšçš„èµ„æ–™å¿˜è®°äº†ã€‚äºæ˜¯æˆ‘ä»¬çš„ç¨‹åºå°±ä¸çŸ¥é“è°æ˜¯è°äº†ã€‚ æ‰€ä»¥ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å®‰å…¨ï¼Œå°±éœ€è¦éªŒè¯ç”¨æˆ·æ˜¯å¦å¤„äºç™»é™†çŠ¶æ€ã€‚</p>\n<h1 id=\"ä¸€ã€JWTçš„ç»„æˆ\"><a href=\"#ä¸€ã€JWTçš„ç»„æˆ\" class=\"headerlink\" title=\"ä¸€ã€JWTçš„ç»„æˆ\"></a>ä¸€ã€JWTçš„ç»„æˆ</h1><p>JWTç”±Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ç”¨.åˆ†éš”ã€‚</p>\n<p>ä¸‹é¢å°±æ˜¯ä¸€ä¸ªjwtçœŸå®çš„æ ·å­ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯é‡Œé¢å´å­˜å‚¨äº†å¾ˆé‡è¦çš„ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyYXljaGVuIiwiaWQiOjIsIm5hbWUiOiJyYXkiLCJwYXNzd29yZCI6IjMyMSIsImlhdCI6MTU5MDI5OTU0OCwiZXhwIjoxNTkwMzg1OTQ4fQ.ORJNldDIfffg7D3_xu0_dBWb16y4fPLtw_r6qgScFpQ</span><br></pre></td></tr></table></figure>\n<p>Headerï¼š</p>\n<blockquote>\n<p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œalgä¸typ,ç¬¬ä¸€ä¸ªæŒ‡å®šçš„æ˜¯ç®—æ³•ï¼Œç¬¬äºŒæŒ‡å®šçš„æ˜¯ç±»å‹ã€‚</p>\n</blockquote>\n<p>Payload</p>\n<blockquote>\n<p>ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸»ä½“ä¿¡æ¯ç»„æˆ,ç”¨æ¥å­˜å‚¨JWTåŸºæœ¬ä¿¡æ¯ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬çš„ä¿¡æ¯ã€‚</p>\n</blockquote>\n<p>Signature</p>\n<blockquote>\n<p>ç¬¬ä¸‰éƒ¨åˆ†ä¸»è¦æ˜¯ç»™ç¬¬ä¸€éƒ¨åˆ†è·Ÿç¬¬äºŒéƒ¨è¿›è¡Œç­¾åä½¿ç”¨çš„,ç”¨æ¥éªŒè¯æ˜¯å¦æ˜¯æˆ‘ä»¬æœåŠ¡å™¨å‘èµ·çš„Tokenï¼Œsecretæ˜¯æˆ‘ä»¬çš„å¯†é’¥ã€‚</p>\n</blockquote>\n<h1 id=\"äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\"><a href=\"#äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\" class=\"headerlink\" title=\"äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\"></a>äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯</h1><p>å…·ä½“æµç¨‹ï¼š</p>\n<ul>\n<li>æŠŠç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å‘åˆ°åç«¯</li>\n<li>åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸä¼šç”Ÿæˆtoken, æŠŠtokenå‘é€ç»™å®¢æˆ·ç«¯</li>\n<li>å®¢æˆ·ç«¯è‡ªå·±ä¿å­˜token, å†æ¬¡è¯·æ±‚å°±è¦åœ¨Httpåè®®çš„è¯·æ±‚å¤´ä¸­å¸¦ç€tokenå»è®¿é—®æœåŠ¡ç«¯ï¼Œå’Œåœ¨æœåŠ¡ç«¯ä¿å­˜çš„tokenä¿¡æ¯è¿›è¡Œæ¯”å¯¹æ ¡éªŒã€‚</li>\n</ul>\n<p>1.å…ˆå¼•å…¥jaråŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.9.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2.ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenå’ŒéªŒè¯tokenï¼ˆç”Ÿæˆtokenæ–¹æ³•ä¸­å­˜å…¥äº†ç”¨æˆ·çš„ä¿¡æ¯ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//å‘è¡Œè€…</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SUBJECT=<span class=\"string\">&quot;raychen&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//è¿‡æœŸæ—¶é—´ ä¸€å¤©</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> EXPIRE=<span class=\"number\">1000</span>*<span class=\"number\">60</span>*<span class=\"number\">60</span>*<span class=\"number\">24</span>;</span><br><span class=\"line\">    <span class=\"comment\">//å¯†é’¥</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String APPSECRET=<span class=\"string\">&quot;raychen11&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç”Ÿæˆjwt</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> user</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">geneJsonWebToken</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(user==<span class=\"literal\">null</span> || user.getId()==<span class=\"literal\">null</span> || user.getName()==<span class=\"literal\">null</span> || user.getPassword()==<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        String token=Jwts.builder().setSubject(SUBJECT)</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;id&quot;</span>,user.getId())</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;name&quot;</span>,user.getName())</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;password&quot;</span>,user.getPassword())</span><br><span class=\"line\">                .setIssuedAt(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>())</span><br><span class=\"line\">                .setExpiration(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(System.currentTimeMillis()+EXPIRE))</span><br><span class=\"line\">                .signWith(SignatureAlgorithm.HS256,APPSECRET).compact();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ ¡éªŒtoken</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> token</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Claims <span class=\"title function_\">checkJWT</span><span class=\"params\">(String token)</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä»¿é€ çš„tokenæˆ–è€…å·²è¿‡æœŸå°±ä¼šæŠ¥é”™</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Claims claims=Jwts.parser().setSigningKey(APPSECRET).parseClaimsJws(token).getBody();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> claims;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;catch...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3.è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¿›è¡ŒtokenéªŒè¯ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> CheckToken &#123;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">required</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>4.ç¼–å†™configï¼Œå°†åå°æ‰€æœ‰è¯·æ±‚å…ˆå»æ‹¦æˆªå™¨ï¼ˆæ‹¦æˆªå™¨è¿”å›äº†trueï¼Œç”¨æˆ·æ‰å¯ä»¥è¯·æ±‚åˆ°æ¥å£ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterceptorConfig</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">WebMvcConfigurer</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addInterceptors</span><span class=\"params\">(InterceptorRegistry registry)</span> &#123;</span><br><span class=\"line\">        registry.addInterceptor(authenticationInterceptor())</span><br><span class=\"line\">                .addPathPatterns(<span class=\"string\">&quot;/**&quot;</span>);    <span class=\"comment\">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AuthenticationInterceptor <span class=\"title function_\">authenticationInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AuthenticationInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>5.å®šä¹‰æ‹¦æˆªå™¨ï¼ˆå¯¹éœ€è¦tokenéªŒè¯çš„è¯·æ±‚ï¼Œè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›falseæ— æ³•è¯·æ±‚åˆ°æ¥å£ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AuthenticationInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">HandlerInterceptor</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Gson gson=<span class=\"keyword\">new</span> <span class=\"title class_\">Gson</span>();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¿›å…¥controllerä¹‹å‰è¿›è¡Œæ‹¦æˆª</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">preHandle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object object)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!(object <span class=\"keyword\">instanceof</span> HandlerMethod)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">HandlerMethod</span> <span class=\"variable\">handlerMethod</span> <span class=\"operator\">=</span> (HandlerMethod) object;</span><br><span class=\"line\">        <span class=\"type\">Method</span> <span class=\"variable\">method</span> <span class=\"operator\">=</span> handlerMethod.getMethod();</span><br><span class=\"line\">        <span class=\"comment\">//æ£€æŸ¥æ˜¯å¦æœ‰LoginTokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (method.isAnnotationPresent(LoginToken.class)) &#123;</span><br><span class=\"line\">            <span class=\"type\">LoginToken</span> <span class=\"variable\">loginToken</span> <span class=\"operator\">=</span> method.getAnnotation(LoginToken.class);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (loginToken.required()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//å‰é¢æ˜¯ä¸éœ€è¦tokenéªŒè¯çš„ ä» http è¯·æ±‚å¤´ä¸­å–å‡º token</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">token</span> <span class=\"operator\">=</span> request.getHeader(<span class=\"string\">&quot;token&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (method.isAnnotationPresent(CheckToken.class)) &#123;</span><br><span class=\"line\">            <span class=\"type\">CheckToken</span> <span class=\"variable\">checkToken</span> <span class=\"operator\">=</span> method.getAnnotation(CheckToken.class);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (checkToken.required()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(token!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                    Claims claims= JwtUtils.checkJWT(token);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(<span class=\"literal\">null</span>==claims)&#123;</span><br><span class=\"line\">                        sendJsonMessage(response, JsonData.buildError(<span class=\"string\">&quot;tokenæœ‰è¯¯&quot;</span>));</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    Integer userId= (Integer) claims.get(<span class=\"string\">&quot;id&quot;</span>);</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> (String) claims.get(<span class=\"string\">&quot;name&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                    request.setAttribute(<span class=\"string\">&quot;userId&quot;</span>,userId);</span><br><span class=\"line\">                    request.setAttribute(<span class=\"string\">&quot;name&quot;</span>,name);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">//tokenä¸ºnullçš„è¯ è¿”å›ä¸€æ®µjsonç»™å‰ç«¯</span></span><br><span class=\"line\">                sendJsonMessage(response, JsonData.buildError(<span class=\"string\">&quot;è¯·ç™»å½•&quot;</span>));</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//æ²¡æœ‰ä½¿ç”¨æ³¨è§£çš„æ–¹æ³• ç›´æ¥è¿”å›true</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * å“åº”æ•°æ®ç»™å‰ç«¯</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> obj</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@throws</span> IOException</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendJsonMessage</span> <span class=\"params\">(HttpServletResponse response, Object obj)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">            response.setContentType(<span class=\"string\">&quot;application/json; charset=utf-8&quot;</span>);</span><br><span class=\"line\">            <span class=\"type\">PrintWriter</span> <span class=\"variable\">writer</span> <span class=\"operator\">=</span> response.getWriter();</span><br><span class=\"line\">            writer.print(gson.toJson(obj));</span><br><span class=\"line\">            writer.close();</span><br><span class=\"line\">            response.flushBuffer();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenã€‚tokenåœ¨æœåŠ¡ç«¯ä¸åšå­˜å‚¨ï¼Œç›´æ¥å°†tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œä½¿ç”¨å·¥å…·ç±»æ¥éªŒè¯headeré‡Œçš„tokenæ˜¯å¦åˆæ³•ã€‚</p>\n<p>é¡¹ç›®ä»£ç åœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n","excerpt":"","more":"<p>ã€€ã€€åœ¨å‰åç«¯å¼€å‘æ—¶ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·è®¤è¯å‘¢ï¼ŸåŸå› æ˜¯ç”±äºHTTPåå®šæ˜¯ä¸å­˜å‚¨çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€å½“æˆ‘ä»¬é€è¿‡è´¦å·å¯†ç éªŒè¯ä¸€ä¸ªä½¿ç”¨è€…æ—¶ï¼Œå½“ä¸‹ä¸€ä¸ªrequestè¯·æ±‚æ—¶ä»–å°±æŠŠåˆšåˆšçš„èµ„æ–™å¿˜è®°äº†ã€‚äºæ˜¯æˆ‘ä»¬çš„ç¨‹åºå°±ä¸çŸ¥é“è°æ˜¯è°äº†ã€‚ æ‰€ä»¥ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å®‰å…¨ï¼Œå°±éœ€è¦éªŒè¯ç”¨æˆ·æ˜¯å¦å¤„äºç™»é™†çŠ¶æ€ã€‚</p>\n<h1 id=\"ä¸€ã€JWTçš„ç»„æˆ\"><a href=\"#ä¸€ã€JWTçš„ç»„æˆ\" class=\"headerlink\" title=\"ä¸€ã€JWTçš„ç»„æˆ\"></a>ä¸€ã€JWTçš„ç»„æˆ</h1><p>JWTç”±Headerã€Payloadã€Signatureä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ç”¨.åˆ†éš”ã€‚</p>\n<p>ä¸‹é¢å°±æ˜¯ä¸€ä¸ªjwtçœŸå®çš„æ ·å­ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯é‡Œé¢å´å­˜å‚¨äº†å¾ˆé‡è¦çš„ä¿¡æ¯ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJyYXljaGVuIiwiaWQiOjIsIm5hbWUiOiJyYXkiLCJwYXNzd29yZCI6IjMyMSIsImlhdCI6MTU5MDI5OTU0OCwiZXhwIjoxNTkwMzg1OTQ4fQ.ORJNldDIfffg7D3_xu0_dBWb16y4fPLtw_r6qgScFpQ</span><br></pre></td></tr></table></figure>\n<p>Headerï¼š</p>\n<blockquote>\n<p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œalgä¸typ,ç¬¬ä¸€ä¸ªæŒ‡å®šçš„æ˜¯ç®—æ³•ï¼Œç¬¬äºŒæŒ‡å®šçš„æ˜¯ç±»å‹ã€‚</p>\n</blockquote>\n<p>Payload</p>\n<blockquote>\n<p>ç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸»ä½“ä¿¡æ¯ç»„æˆ,ç”¨æ¥å­˜å‚¨JWTåŸºæœ¬ä¿¡æ¯ï¼Œæˆ–è€…æ˜¯æˆ‘ä»¬çš„ä¿¡æ¯ã€‚</p>\n</blockquote>\n<p>Signature</p>\n<blockquote>\n<p>ç¬¬ä¸‰éƒ¨åˆ†ä¸»è¦æ˜¯ç»™ç¬¬ä¸€éƒ¨åˆ†è·Ÿç¬¬äºŒéƒ¨è¿›è¡Œç­¾åä½¿ç”¨çš„,ç”¨æ¥éªŒè¯æ˜¯å¦æ˜¯æˆ‘ä»¬æœåŠ¡å™¨å‘èµ·çš„Tokenï¼Œsecretæ˜¯æˆ‘ä»¬çš„å¯†é’¥ã€‚</p>\n</blockquote>\n<h1 id=\"äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\"><a href=\"#äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\" class=\"headerlink\" title=\"äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯\"></a>äºŒã€åœ¨springbooté¡¹ç›®ä¸­ä½¿ç”¨jwtåšéªŒè¯</h1><p>å…·ä½“æµç¨‹ï¼š</p>\n<ul>\n<li>æŠŠç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç å‘åˆ°åç«¯</li>\n<li>åç«¯è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸä¼šç”Ÿæˆtoken, æŠŠtokenå‘é€ç»™å®¢æˆ·ç«¯</li>\n<li>å®¢æˆ·ç«¯è‡ªå·±ä¿å­˜token, å†æ¬¡è¯·æ±‚å°±è¦åœ¨Httpåè®®çš„è¯·æ±‚å¤´ä¸­å¸¦ç€tokenå»è®¿é—®æœåŠ¡ç«¯ï¼Œå’Œåœ¨æœåŠ¡ç«¯ä¿å­˜çš„tokenä¿¡æ¯è¿›è¡Œæ¯”å¯¹æ ¡éªŒã€‚</li>\n</ul>\n<p>1.å…ˆå¼•å…¥jaråŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.9.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2.ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenå’ŒéªŒè¯tokenï¼ˆç”Ÿæˆtokenæ–¹æ³•ä¸­å­˜å…¥äº†ç”¨æˆ·çš„ä¿¡æ¯ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//å‘è¡Œè€…</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String SUBJECT=<span class=\"string\">&quot;raychen&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//è¿‡æœŸæ—¶é—´ ä¸€å¤©</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> EXPIRE=<span class=\"number\">1000</span>*<span class=\"number\">60</span>*<span class=\"number\">60</span>*<span class=\"number\">24</span>;</span><br><span class=\"line\">    <span class=\"comment\">//å¯†é’¥</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String APPSECRET=<span class=\"string\">&quot;raychen11&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ç”Ÿæˆjwt</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> user</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">geneJsonWebToken</span><span class=\"params\">(User user)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(user==<span class=\"literal\">null</span> || user.getId()==<span class=\"literal\">null</span> || user.getName()==<span class=\"literal\">null</span> || user.getPassword()==<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        String token=Jwts.builder().setSubject(SUBJECT)</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;id&quot;</span>,user.getId())</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;name&quot;</span>,user.getName())</span><br><span class=\"line\">                .claim(<span class=\"string\">&quot;password&quot;</span>,user.getPassword())</span><br><span class=\"line\">                .setIssuedAt(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>())</span><br><span class=\"line\">                .setExpiration(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(System.currentTimeMillis()+EXPIRE))</span><br><span class=\"line\">                .signWith(SignatureAlgorithm.HS256,APPSECRET).compact();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> token;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ ¡éªŒtoken</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> token</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Claims <span class=\"title function_\">checkJWT</span><span class=\"params\">(String token)</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä»¿é€ çš„tokenæˆ–è€…å·²è¿‡æœŸå°±ä¼šæŠ¥é”™</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Claims claims=Jwts.parser().setSigningKey(APPSECRET).parseClaimsJws(token).getBody();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> claims;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;catch...&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3.è‡ªå®šä¹‰æ³¨è§£ï¼ˆè¿›è¡ŒtokenéªŒè¯ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> CheckToken &#123;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">required</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>4.ç¼–å†™configï¼Œå°†åå°æ‰€æœ‰è¯·æ±‚å…ˆå»æ‹¦æˆªå™¨ï¼ˆæ‹¦æˆªå™¨è¿”å›äº†trueï¼Œç”¨æˆ·æ‰å¯ä»¥è¯·æ±‚åˆ°æ¥å£ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">InterceptorConfig</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">WebMvcConfigurer</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addInterceptors</span><span class=\"params\">(InterceptorRegistry registry)</span> &#123;</span><br><span class=\"line\">        registry.addInterceptor(authenticationInterceptor())</span><br><span class=\"line\">                .addPathPatterns(<span class=\"string\">&quot;/**&quot;</span>);    <span class=\"comment\">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> AuthenticationInterceptor <span class=\"title function_\">authenticationInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AuthenticationInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>5.å®šä¹‰æ‹¦æˆªå™¨ï¼ˆå¯¹éœ€è¦tokenéªŒè¯çš„è¯·æ±‚ï¼Œè¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›falseæ— æ³•è¯·æ±‚åˆ°æ¥å£ï¼‰</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AuthenticationInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">HandlerInterceptor</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Gson gson=<span class=\"keyword\">new</span> <span class=\"title class_\">Gson</span>();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è¿›å…¥controllerä¹‹å‰è¿›è¡Œæ‹¦æˆª</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">preHandle</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object object)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// å¦‚æœä¸æ˜¯æ˜ å°„åˆ°æ–¹æ³•ç›´æ¥é€šè¿‡</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!(object <span class=\"keyword\">instanceof</span> HandlerMethod)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">HandlerMethod</span> <span class=\"variable\">handlerMethod</span> <span class=\"operator\">=</span> (HandlerMethod) object;</span><br><span class=\"line\">        <span class=\"type\">Method</span> <span class=\"variable\">method</span> <span class=\"operator\">=</span> handlerMethod.getMethod();</span><br><span class=\"line\">        <span class=\"comment\">//æ£€æŸ¥æ˜¯å¦æœ‰LoginTokenæ³¨é‡Šï¼Œæœ‰åˆ™è·³è¿‡è®¤è¯</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (method.isAnnotationPresent(LoginToken.class)) &#123;</span><br><span class=\"line\">            <span class=\"type\">LoginToken</span> <span class=\"variable\">loginToken</span> <span class=\"operator\">=</span> method.getAnnotation(LoginToken.class);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (loginToken.required()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//å‰é¢æ˜¯ä¸éœ€è¦tokenéªŒè¯çš„ ä» http è¯·æ±‚å¤´ä¸­å–å‡º token</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">token</span> <span class=\"operator\">=</span> request.getHeader(<span class=\"string\">&quot;token&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//æ£€æŸ¥æœ‰æ²¡æœ‰éœ€è¦ç”¨æˆ·æƒé™çš„æ³¨è§£</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (method.isAnnotationPresent(CheckToken.class)) &#123;</span><br><span class=\"line\">            <span class=\"type\">CheckToken</span> <span class=\"variable\">checkToken</span> <span class=\"operator\">=</span> method.getAnnotation(CheckToken.class);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (checkToken.required()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(token!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                    Claims claims= JwtUtils.checkJWT(token);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(<span class=\"literal\">null</span>==claims)&#123;</span><br><span class=\"line\">                        sendJsonMessage(response, JsonData.buildError(<span class=\"string\">&quot;tokenæœ‰è¯¯&quot;</span>));</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    Integer userId= (Integer) claims.get(<span class=\"string\">&quot;id&quot;</span>);</span><br><span class=\"line\">                    <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> (String) claims.get(<span class=\"string\">&quot;name&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                    request.setAttribute(<span class=\"string\">&quot;userId&quot;</span>,userId);</span><br><span class=\"line\">                    request.setAttribute(<span class=\"string\">&quot;name&quot;</span>,name);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">//tokenä¸ºnullçš„è¯ è¿”å›ä¸€æ®µjsonç»™å‰ç«¯</span></span><br><span class=\"line\">                sendJsonMessage(response, JsonData.buildError(<span class=\"string\">&quot;è¯·ç™»å½•&quot;</span>));</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//æ²¡æœ‰ä½¿ç”¨æ³¨è§£çš„æ–¹æ³• ç›´æ¥è¿”å›true</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * å“åº”æ•°æ®ç»™å‰ç«¯</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> obj</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@throws</span> IOException</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendJsonMessage</span> <span class=\"params\">(HttpServletResponse response, Object obj)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">            response.setContentType(<span class=\"string\">&quot;application/json; charset=utf-8&quot;</span>);</span><br><span class=\"line\">            <span class=\"type\">PrintWriter</span> <span class=\"variable\">writer</span> <span class=\"operator\">=</span> response.getWriter();</span><br><span class=\"line\">            writer.print(gson.toJson(obj));</span><br><span class=\"line\">            writer.close();</span><br><span class=\"line\">            response.flushBuffer();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆtokenã€‚tokenåœ¨æœåŠ¡ç«¯ä¸åšå­˜å‚¨ï¼Œç›´æ¥å°†tokenè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œä½¿ç”¨å·¥å…·ç±»æ¥éªŒè¯headeré‡Œçš„tokenæ˜¯å¦åˆæ³•ã€‚</p>\n<p>é¡¹ç›®ä»£ç åœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n"},{"title":"Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬)","date":"2022-02-12T09:35:40.000Z","_content":"\nRedis åœ¨äº’è”ç½‘æŠ€æœ¯å­˜å‚¨æ–¹é¢ä½¿ç”¨å¦‚æ­¤å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰çš„åç«¯æŠ€æœ¯é¢è¯•å®˜éƒ½è¦åœ¨ Redis çš„ä½¿ç”¨å’ŒåŸç†æ–¹é¢å¯¹å°ä¼™ä¼´ä»¬è¿›è¡Œå„ç§åˆéš¾ã€‚ä½œä¸ºä¸€ååœ¨äº’è”ç½‘æŠ€æœ¯è¡Œä¸šæ‰“å‡»è¿‡æˆç™¾ä¸Šåƒåã€è¯·å…è®¸æˆ‘å¤¸å¼ ä¸€ä¸‹ã€‘çš„èµ„æ·±æŠ€æœ¯é¢è¯•å®˜ï¼Œçœ‹è¿‡äº†æ— æ•°è½å¯çš„èº«å½±å¤±æœ›çš„ç¦»å¼€ï¼Œç•¥æ„Ÿæ„§ç–šï¼Œæ•…çŒ®ä¸Šæ­¤æ–‡ï¼Œå¸Œæœ›å„ä½è¯»è€…ä»¥åé¢è¯•åŠ¿å¦‚ç ´ç«¹ï¼Œæ°¸æ— å¤±è´¥ï¼\n\n### Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\n\nå­—ç¬¦ä¸² Stringã€å­—å…¸ Hashã€åˆ—è¡¨ Listã€é›†åˆ Setã€æœ‰åºé›†åˆ SortedSetã€‚\n\nå¦‚æœä½ æ˜¯ Redis ä¸­é«˜çº§ç”¨æˆ·ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢å‡ ç§æ•°æ®ç»“æ„ HyperLogLogã€Geoã€Pub/Subã€‚\n\nå¦‚æœä½ è¯´è¿˜ç©è¿‡ Redis Moduleï¼Œåƒ BloomFilterï¼ŒRedisSearchï¼ŒRedis-MLï¼Œé¢è¯•å®˜å¾—çœ¼ç›å°±å¼€å§‹å‘äº®äº†ã€‚\n\n### ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\n\nå…ˆæ‹¿ setnx æ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨ expire ç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾ã€‚\n\nè¿™æ—¶å€™å¯¹æ–¹ä¼šå‘Šè¯‰ä½ è¯´ä½ å›ç­”å¾—ä¸é”™ï¼Œç„¶åæ¥ç€é—®å¦‚æœåœ¨ setnx ä¹‹åæ‰§è¡Œ expire ä¹‹å‰è¿›ç¨‹æ„å¤– crash æˆ–è€…è¦é‡å¯ç»´æŠ¤äº†ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿ\n\nè¿™æ—¶å€™ä½ è¦ç»™äºˆæƒŠè®¶çš„åé¦ˆï¼šå”‰ï¼Œæ˜¯å–”ï¼Œè¿™ä¸ªé”å°±æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾äº†ã€‚ç´§æ¥ç€ä½ éœ€è¦æŠ“ä¸€æŠ“è‡ªå·±å¾—è„‘è¢‹ï¼Œæ•…ä½œæ€è€ƒç‰‡åˆ»ï¼Œå¥½åƒæ¥ä¸‹æ¥çš„ç»“æœæ˜¯ä½ ä¸»åŠ¨æ€è€ƒå‡ºæ¥çš„ï¼Œç„¶åå›ç­”ï¼šæˆ‘è®°å¾— set æŒ‡ä»¤æœ‰éå¸¸å¤æ‚çš„å‚æ•°ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åŒæ—¶æŠŠ setnx å’Œ expire åˆæˆä¸€æ¡æŒ‡ä»¤æ¥ç”¨çš„ï¼å¯¹æ–¹è¿™æ—¶ä¼šæ˜¾éœ²ç¬‘å®¹ï¼Œå¿ƒé‡Œå¼€å§‹é»˜å¿µï¼šæ‘ï¼Œè¿™å°å­è¿˜ä¸é”™ã€‚\n\nå‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10w ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ\n\nä½¿ç”¨ keys æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚\n\nå¯¹æ–¹æ¥ç€è¿½é—®ï¼šå¦‚æœè¿™ä¸ª redis æ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨ keys æŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\nè¿™ä¸ªæ—¶å€™ä½ è¦å›ç­” redis å…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredis çš„å•çº¿ç¨‹çš„ã€‚keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ scan æŒ‡ä»¤ï¼Œscan æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keys æŒ‡ä»¤é•¿ã€‚\n\n### ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\n\nä¸€èˆ¬ä½¿ç”¨ list ç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“ lpop æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“ sleep ä¸€ä¼šå†é‡è¯•ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—®å¯ä¸å¯ä»¥ä¸ç”¨ sleep å‘¢ï¼Ÿlist è¿˜æœ‰ä¸ªæŒ‡ä»¤å« blpopï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—®èƒ½ä¸èƒ½ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡å‘¢ï¼Ÿä½¿ç”¨ pub/sub ä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—® pub/sub æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œå¾—ä½¿ç”¨ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—å¦‚ rabbitmq ç­‰ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—® redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿæˆ‘ä¼°è®¡ç°åœ¨ä½ å¾ˆæƒ³æŠŠé¢è¯•å®˜ä¸€æ£’æ‰“æ­»å¦‚æœä½ æ‰‹ä¸Šæœ‰ä¸€æ ¹æ£’çƒæ£çš„è¯ï¼Œæ€ä¹ˆé—®çš„è¿™ä¹ˆè¯¦ç»†ã€‚ä½†æ˜¯ä½ å¾ˆå…‹åˆ¶ï¼Œç„¶åç¥æ€è‡ªè‹¥çš„å›ç­”é“ï¼šä½¿ç”¨ sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸º scoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸º key è°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨ zrangebyscore æŒ‡ä»¤è·å– N ç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚\n\nåˆ°è¿™é‡Œï¼Œé¢è¯•å®˜æš—åœ°é‡Œå·²ç»å¯¹ä½ ç«–èµ·äº†å¤§æ‹‡æŒ‡ã€‚ä½†æ˜¯ä»–ä¸çŸ¥é“çš„æ˜¯æ­¤åˆ»ä½ å´ç«–èµ·äº†ä¸­æŒ‡ï¼Œåœ¨æ¤…å­èƒŒåã€‚\n\nå¦‚æœæœ‰å¤§é‡çš„ key éœ€è¦è®¾ç½®åŒä¸€æ—¶é—´è¿‡æœŸï¼Œä¸€èˆ¬éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ\n\nå¦‚æœå¤§é‡çš„ key è¿‡æœŸæ—¶é—´è®¾ç½®çš„è¿‡äºé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œredis å¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„å¡é¡¿ç°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚\n\n### Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\n\nbgsave åšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaof åšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸º bgsave ä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ aof æ¥é…åˆä½¿ç”¨ã€‚åœ¨ redis å®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨ bgsave æŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨ aof é‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚\n\nå¯¹æ–¹è¿½é—®é‚£å¦‚æœçªç„¶æœºå™¨æ‰ç”µä¼šæ€æ ·ï¼Ÿå–å†³äº aof æ—¥å¿— sync å±æ€§çš„é…ç½®ï¼Œå¦‚æœä¸è¦æ±‚æ€§èƒ½ï¼Œåœ¨æ¯æ¡å†™æŒ‡ä»¤æ—¶éƒ½ sync ä¸€ä¸‹ç£ç›˜ï¼Œå°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯åœ¨é«˜æ€§èƒ½çš„è¦æ±‚ä¸‹æ¯æ¬¡éƒ½ sync æ˜¯ä¸ç°å®çš„ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å®šæ—¶ syncï¼Œæ¯”å¦‚ 1s1 æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æœ€å¤šå°±ä¼šä¸¢å¤± 1s çš„æ•°æ®ã€‚\n\nå¯¹æ–¹è¿½é—® bgsave çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ ç»™å‡ºä¸¤ä¸ªè¯æ±‡å°±å¯ä»¥äº†ï¼Œfork å’Œ cowã€‚fork æ˜¯æŒ‡ redis é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡Œ bgsave æ“ä½œï¼Œcow æŒ‡çš„æ˜¯ copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚\n\n### Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ\n\nå¯ä»¥å°†å¤šæ¬¡ IO å¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯ pipeline æ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨ redis-benchmark è¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“ redis çš„ QPS å³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯ pipeline æ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚\n\n### Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\n\nRedis å¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡ bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜ bufferï¼Œå¾…å®Œæˆåå°† rdb æ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°† rdb é•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚\n\n### æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nRedis Sentinal ç€çœ¼äºé«˜å¯ç”¨ï¼Œåœ¨ master å®•æœºæ—¶ä¼šè‡ªåŠ¨å°† slave æå‡ä¸º masterï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚\n\nRedis Cluster ç€çœ¼äºæ‰©å±•æ€§ï¼Œåœ¨å•ä¸ª redis å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ Cluster è¿›è¡Œåˆ†ç‰‡å­˜å‚¨ã€‚\n\n## å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\n1ã€ä»€ä¹ˆæ˜¯Redisï¼Ÿ\n\nRedisæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªKey-Valueç±»å‹çš„å†…å­˜æ•°æ®åº“ï¼Œå¾ˆåƒmemcachedï¼Œæ•´ä¸ªæ•°æ®åº“ç»Ÿç»ŸåŠ è½½åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ“ä½œï¼Œå®šæœŸé€šè¿‡å¼‚æ­¥æ“ä½œæŠŠæ•°æ®åº“æ•°æ®flushåˆ°ç¡¬ç›˜ä¸Šè¿›è¡Œä¿å­˜ã€‚å› ä¸ºæ˜¯çº¯å†…å­˜æ“ä½œï¼ŒRedisçš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚ Redisçš„å‡ºè‰²ä¹‹å¤„ä¸ä»…ä»…æ˜¯æ€§èƒ½ï¼ŒRedisæœ€å¤§çš„é­…åŠ›æ˜¯æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œæ­¤å¤–å•ä¸ªvalueçš„æœ€å¤§é™åˆ¶æ˜¯1GBï¼Œä¸åƒ memcachedåªèƒ½ä¿å­˜1MBçš„æ•°æ®ï¼Œå› æ­¤Rediså¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”æ–¹è¯´ç”¨ä»–çš„Listæ¥åšFIFOåŒå‘é“¾è¡¨ï¼Œå®ç°ä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§ èƒ½æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼Œç”¨ä»–çš„Setå¯ä»¥åšé«˜æ€§èƒ½çš„tagç³»ç»Ÿç­‰ç­‰ã€‚å¦å¤–Redisä¹Ÿå¯ä»¥å¯¹å­˜å…¥çš„Key-Valueè®¾ç½®expireæ—¶é—´ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«å½“ä½œä¸€ ä¸ªåŠŸèƒ½åŠ å¼ºç‰ˆçš„memcachedæ¥ç”¨ã€‚ Redisçš„ä¸»è¦ç¼ºç‚¹æ˜¯æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚\n\n2ã€Redisç›¸æ¯”memcachedæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ\n\n(1) memcachedæ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œredisä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹\n\n(2) redisçš„é€Ÿåº¦æ¯”memcachedå¿«å¾ˆå¤š\n\n(3) rediså¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®\n\n3ã€Redisæ”¯æŒå“ªå‡ ç§æ•°æ®ç±»å‹ï¼Ÿ\n\nStringã€Listã€Setã€Sorted Setã€hashes\n\n4ã€Redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ\n\nå†…å­˜ã€‚\n\n5ã€Redisçš„å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ\n\nRemote Dictionary Serverã€‚\n\n6ã€Redisæœ‰å“ªå‡ ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼Ÿ\n\nnoeviction:è¿”å›é”™è¯¯å½“å†…å­˜é™åˆ¶è¾¾åˆ°å¹¶ä¸”å®¢æˆ·ç«¯å°è¯•æ‰§è¡Œä¼šè®©æ›´å¤šå†…å­˜è¢«ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†çš„å†™å…¥æŒ‡ä»¤ï¼Œä½†DELå’Œå‡ ä¸ªä¾‹å¤–ï¼‰\n\nallkeys-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nvolatile-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nallkeys-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nvolatile-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®ã€‚\n\nvolatile-ttl: å›æ”¶åœ¨è¿‡æœŸé›†åˆçš„é”®ï¼Œå¹¶ä¸”ä¼˜å…ˆå›æ”¶å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\n7ã€Rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›Windowsç‰ˆæœ¬ï¼Ÿ\n\nå› ä¸ºç›®å‰Linuxç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘windowsç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚\n\n8ã€ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ\n\n512M\n\n9ã€ä¸ºä»€ä¹ˆRediséœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Ÿ\n\nRedisä¸ºäº†è¾¾åˆ°æœ€å¿«çš„è¯»å†™é€Ÿåº¦å°†æ•°æ®éƒ½è¯»åˆ°å†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥rediså…·æœ‰å¿«é€Ÿå’Œæ•°æ®æŒä¹…åŒ–çš„ç‰¹å¾ã€‚å¦‚æœä¸å°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œç£ç›˜I/Oé€Ÿåº¦ä¸ºä¸¥é‡å½±å“redisçš„æ€§èƒ½ã€‚åœ¨å†…å­˜è¶Šæ¥è¶Šä¾¿å®œçš„ä»Šå¤©ï¼Œrediså°†ä¼šè¶Šæ¥è¶Šå—æ¬¢è¿ã€‚ å¦‚æœè®¾ç½®äº†æœ€å¤§ä½¿ç”¨çš„å†…å­˜ï¼Œåˆ™æ•°æ®å·²æœ‰è®°å½•æ•°è¾¾åˆ°å†…å­˜é™å€¼åä¸èƒ½ç»§ç»­æ’å…¥æ–°å€¼ã€‚\n\n10ã€Redisé›†ç¾¤æ–¹æ¡ˆåº”è¯¥æ€ä¹ˆåšï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ\n\n1.twemproxyï¼Œå¤§æ¦‚æ¦‚å¿µæ˜¯ï¼Œå®ƒç±»ä¼¼äºä¸€ä¸ªä»£ç†æ–¹å¼ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ™®é€šredisæ— ä»»ä½•åŒºåˆ«ï¼Œè®¾ç½®å¥½å®ƒä¸‹å±çš„å¤šä¸ªrediså®ä¾‹åï¼Œä½¿ç”¨æ—¶åœ¨æœ¬éœ€è¦è¿æ¥redisçš„åœ°æ–¹æ”¹ä¸ºè¿æ¥twemproxyï¼Œå®ƒä¼šä»¥ä¸€ä¸ªä»£ç†çš„èº«ä»½æ¥æ”¶è¯·æ±‚å¹¶ä½¿ç”¨ä¸€è‡´æ€§hashç®—æ³•ï¼Œå°†è¯·æ±‚è½¬æ¥åˆ°å…·ä½“redisï¼Œå°†ç»“æœå†è¿”å›twemproxyã€‚ä½¿ç”¨æ–¹å¼ç®€ä¾¿(ç›¸å¯¹redisåªéœ€ä¿®æ”¹è¿æ¥ç«¯å£)ï¼Œå¯¹æ—§é¡¹ç›®æ‰©å±•çš„é¦–é€‰ã€‚ é—®é¢˜ï¼štwemproxyè‡ªèº«å•ç«¯å£å®ä¾‹çš„å‹åŠ›ï¼Œä½¿ç”¨ä¸€è‡´æ€§hashåï¼Œå¯¹redisèŠ‚ç‚¹æ•°é‡æ”¹å˜æ—¶å€™çš„è®¡ç®—å€¼çš„æ”¹å˜ï¼Œæ•°æ®æ— æ³•è‡ªåŠ¨ç§»åŠ¨åˆ°æ–°çš„èŠ‚ç‚¹ã€‚\n\n2.codisï¼Œç›®å‰ç”¨çš„æœ€å¤šçš„é›†ç¾¤æ–¹æ¡ˆï¼ŒåŸºæœ¬å’Œtwemproxyä¸€è‡´çš„æ•ˆæœï¼Œä½†å®ƒæ”¯æŒåœ¨ èŠ‚ç‚¹æ•°é‡æ”¹å˜æƒ…å†µä¸‹ï¼Œæ—§èŠ‚ç‚¹æ•°æ®å¯æ¢å¤åˆ°æ–°hashèŠ‚ç‚¹ã€‚\n\n3.redis cluster3.0è‡ªå¸¦çš„é›†ç¾¤ï¼Œç‰¹ç‚¹åœ¨äºä»–çš„åˆ†å¸ƒå¼ç®—æ³•ä¸æ˜¯ä¸€è‡´æ€§hashï¼Œè€Œæ˜¯hashæ§½çš„æ¦‚å¿µï¼Œä»¥åŠè‡ªèº«æ”¯æŒèŠ‚ç‚¹è®¾ç½®ä»èŠ‚ç‚¹ã€‚å…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚\n\n4.åœ¨ä¸šåŠ¡ä»£ç å±‚å®ç°ï¼Œèµ·å‡ ä¸ªæ¯«æ— å…³è”çš„rediså®ä¾‹ï¼Œåœ¨ä»£ç å±‚ï¼Œå¯¹key è¿›è¡Œhashè®¡ç®—ï¼Œç„¶åå»å¯¹åº”çš„rediså®ä¾‹æ“ä½œæ•°æ®ã€‚ è¿™ç§æ–¹å¼å¯¹hashå±‚ä»£ç è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€ƒè™‘éƒ¨åˆ†åŒ…æ‹¬ï¼ŒèŠ‚ç‚¹å¤±æ•ˆåçš„æ›¿ä»£ç®—æ³•æ–¹æ¡ˆï¼Œæ•°æ®éœ‡è¡åçš„è‡ªåŠ¨è„šæœ¬æ¢å¤ï¼Œå®ä¾‹çš„ç›‘æ§ï¼Œç­‰ç­‰ã€‚\n\n11ã€Redisé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ï¼Ÿ\n\næœ‰Aï¼ŒBï¼ŒCä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤,åœ¨æ²¡æœ‰å¤åˆ¶æ¨¡å‹çš„æƒ…å†µä¸‹,å¦‚æœèŠ‚ç‚¹Bå¤±è´¥äº†ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±ä¼šä»¥ä¸ºç¼ºå°‘5501-11000è¿™ä¸ªèŒƒå›´çš„æ§½è€Œä¸å¯ç”¨ã€‚\n\n12ã€MySQLé‡Œæœ‰2000wæ•°æ®ï¼Œredisä¸­åªå­˜20wçš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ\n\nrediså†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚\n\n13ã€Redisæœ‰å“ªäº›é€‚åˆçš„åœºæ™¯ï¼Ÿ\n\nï¼ˆ1ï¼‰ã€ä¼šè¯ç¼“å­˜ï¼ˆSession Cacheï¼‰\n\næœ€å¸¸ç”¨çš„ä¸€ç§ä½¿ç”¨Redisçš„æƒ…æ™¯æ˜¯ä¼šè¯ç¼“å­˜ï¼ˆsession cacheï¼‰ã€‚ç”¨Redisç¼“å­˜ä¼šè¯æ¯”å…¶ä»–å­˜å‚¨ï¼ˆå¦‚Memcachedï¼‰çš„ä¼˜åŠ¿åœ¨äºï¼šRedisæä¾›æŒä¹…åŒ–ã€‚å½“ç»´æŠ¤ä¸€ä¸ªä¸æ˜¯ä¸¥æ ¼è¦æ±‚ä¸€è‡´æ€§çš„ç¼“å­˜æ—¶ï¼Œå¦‚æœç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šä¸é«˜å…´çš„ï¼Œç°åœ¨ï¼Œä»–ä»¬è¿˜ä¼šè¿™æ ·å—ï¼Ÿ\n\nå¹¸è¿çš„æ˜¯ï¼Œéšç€ Redis è¿™äº›å¹´çš„æ”¹è¿›ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°æ€ä¹ˆæ°å½“çš„ä½¿ç”¨Redisæ¥ç¼“å­˜ä¼šè¯çš„æ–‡æ¡£ã€‚ç”šè‡³å¹¿ä¸ºäººçŸ¥çš„å•†ä¸šå¹³å°Magentoä¹Ÿæä¾›Redisçš„æ’ä»¶ã€‚\n\nï¼ˆ2ï¼‰ã€å…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰\n\né™¤åŸºæœ¬çš„ä¼šè¯tokenä¹‹å¤–ï¼ŒRedisè¿˜æä¾›å¾ˆç®€ä¾¿çš„FPCå¹³å°ã€‚å›åˆ°ä¸€è‡´æ€§é—®é¢˜ï¼Œå³ä½¿é‡å¯äº†Rediså®ä¾‹ï¼Œå› ä¸ºæœ‰ç£ç›˜çš„æŒä¹…åŒ–ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°é¡µé¢åŠ è½½é€Ÿåº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ä¸€ä¸ªæå¤§æ”¹è¿›ï¼Œç±»ä¼¼PHPæœ¬åœ°FPCã€‚\n\nå†æ¬¡ä»¥Magentoä¸ºä¾‹ï¼ŒMagentoæä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨Redisä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚\n\næ­¤å¤–ï¼Œå¯¹WordPressçš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚\n\nï¼ˆ3ï¼‰ã€é˜Ÿåˆ—\n\nReidsåœ¨å†…å­˜å­˜å‚¨å¼•æ“é¢†åŸŸçš„ä¸€å¤§ä¼˜ç‚¹æ˜¯æä¾› list å’Œ set æ“ä½œï¼Œè¿™ä½¿å¾—Redisèƒ½ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—å¹³å°æ¥ä½¿ç”¨ã€‚Redisä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨çš„æ“ä½œï¼Œå°±ç±»ä¼¼äºæœ¬åœ°ç¨‹åºè¯­è¨€ï¼ˆå¦‚Pythonï¼‰å¯¹ list çš„ push/pop æ“ä½œã€‚\n\nå¦‚æœä½ å¿«é€Ÿçš„åœ¨Googleä¸­æœç´¢â€œRedis queuesâ€ï¼Œä½ é©¬ä¸Šå°±èƒ½æ‰¾åˆ°å¤§é‡çš„å¼€æºé¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®çš„ç›®çš„å°±æ˜¯åˆ©ç”¨Redisåˆ›å»ºéå¸¸å¥½çš„åç«¯å·¥å…·ï¼Œä»¥æ»¡è¶³å„ç§é˜Ÿåˆ—éœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒCeleryæœ‰ä¸€ä¸ªåå°å°±æ˜¯ä½¿ç”¨Redisä½œä¸ºbrokerï¼Œä½ å¯ä»¥ä»è¿™é‡Œå»æŸ¥çœ‹ã€‚\n\nï¼ˆ4ï¼‰ï¼Œæ’è¡Œæ¦œ/è®¡æ•°å™¨\n\nRedisåœ¨å†…å­˜ä¸­å¯¹æ•°å­—è¿›è¡Œé€’å¢æˆ–é€’å‡çš„æ“ä½œå®ç°çš„éå¸¸å¥½ã€‚é›†åˆï¼ˆSetï¼‰å’Œæœ‰åºé›†åˆï¼ˆSorted Setï¼‰ä¹Ÿä½¿å¾—æˆ‘ä»¬åœ¨æ‰§è¡Œè¿™äº›æ“ä½œçš„æ—¶å€™å˜çš„éå¸¸ç®€å•ï¼ŒRedisåªæ˜¯æ­£å¥½æä¾›äº†è¿™ä¸¤ç§æ•°æ®ç»“æ„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä»æ’åºé›†åˆä¸­è·å–åˆ°æ’åæœ€é å‰çš„10ä¸ªç”¨æˆ·â€“æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œuser_scoresâ€ï¼Œæˆ‘ä»¬åªéœ€è¦åƒä¸‹é¢ä¸€æ ·æ‰§è¡Œå³å¯ï¼š\n\nå½“ç„¶ï¼Œè¿™æ˜¯å‡å®šä½ æ˜¯æ ¹æ®ä½ ç”¨æˆ·çš„åˆ†æ•°åšé€’å¢çš„æ’åºã€‚å¦‚æœä½ æƒ³è¿”å›ç”¨æˆ·åŠç”¨æˆ·çš„åˆ†æ•°ï¼Œä½ éœ€è¦è¿™æ ·æ‰§è¡Œï¼š\n\nZRANGE user_scores 0 10 WITHSCORES\n\nAgora Gameså°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œç”¨Rubyå®ç°çš„ï¼Œå®ƒçš„æ’è¡Œæ¦œå°±æ˜¯ä½¿ç”¨Redisæ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚\n\nï¼ˆ5ï¼‰ã€å‘å¸ƒ/è®¢é˜…\n\næœ€åï¼ˆä½†è‚¯å®šä¸æ˜¯æœ€ä¸é‡è¦çš„ï¼‰æ˜¯Redisçš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½ã€‚å‘å¸ƒ/è®¢é˜…çš„ä½¿ç”¨åœºæ™¯ç¡®å®éå¸¸å¤šã€‚æˆ‘å·²çœ‹è§äººä»¬åœ¨ç¤¾äº¤ç½‘ç»œè¿æ¥ä¸­ä½¿ç”¨ï¼Œè¿˜å¯ä½œä¸ºåŸºäºå‘å¸ƒ/è®¢é˜…çš„è„šæœ¬è§¦å‘å™¨ï¼Œç”šè‡³ç”¨Redisçš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½æ¥å»ºç«‹èŠå¤©ç³»ç»Ÿï¼ï¼ˆä¸ï¼Œè¿™æ˜¯çœŸçš„ï¼Œä½ å¯ä»¥å»æ ¸å®ï¼‰ã€‚\n\n14ã€Redisæ”¯æŒçš„Javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿå®˜æ–¹æ¨èç”¨å“ªä¸ªï¼Ÿ\n\nRedissonã€Jedisã€lettuceç­‰ç­‰ï¼Œå®˜æ–¹æ¨èä½¿ç”¨Redissonã€‚\n\n15ã€Rediså’ŒRedissonæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ\n\nRedissonæ˜¯ä¸€ä¸ªé«˜çº§çš„åˆ†å¸ƒå¼åè°ƒRediså®¢æœç«¯ï¼Œèƒ½å¸®åŠ©ç”¨æˆ·åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è½»æ¾å®ç°ä¸€äº›Javaçš„å¯¹è±¡ (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish / Subscribe, HyperLogLog)ã€‚\n\n16ã€Jedisä¸Redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ\n\nJedisæ˜¯Redisçš„Javaå®ç°çš„å®¢æˆ·ç«¯ï¼Œå…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼›Redissonå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„Javaæ•°æ®ç»“æ„ï¼Œå’ŒJedisç›¸æ¯”ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²æ“ä½œï¼Œä¸æ”¯æŒæ’åºã€äº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰Redisç‰¹æ€§ã€‚Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚\n\n17ã€Rediså¦‚ä½•è®¾ç½®å¯†ç åŠéªŒè¯å¯†ç ï¼Ÿ\n\nè®¾ç½®å¯†ç ï¼šconfig set requirepass 123456\n\næˆæƒå¯†ç ï¼šauth 123456\n\n18ã€è¯´è¯´Rediså“ˆå¸Œæ§½çš„æ¦‚å¿µï¼Ÿ\n\nRedisé›†ç¾¤æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hash,è€Œæ˜¯å¼•å…¥äº†å“ˆå¸Œæ§½çš„æ¦‚å¿µï¼ŒRedisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªkeyé€šè¿‡CRC16æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ï¼Œé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ã€‚\n\n19ã€Redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ\n\nä¸ºäº†ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…å¤§éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•é€šä¿¡çš„æƒ…å†µä¸‹é›†ç¾¤ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é›†ç¾¤ä½¿ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰N-1ä¸ªå¤åˆ¶å“.\n\n20ã€Redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nRediså¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œã€‚\n\n21ã€Redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿ\n\nå¼‚æ­¥å¤åˆ¶\n\n22ã€Redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ\n\n16384ä¸ªã€‚\n\n23ã€Redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ\n\nRedisé›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨0æ•°æ®åº“ã€‚\n\n24ã€æ€ä¹ˆæµ‹è¯•Redisçš„è¿é€šæ€§ï¼Ÿ\n\nping\n\n25ã€Redisä¸­çš„ç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nä¸€æ¬¡è¯·æ±‚/å“åº”æœåŠ¡å™¨èƒ½å®ç°å¤„ç†æ–°çš„è¯·æ±‚å³ä½¿æ—§çš„è¯·æ±‚è¿˜æœªè¢«å“åº”ã€‚è¿™æ ·å°±å¯ä»¥å°†å¤šä¸ªå‘½ä»¤å‘é€åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ç”¨ç­‰å¾…å›å¤ï¼Œæœ€ååœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è¯»å–è¯¥ç­”å¤ã€‚\n\nè¿™å°±æ˜¯ç®¡é“ï¼ˆpipeliningï¼‰ï¼Œæ˜¯ä¸€ç§å‡ åå¹´æ¥å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ã€‚ä¾‹å¦‚è®¸å¤šPOP3åè®®å·²ç»å®ç°æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå¤§å¤§åŠ å¿«äº†ä»æœåŠ¡å™¨ä¸‹è½½æ–°é‚®ä»¶çš„è¿‡ç¨‹ã€‚\n\n26ã€æ€ä¹ˆç†è§£Redisäº‹åŠ¡ï¼Ÿ\n\näº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚\n\näº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚\n\n27ã€Redisäº‹åŠ¡ç›¸å…³çš„å‘½ä»¤æœ‰å“ªå‡ ä¸ªï¼Ÿ\n\nMULTIã€EXECã€DISCARDã€WATCH\n\n28ã€Redis keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ\n\nEXPIREå’ŒPERSISTå‘½ä»¤ã€‚\n\n29ã€Rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ\n\nå°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„webç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„key,è€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢.\n\n30ã€Rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\n\nä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚\nRediæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶, åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚\nä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚\næ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚\nå¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚\n\n31ã€Rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ\n\nLRUç®—æ³•\n\n32ã€Rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ\n\nRedis2.6å¼€å§‹redis-cliæ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸ºpipe modeçš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚\n\n33ã€ä¸ºä»€ä¹ˆè¦åšRedisåˆ†åŒºï¼Ÿ\n\nåˆ†åŒºå¯ä»¥è®©Redisç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRediså°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ã€‚å¦‚æœæ²¡æœ‰åˆ†åŒºï¼Œä½ æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€å°æœºå™¨çš„å†…å­˜ã€‚åˆ†åŒºä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ è®¡ç®—æœºå¾—åˆ°æˆå€æå‡,Redisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ã€‚\n\n34ã€ä½ çŸ¥é“æœ‰å“ªäº›Redisåˆ†åŒºå®ç°æ–¹æ¡ˆï¼Ÿ\n\nå®¢æˆ·ç«¯åˆ†åŒºå°±æ˜¯åœ¨å®¢æˆ·ç«¯å°±å·²ç»å†³å®šæ•°æ®ä¼šè¢«å­˜å‚¨åˆ°å“ªä¸ªredisèŠ‚ç‚¹æˆ–è€…ä»å“ªä¸ªredisèŠ‚ç‚¹è¯»å–ã€‚å¤§å¤šæ•°å®¢æˆ·ç«¯å·²ç»å®ç°äº†å®¢æˆ·ç«¯åˆ†åŒºã€‚\n\nä»£ç†åˆ†åŒº æ„å‘³ç€å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä»£ç†ï¼Œç„¶åä»£ç†å†³å®šå»å“ªä¸ªèŠ‚ç‚¹å†™æ•°æ®æˆ–è€…è¯»æ•°æ®ã€‚ä»£ç†æ ¹æ®åˆ†åŒºè§„åˆ™å†³å®šè¯·æ±‚å“ªäº›Rediså®ä¾‹ï¼Œç„¶åæ ¹æ®Redisçš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚rediså’Œmemcachedçš„ä¸€ç§ä»£ç†å®ç°å°±æ˜¯Twemproxy\n\næŸ¥è¯¢è·¯ç”±(Query routing) çš„æ„æ€æ˜¯å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ªrediså®ä¾‹ï¼Œç„¶åç”±Rediså°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„RedisèŠ‚ç‚¹ã€‚Redis Clusterå®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ªredisèŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ªredisèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥redirectedåˆ°æ­£ç¡®çš„redisèŠ‚ç‚¹ã€‚\n\n35ã€Redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ\n\næ¶‰åŠå¤šä¸ªkeyçš„æ“ä½œé€šå¸¸ä¸ä¼šè¢«æ”¯æŒã€‚ä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä¸¤ä¸ªé›†åˆæ±‚äº¤é›†ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒçš„Rediså®ä¾‹ï¼ˆå®é™…ä¸Šè¿™ç§æƒ…å†µä¹Ÿæœ‰åŠæ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨äº¤é›†æŒ‡ä»¤ï¼‰ã€‚\nåŒæ—¶æ“ä½œå¤šä¸ªkey,åˆ™ä¸èƒ½ä½¿ç”¨Redisäº‹åŠ¡.\nåˆ†åŒºä½¿ç”¨çš„ç²’åº¦æ˜¯keyï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªéå¸¸é•¿çš„æ’åºkeyå­˜å‚¨ä¸€ä¸ªæ•°æ®é›†ï¼ˆThe partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted setï¼‰.\nå½“ä½¿ç”¨åˆ†åŒºçš„æ—¶å€™ï¼Œæ•°æ®å¤„ç†ä¼šéå¸¸å¤æ‚ï¼Œä¾‹å¦‚ä¸ºäº†å¤‡ä»½ä½ å¿…é¡»ä»ä¸åŒçš„Rediså®ä¾‹å’Œä¸»æœºåŒæ—¶æ”¶é›†RDB / AOFæ–‡ä»¶ã€‚\nåˆ†åŒºæ—¶åŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹å¯èƒ½éå¸¸å¤æ‚ã€‚Redisé›†ç¾¤åœ¨è¿è¡Œæ—¶å¢åŠ æˆ–è€…åˆ é™¤RedisèŠ‚ç‚¹ï¼Œèƒ½åšåˆ°æœ€å¤§ç¨‹åº¦å¯¹ç”¨æˆ·é€æ˜åœ°æ•°æ®å†å¹³è¡¡ï¼Œä½†å…¶ä»–ä¸€äº›å®¢æˆ·ç«¯åˆ†åŒºæˆ–è€…ä»£ç†åˆ†åŒºæ–¹æ³•åˆ™ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§é¢„åˆ†ç‰‡çš„æŠ€æœ¯ä¹Ÿå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n36ã€RedisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ\n\nå¦‚æœRedisè¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚\nå¦‚æœRedisè¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„keys-to-nodesæ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯(å³RedisèŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰Redisé›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚\n37ã€åˆ†å¸ƒå¼Redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\næ—¢ç„¶Redisæ˜¯å¦‚æ­¤çš„è½»é‡ï¼ˆå•å®ä¾‹åªä½¿ç”¨1Må†…å­˜ï¼‰,ä¸ºé˜²æ­¢ä»¥åçš„æ‰©å®¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸€å¼€å§‹å°±å¯åŠ¨è¾ƒå¤šå®ä¾‹ã€‚å³ä¾¿ä½ åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸€å¼€å§‹å°±è®©Redisä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œä½¿ç”¨åˆ†åŒºï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªå®ä¾‹ã€‚\n\nä¸€å¼€å§‹å°±å¤šè®¾ç½®å‡ ä¸ªRediså®ä¾‹ï¼Œä¾‹å¦‚32æˆ–è€…64ä¸ªå®ä¾‹ï¼Œå¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¿™æ“ä½œèµ·æ¥å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯ä»é•¿ä¹…æ¥çœ‹åšè¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚\n\nè¿™æ ·çš„è¯ï¼Œå½“ä½ çš„æ•°æ®ä¸æ–­å¢é•¿ï¼Œéœ€è¦æ›´å¤šçš„RedisæœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯ä»…ä»…å°†Rediså®ä¾‹ä»ä¸€å°æœåŠ¡è¿ç§»åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨è€Œå·²ï¼ˆè€Œä¸ç”¨è€ƒè™‘é‡æ–°åˆ†åŒºçš„é—®é¢˜ï¼‰ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å¦ä¸€å°æœåŠ¡å™¨ï¼Œä½ éœ€è¦å°†ä½ ä¸€åŠçš„Rediså®ä¾‹ä»ç¬¬ä¸€å°æœºå™¨è¿ç§»åˆ°ç¬¬äºŒå°æœºå™¨ã€‚\n\n38ã€Twemproxyæ˜¯ä»€ä¹ˆï¼Ÿ\n\nTwemproxyæ˜¯Twitterç»´æŠ¤çš„ï¼ˆç¼“å­˜ï¼‰ä»£ç†ç³»ç»Ÿï¼Œä»£ç†Memcachedçš„ASCIIåè®®å’ŒRedisåè®®ã€‚å®ƒæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œä½¿ç”¨cè¯­è¨€ç¼–å†™ï¼Œè¿è¡Œèµ·æ¥éå¸¸å¿«ã€‚å®ƒæ˜¯é‡‡ç”¨Apache 2.0 licenseçš„å¼€æºè½¯ä»¶ã€‚ Twemproxyæ”¯æŒè‡ªåŠ¨åˆ†åŒºï¼Œå¦‚æœå…¶ä»£ç†çš„å…¶ä¸­ä¸€ä¸ªRedisèŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹æ’é™¤ï¼ˆè¿™å°†æ”¹å˜åŸæ¥çš„keys-instancesçš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä»…åœ¨æŠŠRediså½“ç¼“å­˜æ—¶ä½¿ç”¨Twemproxy)ã€‚ Twemproxyæœ¬èº«ä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå› ä¸ºä½ å¯ä»¥å¯åŠ¨å¤šä¸ªTwemproxyå®ä¾‹ï¼Œç„¶åè®©ä½ çš„å®¢æˆ·ç«¯å»è¿æ¥ä»»æ„ä¸€ä¸ªTwemproxyå®ä¾‹ã€‚ Twemproxyæ˜¯Rediså®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œç”±å®ƒæ¥å¤„ç†åˆ†åŒºåŠŸèƒ½åº”è¯¥ä¸ç®—å¤æ‚ï¼Œå¹¶ä¸”åº”è¯¥ç®—æ¯”è¾ƒå¯é çš„ã€‚\n\n39ã€æ”¯æŒä¸€è‡´æ€§å“ˆå¸Œçš„å®¢æˆ·ç«¯æœ‰å“ªäº›ï¼Ÿ\n\nRedis-rbã€Predisç­‰ã€‚\n\n40ã€Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ\n\nRedisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚\nRedisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œåº”ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œ ç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚ åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚\n41ã€Redisçš„å†…å­˜å ç”¨æƒ…å†µæ€ä¹ˆæ ·ï¼Ÿ\n\nç»™ä½ ä¸¾ä¸ªä¾‹å­ï¼š 100ä¸‡ä¸ªé”®å€¼å¯¹ï¼ˆé”®æ˜¯0åˆ°999999å€¼æ˜¯å­—ç¬¦ä¸²â€œhello worldâ€ï¼‰åœ¨æˆ‘çš„32ä½çš„Macç¬”è®°æœ¬ä¸Š ç”¨äº†100MBã€‚åŒæ ·çš„æ•°æ®æ”¾åˆ°ä¸€ä¸ªkeyé‡Œåªéœ€è¦16MBï¼Œ è¿™æ˜¯å› ä¸ºé”®å€¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼€é”€ã€‚ åœ¨Memcachedä¸Šæ‰§è¡Œä¹Ÿæ˜¯ç±»ä¼¼çš„ç»“æœï¼Œä½†æ˜¯ç›¸å¯¹Redisçš„å¼€é”€è¦å°ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºRedisä¼šè®°å½•ç±»å‹ä¿¡æ¯å¼•ç”¨è®¡æ•°ç­‰ç­‰ã€‚\n\nå½“ç„¶ï¼Œå¤§é”®å€¼å¯¹æ—¶ä¸¤è€…çš„æ¯”ä¾‹è¦å¥½å¾ˆå¤šã€‚\n\n64ä½çš„ç³»ç»Ÿæ¯”32ä½çš„éœ€è¦æ›´å¤šçš„å†…å­˜å¼€é”€ï¼Œå°¤å…¶æ˜¯é”®å€¼å¯¹éƒ½è¾ƒå°æ—¶ï¼Œè¿™æ˜¯å› ä¸º64ä½çš„ç³»ç»Ÿé‡ŒæŒ‡é’ˆå ç”¨äº†8ä¸ªå­—èŠ‚ã€‚ ä½†æ˜¯ï¼Œå½“ç„¶ï¼Œ64ä½ç³»ç»Ÿæ”¯æŒæ›´å¤§çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸ºäº†è¿è¡Œå¤§å‹çš„RedisæœåŠ¡å™¨æˆ–å¤šæˆ–å°‘çš„éœ€è¦ä½¿ç”¨64ä½çš„ç³»ç»Ÿã€‚\n\n42ã€éƒ½æœ‰å“ªäº›åŠæ³•å¯ä»¥é™ä½Redisçš„å†…å­˜ä½¿ç”¨æƒ…å†µå‘¢ï¼Ÿ\n\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯32ä½çš„Rediså®ä¾‹ï¼Œå¯ä»¥å¥½å¥½åˆ©ç”¨Hash,list,sorted set,setç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„Key-Valueå¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚\n\n43ã€æŸ¥çœ‹Redisä½¿ç”¨æƒ…å†µåŠçŠ¶æ€ä¿¡æ¯ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ\n\ninfo\n\n44ã€Redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nå¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedisçš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥å°†Rediså½“ç¼“å­˜æ¥ä½¿ç”¨é…ç½®æ·˜æ±°æœºåˆ¶ï¼Œå½“Redisè¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚\n\n45ã€Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸CPUçš„åˆ©ç”¨ç‡ï¼Ÿ\n\nå¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ªRedisçš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ªCPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†ç‰‡ï¼ˆshardï¼‰ã€‚\n\n46ã€ä¸€ä¸ªRediså®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘çš„keysï¼ŸListã€Setã€Sorted Setä»–ä»¬æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘å…ƒç´ ï¼Ÿ\n\nç†è®ºä¸ŠRediså¯ä»¥å¤„ç†å¤šè¾¾232çš„keysï¼Œå¹¶ä¸”åœ¨å®é™…ä¸­è¿›è¡Œäº†æµ‹è¯•ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘å­˜æ”¾äº†2äº¿5åƒä¸‡çš„keysã€‚æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€äº›è¾ƒå¤§çš„å€¼ã€‚\n\nä»»ä½•listã€setã€å’Œsorted setéƒ½å¯ä»¥æ”¾232ä¸ªå…ƒç´ ã€‚\n\næ¢å¥è¯è¯´ï¼ŒRedisçš„å­˜å‚¨æé™æ˜¯ç³»ç»Ÿä¸­çš„å¯ç”¨å†…å­˜å€¼ã€‚\n\n47ã€Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ\n\n(1) Masteræœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼Œå¦‚RDBå†…å­˜å¿«ç…§å’ŒAOFæ—¥å¿—æ–‡ä»¶\n\n(2) å¦‚æœæ•°æ®æ¯”è¾ƒé‡è¦ï¼ŒæŸä¸ªSlaveå¼€å¯AOFå¤‡ä»½æ•°æ®ï¼Œç­–ç•¥è®¾ç½®ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡\n\n(3) ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒMasterå’ŒSlaveæœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…\n\n(4) å°½é‡é¿å…åœ¨å‹åŠ›å¾ˆå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“\n\n(5) ä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ä¸ºç¨³å®šï¼Œå³ï¼šMaster <- Slave1 <- Slave2 <- Slave3â€¦\n\nè¿™æ ·çš„ç»“æ„æ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç°Slaveå¯¹Masterçš„æ›¿æ¢ã€‚å¦‚æœMasteræŒ‚äº†ï¼Œå¯ä»¥ç«‹åˆ»å¯ç”¨Slave1åšMasterï¼Œå…¶ä»–ä¸å˜ã€‚\n\n48ã€Redisæä¾›äº†å“ªå‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ\n\nRDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨.\nAOFæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œ,å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®,AOFå‘½ä»¤ä»¥redisåè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾.Redisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™,ä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§.\nå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨,ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼.\nä½ ä¹Ÿå¯ä»¥åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼, åœ¨è¿™ç§æƒ…å†µä¸‹, å½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®,å› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´.\næœ€é‡è¦çš„äº‹æƒ…æ˜¯äº†è§£RDBå’ŒAOFæŒä¹…åŒ–æ–¹å¼çš„ä¸åŒ,è®©æˆ‘ä»¬ä»¥RDBæŒä¹…åŒ–æ–¹å¼å¼€å§‹ã€‚\n49ã€å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿ\n\nä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾PostgreSQLçš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚\n\næœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼šå› ä¸ºå®šæ—¶ç”ŸæˆRDBå¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ ä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…ä¹‹å‰æåˆ°çš„AOFç¨‹åºçš„bugã€‚\n\n50ã€ä¿®æ”¹é…ç½®ä¸é‡å¯Redisä¼šå®æ—¶ç”Ÿæ•ˆå—ï¼Ÿ\n\né’ˆå¯¹è¿è¡Œå®ä¾‹ï¼Œæœ‰è®¸å¤šé…ç½®é€‰é¡¹å¯ä»¥é€šè¿‡ CONFIG SET å‘½ä»¤è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ— éœ€æ‰§è¡Œä»»ä½•å½¢å¼çš„é‡å¯ã€‚ ä» Redis 2.2 å¼€å§‹ï¼Œå¯ä»¥ä» AOF åˆ‡æ¢åˆ° RDB çš„å¿«ç…§æŒä¹…æ€§æˆ–å…¶ä»–æ–¹å¼è€Œä¸éœ€è¦é‡å¯ Redisã€‚æ£€ç´¢ â€˜CONFIG GET *â€™ å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ã€‚\n\nä½†å¶å°”é‡æ–°å¯åŠ¨æ˜¯å¿…é¡»çš„ï¼Œå¦‚ä¸ºå‡çº§ Redis ç¨‹åºåˆ°æ–°çš„ç‰ˆæœ¬ï¼Œæˆ–è€…å½“ä½ éœ€è¦ä¿®æ”¹æŸäº›ç›®å‰ CONFIG å‘½ä»¤è¿˜ä¸æ”¯æŒçš„é…ç½®å‚æ•°çš„æ—¶å€™ã€‚\n\nè½¬è½½äºï¼š[https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/](https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/)","source":"_posts/Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬).md","raw":"---\ntitle: Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬)\ndate: 2022-02-12 17:35:40\ntags:\n---\n\nRedis åœ¨äº’è”ç½‘æŠ€æœ¯å­˜å‚¨æ–¹é¢ä½¿ç”¨å¦‚æ­¤å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰çš„åç«¯æŠ€æœ¯é¢è¯•å®˜éƒ½è¦åœ¨ Redis çš„ä½¿ç”¨å’ŒåŸç†æ–¹é¢å¯¹å°ä¼™ä¼´ä»¬è¿›è¡Œå„ç§åˆéš¾ã€‚ä½œä¸ºä¸€ååœ¨äº’è”ç½‘æŠ€æœ¯è¡Œä¸šæ‰“å‡»è¿‡æˆç™¾ä¸Šåƒåã€è¯·å…è®¸æˆ‘å¤¸å¼ ä¸€ä¸‹ã€‘çš„èµ„æ·±æŠ€æœ¯é¢è¯•å®˜ï¼Œçœ‹è¿‡äº†æ— æ•°è½å¯çš„èº«å½±å¤±æœ›çš„ç¦»å¼€ï¼Œç•¥æ„Ÿæ„§ç–šï¼Œæ•…çŒ®ä¸Šæ­¤æ–‡ï¼Œå¸Œæœ›å„ä½è¯»è€…ä»¥åé¢è¯•åŠ¿å¦‚ç ´ç«¹ï¼Œæ°¸æ— å¤±è´¥ï¼\n\n### Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\n\nå­—ç¬¦ä¸² Stringã€å­—å…¸ Hashã€åˆ—è¡¨ Listã€é›†åˆ Setã€æœ‰åºé›†åˆ SortedSetã€‚\n\nå¦‚æœä½ æ˜¯ Redis ä¸­é«˜çº§ç”¨æˆ·ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢å‡ ç§æ•°æ®ç»“æ„ HyperLogLogã€Geoã€Pub/Subã€‚\n\nå¦‚æœä½ è¯´è¿˜ç©è¿‡ Redis Moduleï¼Œåƒ BloomFilterï¼ŒRedisSearchï¼ŒRedis-MLï¼Œé¢è¯•å®˜å¾—çœ¼ç›å°±å¼€å§‹å‘äº®äº†ã€‚\n\n### ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\n\nå…ˆæ‹¿ setnx æ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨ expire ç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾ã€‚\n\nè¿™æ—¶å€™å¯¹æ–¹ä¼šå‘Šè¯‰ä½ è¯´ä½ å›ç­”å¾—ä¸é”™ï¼Œç„¶åæ¥ç€é—®å¦‚æœåœ¨ setnx ä¹‹åæ‰§è¡Œ expire ä¹‹å‰è¿›ç¨‹æ„å¤– crash æˆ–è€…è¦é‡å¯ç»´æŠ¤äº†ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿ\n\nè¿™æ—¶å€™ä½ è¦ç»™äºˆæƒŠè®¶çš„åé¦ˆï¼šå”‰ï¼Œæ˜¯å–”ï¼Œè¿™ä¸ªé”å°±æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾äº†ã€‚ç´§æ¥ç€ä½ éœ€è¦æŠ“ä¸€æŠ“è‡ªå·±å¾—è„‘è¢‹ï¼Œæ•…ä½œæ€è€ƒç‰‡åˆ»ï¼Œå¥½åƒæ¥ä¸‹æ¥çš„ç»“æœæ˜¯ä½ ä¸»åŠ¨æ€è€ƒå‡ºæ¥çš„ï¼Œç„¶åå›ç­”ï¼šæˆ‘è®°å¾— set æŒ‡ä»¤æœ‰éå¸¸å¤æ‚çš„å‚æ•°ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åŒæ—¶æŠŠ setnx å’Œ expire åˆæˆä¸€æ¡æŒ‡ä»¤æ¥ç”¨çš„ï¼å¯¹æ–¹è¿™æ—¶ä¼šæ˜¾éœ²ç¬‘å®¹ï¼Œå¿ƒé‡Œå¼€å§‹é»˜å¿µï¼šæ‘ï¼Œè¿™å°å­è¿˜ä¸é”™ã€‚\n\nå‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10w ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ\n\nä½¿ç”¨ keys æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚\n\nå¯¹æ–¹æ¥ç€è¿½é—®ï¼šå¦‚æœè¿™ä¸ª redis æ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨ keys æŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\nè¿™ä¸ªæ—¶å€™ä½ è¦å›ç­” redis å…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredis çš„å•çº¿ç¨‹çš„ã€‚keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ scan æŒ‡ä»¤ï¼Œscan æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keys æŒ‡ä»¤é•¿ã€‚\n\n### ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\n\nä¸€èˆ¬ä½¿ç”¨ list ç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“ lpop æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“ sleep ä¸€ä¼šå†é‡è¯•ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—®å¯ä¸å¯ä»¥ä¸ç”¨ sleep å‘¢ï¼Ÿlist è¿˜æœ‰ä¸ªæŒ‡ä»¤å« blpopï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—®èƒ½ä¸èƒ½ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡å‘¢ï¼Ÿä½¿ç”¨ pub/sub ä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—® pub/sub æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œå¾—ä½¿ç”¨ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—å¦‚ rabbitmq ç­‰ã€‚\n\nå¦‚æœå¯¹æ–¹è¿½é—® redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿæˆ‘ä¼°è®¡ç°åœ¨ä½ å¾ˆæƒ³æŠŠé¢è¯•å®˜ä¸€æ£’æ‰“æ­»å¦‚æœä½ æ‰‹ä¸Šæœ‰ä¸€æ ¹æ£’çƒæ£çš„è¯ï¼Œæ€ä¹ˆé—®çš„è¿™ä¹ˆè¯¦ç»†ã€‚ä½†æ˜¯ä½ å¾ˆå…‹åˆ¶ï¼Œç„¶åç¥æ€è‡ªè‹¥çš„å›ç­”é“ï¼šä½¿ç”¨ sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸º scoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸º key è°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨ zrangebyscore æŒ‡ä»¤è·å– N ç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚\n\nåˆ°è¿™é‡Œï¼Œé¢è¯•å®˜æš—åœ°é‡Œå·²ç»å¯¹ä½ ç«–èµ·äº†å¤§æ‹‡æŒ‡ã€‚ä½†æ˜¯ä»–ä¸çŸ¥é“çš„æ˜¯æ­¤åˆ»ä½ å´ç«–èµ·äº†ä¸­æŒ‡ï¼Œåœ¨æ¤…å­èƒŒåã€‚\n\nå¦‚æœæœ‰å¤§é‡çš„ key éœ€è¦è®¾ç½®åŒä¸€æ—¶é—´è¿‡æœŸï¼Œä¸€èˆ¬éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ\n\nå¦‚æœå¤§é‡çš„ key è¿‡æœŸæ—¶é—´è®¾ç½®çš„è¿‡äºé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œredis å¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„å¡é¡¿ç°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚\n\n### Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\n\nbgsave åšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaof åšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸º bgsave ä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ aof æ¥é…åˆä½¿ç”¨ã€‚åœ¨ redis å®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨ bgsave æŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨ aof é‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚\n\nå¯¹æ–¹è¿½é—®é‚£å¦‚æœçªç„¶æœºå™¨æ‰ç”µä¼šæ€æ ·ï¼Ÿå–å†³äº aof æ—¥å¿— sync å±æ€§çš„é…ç½®ï¼Œå¦‚æœä¸è¦æ±‚æ€§èƒ½ï¼Œåœ¨æ¯æ¡å†™æŒ‡ä»¤æ—¶éƒ½ sync ä¸€ä¸‹ç£ç›˜ï¼Œå°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯åœ¨é«˜æ€§èƒ½çš„è¦æ±‚ä¸‹æ¯æ¬¡éƒ½ sync æ˜¯ä¸ç°å®çš„ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å®šæ—¶ syncï¼Œæ¯”å¦‚ 1s1 æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æœ€å¤šå°±ä¼šä¸¢å¤± 1s çš„æ•°æ®ã€‚\n\nå¯¹æ–¹è¿½é—® bgsave çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ ç»™å‡ºä¸¤ä¸ªè¯æ±‡å°±å¯ä»¥äº†ï¼Œfork å’Œ cowã€‚fork æ˜¯æŒ‡ redis é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡Œ bgsave æ“ä½œï¼Œcow æŒ‡çš„æ˜¯ copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚\n\n### Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ\n\nå¯ä»¥å°†å¤šæ¬¡ IO å¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯ pipeline æ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨ redis-benchmark è¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“ redis çš„ QPS å³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯ pipeline æ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚\n\n### Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\n\nRedis å¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡ bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜ bufferï¼Œå¾…å®Œæˆåå°† rdb æ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°† rdb é•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚\n\n### æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\n\nRedis Sentinal ç€çœ¼äºé«˜å¯ç”¨ï¼Œåœ¨ master å®•æœºæ—¶ä¼šè‡ªåŠ¨å°† slave æå‡ä¸º masterï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚\n\nRedis Cluster ç€çœ¼äºæ‰©å±•æ€§ï¼Œåœ¨å•ä¸ª redis å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ Cluster è¿›è¡Œåˆ†ç‰‡å­˜å‚¨ã€‚\n\n## å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\n1ã€ä»€ä¹ˆæ˜¯Redisï¼Ÿ\n\nRedisæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªKey-Valueç±»å‹çš„å†…å­˜æ•°æ®åº“ï¼Œå¾ˆåƒmemcachedï¼Œæ•´ä¸ªæ•°æ®åº“ç»Ÿç»ŸåŠ è½½åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ“ä½œï¼Œå®šæœŸé€šè¿‡å¼‚æ­¥æ“ä½œæŠŠæ•°æ®åº“æ•°æ®flushåˆ°ç¡¬ç›˜ä¸Šè¿›è¡Œä¿å­˜ã€‚å› ä¸ºæ˜¯çº¯å†…å­˜æ“ä½œï¼ŒRedisçš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚ Redisçš„å‡ºè‰²ä¹‹å¤„ä¸ä»…ä»…æ˜¯æ€§èƒ½ï¼ŒRedisæœ€å¤§çš„é­…åŠ›æ˜¯æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œæ­¤å¤–å•ä¸ªvalueçš„æœ€å¤§é™åˆ¶æ˜¯1GBï¼Œä¸åƒ memcachedåªèƒ½ä¿å­˜1MBçš„æ•°æ®ï¼Œå› æ­¤Rediså¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”æ–¹è¯´ç”¨ä»–çš„Listæ¥åšFIFOåŒå‘é“¾è¡¨ï¼Œå®ç°ä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§ èƒ½æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼Œç”¨ä»–çš„Setå¯ä»¥åšé«˜æ€§èƒ½çš„tagç³»ç»Ÿç­‰ç­‰ã€‚å¦å¤–Redisä¹Ÿå¯ä»¥å¯¹å­˜å…¥çš„Key-Valueè®¾ç½®expireæ—¶é—´ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«å½“ä½œä¸€ ä¸ªåŠŸèƒ½åŠ å¼ºç‰ˆçš„memcachedæ¥ç”¨ã€‚ Redisçš„ä¸»è¦ç¼ºç‚¹æ˜¯æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚\n\n2ã€Redisç›¸æ¯”memcachedæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ\n\n(1) memcachedæ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œredisä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹\n\n(2) redisçš„é€Ÿåº¦æ¯”memcachedå¿«å¾ˆå¤š\n\n(3) rediså¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®\n\n3ã€Redisæ”¯æŒå“ªå‡ ç§æ•°æ®ç±»å‹ï¼Ÿ\n\nStringã€Listã€Setã€Sorted Setã€hashes\n\n4ã€Redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ\n\nå†…å­˜ã€‚\n\n5ã€Redisçš„å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ\n\nRemote Dictionary Serverã€‚\n\n6ã€Redisæœ‰å“ªå‡ ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼Ÿ\n\nnoeviction:è¿”å›é”™è¯¯å½“å†…å­˜é™åˆ¶è¾¾åˆ°å¹¶ä¸”å®¢æˆ·ç«¯å°è¯•æ‰§è¡Œä¼šè®©æ›´å¤šå†…å­˜è¢«ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†çš„å†™å…¥æŒ‡ä»¤ï¼Œä½†DELå’Œå‡ ä¸ªä¾‹å¤–ï¼‰\n\nallkeys-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nvolatile-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nallkeys-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\nvolatile-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®ã€‚\n\nvolatile-ttl: å›æ”¶åœ¨è¿‡æœŸé›†åˆçš„é”®ï¼Œå¹¶ä¸”ä¼˜å…ˆå›æ”¶å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚\n\n7ã€Rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›Windowsç‰ˆæœ¬ï¼Ÿ\n\nå› ä¸ºç›®å‰Linuxç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘windowsç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚\n\n8ã€ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ\n\n512M\n\n9ã€ä¸ºä»€ä¹ˆRediséœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Ÿ\n\nRedisä¸ºäº†è¾¾åˆ°æœ€å¿«çš„è¯»å†™é€Ÿåº¦å°†æ•°æ®éƒ½è¯»åˆ°å†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥rediså…·æœ‰å¿«é€Ÿå’Œæ•°æ®æŒä¹…åŒ–çš„ç‰¹å¾ã€‚å¦‚æœä¸å°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œç£ç›˜I/Oé€Ÿåº¦ä¸ºä¸¥é‡å½±å“redisçš„æ€§èƒ½ã€‚åœ¨å†…å­˜è¶Šæ¥è¶Šä¾¿å®œçš„ä»Šå¤©ï¼Œrediså°†ä¼šè¶Šæ¥è¶Šå—æ¬¢è¿ã€‚ å¦‚æœè®¾ç½®äº†æœ€å¤§ä½¿ç”¨çš„å†…å­˜ï¼Œåˆ™æ•°æ®å·²æœ‰è®°å½•æ•°è¾¾åˆ°å†…å­˜é™å€¼åä¸èƒ½ç»§ç»­æ’å…¥æ–°å€¼ã€‚\n\n10ã€Redisé›†ç¾¤æ–¹æ¡ˆåº”è¯¥æ€ä¹ˆåšï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ\n\n1.twemproxyï¼Œå¤§æ¦‚æ¦‚å¿µæ˜¯ï¼Œå®ƒç±»ä¼¼äºä¸€ä¸ªä»£ç†æ–¹å¼ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ™®é€šredisæ— ä»»ä½•åŒºåˆ«ï¼Œè®¾ç½®å¥½å®ƒä¸‹å±çš„å¤šä¸ªrediså®ä¾‹åï¼Œä½¿ç”¨æ—¶åœ¨æœ¬éœ€è¦è¿æ¥redisçš„åœ°æ–¹æ”¹ä¸ºè¿æ¥twemproxyï¼Œå®ƒä¼šä»¥ä¸€ä¸ªä»£ç†çš„èº«ä»½æ¥æ”¶è¯·æ±‚å¹¶ä½¿ç”¨ä¸€è‡´æ€§hashç®—æ³•ï¼Œå°†è¯·æ±‚è½¬æ¥åˆ°å…·ä½“redisï¼Œå°†ç»“æœå†è¿”å›twemproxyã€‚ä½¿ç”¨æ–¹å¼ç®€ä¾¿(ç›¸å¯¹redisåªéœ€ä¿®æ”¹è¿æ¥ç«¯å£)ï¼Œå¯¹æ—§é¡¹ç›®æ‰©å±•çš„é¦–é€‰ã€‚ é—®é¢˜ï¼štwemproxyè‡ªèº«å•ç«¯å£å®ä¾‹çš„å‹åŠ›ï¼Œä½¿ç”¨ä¸€è‡´æ€§hashåï¼Œå¯¹redisèŠ‚ç‚¹æ•°é‡æ”¹å˜æ—¶å€™çš„è®¡ç®—å€¼çš„æ”¹å˜ï¼Œæ•°æ®æ— æ³•è‡ªåŠ¨ç§»åŠ¨åˆ°æ–°çš„èŠ‚ç‚¹ã€‚\n\n2.codisï¼Œç›®å‰ç”¨çš„æœ€å¤šçš„é›†ç¾¤æ–¹æ¡ˆï¼ŒåŸºæœ¬å’Œtwemproxyä¸€è‡´çš„æ•ˆæœï¼Œä½†å®ƒæ”¯æŒåœ¨ èŠ‚ç‚¹æ•°é‡æ”¹å˜æƒ…å†µä¸‹ï¼Œæ—§èŠ‚ç‚¹æ•°æ®å¯æ¢å¤åˆ°æ–°hashèŠ‚ç‚¹ã€‚\n\n3.redis cluster3.0è‡ªå¸¦çš„é›†ç¾¤ï¼Œç‰¹ç‚¹åœ¨äºä»–çš„åˆ†å¸ƒå¼ç®—æ³•ä¸æ˜¯ä¸€è‡´æ€§hashï¼Œè€Œæ˜¯hashæ§½çš„æ¦‚å¿µï¼Œä»¥åŠè‡ªèº«æ”¯æŒèŠ‚ç‚¹è®¾ç½®ä»èŠ‚ç‚¹ã€‚å…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚\n\n4.åœ¨ä¸šåŠ¡ä»£ç å±‚å®ç°ï¼Œèµ·å‡ ä¸ªæ¯«æ— å…³è”çš„rediså®ä¾‹ï¼Œåœ¨ä»£ç å±‚ï¼Œå¯¹key è¿›è¡Œhashè®¡ç®—ï¼Œç„¶åå»å¯¹åº”çš„rediså®ä¾‹æ“ä½œæ•°æ®ã€‚ è¿™ç§æ–¹å¼å¯¹hashå±‚ä»£ç è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€ƒè™‘éƒ¨åˆ†åŒ…æ‹¬ï¼ŒèŠ‚ç‚¹å¤±æ•ˆåçš„æ›¿ä»£ç®—æ³•æ–¹æ¡ˆï¼Œæ•°æ®éœ‡è¡åçš„è‡ªåŠ¨è„šæœ¬æ¢å¤ï¼Œå®ä¾‹çš„ç›‘æ§ï¼Œç­‰ç­‰ã€‚\n\n11ã€Redisé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ï¼Ÿ\n\næœ‰Aï¼ŒBï¼ŒCä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤,åœ¨æ²¡æœ‰å¤åˆ¶æ¨¡å‹çš„æƒ…å†µä¸‹,å¦‚æœèŠ‚ç‚¹Bå¤±è´¥äº†ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±ä¼šä»¥ä¸ºç¼ºå°‘5501-11000è¿™ä¸ªèŒƒå›´çš„æ§½è€Œä¸å¯ç”¨ã€‚\n\n12ã€MySQLé‡Œæœ‰2000wæ•°æ®ï¼Œredisä¸­åªå­˜20wçš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ\n\nrediså†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚\n\n13ã€Redisæœ‰å“ªäº›é€‚åˆçš„åœºæ™¯ï¼Ÿ\n\nï¼ˆ1ï¼‰ã€ä¼šè¯ç¼“å­˜ï¼ˆSession Cacheï¼‰\n\næœ€å¸¸ç”¨çš„ä¸€ç§ä½¿ç”¨Redisçš„æƒ…æ™¯æ˜¯ä¼šè¯ç¼“å­˜ï¼ˆsession cacheï¼‰ã€‚ç”¨Redisç¼“å­˜ä¼šè¯æ¯”å…¶ä»–å­˜å‚¨ï¼ˆå¦‚Memcachedï¼‰çš„ä¼˜åŠ¿åœ¨äºï¼šRedisæä¾›æŒä¹…åŒ–ã€‚å½“ç»´æŠ¤ä¸€ä¸ªä¸æ˜¯ä¸¥æ ¼è¦æ±‚ä¸€è‡´æ€§çš„ç¼“å­˜æ—¶ï¼Œå¦‚æœç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šä¸é«˜å…´çš„ï¼Œç°åœ¨ï¼Œä»–ä»¬è¿˜ä¼šè¿™æ ·å—ï¼Ÿ\n\nå¹¸è¿çš„æ˜¯ï¼Œéšç€ Redis è¿™äº›å¹´çš„æ”¹è¿›ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°æ€ä¹ˆæ°å½“çš„ä½¿ç”¨Redisæ¥ç¼“å­˜ä¼šè¯çš„æ–‡æ¡£ã€‚ç”šè‡³å¹¿ä¸ºäººçŸ¥çš„å•†ä¸šå¹³å°Magentoä¹Ÿæä¾›Redisçš„æ’ä»¶ã€‚\n\nï¼ˆ2ï¼‰ã€å…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰\n\né™¤åŸºæœ¬çš„ä¼šè¯tokenä¹‹å¤–ï¼ŒRedisè¿˜æä¾›å¾ˆç®€ä¾¿çš„FPCå¹³å°ã€‚å›åˆ°ä¸€è‡´æ€§é—®é¢˜ï¼Œå³ä½¿é‡å¯äº†Rediså®ä¾‹ï¼Œå› ä¸ºæœ‰ç£ç›˜çš„æŒä¹…åŒ–ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°é¡µé¢åŠ è½½é€Ÿåº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ä¸€ä¸ªæå¤§æ”¹è¿›ï¼Œç±»ä¼¼PHPæœ¬åœ°FPCã€‚\n\nå†æ¬¡ä»¥Magentoä¸ºä¾‹ï¼ŒMagentoæä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨Redisä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚\n\næ­¤å¤–ï¼Œå¯¹WordPressçš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚\n\nï¼ˆ3ï¼‰ã€é˜Ÿåˆ—\n\nReidsåœ¨å†…å­˜å­˜å‚¨å¼•æ“é¢†åŸŸçš„ä¸€å¤§ä¼˜ç‚¹æ˜¯æä¾› list å’Œ set æ“ä½œï¼Œè¿™ä½¿å¾—Redisèƒ½ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—å¹³å°æ¥ä½¿ç”¨ã€‚Redisä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨çš„æ“ä½œï¼Œå°±ç±»ä¼¼äºæœ¬åœ°ç¨‹åºè¯­è¨€ï¼ˆå¦‚Pythonï¼‰å¯¹ list çš„ push/pop æ“ä½œã€‚\n\nå¦‚æœä½ å¿«é€Ÿçš„åœ¨Googleä¸­æœç´¢â€œRedis queuesâ€ï¼Œä½ é©¬ä¸Šå°±èƒ½æ‰¾åˆ°å¤§é‡çš„å¼€æºé¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®çš„ç›®çš„å°±æ˜¯åˆ©ç”¨Redisåˆ›å»ºéå¸¸å¥½çš„åç«¯å·¥å…·ï¼Œä»¥æ»¡è¶³å„ç§é˜Ÿåˆ—éœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒCeleryæœ‰ä¸€ä¸ªåå°å°±æ˜¯ä½¿ç”¨Redisä½œä¸ºbrokerï¼Œä½ å¯ä»¥ä»è¿™é‡Œå»æŸ¥çœ‹ã€‚\n\nï¼ˆ4ï¼‰ï¼Œæ’è¡Œæ¦œ/è®¡æ•°å™¨\n\nRedisåœ¨å†…å­˜ä¸­å¯¹æ•°å­—è¿›è¡Œé€’å¢æˆ–é€’å‡çš„æ“ä½œå®ç°çš„éå¸¸å¥½ã€‚é›†åˆï¼ˆSetï¼‰å’Œæœ‰åºé›†åˆï¼ˆSorted Setï¼‰ä¹Ÿä½¿å¾—æˆ‘ä»¬åœ¨æ‰§è¡Œè¿™äº›æ“ä½œçš„æ—¶å€™å˜çš„éå¸¸ç®€å•ï¼ŒRedisåªæ˜¯æ­£å¥½æä¾›äº†è¿™ä¸¤ç§æ•°æ®ç»“æ„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä»æ’åºé›†åˆä¸­è·å–åˆ°æ’åæœ€é å‰çš„10ä¸ªç”¨æˆ·â€“æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œuser_scoresâ€ï¼Œæˆ‘ä»¬åªéœ€è¦åƒä¸‹é¢ä¸€æ ·æ‰§è¡Œå³å¯ï¼š\n\nå½“ç„¶ï¼Œè¿™æ˜¯å‡å®šä½ æ˜¯æ ¹æ®ä½ ç”¨æˆ·çš„åˆ†æ•°åšé€’å¢çš„æ’åºã€‚å¦‚æœä½ æƒ³è¿”å›ç”¨æˆ·åŠç”¨æˆ·çš„åˆ†æ•°ï¼Œä½ éœ€è¦è¿™æ ·æ‰§è¡Œï¼š\n\nZRANGE user_scores 0 10 WITHSCORES\n\nAgora Gameså°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œç”¨Rubyå®ç°çš„ï¼Œå®ƒçš„æ’è¡Œæ¦œå°±æ˜¯ä½¿ç”¨Redisæ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚\n\nï¼ˆ5ï¼‰ã€å‘å¸ƒ/è®¢é˜…\n\næœ€åï¼ˆä½†è‚¯å®šä¸æ˜¯æœ€ä¸é‡è¦çš„ï¼‰æ˜¯Redisçš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½ã€‚å‘å¸ƒ/è®¢é˜…çš„ä½¿ç”¨åœºæ™¯ç¡®å®éå¸¸å¤šã€‚æˆ‘å·²çœ‹è§äººä»¬åœ¨ç¤¾äº¤ç½‘ç»œè¿æ¥ä¸­ä½¿ç”¨ï¼Œè¿˜å¯ä½œä¸ºåŸºäºå‘å¸ƒ/è®¢é˜…çš„è„šæœ¬è§¦å‘å™¨ï¼Œç”šè‡³ç”¨Redisçš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½æ¥å»ºç«‹èŠå¤©ç³»ç»Ÿï¼ï¼ˆä¸ï¼Œè¿™æ˜¯çœŸçš„ï¼Œä½ å¯ä»¥å»æ ¸å®ï¼‰ã€‚\n\n14ã€Redisæ”¯æŒçš„Javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿå®˜æ–¹æ¨èç”¨å“ªä¸ªï¼Ÿ\n\nRedissonã€Jedisã€lettuceç­‰ç­‰ï¼Œå®˜æ–¹æ¨èä½¿ç”¨Redissonã€‚\n\n15ã€Rediså’ŒRedissonæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ\n\nRedissonæ˜¯ä¸€ä¸ªé«˜çº§çš„åˆ†å¸ƒå¼åè°ƒRediså®¢æœç«¯ï¼Œèƒ½å¸®åŠ©ç”¨æˆ·åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è½»æ¾å®ç°ä¸€äº›Javaçš„å¯¹è±¡ (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish / Subscribe, HyperLogLog)ã€‚\n\n16ã€Jedisä¸Redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ\n\nJedisæ˜¯Redisçš„Javaå®ç°çš„å®¢æˆ·ç«¯ï¼Œå…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼›Redissonå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„Javaæ•°æ®ç»“æ„ï¼Œå’ŒJedisç›¸æ¯”ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²æ“ä½œï¼Œä¸æ”¯æŒæ’åºã€äº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰Redisç‰¹æ€§ã€‚Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚\n\n17ã€Rediså¦‚ä½•è®¾ç½®å¯†ç åŠéªŒè¯å¯†ç ï¼Ÿ\n\nè®¾ç½®å¯†ç ï¼šconfig set requirepass 123456\n\næˆæƒå¯†ç ï¼šauth 123456\n\n18ã€è¯´è¯´Rediså“ˆå¸Œæ§½çš„æ¦‚å¿µï¼Ÿ\n\nRedisé›†ç¾¤æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hash,è€Œæ˜¯å¼•å…¥äº†å“ˆå¸Œæ§½çš„æ¦‚å¿µï¼ŒRedisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªkeyé€šè¿‡CRC16æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ï¼Œé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ã€‚\n\n19ã€Redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ\n\nä¸ºäº†ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…å¤§éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•é€šä¿¡çš„æƒ…å†µä¸‹é›†ç¾¤ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é›†ç¾¤ä½¿ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰N-1ä¸ªå¤åˆ¶å“.\n\n20ã€Redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\nRediså¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œã€‚\n\n21ã€Redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿ\n\nå¼‚æ­¥å¤åˆ¶\n\n22ã€Redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ\n\n16384ä¸ªã€‚\n\n23ã€Redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ\n\nRedisé›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨0æ•°æ®åº“ã€‚\n\n24ã€æ€ä¹ˆæµ‹è¯•Redisçš„è¿é€šæ€§ï¼Ÿ\n\nping\n\n25ã€Redisä¸­çš„ç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nä¸€æ¬¡è¯·æ±‚/å“åº”æœåŠ¡å™¨èƒ½å®ç°å¤„ç†æ–°çš„è¯·æ±‚å³ä½¿æ—§çš„è¯·æ±‚è¿˜æœªè¢«å“åº”ã€‚è¿™æ ·å°±å¯ä»¥å°†å¤šä¸ªå‘½ä»¤å‘é€åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ç”¨ç­‰å¾…å›å¤ï¼Œæœ€ååœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è¯»å–è¯¥ç­”å¤ã€‚\n\nè¿™å°±æ˜¯ç®¡é“ï¼ˆpipeliningï¼‰ï¼Œæ˜¯ä¸€ç§å‡ åå¹´æ¥å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ã€‚ä¾‹å¦‚è®¸å¤šPOP3åè®®å·²ç»å®ç°æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå¤§å¤§åŠ å¿«äº†ä»æœåŠ¡å™¨ä¸‹è½½æ–°é‚®ä»¶çš„è¿‡ç¨‹ã€‚\n\n26ã€æ€ä¹ˆç†è§£Redisäº‹åŠ¡ï¼Ÿ\n\näº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚\n\näº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚\n\n27ã€Redisäº‹åŠ¡ç›¸å…³çš„å‘½ä»¤æœ‰å“ªå‡ ä¸ªï¼Ÿ\n\nMULTIã€EXECã€DISCARDã€WATCH\n\n28ã€Redis keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ\n\nEXPIREå’ŒPERSISTå‘½ä»¤ã€‚\n\n29ã€Rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ\n\nå°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„webç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„key,è€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢.\n\n30ã€Rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\n\nä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚\nRediæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶, åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚\nä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚\næ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚\nå¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚\n\n31ã€Rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ\n\nLRUç®—æ³•\n\n32ã€Rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ\n\nRedis2.6å¼€å§‹redis-cliæ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸ºpipe modeçš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚\n\n33ã€ä¸ºä»€ä¹ˆè¦åšRedisåˆ†åŒºï¼Ÿ\n\nåˆ†åŒºå¯ä»¥è®©Redisç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRediså°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ã€‚å¦‚æœæ²¡æœ‰åˆ†åŒºï¼Œä½ æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€å°æœºå™¨çš„å†…å­˜ã€‚åˆ†åŒºä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ è®¡ç®—æœºå¾—åˆ°æˆå€æå‡,Redisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ã€‚\n\n34ã€ä½ çŸ¥é“æœ‰å“ªäº›Redisåˆ†åŒºå®ç°æ–¹æ¡ˆï¼Ÿ\n\nå®¢æˆ·ç«¯åˆ†åŒºå°±æ˜¯åœ¨å®¢æˆ·ç«¯å°±å·²ç»å†³å®šæ•°æ®ä¼šè¢«å­˜å‚¨åˆ°å“ªä¸ªredisèŠ‚ç‚¹æˆ–è€…ä»å“ªä¸ªredisèŠ‚ç‚¹è¯»å–ã€‚å¤§å¤šæ•°å®¢æˆ·ç«¯å·²ç»å®ç°äº†å®¢æˆ·ç«¯åˆ†åŒºã€‚\n\nä»£ç†åˆ†åŒº æ„å‘³ç€å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä»£ç†ï¼Œç„¶åä»£ç†å†³å®šå»å“ªä¸ªèŠ‚ç‚¹å†™æ•°æ®æˆ–è€…è¯»æ•°æ®ã€‚ä»£ç†æ ¹æ®åˆ†åŒºè§„åˆ™å†³å®šè¯·æ±‚å“ªäº›Rediså®ä¾‹ï¼Œç„¶åæ ¹æ®Redisçš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚rediså’Œmemcachedçš„ä¸€ç§ä»£ç†å®ç°å°±æ˜¯Twemproxy\n\næŸ¥è¯¢è·¯ç”±(Query routing) çš„æ„æ€æ˜¯å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ªrediså®ä¾‹ï¼Œç„¶åç”±Rediså°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„RedisèŠ‚ç‚¹ã€‚Redis Clusterå®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ªredisèŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ªredisèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥redirectedåˆ°æ­£ç¡®çš„redisèŠ‚ç‚¹ã€‚\n\n35ã€Redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ\n\næ¶‰åŠå¤šä¸ªkeyçš„æ“ä½œé€šå¸¸ä¸ä¼šè¢«æ”¯æŒã€‚ä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä¸¤ä¸ªé›†åˆæ±‚äº¤é›†ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒçš„Rediså®ä¾‹ï¼ˆå®é™…ä¸Šè¿™ç§æƒ…å†µä¹Ÿæœ‰åŠæ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨äº¤é›†æŒ‡ä»¤ï¼‰ã€‚\nåŒæ—¶æ“ä½œå¤šä¸ªkey,åˆ™ä¸èƒ½ä½¿ç”¨Redisäº‹åŠ¡.\nåˆ†åŒºä½¿ç”¨çš„ç²’åº¦æ˜¯keyï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªéå¸¸é•¿çš„æ’åºkeyå­˜å‚¨ä¸€ä¸ªæ•°æ®é›†ï¼ˆThe partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted setï¼‰.\nå½“ä½¿ç”¨åˆ†åŒºçš„æ—¶å€™ï¼Œæ•°æ®å¤„ç†ä¼šéå¸¸å¤æ‚ï¼Œä¾‹å¦‚ä¸ºäº†å¤‡ä»½ä½ å¿…é¡»ä»ä¸åŒçš„Rediså®ä¾‹å’Œä¸»æœºåŒæ—¶æ”¶é›†RDB / AOFæ–‡ä»¶ã€‚\nåˆ†åŒºæ—¶åŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹å¯èƒ½éå¸¸å¤æ‚ã€‚Redisé›†ç¾¤åœ¨è¿è¡Œæ—¶å¢åŠ æˆ–è€…åˆ é™¤RedisèŠ‚ç‚¹ï¼Œèƒ½åšåˆ°æœ€å¤§ç¨‹åº¦å¯¹ç”¨æˆ·é€æ˜åœ°æ•°æ®å†å¹³è¡¡ï¼Œä½†å…¶ä»–ä¸€äº›å®¢æˆ·ç«¯åˆ†åŒºæˆ–è€…ä»£ç†åˆ†åŒºæ–¹æ³•åˆ™ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§é¢„åˆ†ç‰‡çš„æŠ€æœ¯ä¹Ÿå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n36ã€RedisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ\n\nå¦‚æœRedisè¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚\nå¦‚æœRedisè¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„keys-to-nodesæ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯(å³RedisèŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰Redisé›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚\n37ã€åˆ†å¸ƒå¼Redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ\n\næ—¢ç„¶Redisæ˜¯å¦‚æ­¤çš„è½»é‡ï¼ˆå•å®ä¾‹åªä½¿ç”¨1Må†…å­˜ï¼‰,ä¸ºé˜²æ­¢ä»¥åçš„æ‰©å®¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸€å¼€å§‹å°±å¯åŠ¨è¾ƒå¤šå®ä¾‹ã€‚å³ä¾¿ä½ åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸€å¼€å§‹å°±è®©Redisä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œä½¿ç”¨åˆ†åŒºï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªå®ä¾‹ã€‚\n\nä¸€å¼€å§‹å°±å¤šè®¾ç½®å‡ ä¸ªRediså®ä¾‹ï¼Œä¾‹å¦‚32æˆ–è€…64ä¸ªå®ä¾‹ï¼Œå¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¿™æ“ä½œèµ·æ¥å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯ä»é•¿ä¹…æ¥çœ‹åšè¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚\n\nè¿™æ ·çš„è¯ï¼Œå½“ä½ çš„æ•°æ®ä¸æ–­å¢é•¿ï¼Œéœ€è¦æ›´å¤šçš„RedisæœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯ä»…ä»…å°†Rediså®ä¾‹ä»ä¸€å°æœåŠ¡è¿ç§»åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨è€Œå·²ï¼ˆè€Œä¸ç”¨è€ƒè™‘é‡æ–°åˆ†åŒºçš„é—®é¢˜ï¼‰ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å¦ä¸€å°æœåŠ¡å™¨ï¼Œä½ éœ€è¦å°†ä½ ä¸€åŠçš„Rediså®ä¾‹ä»ç¬¬ä¸€å°æœºå™¨è¿ç§»åˆ°ç¬¬äºŒå°æœºå™¨ã€‚\n\n38ã€Twemproxyæ˜¯ä»€ä¹ˆï¼Ÿ\n\nTwemproxyæ˜¯Twitterç»´æŠ¤çš„ï¼ˆç¼“å­˜ï¼‰ä»£ç†ç³»ç»Ÿï¼Œä»£ç†Memcachedçš„ASCIIåè®®å’ŒRedisåè®®ã€‚å®ƒæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œä½¿ç”¨cè¯­è¨€ç¼–å†™ï¼Œè¿è¡Œèµ·æ¥éå¸¸å¿«ã€‚å®ƒæ˜¯é‡‡ç”¨Apache 2.0 licenseçš„å¼€æºè½¯ä»¶ã€‚ Twemproxyæ”¯æŒè‡ªåŠ¨åˆ†åŒºï¼Œå¦‚æœå…¶ä»£ç†çš„å…¶ä¸­ä¸€ä¸ªRedisèŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹æ’é™¤ï¼ˆè¿™å°†æ”¹å˜åŸæ¥çš„keys-instancesçš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä»…åœ¨æŠŠRediså½“ç¼“å­˜æ—¶ä½¿ç”¨Twemproxy)ã€‚ Twemproxyæœ¬èº«ä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå› ä¸ºä½ å¯ä»¥å¯åŠ¨å¤šä¸ªTwemproxyå®ä¾‹ï¼Œç„¶åè®©ä½ çš„å®¢æˆ·ç«¯å»è¿æ¥ä»»æ„ä¸€ä¸ªTwemproxyå®ä¾‹ã€‚ Twemproxyæ˜¯Rediså®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œç”±å®ƒæ¥å¤„ç†åˆ†åŒºåŠŸèƒ½åº”è¯¥ä¸ç®—å¤æ‚ï¼Œå¹¶ä¸”åº”è¯¥ç®—æ¯”è¾ƒå¯é çš„ã€‚\n\n39ã€æ”¯æŒä¸€è‡´æ€§å“ˆå¸Œçš„å®¢æˆ·ç«¯æœ‰å“ªäº›ï¼Ÿ\n\nRedis-rbã€Predisç­‰ã€‚\n\n40ã€Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ\n\nRedisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚\nRedisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œåº”ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œ ç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚ åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚\n41ã€Redisçš„å†…å­˜å ç”¨æƒ…å†µæ€ä¹ˆæ ·ï¼Ÿ\n\nç»™ä½ ä¸¾ä¸ªä¾‹å­ï¼š 100ä¸‡ä¸ªé”®å€¼å¯¹ï¼ˆé”®æ˜¯0åˆ°999999å€¼æ˜¯å­—ç¬¦ä¸²â€œhello worldâ€ï¼‰åœ¨æˆ‘çš„32ä½çš„Macç¬”è®°æœ¬ä¸Š ç”¨äº†100MBã€‚åŒæ ·çš„æ•°æ®æ”¾åˆ°ä¸€ä¸ªkeyé‡Œåªéœ€è¦16MBï¼Œ è¿™æ˜¯å› ä¸ºé”®å€¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼€é”€ã€‚ åœ¨Memcachedä¸Šæ‰§è¡Œä¹Ÿæ˜¯ç±»ä¼¼çš„ç»“æœï¼Œä½†æ˜¯ç›¸å¯¹Redisçš„å¼€é”€è¦å°ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºRedisä¼šè®°å½•ç±»å‹ä¿¡æ¯å¼•ç”¨è®¡æ•°ç­‰ç­‰ã€‚\n\nå½“ç„¶ï¼Œå¤§é”®å€¼å¯¹æ—¶ä¸¤è€…çš„æ¯”ä¾‹è¦å¥½å¾ˆå¤šã€‚\n\n64ä½çš„ç³»ç»Ÿæ¯”32ä½çš„éœ€è¦æ›´å¤šçš„å†…å­˜å¼€é”€ï¼Œå°¤å…¶æ˜¯é”®å€¼å¯¹éƒ½è¾ƒå°æ—¶ï¼Œè¿™æ˜¯å› ä¸º64ä½çš„ç³»ç»Ÿé‡ŒæŒ‡é’ˆå ç”¨äº†8ä¸ªå­—èŠ‚ã€‚ ä½†æ˜¯ï¼Œå½“ç„¶ï¼Œ64ä½ç³»ç»Ÿæ”¯æŒæ›´å¤§çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸ºäº†è¿è¡Œå¤§å‹çš„RedisæœåŠ¡å™¨æˆ–å¤šæˆ–å°‘çš„éœ€è¦ä½¿ç”¨64ä½çš„ç³»ç»Ÿã€‚\n\n42ã€éƒ½æœ‰å“ªäº›åŠæ³•å¯ä»¥é™ä½Redisçš„å†…å­˜ä½¿ç”¨æƒ…å†µå‘¢ï¼Ÿ\n\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯32ä½çš„Rediså®ä¾‹ï¼Œå¯ä»¥å¥½å¥½åˆ©ç”¨Hash,list,sorted set,setç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„Key-Valueå¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚\n\n43ã€æŸ¥çœ‹Redisä½¿ç”¨æƒ…å†µåŠçŠ¶æ€ä¿¡æ¯ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ\n\ninfo\n\n44ã€Redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nå¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedisçš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥å°†Rediså½“ç¼“å­˜æ¥ä½¿ç”¨é…ç½®æ·˜æ±°æœºåˆ¶ï¼Œå½“Redisè¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚\n\n45ã€Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸CPUçš„åˆ©ç”¨ç‡ï¼Ÿ\n\nå¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ªRedisçš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ªCPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†ç‰‡ï¼ˆshardï¼‰ã€‚\n\n46ã€ä¸€ä¸ªRediså®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘çš„keysï¼ŸListã€Setã€Sorted Setä»–ä»¬æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘å…ƒç´ ï¼Ÿ\n\nç†è®ºä¸ŠRediså¯ä»¥å¤„ç†å¤šè¾¾232çš„keysï¼Œå¹¶ä¸”åœ¨å®é™…ä¸­è¿›è¡Œäº†æµ‹è¯•ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘å­˜æ”¾äº†2äº¿5åƒä¸‡çš„keysã€‚æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€äº›è¾ƒå¤§çš„å€¼ã€‚\n\nä»»ä½•listã€setã€å’Œsorted setéƒ½å¯ä»¥æ”¾232ä¸ªå…ƒç´ ã€‚\n\næ¢å¥è¯è¯´ï¼ŒRedisçš„å­˜å‚¨æé™æ˜¯ç³»ç»Ÿä¸­çš„å¯ç”¨å†…å­˜å€¼ã€‚\n\n47ã€Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ\n\n(1) Masteræœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼Œå¦‚RDBå†…å­˜å¿«ç…§å’ŒAOFæ—¥å¿—æ–‡ä»¶\n\n(2) å¦‚æœæ•°æ®æ¯”è¾ƒé‡è¦ï¼ŒæŸä¸ªSlaveå¼€å¯AOFå¤‡ä»½æ•°æ®ï¼Œç­–ç•¥è®¾ç½®ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡\n\n(3) ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒMasterå’ŒSlaveæœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…\n\n(4) å°½é‡é¿å…åœ¨å‹åŠ›å¾ˆå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“\n\n(5) ä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ä¸ºç¨³å®šï¼Œå³ï¼šMaster <- Slave1 <- Slave2 <- Slave3â€¦\n\nè¿™æ ·çš„ç»“æ„æ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç°Slaveå¯¹Masterçš„æ›¿æ¢ã€‚å¦‚æœMasteræŒ‚äº†ï¼Œå¯ä»¥ç«‹åˆ»å¯ç”¨Slave1åšMasterï¼Œå…¶ä»–ä¸å˜ã€‚\n\n48ã€Redisæä¾›äº†å“ªå‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ\n\nRDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨.\nAOFæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œ,å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®,AOFå‘½ä»¤ä»¥redisåè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾.Redisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™,ä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§.\nå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨,ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼.\nä½ ä¹Ÿå¯ä»¥åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼, åœ¨è¿™ç§æƒ…å†µä¸‹, å½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®,å› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´.\næœ€é‡è¦çš„äº‹æƒ…æ˜¯äº†è§£RDBå’ŒAOFæŒä¹…åŒ–æ–¹å¼çš„ä¸åŒ,è®©æˆ‘ä»¬ä»¥RDBæŒä¹…åŒ–æ–¹å¼å¼€å§‹ã€‚\n49ã€å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿ\n\nä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾PostgreSQLçš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚\n\næœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼šå› ä¸ºå®šæ—¶ç”ŸæˆRDBå¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ ä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…ä¹‹å‰æåˆ°çš„AOFç¨‹åºçš„bugã€‚\n\n50ã€ä¿®æ”¹é…ç½®ä¸é‡å¯Redisä¼šå®æ—¶ç”Ÿæ•ˆå—ï¼Ÿ\n\né’ˆå¯¹è¿è¡Œå®ä¾‹ï¼Œæœ‰è®¸å¤šé…ç½®é€‰é¡¹å¯ä»¥é€šè¿‡ CONFIG SET å‘½ä»¤è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ— éœ€æ‰§è¡Œä»»ä½•å½¢å¼çš„é‡å¯ã€‚ ä» Redis 2.2 å¼€å§‹ï¼Œå¯ä»¥ä» AOF åˆ‡æ¢åˆ° RDB çš„å¿«ç…§æŒä¹…æ€§æˆ–å…¶ä»–æ–¹å¼è€Œä¸éœ€è¦é‡å¯ Redisã€‚æ£€ç´¢ â€˜CONFIG GET *â€™ å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ã€‚\n\nä½†å¶å°”é‡æ–°å¯åŠ¨æ˜¯å¿…é¡»çš„ï¼Œå¦‚ä¸ºå‡çº§ Redis ç¨‹åºåˆ°æ–°çš„ç‰ˆæœ¬ï¼Œæˆ–è€…å½“ä½ éœ€è¦ä¿®æ”¹æŸäº›ç›®å‰ CONFIG å‘½ä»¤è¿˜ä¸æ”¯æŒçš„é…ç½®å‚æ•°çš„æ—¶å€™ã€‚\n\nè½¬è½½äºï¼š[https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/](https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/)","slug":"Redisé¢è¯•æ€»ç»“&å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ(è½¬)","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dn000qwen1d4eohmgf","content":"<p>Redis åœ¨äº’è”ç½‘æŠ€æœ¯å­˜å‚¨æ–¹é¢ä½¿ç”¨å¦‚æ­¤å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰çš„åç«¯æŠ€æœ¯é¢è¯•å®˜éƒ½è¦åœ¨ Redis çš„ä½¿ç”¨å’ŒåŸç†æ–¹é¢å¯¹å°ä¼™ä¼´ä»¬è¿›è¡Œå„ç§åˆéš¾ã€‚ä½œä¸ºä¸€ååœ¨äº’è”ç½‘æŠ€æœ¯è¡Œä¸šæ‰“å‡»è¿‡æˆç™¾ä¸Šåƒåã€è¯·å…è®¸æˆ‘å¤¸å¼ ä¸€ä¸‹ã€‘çš„èµ„æ·±æŠ€æœ¯é¢è¯•å®˜ï¼Œçœ‹è¿‡äº†æ— æ•°è½å¯çš„èº«å½±å¤±æœ›çš„ç¦»å¼€ï¼Œç•¥æ„Ÿæ„§ç–šï¼Œæ•…çŒ®ä¸Šæ­¤æ–‡ï¼Œå¸Œæœ›å„ä½è¯»è€…ä»¥åé¢è¯•åŠ¿å¦‚ç ´ç«¹ï¼Œæ°¸æ— å¤±è´¥ï¼</p>\n<h3 id=\"Redis-æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\"><a href=\"#Redis-æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\" class=\"headerlink\" title=\"Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\"></a>Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ</h3><p>å­—ç¬¦ä¸² Stringã€å­—å…¸ Hashã€åˆ—è¡¨ Listã€é›†åˆ Setã€æœ‰åºé›†åˆ SortedSetã€‚</p>\n<p>å¦‚æœä½ æ˜¯ Redis ä¸­é«˜çº§ç”¨æˆ·ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢å‡ ç§æ•°æ®ç»“æ„ HyperLogLogã€Geoã€Pub&#x2F;Subã€‚</p>\n<p>å¦‚æœä½ è¯´è¿˜ç©è¿‡ Redis Moduleï¼Œåƒ BloomFilterï¼ŒRedisSearchï¼ŒRedis-MLï¼Œé¢è¯•å®˜å¾—çœ¼ç›å°±å¼€å§‹å‘äº®äº†ã€‚</p>\n<h3 id=\"ä½¿ç”¨è¿‡-Redis-åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\"><a href=\"#ä½¿ç”¨è¿‡-Redis-åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\"></a>ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ</h3><p>å…ˆæ‹¿ setnx æ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨ expire ç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾ã€‚</p>\n<p>è¿™æ—¶å€™å¯¹æ–¹ä¼šå‘Šè¯‰ä½ è¯´ä½ å›ç­”å¾—ä¸é”™ï¼Œç„¶åæ¥ç€é—®å¦‚æœåœ¨ setnx ä¹‹åæ‰§è¡Œ expire ä¹‹å‰è¿›ç¨‹æ„å¤– crash æˆ–è€…è¦é‡å¯ç»´æŠ¤äº†ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>\n<p>è¿™æ—¶å€™ä½ è¦ç»™äºˆæƒŠè®¶çš„åé¦ˆï¼šå”‰ï¼Œæ˜¯å–”ï¼Œè¿™ä¸ªé”å°±æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾äº†ã€‚ç´§æ¥ç€ä½ éœ€è¦æŠ“ä¸€æŠ“è‡ªå·±å¾—è„‘è¢‹ï¼Œæ•…ä½œæ€è€ƒç‰‡åˆ»ï¼Œå¥½åƒæ¥ä¸‹æ¥çš„ç»“æœæ˜¯ä½ ä¸»åŠ¨æ€è€ƒå‡ºæ¥çš„ï¼Œç„¶åå›ç­”ï¼šæˆ‘è®°å¾— set æŒ‡ä»¤æœ‰éå¸¸å¤æ‚çš„å‚æ•°ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åŒæ—¶æŠŠ setnx å’Œ expire åˆæˆä¸€æ¡æŒ‡ä»¤æ¥ç”¨çš„ï¼å¯¹æ–¹è¿™æ—¶ä¼šæ˜¾éœ²ç¬‘å®¹ï¼Œå¿ƒé‡Œå¼€å§‹é»˜å¿µï¼šæ‘ï¼Œè¿™å°å­è¿˜ä¸é”™ã€‚</p>\n<p>å‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10w ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</p>\n<p>ä½¿ç”¨ keys æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚</p>\n<p>å¯¹æ–¹æ¥ç€è¿½é—®ï¼šå¦‚æœè¿™ä¸ª redis æ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨ keys æŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>\n<p>è¿™ä¸ªæ—¶å€™ä½ è¦å›ç­” redis å…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredis çš„å•çº¿ç¨‹çš„ã€‚keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ scan æŒ‡ä»¤ï¼Œscan æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keys æŒ‡ä»¤é•¿ã€‚</p>\n<h3 id=\"ä½¿ç”¨è¿‡-Redis-åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\"><a href=\"#ä½¿ç”¨è¿‡-Redis-åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\"></a>ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ</h3><p>ä¸€èˆ¬ä½¿ç”¨ list ç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“ lpop æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“ sleep ä¸€ä¼šå†é‡è¯•ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—®å¯ä¸å¯ä»¥ä¸ç”¨ sleep å‘¢ï¼Ÿlist è¿˜æœ‰ä¸ªæŒ‡ä»¤å« blpopï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—®èƒ½ä¸èƒ½ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡å‘¢ï¼Ÿä½¿ç”¨ pub&#x2F;sub ä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—® pub&#x2F;sub æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œå¾—ä½¿ç”¨ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—å¦‚ rabbitmq ç­‰ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—® redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿæˆ‘ä¼°è®¡ç°åœ¨ä½ å¾ˆæƒ³æŠŠé¢è¯•å®˜ä¸€æ£’æ‰“æ­»å¦‚æœä½ æ‰‹ä¸Šæœ‰ä¸€æ ¹æ£’çƒæ£çš„è¯ï¼Œæ€ä¹ˆé—®çš„è¿™ä¹ˆè¯¦ç»†ã€‚ä½†æ˜¯ä½ å¾ˆå…‹åˆ¶ï¼Œç„¶åç¥æ€è‡ªè‹¥çš„å›ç­”é“ï¼šä½¿ç”¨ sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸º scoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸º key è°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨ zrangebyscore æŒ‡ä»¤è·å– N ç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚</p>\n<p>åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜æš—åœ°é‡Œå·²ç»å¯¹ä½ ç«–èµ·äº†å¤§æ‹‡æŒ‡ã€‚ä½†æ˜¯ä»–ä¸çŸ¥é“çš„æ˜¯æ­¤åˆ»ä½ å´ç«–èµ·äº†ä¸­æŒ‡ï¼Œåœ¨æ¤…å­èƒŒåã€‚</p>\n<p>å¦‚æœæœ‰å¤§é‡çš„ key éœ€è¦è®¾ç½®åŒä¸€æ—¶é—´è¿‡æœŸï¼Œä¸€èˆ¬éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</p>\n<p>å¦‚æœå¤§é‡çš„ key è¿‡æœŸæ—¶é—´è®¾ç½®çš„è¿‡äºé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œredis å¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„å¡é¡¿ç°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚</p>\n<h3 id=\"Redis-å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\"><a href=\"#Redis-å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\" class=\"headerlink\" title=\"Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\"></a>Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ</h3><p>bgsave åšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaof åšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸º bgsave ä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ aof æ¥é…åˆä½¿ç”¨ã€‚åœ¨ redis å®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨ bgsave æŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨ aof é‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚</p>\n<p>å¯¹æ–¹è¿½é—®é‚£å¦‚æœçªç„¶æœºå™¨æ‰ç”µä¼šæ€æ ·ï¼Ÿå–å†³äº aof æ—¥å¿— sync å±æ€§çš„é…ç½®ï¼Œå¦‚æœä¸è¦æ±‚æ€§èƒ½ï¼Œåœ¨æ¯æ¡å†™æŒ‡ä»¤æ—¶éƒ½ sync ä¸€ä¸‹ç£ç›˜ï¼Œå°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯åœ¨é«˜æ€§èƒ½çš„è¦æ±‚ä¸‹æ¯æ¬¡éƒ½ sync æ˜¯ä¸ç°å®çš„ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å®šæ—¶ syncï¼Œæ¯”å¦‚ 1s1 æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æœ€å¤šå°±ä¼šä¸¢å¤± 1s çš„æ•°æ®ã€‚</p>\n<p>å¯¹æ–¹è¿½é—® bgsave çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ ç»™å‡ºä¸¤ä¸ªè¯æ±‡å°±å¯ä»¥äº†ï¼Œfork å’Œ cowã€‚fork æ˜¯æŒ‡ redis é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡Œ bgsave æ“ä½œï¼Œcow æŒ‡çš„æ˜¯ copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚</p>\n<h3 id=\"Pipeline-æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨-pipelineï¼Ÿ\"><a href=\"#Pipeline-æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨-pipelineï¼Ÿ\" class=\"headerlink\" title=\"Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ\"></a>Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ</h3><p>å¯ä»¥å°†å¤šæ¬¡ IO å¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯ pipeline æ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨ redis-benchmark è¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“ redis çš„ QPS å³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯ pipeline æ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚</p>\n<h3 id=\"Redis-çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\"><a href=\"#Redis-çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\"></a>Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ</h3><p>Redis å¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡ bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜ bufferï¼Œå¾…å®Œæˆåå°† rdb æ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°† rdb é•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚</p>\n<h3 id=\"æ˜¯å¦ä½¿ç”¨è¿‡-Redis-é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#æ˜¯å¦ä½¿ç”¨è¿‡-Redis-é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Redis Sentinal ç€çœ¼äºé«˜å¯ç”¨ï¼Œåœ¨ master å®•æœºæ—¶ä¼šè‡ªåŠ¨å°† slave æå‡ä¸º masterï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚</p>\n<p>Redis Cluster ç€çœ¼äºæ‰©å±•æ€§ï¼Œåœ¨å•ä¸ª redis å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ Cluster è¿›è¡Œåˆ†ç‰‡å­˜å‚¨ã€‚</p>\n<h2 id=\"å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\"><a href=\"#å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\" class=\"headerlink\" title=\"å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\"></a>å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ</h2><p>1ã€ä»€ä¹ˆæ˜¯Redisï¼Ÿ</p>\n<p>Redisæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªKey-Valueç±»å‹çš„å†…å­˜æ•°æ®åº“ï¼Œå¾ˆåƒmemcachedï¼Œæ•´ä¸ªæ•°æ®åº“ç»Ÿç»ŸåŠ è½½åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ“ä½œï¼Œå®šæœŸé€šè¿‡å¼‚æ­¥æ“ä½œæŠŠæ•°æ®åº“æ•°æ®flushåˆ°ç¡¬ç›˜ä¸Šè¿›è¡Œä¿å­˜ã€‚å› ä¸ºæ˜¯çº¯å†…å­˜æ“ä½œï¼ŒRedisçš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚ Redisçš„å‡ºè‰²ä¹‹å¤„ä¸ä»…ä»…æ˜¯æ€§èƒ½ï¼ŒRedisæœ€å¤§çš„é­…åŠ›æ˜¯æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œæ­¤å¤–å•ä¸ªvalueçš„æœ€å¤§é™åˆ¶æ˜¯1GBï¼Œä¸åƒ memcachedåªèƒ½ä¿å­˜1MBçš„æ•°æ®ï¼Œå› æ­¤Rediså¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”æ–¹è¯´ç”¨ä»–çš„Listæ¥åšFIFOåŒå‘é“¾è¡¨ï¼Œå®ç°ä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§ èƒ½æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼Œç”¨ä»–çš„Setå¯ä»¥åšé«˜æ€§èƒ½çš„tagç³»ç»Ÿç­‰ç­‰ã€‚å¦å¤–Redisä¹Ÿå¯ä»¥å¯¹å­˜å…¥çš„Key-Valueè®¾ç½®expireæ—¶é—´ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«å½“ä½œä¸€ ä¸ªåŠŸèƒ½åŠ å¼ºç‰ˆçš„memcachedæ¥ç”¨ã€‚ Redisçš„ä¸»è¦ç¼ºç‚¹æ˜¯æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚</p>\n<p>2ã€Redisç›¸æ¯”memcachedæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p>\n<p>(1) memcachedæ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œredisä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹</p>\n<p>(2) redisçš„é€Ÿåº¦æ¯”memcachedå¿«å¾ˆå¤š</p>\n<p>(3) rediså¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®</p>\n<p>3ã€Redisæ”¯æŒå“ªå‡ ç§æ•°æ®ç±»å‹ï¼Ÿ</p>\n<p>Stringã€Listã€Setã€Sorted Setã€hashes</p>\n<p>4ã€Redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ</p>\n<p>å†…å­˜ã€‚</p>\n<p>5ã€Redisçš„å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>Remote Dictionary Serverã€‚</p>\n<p>6ã€Redisæœ‰å“ªå‡ ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼Ÿ</p>\n<p>noeviction:è¿”å›é”™è¯¯å½“å†…å­˜é™åˆ¶è¾¾åˆ°å¹¶ä¸”å®¢æˆ·ç«¯å°è¯•æ‰§è¡Œä¼šè®©æ›´å¤šå†…å­˜è¢«ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†çš„å†™å…¥æŒ‡ä»¤ï¼Œä½†DELå’Œå‡ ä¸ªä¾‹å¤–ï¼‰</p>\n<p>allkeys-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>volatile-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>allkeys-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>volatile-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®ã€‚</p>\n<p>volatile-ttl: å›æ”¶åœ¨è¿‡æœŸé›†åˆçš„é”®ï¼Œå¹¶ä¸”ä¼˜å…ˆå›æ”¶å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>7ã€Rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›Windowsç‰ˆæœ¬ï¼Ÿ</p>\n<p>å› ä¸ºç›®å‰Linuxç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘windowsç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚</p>\n<p>8ã€ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>512M</p>\n<p>9ã€ä¸ºä»€ä¹ˆRediséœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Ÿ</p>\n<p>Redisä¸ºäº†è¾¾åˆ°æœ€å¿«çš„è¯»å†™é€Ÿåº¦å°†æ•°æ®éƒ½è¯»åˆ°å†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥rediså…·æœ‰å¿«é€Ÿå’Œæ•°æ®æŒä¹…åŒ–çš„ç‰¹å¾ã€‚å¦‚æœä¸å°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œç£ç›˜I&#x2F;Oé€Ÿåº¦ä¸ºä¸¥é‡å½±å“redisçš„æ€§èƒ½ã€‚åœ¨å†…å­˜è¶Šæ¥è¶Šä¾¿å®œçš„ä»Šå¤©ï¼Œrediså°†ä¼šè¶Šæ¥è¶Šå—æ¬¢è¿ã€‚ å¦‚æœè®¾ç½®äº†æœ€å¤§ä½¿ç”¨çš„å†…å­˜ï¼Œåˆ™æ•°æ®å·²æœ‰è®°å½•æ•°è¾¾åˆ°å†…å­˜é™å€¼åä¸èƒ½ç»§ç»­æ’å…¥æ–°å€¼ã€‚</p>\n<p>10ã€Redisé›†ç¾¤æ–¹æ¡ˆåº”è¯¥æ€ä¹ˆåšï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ</p>\n<p>1.twemproxyï¼Œå¤§æ¦‚æ¦‚å¿µæ˜¯ï¼Œå®ƒç±»ä¼¼äºä¸€ä¸ªä»£ç†æ–¹å¼ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ™®é€šredisæ— ä»»ä½•åŒºåˆ«ï¼Œè®¾ç½®å¥½å®ƒä¸‹å±çš„å¤šä¸ªrediså®ä¾‹åï¼Œä½¿ç”¨æ—¶åœ¨æœ¬éœ€è¦è¿æ¥redisçš„åœ°æ–¹æ”¹ä¸ºè¿æ¥twemproxyï¼Œå®ƒä¼šä»¥ä¸€ä¸ªä»£ç†çš„èº«ä»½æ¥æ”¶è¯·æ±‚å¹¶ä½¿ç”¨ä¸€è‡´æ€§hashç®—æ³•ï¼Œå°†è¯·æ±‚è½¬æ¥åˆ°å…·ä½“redisï¼Œå°†ç»“æœå†è¿”å›twemproxyã€‚ä½¿ç”¨æ–¹å¼ç®€ä¾¿(ç›¸å¯¹redisåªéœ€ä¿®æ”¹è¿æ¥ç«¯å£)ï¼Œå¯¹æ—§é¡¹ç›®æ‰©å±•çš„é¦–é€‰ã€‚ é—®é¢˜ï¼štwemproxyè‡ªèº«å•ç«¯å£å®ä¾‹çš„å‹åŠ›ï¼Œä½¿ç”¨ä¸€è‡´æ€§hashåï¼Œå¯¹redisèŠ‚ç‚¹æ•°é‡æ”¹å˜æ—¶å€™çš„è®¡ç®—å€¼çš„æ”¹å˜ï¼Œæ•°æ®æ— æ³•è‡ªåŠ¨ç§»åŠ¨åˆ°æ–°çš„èŠ‚ç‚¹ã€‚</p>\n<p>2.codisï¼Œç›®å‰ç”¨çš„æœ€å¤šçš„é›†ç¾¤æ–¹æ¡ˆï¼ŒåŸºæœ¬å’Œtwemproxyä¸€è‡´çš„æ•ˆæœï¼Œä½†å®ƒæ”¯æŒåœ¨ èŠ‚ç‚¹æ•°é‡æ”¹å˜æƒ…å†µä¸‹ï¼Œæ—§èŠ‚ç‚¹æ•°æ®å¯æ¢å¤åˆ°æ–°hashèŠ‚ç‚¹ã€‚</p>\n<p>3.redis cluster3.0è‡ªå¸¦çš„é›†ç¾¤ï¼Œç‰¹ç‚¹åœ¨äºä»–çš„åˆ†å¸ƒå¼ç®—æ³•ä¸æ˜¯ä¸€è‡´æ€§hashï¼Œè€Œæ˜¯hashæ§½çš„æ¦‚å¿µï¼Œä»¥åŠè‡ªèº«æ”¯æŒèŠ‚ç‚¹è®¾ç½®ä»èŠ‚ç‚¹ã€‚å…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚</p>\n<p>4.åœ¨ä¸šåŠ¡ä»£ç å±‚å®ç°ï¼Œèµ·å‡ ä¸ªæ¯«æ— å…³è”çš„rediså®ä¾‹ï¼Œåœ¨ä»£ç å±‚ï¼Œå¯¹key è¿›è¡Œhashè®¡ç®—ï¼Œç„¶åå»å¯¹åº”çš„rediså®ä¾‹æ“ä½œæ•°æ®ã€‚ è¿™ç§æ–¹å¼å¯¹hashå±‚ä»£ç è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€ƒè™‘éƒ¨åˆ†åŒ…æ‹¬ï¼ŒèŠ‚ç‚¹å¤±æ•ˆåçš„æ›¿ä»£ç®—æ³•æ–¹æ¡ˆï¼Œæ•°æ®éœ‡è¡åçš„è‡ªåŠ¨è„šæœ¬æ¢å¤ï¼Œå®ä¾‹çš„ç›‘æ§ï¼Œç­‰ç­‰ã€‚</p>\n<p>11ã€Redisé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ï¼Ÿ</p>\n<p>æœ‰Aï¼ŒBï¼ŒCä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤,åœ¨æ²¡æœ‰å¤åˆ¶æ¨¡å‹çš„æƒ…å†µä¸‹,å¦‚æœèŠ‚ç‚¹Bå¤±è´¥äº†ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±ä¼šä»¥ä¸ºç¼ºå°‘5501-11000è¿™ä¸ªèŒƒå›´çš„æ§½è€Œä¸å¯ç”¨ã€‚</p>\n<p>12ã€MySQLé‡Œæœ‰2000wæ•°æ®ï¼Œredisä¸­åªå­˜20wçš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ</p>\n<p>rediså†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚</p>\n<p>13ã€Redisæœ‰å“ªäº›é€‚åˆçš„åœºæ™¯ï¼Ÿ</p>\n<p>ï¼ˆ1ï¼‰ã€ä¼šè¯ç¼“å­˜ï¼ˆSession Cacheï¼‰</p>\n<p>æœ€å¸¸ç”¨çš„ä¸€ç§ä½¿ç”¨Redisçš„æƒ…æ™¯æ˜¯ä¼šè¯ç¼“å­˜ï¼ˆsession cacheï¼‰ã€‚ç”¨Redisç¼“å­˜ä¼šè¯æ¯”å…¶ä»–å­˜å‚¨ï¼ˆå¦‚Memcachedï¼‰çš„ä¼˜åŠ¿åœ¨äºï¼šRedisæä¾›æŒä¹…åŒ–ã€‚å½“ç»´æŠ¤ä¸€ä¸ªä¸æ˜¯ä¸¥æ ¼è¦æ±‚ä¸€è‡´æ€§çš„ç¼“å­˜æ—¶ï¼Œå¦‚æœç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šä¸é«˜å…´çš„ï¼Œç°åœ¨ï¼Œä»–ä»¬è¿˜ä¼šè¿™æ ·å—ï¼Ÿ</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œéšç€ Redis è¿™äº›å¹´çš„æ”¹è¿›ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°æ€ä¹ˆæ°å½“çš„ä½¿ç”¨Redisæ¥ç¼“å­˜ä¼šè¯çš„æ–‡æ¡£ã€‚ç”šè‡³å¹¿ä¸ºäººçŸ¥çš„å•†ä¸šå¹³å°Magentoä¹Ÿæä¾›Redisçš„æ’ä»¶ã€‚</p>\n<p>ï¼ˆ2ï¼‰ã€å…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰</p>\n<p>é™¤åŸºæœ¬çš„ä¼šè¯tokenä¹‹å¤–ï¼ŒRedisè¿˜æä¾›å¾ˆç®€ä¾¿çš„FPCå¹³å°ã€‚å›åˆ°ä¸€è‡´æ€§é—®é¢˜ï¼Œå³ä½¿é‡å¯äº†Rediså®ä¾‹ï¼Œå› ä¸ºæœ‰ç£ç›˜çš„æŒä¹…åŒ–ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°é¡µé¢åŠ è½½é€Ÿåº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ä¸€ä¸ªæå¤§æ”¹è¿›ï¼Œç±»ä¼¼PHPæœ¬åœ°FPCã€‚</p>\n<p>å†æ¬¡ä»¥Magentoä¸ºä¾‹ï¼ŒMagentoæä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨Redisä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚</p>\n<p>æ­¤å¤–ï¼Œå¯¹WordPressçš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚</p>\n<p>ï¼ˆ3ï¼‰ã€é˜Ÿåˆ—</p>\n<p>Reidsåœ¨å†…å­˜å­˜å‚¨å¼•æ“é¢†åŸŸçš„ä¸€å¤§ä¼˜ç‚¹æ˜¯æä¾› list å’Œ set æ“ä½œï¼Œè¿™ä½¿å¾—Redisèƒ½ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—å¹³å°æ¥ä½¿ç”¨ã€‚Redisä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨çš„æ“ä½œï¼Œå°±ç±»ä¼¼äºæœ¬åœ°ç¨‹åºè¯­è¨€ï¼ˆå¦‚Pythonï¼‰å¯¹ list çš„ push&#x2F;pop æ“ä½œã€‚</p>\n<p>å¦‚æœä½ å¿«é€Ÿçš„åœ¨Googleä¸­æœç´¢â€œRedis queuesâ€ï¼Œä½ é©¬ä¸Šå°±èƒ½æ‰¾åˆ°å¤§é‡çš„å¼€æºé¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®çš„ç›®çš„å°±æ˜¯åˆ©ç”¨Redisåˆ›å»ºéå¸¸å¥½çš„åç«¯å·¥å…·ï¼Œä»¥æ»¡è¶³å„ç§é˜Ÿåˆ—éœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒCeleryæœ‰ä¸€ä¸ªåå°å°±æ˜¯ä½¿ç”¨Redisä½œä¸ºbrokerï¼Œä½ å¯ä»¥ä»è¿™é‡Œå»æŸ¥çœ‹ã€‚</p>\n<p>ï¼ˆ4ï¼‰ï¼Œæ’è¡Œæ¦œ&#x2F;è®¡æ•°å™¨</p>\n<p>Redisåœ¨å†…å­˜ä¸­å¯¹æ•°å­—è¿›è¡Œé€’å¢æˆ–é€’å‡çš„æ“ä½œå®ç°çš„éå¸¸å¥½ã€‚é›†åˆï¼ˆSetï¼‰å’Œæœ‰åºé›†åˆï¼ˆSorted Setï¼‰ä¹Ÿä½¿å¾—æˆ‘ä»¬åœ¨æ‰§è¡Œè¿™äº›æ“ä½œçš„æ—¶å€™å˜çš„éå¸¸ç®€å•ï¼ŒRedisåªæ˜¯æ­£å¥½æä¾›äº†è¿™ä¸¤ç§æ•°æ®ç»“æ„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä»æ’åºé›†åˆä¸­è·å–åˆ°æ’åæœ€é å‰çš„10ä¸ªç”¨æˆ·â€“æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œuser_scoresâ€ï¼Œæˆ‘ä»¬åªéœ€è¦åƒä¸‹é¢ä¸€æ ·æ‰§è¡Œå³å¯ï¼š</p>\n<p>å½“ç„¶ï¼Œè¿™æ˜¯å‡å®šä½ æ˜¯æ ¹æ®ä½ ç”¨æˆ·çš„åˆ†æ•°åšé€’å¢çš„æ’åºã€‚å¦‚æœä½ æƒ³è¿”å›ç”¨æˆ·åŠç”¨æˆ·çš„åˆ†æ•°ï¼Œä½ éœ€è¦è¿™æ ·æ‰§è¡Œï¼š</p>\n<p>ZRANGE user_scores 0 10 WITHSCORES</p>\n<p>Agora Gameså°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œç”¨Rubyå®ç°çš„ï¼Œå®ƒçš„æ’è¡Œæ¦œå°±æ˜¯ä½¿ç”¨Redisæ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚</p>\n<p>ï¼ˆ5ï¼‰ã€å‘å¸ƒ&#x2F;è®¢é˜…</p>\n<p>æœ€åï¼ˆä½†è‚¯å®šä¸æ˜¯æœ€ä¸é‡è¦çš„ï¼‰æ˜¯Redisçš„å‘å¸ƒ&#x2F;è®¢é˜…åŠŸèƒ½ã€‚å‘å¸ƒ&#x2F;è®¢é˜…çš„ä½¿ç”¨åœºæ™¯ç¡®å®éå¸¸å¤šã€‚æˆ‘å·²çœ‹è§äººä»¬åœ¨ç¤¾äº¤ç½‘ç»œè¿æ¥ä¸­ä½¿ç”¨ï¼Œè¿˜å¯ä½œä¸ºåŸºäºå‘å¸ƒ&#x2F;è®¢é˜…çš„è„šæœ¬è§¦å‘å™¨ï¼Œç”šè‡³ç”¨Redisçš„å‘å¸ƒ&#x2F;è®¢é˜…åŠŸèƒ½æ¥å»ºç«‹èŠå¤©ç³»ç»Ÿï¼ï¼ˆä¸ï¼Œè¿™æ˜¯çœŸçš„ï¼Œä½ å¯ä»¥å»æ ¸å®ï¼‰ã€‚</p>\n<p>14ã€Redisæ”¯æŒçš„Javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿå®˜æ–¹æ¨èç”¨å“ªä¸ªï¼Ÿ</p>\n<p>Redissonã€Jedisã€lettuceç­‰ç­‰ï¼Œå®˜æ–¹æ¨èä½¿ç”¨Redissonã€‚</p>\n<p>15ã€Rediså’ŒRedissonæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>\n<p>Redissonæ˜¯ä¸€ä¸ªé«˜çº§çš„åˆ†å¸ƒå¼åè°ƒRediså®¢æœç«¯ï¼Œèƒ½å¸®åŠ©ç”¨æˆ·åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è½»æ¾å®ç°ä¸€äº›Javaçš„å¯¹è±¡ (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish &#x2F; Subscribe, HyperLogLog)ã€‚</p>\n<p>16ã€Jedisä¸Redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</p>\n<p>Jedisæ˜¯Redisçš„Javaå®ç°çš„å®¢æˆ·ç«¯ï¼Œå…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼›Redissonå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„Javaæ•°æ®ç»“æ„ï¼Œå’ŒJedisç›¸æ¯”ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²æ“ä½œï¼Œä¸æ”¯æŒæ’åºã€äº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰Redisç‰¹æ€§ã€‚Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</p>\n<p>17ã€Rediså¦‚ä½•è®¾ç½®å¯†ç åŠéªŒè¯å¯†ç ï¼Ÿ</p>\n<p>è®¾ç½®å¯†ç ï¼šconfig set requirepass 123456</p>\n<p>æˆæƒå¯†ç ï¼šauth 123456</p>\n<p>18ã€è¯´è¯´Rediså“ˆå¸Œæ§½çš„æ¦‚å¿µï¼Ÿ</p>\n<p>Redisé›†ç¾¤æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hash,è€Œæ˜¯å¼•å…¥äº†å“ˆå¸Œæ§½çš„æ¦‚å¿µï¼ŒRedisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªkeyé€šè¿‡CRC16æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ï¼Œé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ã€‚</p>\n<p>19ã€Redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ</p>\n<p>ä¸ºäº†ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…å¤§éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•é€šä¿¡çš„æƒ…å†µä¸‹é›†ç¾¤ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é›†ç¾¤ä½¿ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰N-1ä¸ªå¤åˆ¶å“.</p>\n<p>20ã€Redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>Rediså¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œã€‚</p>\n<p>21ã€Redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿ</p>\n<p>å¼‚æ­¥å¤åˆ¶</p>\n<p>22ã€Redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>16384ä¸ªã€‚</p>\n<p>23ã€Redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ</p>\n<p>Redisé›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨0æ•°æ®åº“ã€‚</p>\n<p>24ã€æ€ä¹ˆæµ‹è¯•Redisçš„è¿é€šæ€§ï¼Ÿ</p>\n<p>ping</p>\n<p>25ã€Redisä¸­çš„ç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>\n<p>ä¸€æ¬¡è¯·æ±‚&#x2F;å“åº”æœåŠ¡å™¨èƒ½å®ç°å¤„ç†æ–°çš„è¯·æ±‚å³ä½¿æ—§çš„è¯·æ±‚è¿˜æœªè¢«å“åº”ã€‚è¿™æ ·å°±å¯ä»¥å°†å¤šä¸ªå‘½ä»¤å‘é€åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ç”¨ç­‰å¾…å›å¤ï¼Œæœ€ååœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è¯»å–è¯¥ç­”å¤ã€‚</p>\n<p>è¿™å°±æ˜¯ç®¡é“ï¼ˆpipeliningï¼‰ï¼Œæ˜¯ä¸€ç§å‡ åå¹´æ¥å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ã€‚ä¾‹å¦‚è®¸å¤šPOP3åè®®å·²ç»å®ç°æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå¤§å¤§åŠ å¿«äº†ä»æœåŠ¡å™¨ä¸‹è½½æ–°é‚®ä»¶çš„è¿‡ç¨‹ã€‚</p>\n<p>26ã€æ€ä¹ˆç†è§£Redisäº‹åŠ¡ï¼Ÿ</p>\n<p>äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚</p>\n<p>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚</p>\n<p>27ã€Redisäº‹åŠ¡ç›¸å…³çš„å‘½ä»¤æœ‰å“ªå‡ ä¸ªï¼Ÿ</p>\n<p>MULTIã€EXECã€DISCARDã€WATCH</p>\n<p>28ã€Redis keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ</p>\n<p>EXPIREå’ŒPERSISTå‘½ä»¤ã€‚</p>\n<p>29ã€Rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ</p>\n<p>å°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„webç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„key,è€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢.</p>\n<p>30ã€Rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</p>\n<p>ä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚<br>Rediæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶, åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚<br>ä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚<br>å¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚</p>\n<p>31ã€Rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ</p>\n<p>LRUç®—æ³•</p>\n<p>32ã€Rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ</p>\n<p>Redis2.6å¼€å§‹redis-cliæ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸ºpipe modeçš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚</p>\n<p>33ã€ä¸ºä»€ä¹ˆè¦åšRedisåˆ†åŒºï¼Ÿ</p>\n<p>åˆ†åŒºå¯ä»¥è®©Redisç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRediså°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ã€‚å¦‚æœæ²¡æœ‰åˆ†åŒºï¼Œä½ æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€å°æœºå™¨çš„å†…å­˜ã€‚åˆ†åŒºä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ è®¡ç®—æœºå¾—åˆ°æˆå€æå‡,Redisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ã€‚</p>\n<p>34ã€ä½ çŸ¥é“æœ‰å“ªäº›Redisåˆ†åŒºå®ç°æ–¹æ¡ˆï¼Ÿ</p>\n<p>å®¢æˆ·ç«¯åˆ†åŒºå°±æ˜¯åœ¨å®¢æˆ·ç«¯å°±å·²ç»å†³å®šæ•°æ®ä¼šè¢«å­˜å‚¨åˆ°å“ªä¸ªredisèŠ‚ç‚¹æˆ–è€…ä»å“ªä¸ªredisèŠ‚ç‚¹è¯»å–ã€‚å¤§å¤šæ•°å®¢æˆ·ç«¯å·²ç»å®ç°äº†å®¢æˆ·ç«¯åˆ†åŒºã€‚</p>\n<p>ä»£ç†åˆ†åŒº æ„å‘³ç€å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä»£ç†ï¼Œç„¶åä»£ç†å†³å®šå»å“ªä¸ªèŠ‚ç‚¹å†™æ•°æ®æˆ–è€…è¯»æ•°æ®ã€‚ä»£ç†æ ¹æ®åˆ†åŒºè§„åˆ™å†³å®šè¯·æ±‚å“ªäº›Rediså®ä¾‹ï¼Œç„¶åæ ¹æ®Redisçš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚rediså’Œmemcachedçš„ä¸€ç§ä»£ç†å®ç°å°±æ˜¯Twemproxy</p>\n<p>æŸ¥è¯¢è·¯ç”±(Query routing) çš„æ„æ€æ˜¯å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ªrediså®ä¾‹ï¼Œç„¶åç”±Rediså°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„RedisèŠ‚ç‚¹ã€‚Redis Clusterå®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ªredisèŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ªredisèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥redirectedåˆ°æ­£ç¡®çš„redisèŠ‚ç‚¹ã€‚</p>\n<p>35ã€Redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ</p>\n<p>æ¶‰åŠå¤šä¸ªkeyçš„æ“ä½œé€šå¸¸ä¸ä¼šè¢«æ”¯æŒã€‚ä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä¸¤ä¸ªé›†åˆæ±‚äº¤é›†ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒçš„Rediså®ä¾‹ï¼ˆå®é™…ä¸Šè¿™ç§æƒ…å†µä¹Ÿæœ‰åŠæ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨äº¤é›†æŒ‡ä»¤ï¼‰ã€‚<br>åŒæ—¶æ“ä½œå¤šä¸ªkey,åˆ™ä¸èƒ½ä½¿ç”¨Redisäº‹åŠ¡.<br>åˆ†åŒºä½¿ç”¨çš„ç²’åº¦æ˜¯keyï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªéå¸¸é•¿çš„æ’åºkeyå­˜å‚¨ä¸€ä¸ªæ•°æ®é›†ï¼ˆThe partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted setï¼‰.<br>å½“ä½¿ç”¨åˆ†åŒºçš„æ—¶å€™ï¼Œæ•°æ®å¤„ç†ä¼šéå¸¸å¤æ‚ï¼Œä¾‹å¦‚ä¸ºäº†å¤‡ä»½ä½ å¿…é¡»ä»ä¸åŒçš„Rediså®ä¾‹å’Œä¸»æœºåŒæ—¶æ”¶é›†RDB &#x2F; AOFæ–‡ä»¶ã€‚<br>åˆ†åŒºæ—¶åŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹å¯èƒ½éå¸¸å¤æ‚ã€‚Redisé›†ç¾¤åœ¨è¿è¡Œæ—¶å¢åŠ æˆ–è€…åˆ é™¤RedisèŠ‚ç‚¹ï¼Œèƒ½åšåˆ°æœ€å¤§ç¨‹åº¦å¯¹ç”¨æˆ·é€æ˜åœ°æ•°æ®å†å¹³è¡¡ï¼Œä½†å…¶ä»–ä¸€äº›å®¢æˆ·ç«¯åˆ†åŒºæˆ–è€…ä»£ç†åˆ†åŒºæ–¹æ³•åˆ™ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§é¢„åˆ†ç‰‡çš„æŠ€æœ¯ä¹Ÿå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>36ã€RedisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ</p>\n<p>å¦‚æœRedisè¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚<br>å¦‚æœRedisè¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„keys-to-nodesæ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯(å³RedisèŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰Redisé›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚<br>37ã€åˆ†å¸ƒå¼Redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>æ—¢ç„¶Redisæ˜¯å¦‚æ­¤çš„è½»é‡ï¼ˆå•å®ä¾‹åªä½¿ç”¨1Må†…å­˜ï¼‰,ä¸ºé˜²æ­¢ä»¥åçš„æ‰©å®¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸€å¼€å§‹å°±å¯åŠ¨è¾ƒå¤šå®ä¾‹ã€‚å³ä¾¿ä½ åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸€å¼€å§‹å°±è®©Redisä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œä½¿ç”¨åˆ†åŒºï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªå®ä¾‹ã€‚</p>\n<p>ä¸€å¼€å§‹å°±å¤šè®¾ç½®å‡ ä¸ªRediså®ä¾‹ï¼Œä¾‹å¦‚32æˆ–è€…64ä¸ªå®ä¾‹ï¼Œå¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¿™æ“ä½œèµ·æ¥å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯ä»é•¿ä¹…æ¥çœ‹åšè¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚</p>\n<p>è¿™æ ·çš„è¯ï¼Œå½“ä½ çš„æ•°æ®ä¸æ–­å¢é•¿ï¼Œéœ€è¦æ›´å¤šçš„RedisæœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯ä»…ä»…å°†Rediså®ä¾‹ä»ä¸€å°æœåŠ¡è¿ç§»åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨è€Œå·²ï¼ˆè€Œä¸ç”¨è€ƒè™‘é‡æ–°åˆ†åŒºçš„é—®é¢˜ï¼‰ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å¦ä¸€å°æœåŠ¡å™¨ï¼Œä½ éœ€è¦å°†ä½ ä¸€åŠçš„Rediså®ä¾‹ä»ç¬¬ä¸€å°æœºå™¨è¿ç§»åˆ°ç¬¬äºŒå°æœºå™¨ã€‚</p>\n<p>38ã€Twemproxyæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>Twemproxyæ˜¯Twitterç»´æŠ¤çš„ï¼ˆç¼“å­˜ï¼‰ä»£ç†ç³»ç»Ÿï¼Œä»£ç†Memcachedçš„ASCIIåè®®å’ŒRedisåè®®ã€‚å®ƒæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œä½¿ç”¨cè¯­è¨€ç¼–å†™ï¼Œè¿è¡Œèµ·æ¥éå¸¸å¿«ã€‚å®ƒæ˜¯é‡‡ç”¨Apache 2.0 licenseçš„å¼€æºè½¯ä»¶ã€‚ Twemproxyæ”¯æŒè‡ªåŠ¨åˆ†åŒºï¼Œå¦‚æœå…¶ä»£ç†çš„å…¶ä¸­ä¸€ä¸ªRedisèŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹æ’é™¤ï¼ˆè¿™å°†æ”¹å˜åŸæ¥çš„keys-instancesçš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä»…åœ¨æŠŠRediså½“ç¼“å­˜æ—¶ä½¿ç”¨Twemproxy)ã€‚ Twemproxyæœ¬èº«ä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå› ä¸ºä½ å¯ä»¥å¯åŠ¨å¤šä¸ªTwemproxyå®ä¾‹ï¼Œç„¶åè®©ä½ çš„å®¢æˆ·ç«¯å»è¿æ¥ä»»æ„ä¸€ä¸ªTwemproxyå®ä¾‹ã€‚ Twemproxyæ˜¯Rediså®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œç”±å®ƒæ¥å¤„ç†åˆ†åŒºåŠŸèƒ½åº”è¯¥ä¸ç®—å¤æ‚ï¼Œå¹¶ä¸”åº”è¯¥ç®—æ¯”è¾ƒå¯é çš„ã€‚</p>\n<p>39ã€æ”¯æŒä¸€è‡´æ€§å“ˆå¸Œçš„å®¢æˆ·ç«¯æœ‰å“ªäº›ï¼Ÿ</p>\n<p>Redis-rbã€Predisç­‰ã€‚</p>\n<p>40ã€Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>\n<p>Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚<br>Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œåº”ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œ ç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚ åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚<br>41ã€Redisçš„å†…å­˜å ç”¨æƒ…å†µæ€ä¹ˆæ ·ï¼Ÿ</p>\n<p>ç»™ä½ ä¸¾ä¸ªä¾‹å­ï¼š 100ä¸‡ä¸ªé”®å€¼å¯¹ï¼ˆé”®æ˜¯0åˆ°999999å€¼æ˜¯å­—ç¬¦ä¸²â€œhello worldâ€ï¼‰åœ¨æˆ‘çš„32ä½çš„Macç¬”è®°æœ¬ä¸Š ç”¨äº†100MBã€‚åŒæ ·çš„æ•°æ®æ”¾åˆ°ä¸€ä¸ªkeyé‡Œåªéœ€è¦16MBï¼Œ è¿™æ˜¯å› ä¸ºé”®å€¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼€é”€ã€‚ åœ¨Memcachedä¸Šæ‰§è¡Œä¹Ÿæ˜¯ç±»ä¼¼çš„ç»“æœï¼Œä½†æ˜¯ç›¸å¯¹Redisçš„å¼€é”€è¦å°ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºRedisä¼šè®°å½•ç±»å‹ä¿¡æ¯å¼•ç”¨è®¡æ•°ç­‰ç­‰ã€‚</p>\n<p>å½“ç„¶ï¼Œå¤§é”®å€¼å¯¹æ—¶ä¸¤è€…çš„æ¯”ä¾‹è¦å¥½å¾ˆå¤šã€‚</p>\n<p>64ä½çš„ç³»ç»Ÿæ¯”32ä½çš„éœ€è¦æ›´å¤šçš„å†…å­˜å¼€é”€ï¼Œå°¤å…¶æ˜¯é”®å€¼å¯¹éƒ½è¾ƒå°æ—¶ï¼Œè¿™æ˜¯å› ä¸º64ä½çš„ç³»ç»Ÿé‡ŒæŒ‡é’ˆå ç”¨äº†8ä¸ªå­—èŠ‚ã€‚ ä½†æ˜¯ï¼Œå½“ç„¶ï¼Œ64ä½ç³»ç»Ÿæ”¯æŒæ›´å¤§çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸ºäº†è¿è¡Œå¤§å‹çš„RedisæœåŠ¡å™¨æˆ–å¤šæˆ–å°‘çš„éœ€è¦ä½¿ç”¨64ä½çš„ç³»ç»Ÿã€‚</p>\n<p>42ã€éƒ½æœ‰å“ªäº›åŠæ³•å¯ä»¥é™ä½Redisçš„å†…å­˜ä½¿ç”¨æƒ…å†µå‘¢ï¼Ÿ</p>\n<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯32ä½çš„Rediså®ä¾‹ï¼Œå¯ä»¥å¥½å¥½åˆ©ç”¨Hash,list,sorted set,setç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„Key-Valueå¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚</p>\n<p>43ã€æŸ¥çœ‹Redisä½¿ç”¨æƒ…å†µåŠçŠ¶æ€ä¿¡æ¯ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ</p>\n<p>info</p>\n<p>44ã€Redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>å¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedisçš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥å°†Rediså½“ç¼“å­˜æ¥ä½¿ç”¨é…ç½®æ·˜æ±°æœºåˆ¶ï¼Œå½“Redisè¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚</p>\n<p>45ã€Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸CPUçš„åˆ©ç”¨ç‡ï¼Ÿ</p>\n<p>å¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ªRedisçš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ªCPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†ç‰‡ï¼ˆshardï¼‰ã€‚</p>\n<p>46ã€ä¸€ä¸ªRediså®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘çš„keysï¼ŸListã€Setã€Sorted Setä»–ä»¬æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘å…ƒç´ ï¼Ÿ</p>\n<p>ç†è®ºä¸ŠRediså¯ä»¥å¤„ç†å¤šè¾¾232çš„keysï¼Œå¹¶ä¸”åœ¨å®é™…ä¸­è¿›è¡Œäº†æµ‹è¯•ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘å­˜æ”¾äº†2äº¿5åƒä¸‡çš„keysã€‚æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€äº›è¾ƒå¤§çš„å€¼ã€‚</p>\n<p>ä»»ä½•listã€setã€å’Œsorted setéƒ½å¯ä»¥æ”¾232ä¸ªå…ƒç´ ã€‚</p>\n<p>æ¢å¥è¯è¯´ï¼ŒRedisçš„å­˜å‚¨æé™æ˜¯ç³»ç»Ÿä¸­çš„å¯ç”¨å†…å­˜å€¼ã€‚</p>\n<p>47ã€Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</p>\n<p>(1) Masteræœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼Œå¦‚RDBå†…å­˜å¿«ç…§å’ŒAOFæ—¥å¿—æ–‡ä»¶</p>\n<p>(2) å¦‚æœæ•°æ®æ¯”è¾ƒé‡è¦ï¼ŒæŸä¸ªSlaveå¼€å¯AOFå¤‡ä»½æ•°æ®ï¼Œç­–ç•¥è®¾ç½®ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡</p>\n<p>(3) ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒMasterå’ŒSlaveæœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…</p>\n<p>(4) å°½é‡é¿å…åœ¨å‹åŠ›å¾ˆå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“</p>\n<p>(5) ä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ä¸ºç¨³å®šï¼Œå³ï¼šMaster &lt;- Slave1 &lt;- Slave2 &lt;- Slave3â€¦</p>\n<p>è¿™æ ·çš„ç»“æ„æ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç°Slaveå¯¹Masterçš„æ›¿æ¢ã€‚å¦‚æœMasteræŒ‚äº†ï¼Œå¯ä»¥ç«‹åˆ»å¯ç”¨Slave1åšMasterï¼Œå…¶ä»–ä¸å˜ã€‚</p>\n<p>48ã€Redisæä¾›äº†å“ªå‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</p>\n<p>RDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨.<br>AOFæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œ,å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®,AOFå‘½ä»¤ä»¥redisåè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾.Redisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™,ä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§.<br>å¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨,ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼.<br>ä½ ä¹Ÿå¯ä»¥åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼, åœ¨è¿™ç§æƒ…å†µä¸‹, å½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®,å› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´.<br>æœ€é‡è¦çš„äº‹æƒ…æ˜¯äº†è§£RDBå’ŒAOFæŒä¹…åŒ–æ–¹å¼çš„ä¸åŒ,è®©æˆ‘ä»¬ä»¥RDBæŒä¹…åŒ–æ–¹å¼å¼€å§‹ã€‚<br>49ã€å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾PostgreSQLçš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚</p>\n<p>æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼šå› ä¸ºå®šæ—¶ç”ŸæˆRDBå¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ ä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…ä¹‹å‰æåˆ°çš„AOFç¨‹åºçš„bugã€‚</p>\n<p>50ã€ä¿®æ”¹é…ç½®ä¸é‡å¯Redisä¼šå®æ—¶ç”Ÿæ•ˆå—ï¼Ÿ</p>\n<p>é’ˆå¯¹è¿è¡Œå®ä¾‹ï¼Œæœ‰è®¸å¤šé…ç½®é€‰é¡¹å¯ä»¥é€šè¿‡ CONFIG SET å‘½ä»¤è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ— éœ€æ‰§è¡Œä»»ä½•å½¢å¼çš„é‡å¯ã€‚ ä» Redis 2.2 å¼€å§‹ï¼Œå¯ä»¥ä» AOF åˆ‡æ¢åˆ° RDB çš„å¿«ç…§æŒä¹…æ€§æˆ–å…¶ä»–æ–¹å¼è€Œä¸éœ€è¦é‡å¯ Redisã€‚æ£€ç´¢ â€˜CONFIG GET *â€™ å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ã€‚</p>\n<p>ä½†å¶å°”é‡æ–°å¯åŠ¨æ˜¯å¿…é¡»çš„ï¼Œå¦‚ä¸ºå‡çº§ Redis ç¨‹åºåˆ°æ–°çš„ç‰ˆæœ¬ï¼Œæˆ–è€…å½“ä½ éœ€è¦ä¿®æ”¹æŸäº›ç›®å‰ CONFIG å‘½ä»¤è¿˜ä¸æ”¯æŒçš„é…ç½®å‚æ•°çš„æ—¶å€™ã€‚</p>\n<p>è½¬è½½äºï¼š<a href=\"https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/\">https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/</a></p>\n","excerpt":"","more":"<p>Redis åœ¨äº’è”ç½‘æŠ€æœ¯å­˜å‚¨æ–¹é¢ä½¿ç”¨å¦‚æ­¤å¹¿æ³›ï¼Œå‡ ä¹æ‰€æœ‰çš„åç«¯æŠ€æœ¯é¢è¯•å®˜éƒ½è¦åœ¨ Redis çš„ä½¿ç”¨å’ŒåŸç†æ–¹é¢å¯¹å°ä¼™ä¼´ä»¬è¿›è¡Œå„ç§åˆéš¾ã€‚ä½œä¸ºä¸€ååœ¨äº’è”ç½‘æŠ€æœ¯è¡Œä¸šæ‰“å‡»è¿‡æˆç™¾ä¸Šåƒåã€è¯·å…è®¸æˆ‘å¤¸å¼ ä¸€ä¸‹ã€‘çš„èµ„æ·±æŠ€æœ¯é¢è¯•å®˜ï¼Œçœ‹è¿‡äº†æ— æ•°è½å¯çš„èº«å½±å¤±æœ›çš„ç¦»å¼€ï¼Œç•¥æ„Ÿæ„§ç–šï¼Œæ•…çŒ®ä¸Šæ­¤æ–‡ï¼Œå¸Œæœ›å„ä½è¯»è€…ä»¥åé¢è¯•åŠ¿å¦‚ç ´ç«¹ï¼Œæ°¸æ— å¤±è´¥ï¼</p>\n<h3 id=\"Redis-æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\"><a href=\"#Redis-æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\" class=\"headerlink\" title=\"Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ\"></a>Redis æœ‰å“ªäº›æ•°æ®ç»“æ„ï¼Ÿ</h3><p>å­—ç¬¦ä¸² Stringã€å­—å…¸ Hashã€åˆ—è¡¨ Listã€é›†åˆ Setã€æœ‰åºé›†åˆ SortedSetã€‚</p>\n<p>å¦‚æœä½ æ˜¯ Redis ä¸­é«˜çº§ç”¨æˆ·ï¼Œè¿˜éœ€è¦åŠ ä¸Šä¸‹é¢å‡ ç§æ•°æ®ç»“æ„ HyperLogLogã€Geoã€Pub&#x2F;Subã€‚</p>\n<p>å¦‚æœä½ è¯´è¿˜ç©è¿‡ Redis Moduleï¼Œåƒ BloomFilterï¼ŒRedisSearchï¼ŒRedis-MLï¼Œé¢è¯•å®˜å¾—çœ¼ç›å°±å¼€å§‹å‘äº®äº†ã€‚</p>\n<h3 id=\"ä½¿ç”¨è¿‡-Redis-åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\"><a href=\"#ä½¿ç”¨è¿‡-Redis-åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ\"></a>ä½¿ç”¨è¿‡ Redis åˆ†å¸ƒå¼é”ä¹ˆï¼Œå®ƒæ˜¯ä»€ä¹ˆå›äº‹ï¼Ÿ</h3><p>å…ˆæ‹¿ setnx æ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨ expire ç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾ã€‚</p>\n<p>è¿™æ—¶å€™å¯¹æ–¹ä¼šå‘Šè¯‰ä½ è¯´ä½ å›ç­”å¾—ä¸é”™ï¼Œç„¶åæ¥ç€é—®å¦‚æœåœ¨ setnx ä¹‹åæ‰§è¡Œ expire ä¹‹å‰è¿›ç¨‹æ„å¤– crash æˆ–è€…è¦é‡å¯ç»´æŠ¤äº†ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>\n<p>è¿™æ—¶å€™ä½ è¦ç»™äºˆæƒŠè®¶çš„åé¦ˆï¼šå”‰ï¼Œæ˜¯å–”ï¼Œè¿™ä¸ªé”å°±æ°¸è¿œå¾—ä¸åˆ°é‡Šæ”¾äº†ã€‚ç´§æ¥ç€ä½ éœ€è¦æŠ“ä¸€æŠ“è‡ªå·±å¾—è„‘è¢‹ï¼Œæ•…ä½œæ€è€ƒç‰‡åˆ»ï¼Œå¥½åƒæ¥ä¸‹æ¥çš„ç»“æœæ˜¯ä½ ä¸»åŠ¨æ€è€ƒå‡ºæ¥çš„ï¼Œç„¶åå›ç­”ï¼šæˆ‘è®°å¾— set æŒ‡ä»¤æœ‰éå¸¸å¤æ‚çš„å‚æ•°ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯ä»¥åŒæ—¶æŠŠ setnx å’Œ expire åˆæˆä¸€æ¡æŒ‡ä»¤æ¥ç”¨çš„ï¼å¯¹æ–¹è¿™æ—¶ä¼šæ˜¾éœ²ç¬‘å®¹ï¼Œå¿ƒé‡Œå¼€å§‹é»˜å¿µï¼šæ‘ï¼Œè¿™å°å­è¿˜ä¸é”™ã€‚</p>\n<p>å‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10w ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</p>\n<p>ä½¿ç”¨ keys æŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ã€‚</p>\n<p>å¯¹æ–¹æ¥ç€è¿½é—®ï¼šå¦‚æœè¿™ä¸ª redis æ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨ keys æŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>\n<p>è¿™ä¸ªæ—¶å€™ä½ è¦å›ç­” redis å…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredis çš„å•çº¿ç¨‹çš„ã€‚keys æŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ scan æŒ‡ä»¤ï¼Œscan æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„ key åˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keys æŒ‡ä»¤é•¿ã€‚</p>\n<h3 id=\"ä½¿ç”¨è¿‡-Redis-åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\"><a href=\"#ä½¿ç”¨è¿‡-Redis-åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\" class=\"headerlink\" title=\"ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ\"></a>ä½¿ç”¨è¿‡ Redis åšå¼‚æ­¥é˜Ÿåˆ—ä¹ˆï¼Œä½ æ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ</h3><p>ä¸€èˆ¬ä½¿ç”¨ list ç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œrpush ç”Ÿäº§æ¶ˆæ¯ï¼Œlpop æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“ lpop æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“ sleep ä¸€ä¼šå†é‡è¯•ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—®å¯ä¸å¯ä»¥ä¸ç”¨ sleep å‘¢ï¼Ÿlist è¿˜æœ‰ä¸ªæŒ‡ä»¤å« blpopï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—®èƒ½ä¸èƒ½ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡å‘¢ï¼Ÿä½¿ç”¨ pub&#x2F;sub ä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—® pub&#x2F;sub æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œå¾—ä½¿ç”¨ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—å¦‚ rabbitmq ç­‰ã€‚</p>\n<p>å¦‚æœå¯¹æ–¹è¿½é—® redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—ï¼Ÿæˆ‘ä¼°è®¡ç°åœ¨ä½ å¾ˆæƒ³æŠŠé¢è¯•å®˜ä¸€æ£’æ‰“æ­»å¦‚æœä½ æ‰‹ä¸Šæœ‰ä¸€æ ¹æ£’çƒæ£çš„è¯ï¼Œæ€ä¹ˆé—®çš„è¿™ä¹ˆè¯¦ç»†ã€‚ä½†æ˜¯ä½ å¾ˆå…‹åˆ¶ï¼Œç„¶åç¥æ€è‡ªè‹¥çš„å›ç­”é“ï¼šä½¿ç”¨ sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸º scoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸º key è°ƒç”¨ zadd æ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨ zrangebyscore æŒ‡ä»¤è·å– N ç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚</p>\n<p>åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜æš—åœ°é‡Œå·²ç»å¯¹ä½ ç«–èµ·äº†å¤§æ‹‡æŒ‡ã€‚ä½†æ˜¯ä»–ä¸çŸ¥é“çš„æ˜¯æ­¤åˆ»ä½ å´ç«–èµ·äº†ä¸­æŒ‡ï¼Œåœ¨æ¤…å­èƒŒåã€‚</p>\n<p>å¦‚æœæœ‰å¤§é‡çš„ key éœ€è¦è®¾ç½®åŒä¸€æ—¶é—´è¿‡æœŸï¼Œä¸€èˆ¬éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ</p>\n<p>å¦‚æœå¤§é‡çš„ key è¿‡æœŸæ—¶é—´è®¾ç½®çš„è¿‡äºé›†ä¸­ï¼Œåˆ°è¿‡æœŸçš„é‚£ä¸ªæ—¶é—´ç‚¹ï¼Œredis å¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„å¡é¡¿ç°è±¡ã€‚ä¸€èˆ¬éœ€è¦åœ¨æ—¶é—´ä¸ŠåŠ ä¸€ä¸ªéšæœºå€¼ï¼Œä½¿å¾—è¿‡æœŸæ—¶é—´åˆ†æ•£ä¸€äº›ã€‚</p>\n<h3 id=\"Redis-å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\"><a href=\"#Redis-å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\" class=\"headerlink\" title=\"Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ\"></a>Redis å¦‚ä½•åšæŒä¹…åŒ–çš„ï¼Ÿ</h3><p>bgsave åšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼Œaof åšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸º bgsave ä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ aof æ¥é…åˆä½¿ç”¨ã€‚åœ¨ redis å®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨ bgsave æŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨ aof é‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚</p>\n<p>å¯¹æ–¹è¿½é—®é‚£å¦‚æœçªç„¶æœºå™¨æ‰ç”µä¼šæ€æ ·ï¼Ÿå–å†³äº aof æ—¥å¿— sync å±æ€§çš„é…ç½®ï¼Œå¦‚æœä¸è¦æ±‚æ€§èƒ½ï¼Œåœ¨æ¯æ¡å†™æŒ‡ä»¤æ—¶éƒ½ sync ä¸€ä¸‹ç£ç›˜ï¼Œå°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚ä½†æ˜¯åœ¨é«˜æ€§èƒ½çš„è¦æ±‚ä¸‹æ¯æ¬¡éƒ½ sync æ˜¯ä¸ç°å®çš„ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å®šæ—¶ syncï¼Œæ¯”å¦‚ 1s1 æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™æœ€å¤šå°±ä¼šä¸¢å¤± 1s çš„æ•°æ®ã€‚</p>\n<p>å¯¹æ–¹è¿½é—® bgsave çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿä½ ç»™å‡ºä¸¤ä¸ªè¯æ±‡å°±å¯ä»¥äº†ï¼Œfork å’Œ cowã€‚fork æ˜¯æŒ‡ redis é€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡Œ bgsave æ“ä½œï¼Œcow æŒ‡çš„æ˜¯ copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚</p>\n<h3 id=\"Pipeline-æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨-pipelineï¼Ÿ\"><a href=\"#Pipeline-æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨-pipelineï¼Ÿ\" class=\"headerlink\" title=\"Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ\"></a>Pipeline æœ‰ä»€ä¹ˆå¥½å¤„ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ pipelineï¼Ÿ</h3><p>å¯ä»¥å°†å¤šæ¬¡ IO å¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯ pipeline æ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨ redis-benchmark è¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“ redis çš„ QPS å³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯ pipeline æ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚</p>\n<h3 id=\"Redis-çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\"><a href=\"#Redis-çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ\"></a>Redis çš„åŒæ­¥æœºåˆ¶äº†è§£ä¹ˆï¼Ÿ</h3><p>Redis å¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡ bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜ bufferï¼Œå¾…å®Œæˆåå°† rdb æ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°† rdb é•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚</p>\n<h3 id=\"æ˜¯å¦ä½¿ç”¨è¿‡-Redis-é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#æ˜¯å¦ä½¿ç”¨è¿‡-Redis-é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ\"></a>æ˜¯å¦ä½¿ç”¨è¿‡ Redis é›†ç¾¤ï¼Œé›†ç¾¤çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Redis Sentinal ç€çœ¼äºé«˜å¯ç”¨ï¼Œåœ¨ master å®•æœºæ—¶ä¼šè‡ªåŠ¨å°† slave æå‡ä¸º masterï¼Œç»§ç»­æä¾›æœåŠ¡ã€‚</p>\n<p>Redis Cluster ç€çœ¼äºæ‰©å±•æ€§ï¼Œåœ¨å•ä¸ª redis å†…å­˜ä¸è¶³æ—¶ï¼Œä½¿ç”¨ Cluster è¿›è¡Œåˆ†ç‰‡å­˜å‚¨ã€‚</p>\n<h2 id=\"å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\"><a href=\"#å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\" class=\"headerlink\" title=\"å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ\"></a>å²ä¸Šæœ€å…¨Redisé¢è¯•é¢˜åŠç­”æ¡ˆ</h2><p>1ã€ä»€ä¹ˆæ˜¯Redisï¼Ÿ</p>\n<p>Redisæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªKey-Valueç±»å‹çš„å†…å­˜æ•°æ®åº“ï¼Œå¾ˆåƒmemcachedï¼Œæ•´ä¸ªæ•°æ®åº“ç»Ÿç»ŸåŠ è½½åœ¨å†…å­˜å½“ä¸­è¿›è¡Œæ“ä½œï¼Œå®šæœŸé€šè¿‡å¼‚æ­¥æ“ä½œæŠŠæ•°æ®åº“æ•°æ®flushåˆ°ç¡¬ç›˜ä¸Šè¿›è¡Œä¿å­˜ã€‚å› ä¸ºæ˜¯çº¯å†…å­˜æ“ä½œï¼ŒRedisçš„æ€§èƒ½éå¸¸å‡ºè‰²ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚ Redisçš„å‡ºè‰²ä¹‹å¤„ä¸ä»…ä»…æ˜¯æ€§èƒ½ï¼ŒRedisæœ€å¤§çš„é­…åŠ›æ˜¯æ”¯æŒä¿å­˜å¤šç§æ•°æ®ç»“æ„ï¼Œæ­¤å¤–å•ä¸ªvalueçš„æœ€å¤§é™åˆ¶æ˜¯1GBï¼Œä¸åƒ memcachedåªèƒ½ä¿å­˜1MBçš„æ•°æ®ï¼Œå› æ­¤Rediså¯ä»¥ç”¨æ¥å®ç°å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”æ–¹è¯´ç”¨ä»–çš„Listæ¥åšFIFOåŒå‘é“¾è¡¨ï¼Œå®ç°ä¸€ä¸ªè½»é‡çº§çš„é«˜æ€§ èƒ½æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ï¼Œç”¨ä»–çš„Setå¯ä»¥åšé«˜æ€§èƒ½çš„tagç³»ç»Ÿç­‰ç­‰ã€‚å¦å¤–Redisä¹Ÿå¯ä»¥å¯¹å­˜å…¥çš„Key-Valueè®¾ç½®expireæ—¶é—´ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è¢«å½“ä½œä¸€ ä¸ªåŠŸèƒ½åŠ å¼ºç‰ˆçš„memcachedæ¥ç”¨ã€‚ Redisçš„ä¸»è¦ç¼ºç‚¹æ˜¯æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚</p>\n<p>2ã€Redisç›¸æ¯”memcachedæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p>\n<p>(1) memcachedæ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œredisä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹</p>\n<p>(2) redisçš„é€Ÿåº¦æ¯”memcachedå¿«å¾ˆå¤š</p>\n<p>(3) rediså¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®</p>\n<p>3ã€Redisæ”¯æŒå“ªå‡ ç§æ•°æ®ç±»å‹ï¼Ÿ</p>\n<p>Stringã€Listã€Setã€Sorted Setã€hashes</p>\n<p>4ã€Redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ</p>\n<p>å†…å­˜ã€‚</p>\n<p>5ã€Redisçš„å…¨ç§°æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>Remote Dictionary Serverã€‚</p>\n<p>6ã€Redisæœ‰å“ªå‡ ç§æ•°æ®æ·˜æ±°ç­–ç•¥ï¼Ÿ</p>\n<p>noeviction:è¿”å›é”™è¯¯å½“å†…å­˜é™åˆ¶è¾¾åˆ°å¹¶ä¸”å®¢æˆ·ç«¯å°è¯•æ‰§è¡Œä¼šè®©æ›´å¤šå†…å­˜è¢«ä½¿ç”¨çš„å‘½ä»¤ï¼ˆå¤§éƒ¨åˆ†çš„å†™å…¥æŒ‡ä»¤ï¼Œä½†DELå’Œå‡ ä¸ªä¾‹å¤–ï¼‰</p>\n<p>allkeys-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>volatile-lru: å°è¯•å›æ”¶æœ€å°‘ä½¿ç”¨çš„é”®ï¼ˆLRUï¼‰ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>allkeys-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>volatile-random: å›æ”¶éšæœºçš„é”®ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ï¼Œä½†ä»…é™äºåœ¨è¿‡æœŸé›†åˆçš„é”®ã€‚</p>\n<p>volatile-ttl: å›æ”¶åœ¨è¿‡æœŸé›†åˆçš„é”®ï¼Œå¹¶ä¸”ä¼˜å…ˆå›æ”¶å­˜æ´»æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®,ä½¿å¾—æ–°æ·»åŠ çš„æ•°æ®æœ‰ç©ºé—´å­˜æ”¾ã€‚</p>\n<p>7ã€Rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›Windowsç‰ˆæœ¬ï¼Ÿ</p>\n<p>å› ä¸ºç›®å‰Linuxç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘windowsç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚</p>\n<p>8ã€ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>512M</p>\n<p>9ã€ä¸ºä»€ä¹ˆRediséœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Ÿ</p>\n<p>Redisä¸ºäº†è¾¾åˆ°æœ€å¿«çš„è¯»å†™é€Ÿåº¦å°†æ•°æ®éƒ½è¯»åˆ°å†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚æ‰€ä»¥rediså…·æœ‰å¿«é€Ÿå’Œæ•°æ®æŒä¹…åŒ–çš„ç‰¹å¾ã€‚å¦‚æœä¸å°†æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œç£ç›˜I&#x2F;Oé€Ÿåº¦ä¸ºä¸¥é‡å½±å“redisçš„æ€§èƒ½ã€‚åœ¨å†…å­˜è¶Šæ¥è¶Šä¾¿å®œçš„ä»Šå¤©ï¼Œrediså°†ä¼šè¶Šæ¥è¶Šå—æ¬¢è¿ã€‚ å¦‚æœè®¾ç½®äº†æœ€å¤§ä½¿ç”¨çš„å†…å­˜ï¼Œåˆ™æ•°æ®å·²æœ‰è®°å½•æ•°è¾¾åˆ°å†…å­˜é™å€¼åä¸èƒ½ç»§ç»­æ’å…¥æ–°å€¼ã€‚</p>\n<p>10ã€Redisé›†ç¾¤æ–¹æ¡ˆåº”è¯¥æ€ä¹ˆåšï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿ</p>\n<p>1.twemproxyï¼Œå¤§æ¦‚æ¦‚å¿µæ˜¯ï¼Œå®ƒç±»ä¼¼äºä¸€ä¸ªä»£ç†æ–¹å¼ï¼Œä½¿ç”¨æ–¹æ³•å’Œæ™®é€šredisæ— ä»»ä½•åŒºåˆ«ï¼Œè®¾ç½®å¥½å®ƒä¸‹å±çš„å¤šä¸ªrediså®ä¾‹åï¼Œä½¿ç”¨æ—¶åœ¨æœ¬éœ€è¦è¿æ¥redisçš„åœ°æ–¹æ”¹ä¸ºè¿æ¥twemproxyï¼Œå®ƒä¼šä»¥ä¸€ä¸ªä»£ç†çš„èº«ä»½æ¥æ”¶è¯·æ±‚å¹¶ä½¿ç”¨ä¸€è‡´æ€§hashç®—æ³•ï¼Œå°†è¯·æ±‚è½¬æ¥åˆ°å…·ä½“redisï¼Œå°†ç»“æœå†è¿”å›twemproxyã€‚ä½¿ç”¨æ–¹å¼ç®€ä¾¿(ç›¸å¯¹redisåªéœ€ä¿®æ”¹è¿æ¥ç«¯å£)ï¼Œå¯¹æ—§é¡¹ç›®æ‰©å±•çš„é¦–é€‰ã€‚ é—®é¢˜ï¼štwemproxyè‡ªèº«å•ç«¯å£å®ä¾‹çš„å‹åŠ›ï¼Œä½¿ç”¨ä¸€è‡´æ€§hashåï¼Œå¯¹redisèŠ‚ç‚¹æ•°é‡æ”¹å˜æ—¶å€™çš„è®¡ç®—å€¼çš„æ”¹å˜ï¼Œæ•°æ®æ— æ³•è‡ªåŠ¨ç§»åŠ¨åˆ°æ–°çš„èŠ‚ç‚¹ã€‚</p>\n<p>2.codisï¼Œç›®å‰ç”¨çš„æœ€å¤šçš„é›†ç¾¤æ–¹æ¡ˆï¼ŒåŸºæœ¬å’Œtwemproxyä¸€è‡´çš„æ•ˆæœï¼Œä½†å®ƒæ”¯æŒåœ¨ èŠ‚ç‚¹æ•°é‡æ”¹å˜æƒ…å†µä¸‹ï¼Œæ—§èŠ‚ç‚¹æ•°æ®å¯æ¢å¤åˆ°æ–°hashèŠ‚ç‚¹ã€‚</p>\n<p>3.redis cluster3.0è‡ªå¸¦çš„é›†ç¾¤ï¼Œç‰¹ç‚¹åœ¨äºä»–çš„åˆ†å¸ƒå¼ç®—æ³•ä¸æ˜¯ä¸€è‡´æ€§hashï¼Œè€Œæ˜¯hashæ§½çš„æ¦‚å¿µï¼Œä»¥åŠè‡ªèº«æ”¯æŒèŠ‚ç‚¹è®¾ç½®ä»èŠ‚ç‚¹ã€‚å…·ä½“çœ‹å®˜æ–¹æ–‡æ¡£ä»‹ç»ã€‚</p>\n<p>4.åœ¨ä¸šåŠ¡ä»£ç å±‚å®ç°ï¼Œèµ·å‡ ä¸ªæ¯«æ— å…³è”çš„rediså®ä¾‹ï¼Œåœ¨ä»£ç å±‚ï¼Œå¯¹key è¿›è¡Œhashè®¡ç®—ï¼Œç„¶åå»å¯¹åº”çš„rediså®ä¾‹æ“ä½œæ•°æ®ã€‚ è¿™ç§æ–¹å¼å¯¹hashå±‚ä»£ç è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€ƒè™‘éƒ¨åˆ†åŒ…æ‹¬ï¼ŒèŠ‚ç‚¹å¤±æ•ˆåçš„æ›¿ä»£ç®—æ³•æ–¹æ¡ˆï¼Œæ•°æ®éœ‡è¡åçš„è‡ªåŠ¨è„šæœ¬æ¢å¤ï¼Œå®ä¾‹çš„ç›‘æ§ï¼Œç­‰ç­‰ã€‚</p>\n<p>11ã€Redisé›†ç¾¤æ–¹æ¡ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ï¼Ÿ</p>\n<p>æœ‰Aï¼ŒBï¼ŒCä¸‰ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤,åœ¨æ²¡æœ‰å¤åˆ¶æ¨¡å‹çš„æƒ…å†µä¸‹,å¦‚æœèŠ‚ç‚¹Bå¤±è´¥äº†ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±ä¼šä»¥ä¸ºç¼ºå°‘5501-11000è¿™ä¸ªèŒƒå›´çš„æ§½è€Œä¸å¯ç”¨ã€‚</p>\n<p>12ã€MySQLé‡Œæœ‰2000wæ•°æ®ï¼Œredisä¸­åªå­˜20wçš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ï¼Ÿ</p>\n<p>rediså†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚</p>\n<p>13ã€Redisæœ‰å“ªäº›é€‚åˆçš„åœºæ™¯ï¼Ÿ</p>\n<p>ï¼ˆ1ï¼‰ã€ä¼šè¯ç¼“å­˜ï¼ˆSession Cacheï¼‰</p>\n<p>æœ€å¸¸ç”¨çš„ä¸€ç§ä½¿ç”¨Redisçš„æƒ…æ™¯æ˜¯ä¼šè¯ç¼“å­˜ï¼ˆsession cacheï¼‰ã€‚ç”¨Redisç¼“å­˜ä¼šè¯æ¯”å…¶ä»–å­˜å‚¨ï¼ˆå¦‚Memcachedï¼‰çš„ä¼˜åŠ¿åœ¨äºï¼šRedisæä¾›æŒä¹…åŒ–ã€‚å½“ç»´æŠ¤ä¸€ä¸ªä¸æ˜¯ä¸¥æ ¼è¦æ±‚ä¸€è‡´æ€§çš„ç¼“å­˜æ—¶ï¼Œå¦‚æœç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šä¸é«˜å…´çš„ï¼Œç°åœ¨ï¼Œä»–ä»¬è¿˜ä¼šè¿™æ ·å—ï¼Ÿ</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œéšç€ Redis è¿™äº›å¹´çš„æ”¹è¿›ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°æ€ä¹ˆæ°å½“çš„ä½¿ç”¨Redisæ¥ç¼“å­˜ä¼šè¯çš„æ–‡æ¡£ã€‚ç”šè‡³å¹¿ä¸ºäººçŸ¥çš„å•†ä¸šå¹³å°Magentoä¹Ÿæä¾›Redisçš„æ’ä»¶ã€‚</p>\n<p>ï¼ˆ2ï¼‰ã€å…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰</p>\n<p>é™¤åŸºæœ¬çš„ä¼šè¯tokenä¹‹å¤–ï¼ŒRedisè¿˜æä¾›å¾ˆç®€ä¾¿çš„FPCå¹³å°ã€‚å›åˆ°ä¸€è‡´æ€§é—®é¢˜ï¼Œå³ä½¿é‡å¯äº†Rediså®ä¾‹ï¼Œå› ä¸ºæœ‰ç£ç›˜çš„æŒä¹…åŒ–ï¼Œç”¨æˆ·ä¹Ÿä¸ä¼šçœ‹åˆ°é¡µé¢åŠ è½½é€Ÿåº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ä¸€ä¸ªæå¤§æ”¹è¿›ï¼Œç±»ä¼¼PHPæœ¬åœ°FPCã€‚</p>\n<p>å†æ¬¡ä»¥Magentoä¸ºä¾‹ï¼ŒMagentoæä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨Redisä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚</p>\n<p>æ­¤å¤–ï¼Œå¯¹WordPressçš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚</p>\n<p>ï¼ˆ3ï¼‰ã€é˜Ÿåˆ—</p>\n<p>Reidsåœ¨å†…å­˜å­˜å‚¨å¼•æ“é¢†åŸŸçš„ä¸€å¤§ä¼˜ç‚¹æ˜¯æä¾› list å’Œ set æ“ä½œï¼Œè¿™ä½¿å¾—Redisèƒ½ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„æ¶ˆæ¯é˜Ÿåˆ—å¹³å°æ¥ä½¿ç”¨ã€‚Redisä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨çš„æ“ä½œï¼Œå°±ç±»ä¼¼äºæœ¬åœ°ç¨‹åºè¯­è¨€ï¼ˆå¦‚Pythonï¼‰å¯¹ list çš„ push&#x2F;pop æ“ä½œã€‚</p>\n<p>å¦‚æœä½ å¿«é€Ÿçš„åœ¨Googleä¸­æœç´¢â€œRedis queuesâ€ï¼Œä½ é©¬ä¸Šå°±èƒ½æ‰¾åˆ°å¤§é‡çš„å¼€æºé¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®çš„ç›®çš„å°±æ˜¯åˆ©ç”¨Redisåˆ›å»ºéå¸¸å¥½çš„åç«¯å·¥å…·ï¼Œä»¥æ»¡è¶³å„ç§é˜Ÿåˆ—éœ€æ±‚ã€‚ä¾‹å¦‚ï¼ŒCeleryæœ‰ä¸€ä¸ªåå°å°±æ˜¯ä½¿ç”¨Redisä½œä¸ºbrokerï¼Œä½ å¯ä»¥ä»è¿™é‡Œå»æŸ¥çœ‹ã€‚</p>\n<p>ï¼ˆ4ï¼‰ï¼Œæ’è¡Œæ¦œ&#x2F;è®¡æ•°å™¨</p>\n<p>Redisåœ¨å†…å­˜ä¸­å¯¹æ•°å­—è¿›è¡Œé€’å¢æˆ–é€’å‡çš„æ“ä½œå®ç°çš„éå¸¸å¥½ã€‚é›†åˆï¼ˆSetï¼‰å’Œæœ‰åºé›†åˆï¼ˆSorted Setï¼‰ä¹Ÿä½¿å¾—æˆ‘ä»¬åœ¨æ‰§è¡Œè¿™äº›æ“ä½œçš„æ—¶å€™å˜çš„éå¸¸ç®€å•ï¼ŒRedisåªæ˜¯æ­£å¥½æä¾›äº†è¿™ä¸¤ç§æ•°æ®ç»“æ„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä»æ’åºé›†åˆä¸­è·å–åˆ°æ’åæœ€é å‰çš„10ä¸ªç”¨æˆ·â€“æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œuser_scoresâ€ï¼Œæˆ‘ä»¬åªéœ€è¦åƒä¸‹é¢ä¸€æ ·æ‰§è¡Œå³å¯ï¼š</p>\n<p>å½“ç„¶ï¼Œè¿™æ˜¯å‡å®šä½ æ˜¯æ ¹æ®ä½ ç”¨æˆ·çš„åˆ†æ•°åšé€’å¢çš„æ’åºã€‚å¦‚æœä½ æƒ³è¿”å›ç”¨æˆ·åŠç”¨æˆ·çš„åˆ†æ•°ï¼Œä½ éœ€è¦è¿™æ ·æ‰§è¡Œï¼š</p>\n<p>ZRANGE user_scores 0 10 WITHSCORES</p>\n<p>Agora Gameså°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œç”¨Rubyå®ç°çš„ï¼Œå®ƒçš„æ’è¡Œæ¦œå°±æ˜¯ä½¿ç”¨Redisæ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ã€‚</p>\n<p>ï¼ˆ5ï¼‰ã€å‘å¸ƒ&#x2F;è®¢é˜…</p>\n<p>æœ€åï¼ˆä½†è‚¯å®šä¸æ˜¯æœ€ä¸é‡è¦çš„ï¼‰æ˜¯Redisçš„å‘å¸ƒ&#x2F;è®¢é˜…åŠŸèƒ½ã€‚å‘å¸ƒ&#x2F;è®¢é˜…çš„ä½¿ç”¨åœºæ™¯ç¡®å®éå¸¸å¤šã€‚æˆ‘å·²çœ‹è§äººä»¬åœ¨ç¤¾äº¤ç½‘ç»œè¿æ¥ä¸­ä½¿ç”¨ï¼Œè¿˜å¯ä½œä¸ºåŸºäºå‘å¸ƒ&#x2F;è®¢é˜…çš„è„šæœ¬è§¦å‘å™¨ï¼Œç”šè‡³ç”¨Redisçš„å‘å¸ƒ&#x2F;è®¢é˜…åŠŸèƒ½æ¥å»ºç«‹èŠå¤©ç³»ç»Ÿï¼ï¼ˆä¸ï¼Œè¿™æ˜¯çœŸçš„ï¼Œä½ å¯ä»¥å»æ ¸å®ï¼‰ã€‚</p>\n<p>14ã€Redisæ”¯æŒçš„Javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿå®˜æ–¹æ¨èç”¨å“ªä¸ªï¼Ÿ</p>\n<p>Redissonã€Jedisã€lettuceç­‰ç­‰ï¼Œå®˜æ–¹æ¨èä½¿ç”¨Redissonã€‚</p>\n<p>15ã€Rediså’ŒRedissonæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>\n<p>Redissonæ˜¯ä¸€ä¸ªé«˜çº§çš„åˆ†å¸ƒå¼åè°ƒRediså®¢æœç«¯ï¼Œèƒ½å¸®åŠ©ç”¨æˆ·åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è½»æ¾å®ç°ä¸€äº›Javaçš„å¯¹è±¡ (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish &#x2F; Subscribe, HyperLogLog)ã€‚</p>\n<p>16ã€Jedisä¸Redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</p>\n<p>Jedisæ˜¯Redisçš„Javaå®ç°çš„å®¢æˆ·ç«¯ï¼Œå…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼›Redissonå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„Javaæ•°æ®ç»“æ„ï¼Œå’ŒJedisç›¸æ¯”ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²æ“ä½œï¼Œä¸æ”¯æŒæ’åºã€äº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰Redisç‰¹æ€§ã€‚Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</p>\n<p>17ã€Rediså¦‚ä½•è®¾ç½®å¯†ç åŠéªŒè¯å¯†ç ï¼Ÿ</p>\n<p>è®¾ç½®å¯†ç ï¼šconfig set requirepass 123456</p>\n<p>æˆæƒå¯†ç ï¼šauth 123456</p>\n<p>18ã€è¯´è¯´Rediså“ˆå¸Œæ§½çš„æ¦‚å¿µï¼Ÿ</p>\n<p>Redisé›†ç¾¤æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hash,è€Œæ˜¯å¼•å…¥äº†å“ˆå¸Œæ§½çš„æ¦‚å¿µï¼ŒRedisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªkeyé€šè¿‡CRC16æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ï¼Œé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ã€‚</p>\n<p>19ã€Redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ</p>\n<p>ä¸ºäº†ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…å¤§éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•é€šä¿¡çš„æƒ…å†µä¸‹é›†ç¾¤ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é›†ç¾¤ä½¿ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰N-1ä¸ªå¤åˆ¶å“.</p>\n<p>20ã€Redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>Rediså¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œã€‚</p>\n<p>21ã€Redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿ</p>\n<p>å¼‚æ­¥å¤åˆ¶</p>\n<p>22ã€Redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>16384ä¸ªã€‚</p>\n<p>23ã€Redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ</p>\n<p>Redisé›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨0æ•°æ®åº“ã€‚</p>\n<p>24ã€æ€ä¹ˆæµ‹è¯•Redisçš„è¿é€šæ€§ï¼Ÿ</p>\n<p>ping</p>\n<p>25ã€Redisä¸­çš„ç®¡é“æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>\n<p>ä¸€æ¬¡è¯·æ±‚&#x2F;å“åº”æœåŠ¡å™¨èƒ½å®ç°å¤„ç†æ–°çš„è¯·æ±‚å³ä½¿æ—§çš„è¯·æ±‚è¿˜æœªè¢«å“åº”ã€‚è¿™æ ·å°±å¯ä»¥å°†å¤šä¸ªå‘½ä»¤å‘é€åˆ°æœåŠ¡å™¨ï¼Œè€Œä¸ç”¨ç­‰å¾…å›å¤ï¼Œæœ€ååœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è¯»å–è¯¥ç­”å¤ã€‚</p>\n<p>è¿™å°±æ˜¯ç®¡é“ï¼ˆpipeliningï¼‰ï¼Œæ˜¯ä¸€ç§å‡ åå¹´æ¥å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ã€‚ä¾‹å¦‚è®¸å¤šPOP3åè®®å·²ç»å®ç°æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå¤§å¤§åŠ å¿«äº†ä»æœåŠ¡å™¨ä¸‹è½½æ–°é‚®ä»¶çš„è¿‡ç¨‹ã€‚</p>\n<p>26ã€æ€ä¹ˆç†è§£Redisäº‹åŠ¡ï¼Ÿ</p>\n<p>äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚</p>\n<p>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚</p>\n<p>27ã€Redisäº‹åŠ¡ç›¸å…³çš„å‘½ä»¤æœ‰å“ªå‡ ä¸ªï¼Ÿ</p>\n<p>MULTIã€EXECã€DISCARDã€WATCH</p>\n<p>28ã€Redis keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ</p>\n<p>EXPIREå’ŒPERSISTå‘½ä»¤ã€‚</p>\n<p>29ã€Rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ</p>\n<p>å°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„webç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„key,è€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢.</p>\n<p>30ã€Rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</p>\n<p>ä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚<br>Rediæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶, åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚<br>ä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚<br>æ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚<br>å¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚</p>\n<p>31ã€Rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ</p>\n<p>LRUç®—æ³•</p>\n<p>32ã€Rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ</p>\n<p>Redis2.6å¼€å§‹redis-cliæ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸ºpipe modeçš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚</p>\n<p>33ã€ä¸ºä»€ä¹ˆè¦åšRedisåˆ†åŒºï¼Ÿ</p>\n<p>åˆ†åŒºå¯ä»¥è®©Redisç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRediså°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ã€‚å¦‚æœæ²¡æœ‰åˆ†åŒºï¼Œä½ æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€å°æœºå™¨çš„å†…å­˜ã€‚åˆ†åŒºä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ è®¡ç®—æœºå¾—åˆ°æˆå€æå‡,Redisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ã€‚</p>\n<p>34ã€ä½ çŸ¥é“æœ‰å“ªäº›Redisåˆ†åŒºå®ç°æ–¹æ¡ˆï¼Ÿ</p>\n<p>å®¢æˆ·ç«¯åˆ†åŒºå°±æ˜¯åœ¨å®¢æˆ·ç«¯å°±å·²ç»å†³å®šæ•°æ®ä¼šè¢«å­˜å‚¨åˆ°å“ªä¸ªredisèŠ‚ç‚¹æˆ–è€…ä»å“ªä¸ªredisèŠ‚ç‚¹è¯»å–ã€‚å¤§å¤šæ•°å®¢æˆ·ç«¯å·²ç»å®ç°äº†å®¢æˆ·ç«¯åˆ†åŒºã€‚</p>\n<p>ä»£ç†åˆ†åŒº æ„å‘³ç€å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä»£ç†ï¼Œç„¶åä»£ç†å†³å®šå»å“ªä¸ªèŠ‚ç‚¹å†™æ•°æ®æˆ–è€…è¯»æ•°æ®ã€‚ä»£ç†æ ¹æ®åˆ†åŒºè§„åˆ™å†³å®šè¯·æ±‚å“ªäº›Rediså®ä¾‹ï¼Œç„¶åæ ¹æ®Redisçš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚rediså’Œmemcachedçš„ä¸€ç§ä»£ç†å®ç°å°±æ˜¯Twemproxy</p>\n<p>æŸ¥è¯¢è·¯ç”±(Query routing) çš„æ„æ€æ˜¯å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ªrediså®ä¾‹ï¼Œç„¶åç”±Rediså°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„RedisèŠ‚ç‚¹ã€‚Redis Clusterå®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ªredisèŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ªredisèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥redirectedåˆ°æ­£ç¡®çš„redisèŠ‚ç‚¹ã€‚</p>\n<p>35ã€Redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ</p>\n<p>æ¶‰åŠå¤šä¸ªkeyçš„æ“ä½œé€šå¸¸ä¸ä¼šè¢«æ”¯æŒã€‚ä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä¸¤ä¸ªé›†åˆæ±‚äº¤é›†ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒçš„Rediså®ä¾‹ï¼ˆå®é™…ä¸Šè¿™ç§æƒ…å†µä¹Ÿæœ‰åŠæ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨äº¤é›†æŒ‡ä»¤ï¼‰ã€‚<br>åŒæ—¶æ“ä½œå¤šä¸ªkey,åˆ™ä¸èƒ½ä½¿ç”¨Redisäº‹åŠ¡.<br>åˆ†åŒºä½¿ç”¨çš„ç²’åº¦æ˜¯keyï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªéå¸¸é•¿çš„æ’åºkeyå­˜å‚¨ä¸€ä¸ªæ•°æ®é›†ï¼ˆThe partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted setï¼‰.<br>å½“ä½¿ç”¨åˆ†åŒºçš„æ—¶å€™ï¼Œæ•°æ®å¤„ç†ä¼šéå¸¸å¤æ‚ï¼Œä¾‹å¦‚ä¸ºäº†å¤‡ä»½ä½ å¿…é¡»ä»ä¸åŒçš„Rediså®ä¾‹å’Œä¸»æœºåŒæ—¶æ”¶é›†RDB &#x2F; AOFæ–‡ä»¶ã€‚<br>åˆ†åŒºæ—¶åŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹å¯èƒ½éå¸¸å¤æ‚ã€‚Redisé›†ç¾¤åœ¨è¿è¡Œæ—¶å¢åŠ æˆ–è€…åˆ é™¤RedisèŠ‚ç‚¹ï¼Œèƒ½åšåˆ°æœ€å¤§ç¨‹åº¦å¯¹ç”¨æˆ·é€æ˜åœ°æ•°æ®å†å¹³è¡¡ï¼Œä½†å…¶ä»–ä¸€äº›å®¢æˆ·ç«¯åˆ†åŒºæˆ–è€…ä»£ç†åˆ†åŒºæ–¹æ³•åˆ™ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§é¢„åˆ†ç‰‡çš„æŠ€æœ¯ä¹Ÿå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>36ã€RedisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ</p>\n<p>å¦‚æœRedisè¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚<br>å¦‚æœRedisè¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„keys-to-nodesæ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯(å³RedisèŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰Redisé›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚<br>37ã€åˆ†å¸ƒå¼Redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>æ—¢ç„¶Redisæ˜¯å¦‚æ­¤çš„è½»é‡ï¼ˆå•å®ä¾‹åªä½¿ç”¨1Må†…å­˜ï¼‰,ä¸ºé˜²æ­¢ä»¥åçš„æ‰©å®¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸€å¼€å§‹å°±å¯åŠ¨è¾ƒå¤šå®ä¾‹ã€‚å³ä¾¿ä½ åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸€å¼€å§‹å°±è®©Redisä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œä½¿ç”¨åˆ†åŒºï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªå®ä¾‹ã€‚</p>\n<p>ä¸€å¼€å§‹å°±å¤šè®¾ç½®å‡ ä¸ªRediså®ä¾‹ï¼Œä¾‹å¦‚32æˆ–è€…64ä¸ªå®ä¾‹ï¼Œå¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¿™æ“ä½œèµ·æ¥å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯ä»é•¿ä¹…æ¥çœ‹åšè¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚</p>\n<p>è¿™æ ·çš„è¯ï¼Œå½“ä½ çš„æ•°æ®ä¸æ–­å¢é•¿ï¼Œéœ€è¦æ›´å¤šçš„RedisæœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯ä»…ä»…å°†Rediså®ä¾‹ä»ä¸€å°æœåŠ¡è¿ç§»åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨è€Œå·²ï¼ˆè€Œä¸ç”¨è€ƒè™‘é‡æ–°åˆ†åŒºçš„é—®é¢˜ï¼‰ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å¦ä¸€å°æœåŠ¡å™¨ï¼Œä½ éœ€è¦å°†ä½ ä¸€åŠçš„Rediså®ä¾‹ä»ç¬¬ä¸€å°æœºå™¨è¿ç§»åˆ°ç¬¬äºŒå°æœºå™¨ã€‚</p>\n<p>38ã€Twemproxyæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>Twemproxyæ˜¯Twitterç»´æŠ¤çš„ï¼ˆç¼“å­˜ï¼‰ä»£ç†ç³»ç»Ÿï¼Œä»£ç†Memcachedçš„ASCIIåè®®å’ŒRedisåè®®ã€‚å®ƒæ˜¯å•çº¿ç¨‹ç¨‹åºï¼Œä½¿ç”¨cè¯­è¨€ç¼–å†™ï¼Œè¿è¡Œèµ·æ¥éå¸¸å¿«ã€‚å®ƒæ˜¯é‡‡ç”¨Apache 2.0 licenseçš„å¼€æºè½¯ä»¶ã€‚ Twemproxyæ”¯æŒè‡ªåŠ¨åˆ†åŒºï¼Œå¦‚æœå…¶ä»£ç†çš„å…¶ä¸­ä¸€ä¸ªRedisèŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹æ’é™¤ï¼ˆè¿™å°†æ”¹å˜åŸæ¥çš„keys-instancesçš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä»…åœ¨æŠŠRediså½“ç¼“å­˜æ—¶ä½¿ç”¨Twemproxy)ã€‚ Twemproxyæœ¬èº«ä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå› ä¸ºä½ å¯ä»¥å¯åŠ¨å¤šä¸ªTwemproxyå®ä¾‹ï¼Œç„¶åè®©ä½ çš„å®¢æˆ·ç«¯å»è¿æ¥ä»»æ„ä¸€ä¸ªTwemproxyå®ä¾‹ã€‚ Twemproxyæ˜¯Rediså®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œç”±å®ƒæ¥å¤„ç†åˆ†åŒºåŠŸèƒ½åº”è¯¥ä¸ç®—å¤æ‚ï¼Œå¹¶ä¸”åº”è¯¥ç®—æ¯”è¾ƒå¯é çš„ã€‚</p>\n<p>39ã€æ”¯æŒä¸€è‡´æ€§å“ˆå¸Œçš„å®¢æˆ·ç«¯æœ‰å“ªäº›ï¼Ÿ</p>\n<p>Redis-rbã€Predisç­‰ã€‚</p>\n<p>40ã€Redisä¸å…¶ä»–key-valueå­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>\n<p>Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚<br>Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œåº”ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œ ç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚ åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚<br>41ã€Redisçš„å†…å­˜å ç”¨æƒ…å†µæ€ä¹ˆæ ·ï¼Ÿ</p>\n<p>ç»™ä½ ä¸¾ä¸ªä¾‹å­ï¼š 100ä¸‡ä¸ªé”®å€¼å¯¹ï¼ˆé”®æ˜¯0åˆ°999999å€¼æ˜¯å­—ç¬¦ä¸²â€œhello worldâ€ï¼‰åœ¨æˆ‘çš„32ä½çš„Macç¬”è®°æœ¬ä¸Š ç”¨äº†100MBã€‚åŒæ ·çš„æ•°æ®æ”¾åˆ°ä¸€ä¸ªkeyé‡Œåªéœ€è¦16MBï¼Œ è¿™æ˜¯å› ä¸ºé”®å€¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼€é”€ã€‚ åœ¨Memcachedä¸Šæ‰§è¡Œä¹Ÿæ˜¯ç±»ä¼¼çš„ç»“æœï¼Œä½†æ˜¯ç›¸å¯¹Redisçš„å¼€é”€è¦å°ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºRedisä¼šè®°å½•ç±»å‹ä¿¡æ¯å¼•ç”¨è®¡æ•°ç­‰ç­‰ã€‚</p>\n<p>å½“ç„¶ï¼Œå¤§é”®å€¼å¯¹æ—¶ä¸¤è€…çš„æ¯”ä¾‹è¦å¥½å¾ˆå¤šã€‚</p>\n<p>64ä½çš„ç³»ç»Ÿæ¯”32ä½çš„éœ€è¦æ›´å¤šçš„å†…å­˜å¼€é”€ï¼Œå°¤å…¶æ˜¯é”®å€¼å¯¹éƒ½è¾ƒå°æ—¶ï¼Œè¿™æ˜¯å› ä¸º64ä½çš„ç³»ç»Ÿé‡ŒæŒ‡é’ˆå ç”¨äº†8ä¸ªå­—èŠ‚ã€‚ ä½†æ˜¯ï¼Œå½“ç„¶ï¼Œ64ä½ç³»ç»Ÿæ”¯æŒæ›´å¤§çš„å†…å­˜ï¼Œæ‰€ä»¥ä¸ºäº†è¿è¡Œå¤§å‹çš„RedisæœåŠ¡å™¨æˆ–å¤šæˆ–å°‘çš„éœ€è¦ä½¿ç”¨64ä½çš„ç³»ç»Ÿã€‚</p>\n<p>42ã€éƒ½æœ‰å“ªäº›åŠæ³•å¯ä»¥é™ä½Redisçš„å†…å­˜ä½¿ç”¨æƒ…å†µå‘¢ï¼Ÿ</p>\n<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯32ä½çš„Rediså®ä¾‹ï¼Œå¯ä»¥å¥½å¥½åˆ©ç”¨Hash,list,sorted set,setç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„Key-Valueå¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚</p>\n<p>43ã€æŸ¥çœ‹Redisä½¿ç”¨æƒ…å†µåŠçŠ¶æ€ä¿¡æ¯ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Ÿ</p>\n<p>info</p>\n<p>44ã€Redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>\n<p>å¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedisçš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥å°†Rediså½“ç¼“å­˜æ¥ä½¿ç”¨é…ç½®æ·˜æ±°æœºåˆ¶ï¼Œå½“Redisè¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚</p>\n<p>45ã€Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸CPUçš„åˆ©ç”¨ç‡ï¼Ÿ</p>\n<p>å¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ªRedisçš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ªCPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†ç‰‡ï¼ˆshardï¼‰ã€‚</p>\n<p>46ã€ä¸€ä¸ªRediså®ä¾‹æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘çš„keysï¼ŸListã€Setã€Sorted Setä»–ä»¬æœ€å¤šèƒ½å­˜æ”¾å¤šå°‘å…ƒç´ ï¼Ÿ</p>\n<p>ç†è®ºä¸ŠRediså¯ä»¥å¤„ç†å¤šè¾¾232çš„keysï¼Œå¹¶ä¸”åœ¨å®é™…ä¸­è¿›è¡Œäº†æµ‹è¯•ï¼Œæ¯ä¸ªå®ä¾‹è‡³å°‘å­˜æ”¾äº†2äº¿5åƒä¸‡çš„keysã€‚æˆ‘ä»¬æ­£åœ¨æµ‹è¯•ä¸€äº›è¾ƒå¤§çš„å€¼ã€‚</p>\n<p>ä»»ä½•listã€setã€å’Œsorted setéƒ½å¯ä»¥æ”¾232ä¸ªå…ƒç´ ã€‚</p>\n<p>æ¢å¥è¯è¯´ï¼ŒRedisçš„å­˜å‚¨æé™æ˜¯ç³»ç»Ÿä¸­çš„å¯ç”¨å†…å­˜å€¼ã€‚</p>\n<p>47ã€Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</p>\n<p>(1) Masteræœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼Œå¦‚RDBå†…å­˜å¿«ç…§å’ŒAOFæ—¥å¿—æ–‡ä»¶</p>\n<p>(2) å¦‚æœæ•°æ®æ¯”è¾ƒé‡è¦ï¼ŒæŸä¸ªSlaveå¼€å¯AOFå¤‡ä»½æ•°æ®ï¼Œç­–ç•¥è®¾ç½®ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡</p>\n<p>(3) ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒMasterå’ŒSlaveæœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…</p>\n<p>(4) å°½é‡é¿å…åœ¨å‹åŠ›å¾ˆå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“</p>\n<p>(5) ä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ä¸ºç¨³å®šï¼Œå³ï¼šMaster &lt;- Slave1 &lt;- Slave2 &lt;- Slave3â€¦</p>\n<p>è¿™æ ·çš„ç»“æ„æ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç°Slaveå¯¹Masterçš„æ›¿æ¢ã€‚å¦‚æœMasteræŒ‚äº†ï¼Œå¯ä»¥ç«‹åˆ»å¯ç”¨Slave1åšMasterï¼Œå…¶ä»–ä¸å˜ã€‚</p>\n<p>48ã€Redisæä¾›äº†å“ªå‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</p>\n<p>RDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨.<br>AOFæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œ,å½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®,AOFå‘½ä»¤ä»¥redisåè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾.Redisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™,ä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§.<br>å¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨,ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼.<br>ä½ ä¹Ÿå¯ä»¥åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼, åœ¨è¿™ç§æƒ…å†µä¸‹, å½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®,å› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´.<br>æœ€é‡è¦çš„äº‹æƒ…æ˜¯äº†è§£RDBå’ŒAOFæŒä¹…åŒ–æ–¹å¼çš„ä¸åŒ,è®©æˆ‘ä»¬ä»¥RDBæŒä¹…åŒ–æ–¹å¼å¼€å§‹ã€‚<br>49ã€å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾PostgreSQLçš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚</p>\n<p>æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼šå› ä¸ºå®šæ—¶ç”ŸæˆRDBå¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œ ä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…ä¹‹å‰æåˆ°çš„AOFç¨‹åºçš„bugã€‚</p>\n<p>50ã€ä¿®æ”¹é…ç½®ä¸é‡å¯Redisä¼šå®æ—¶ç”Ÿæ•ˆå—ï¼Ÿ</p>\n<p>é’ˆå¯¹è¿è¡Œå®ä¾‹ï¼Œæœ‰è®¸å¤šé…ç½®é€‰é¡¹å¯ä»¥é€šè¿‡ CONFIG SET å‘½ä»¤è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ— éœ€æ‰§è¡Œä»»ä½•å½¢å¼çš„é‡å¯ã€‚ ä» Redis 2.2 å¼€å§‹ï¼Œå¯ä»¥ä» AOF åˆ‡æ¢åˆ° RDB çš„å¿«ç…§æŒä¹…æ€§æˆ–å…¶ä»–æ–¹å¼è€Œä¸éœ€è¦é‡å¯ Redisã€‚æ£€ç´¢ â€˜CONFIG GET *â€™ å‘½ä»¤è·å–æ›´å¤šä¿¡æ¯ã€‚</p>\n<p>ä½†å¶å°”é‡æ–°å¯åŠ¨æ˜¯å¿…é¡»çš„ï¼Œå¦‚ä¸ºå‡çº§ Redis ç¨‹åºåˆ°æ–°çš„ç‰ˆæœ¬ï¼Œæˆ–è€…å½“ä½ éœ€è¦ä¿®æ”¹æŸäº›ç›®å‰ CONFIG å‘½ä»¤è¿˜ä¸æ”¯æŒçš„é…ç½®å‚æ•°çš„æ—¶å€™ã€‚</p>\n<p>è½¬è½½äºï¼š<a href=\"https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/\">https://cloudpai.gitee.io/2018/04/18/2018-04-18-3/</a></p>\n"},{"title":"SpringBootæ•´åˆHibernate Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½","date":"2022-06-01T01:34:37.000Z","_content":"\nã€€ã€€åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œåç«¯å¯¹å‰ç«¯ä¼ å…¥çš„å‚æ•°çš„æ ¡éªŒæˆäº†å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç¯èŠ‚ã€‚ä½†æ˜¯åœ¨å¤šå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåœ¨controllerå±‚åŠ ä¸Šå‚æ•°éªŒè¯ï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«è‡ƒè‚¿ï¼Œå¹¶ä¸”ä¼šæœ‰è®¸å¤šçš„é‡å¤ä»£ç ã€‚è¿™é‡Œå¯ä»¥å¼•ç”¨Hibernate Validatoræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒï¼ŒéªŒè¯å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ï¼Œå‡å°‘controllerå±‚çš„ä»£ç é‡ã€‚\n\n# ä¸€ã€pomå¼•å…¥Hibernate Validator\n\n```xml\n<!-- éªŒè¯å™¨ -->\n<dependency>\n      <groupId>org.hibernate.validator</groupId>\n      <artifactId>hibernate-validator</artifactId>\n      <version>6.1.5.Final</version>\n</dependency>\n```\n# äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\n\n```java\n@Data\npublic class UserModel {\n\n    @NotNull(message = \"ç”¨æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼\")\n    private String userName;\n\n    @NotNull(message = \"ageä¸èƒ½ä¸ºnull!\")\n    @Range(min = 1, max = 888, message = \"èŒƒå›´ä¸º1è‡³888\")\n    private Integer age;\n\n    /**\n     * æ—¥æœŸæ ¼å¼åŒ–è½¬æ¢\n     */\n    @NotNull(message = \"æ—¥æœŸä¸èƒ½ä¸ºnull!\")\n    private Date date;\n}\n```\nè¿™é‡Œç”¨åˆ°çš„å‚æ•°æ ¡éªŒçš„æ³¨è§£æœ‰@NotNullå’Œ@Rangeï¼Œmessageæ˜¯åˆ°æ—¶å€™æˆ‘ä»¬è¿”å›ç»™å‰ç«¯çš„ä¿¡æ¯ï¼Œæ³¨è§£çš„å…·ä½“æ„æ€å¦‚ä¸‹ï¼š\n```java\n@Null  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºnull\n@NotNull  è¢«æ³¨é‡Šçš„å…ƒç´ ä¸èƒ½ä¸ºnull\n@AssertTrue  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºtrue\n@AssertFalse  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºfalse\n@Min(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼\n@Max(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼\n@DecimalMin(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼\n@DecimalMax(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼\n@Size(max,min)  è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚\n@Digits(integer,fraction)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…\n@Past  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ\n@Future  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ\n@Pattern(value) è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚\n@Email è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ä»¶åœ°å€\n@Length è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…\n@NotEmpty  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²å¿…é¡»éç©º\n@Range  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…\n```\n# ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£\n\n```java\n@PostMapping(\"/testPost\")\npublic Object testPost(@RequestBody @Valid UserModel userModel, BindingResult result){\n    if(result.hasErrors()){\n        for(ObjectError error:result.getAllErrors()){\n            return error.getDefaultMessage();\n        }\n    }\n    return userModel;\n}\n```\ncontrollerå±‚è¿™é‡Œåªéœ€è¦åœ¨å®ä½“ç±»çš„å‰é¢åŠ ä¸Š@Validæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å®ç°æ•°æ®çš„éªŒè¯ã€‚è¿™é‡ŒBindingResultæ˜¯å­˜å‚¨äº†æ ¡éªŒæ—¶çš„é”™è¯¯ä¿¡æ¯ï¼ŒéªŒè¯æœ‰è¯¯æ—¶å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‰ç«¯ã€‚è¿™é‡Œä¸ä½¿ç”¨BindingResultçš„æ—¶å€™ï¼Œæ§åˆ¶å°ä¼šæŠ¥MethodArgumentNotValidExceptionï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰å¼‚å¸¸ç±»æ¥æ•æ‰å®ƒï¼Œç„¶åå»æ‰BindingResultï¼Œä»¥åŠéš¾çœ‹çš„ifåˆ¤æ–­ã€‚\n\n# å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\n\n```java\n@RestControllerAdvice\npublic class GlobalExceptionAdvice {\n\n    @ExceptionHandler(value = MethodArgumentNotValidException.class)\n    public JsonData validException(MethodArgumentNotValidException e) {\n        //éªŒè¯postè¯·æ±‚çš„å‚æ•°åˆæ³•æ€§\n        MethodArgumentNotValidException notValidException = e;\n        String msg = notValidException.getBindingResult().getFieldError().getDefaultMessage();\n        return JsonData.buildError(msg);\n    }\n}\n```\nä½¿ç”¨PostMançš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0e7da5f5ea00deaf1e69196d09085f49.png)\n\nå…·ä½“çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„githubä¸Šé¢æŸ¥çœ‹ï¼Œhttps://github.com/ruiyeclub/SpringBoot-Hello\n","source":"_posts/SpringBootæ•´åˆHibernate-Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½.md","raw":"---\ntitle: SpringBootæ•´åˆHibernate Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½\ndate: 2022-06-01 09:34:37\ntags:\n---\n\nã€€ã€€åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œåç«¯å¯¹å‰ç«¯ä¼ å…¥çš„å‚æ•°çš„æ ¡éªŒæˆäº†å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç¯èŠ‚ã€‚ä½†æ˜¯åœ¨å¤šå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåœ¨controllerå±‚åŠ ä¸Šå‚æ•°éªŒè¯ï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«è‡ƒè‚¿ï¼Œå¹¶ä¸”ä¼šæœ‰è®¸å¤šçš„é‡å¤ä»£ç ã€‚è¿™é‡Œå¯ä»¥å¼•ç”¨Hibernate Validatoræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒï¼ŒéªŒè¯å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ï¼Œå‡å°‘controllerå±‚çš„ä»£ç é‡ã€‚\n\n# ä¸€ã€pomå¼•å…¥Hibernate Validator\n\n```xml\n<!-- éªŒè¯å™¨ -->\n<dependency>\n      <groupId>org.hibernate.validator</groupId>\n      <artifactId>hibernate-validator</artifactId>\n      <version>6.1.5.Final</version>\n</dependency>\n```\n# äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\n\n```java\n@Data\npublic class UserModel {\n\n    @NotNull(message = \"ç”¨æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼\")\n    private String userName;\n\n    @NotNull(message = \"ageä¸èƒ½ä¸ºnull!\")\n    @Range(min = 1, max = 888, message = \"èŒƒå›´ä¸º1è‡³888\")\n    private Integer age;\n\n    /**\n     * æ—¥æœŸæ ¼å¼åŒ–è½¬æ¢\n     */\n    @NotNull(message = \"æ—¥æœŸä¸èƒ½ä¸ºnull!\")\n    private Date date;\n}\n```\nè¿™é‡Œç”¨åˆ°çš„å‚æ•°æ ¡éªŒçš„æ³¨è§£æœ‰@NotNullå’Œ@Rangeï¼Œmessageæ˜¯åˆ°æ—¶å€™æˆ‘ä»¬è¿”å›ç»™å‰ç«¯çš„ä¿¡æ¯ï¼Œæ³¨è§£çš„å…·ä½“æ„æ€å¦‚ä¸‹ï¼š\n```java\n@Null  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºnull\n@NotNull  è¢«æ³¨é‡Šçš„å…ƒç´ ä¸èƒ½ä¸ºnull\n@AssertTrue  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºtrue\n@AssertFalse  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ºfalse\n@Min(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼\n@Max(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼\n@DecimalMin(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼\n@DecimalMax(value)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼\n@Size(max,min)  è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚\n@Digits(integer,fraction)  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…\n@Past  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ\n@Future  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ\n@Pattern(value) è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚\n@Email è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ä»¶åœ°å€\n@Length è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…\n@NotEmpty  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²å¿…é¡»éç©º\n@Range  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…\n```\n# ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£\n\n```java\n@PostMapping(\"/testPost\")\npublic Object testPost(@RequestBody @Valid UserModel userModel, BindingResult result){\n    if(result.hasErrors()){\n        for(ObjectError error:result.getAllErrors()){\n            return error.getDefaultMessage();\n        }\n    }\n    return userModel;\n}\n```\ncontrollerå±‚è¿™é‡Œåªéœ€è¦åœ¨å®ä½“ç±»çš„å‰é¢åŠ ä¸Š@Validæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å®ç°æ•°æ®çš„éªŒè¯ã€‚è¿™é‡ŒBindingResultæ˜¯å­˜å‚¨äº†æ ¡éªŒæ—¶çš„é”™è¯¯ä¿¡æ¯ï¼ŒéªŒè¯æœ‰è¯¯æ—¶å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‰ç«¯ã€‚è¿™é‡Œä¸ä½¿ç”¨BindingResultçš„æ—¶å€™ï¼Œæ§åˆ¶å°ä¼šæŠ¥MethodArgumentNotValidExceptionï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰å¼‚å¸¸ç±»æ¥æ•æ‰å®ƒï¼Œç„¶åå»æ‰BindingResultï¼Œä»¥åŠéš¾çœ‹çš„ifåˆ¤æ–­ã€‚\n\n# å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\n\n```java\n@RestControllerAdvice\npublic class GlobalExceptionAdvice {\n\n    @ExceptionHandler(value = MethodArgumentNotValidException.class)\n    public JsonData validException(MethodArgumentNotValidException e) {\n        //éªŒè¯postè¯·æ±‚çš„å‚æ•°åˆæ³•æ€§\n        MethodArgumentNotValidException notValidException = e;\n        String msg = notValidException.getBindingResult().getFieldError().getDefaultMessage();\n        return JsonData.buildError(msg);\n    }\n}\n```\nä½¿ç”¨PostMançš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0e7da5f5ea00deaf1e69196d09085f49.png)\n\nå…·ä½“çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„githubä¸Šé¢æŸ¥çœ‹ï¼Œhttps://github.com/ruiyeclub/SpringBoot-Hello\n","slug":"SpringBootæ•´åˆHibernate-Validatorå®ç°å‚æ•°éªŒè¯åŠŸèƒ½","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dn000rwen1c09c2526","content":"<p>ã€€ã€€åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œåç«¯å¯¹å‰ç«¯ä¼ å…¥çš„å‚æ•°çš„æ ¡éªŒæˆäº†å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç¯èŠ‚ã€‚ä½†æ˜¯åœ¨å¤šå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåœ¨controllerå±‚åŠ ä¸Šå‚æ•°éªŒè¯ï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«è‡ƒè‚¿ï¼Œå¹¶ä¸”ä¼šæœ‰è®¸å¤šçš„é‡å¤ä»£ç ã€‚è¿™é‡Œå¯ä»¥å¼•ç”¨Hibernate Validatoræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒï¼ŒéªŒè¯å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ï¼Œå‡å°‘controllerå±‚çš„ä»£ç é‡ã€‚</p>\n<h1 id=\"ä¸€ã€pomå¼•å…¥Hibernate-Validator\"><a href=\"#ä¸€ã€pomå¼•å…¥Hibernate-Validator\" class=\"headerlink\" title=\"ä¸€ã€pomå¼•å…¥Hibernate Validator\"></a>ä¸€ã€pomå¼•å…¥Hibernate Validator</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- éªŒè¯å™¨ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.hibernate.validator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>hibernate-validator<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>6.1.5.Final<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\"><a href=\"#äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\" class=\"headerlink\" title=\"äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\"></a>äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserModel</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;ç”¨æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String userName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;ageä¸èƒ½ä¸ºnull!&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Range(min = 1, max = 888, message = &quot;èŒƒå›´ä¸º1è‡³888&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ—¥æœŸæ ¼å¼åŒ–è½¬æ¢</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;æ—¥æœŸä¸èƒ½ä¸ºnull!&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date date;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œç”¨åˆ°çš„å‚æ•°æ ¡éªŒçš„æ³¨è§£æœ‰@NotNullå’Œ@Rangeï¼Œmessageæ˜¯åˆ°æ—¶å€™æˆ‘ä»¬è¿”å›ç»™å‰ç«¯çš„ä¿¡æ¯ï¼Œæ³¨è§£çš„å…·ä½“æ„æ€å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Null</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">null</span></span><br><span class=\"line\"><span class=\"meta\">@NotNull</span>  è¢«æ³¨é‡Šçš„å…ƒç´ ä¸èƒ½ä¸º<span class=\"literal\">null</span></span><br><span class=\"line\"><span class=\"meta\">@AssertTrue</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"meta\">@AssertFalse</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">@Min(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</span><br><span class=\"line\"><span class=\"meta\">@Max(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class=\"line\"><span class=\"meta\">@DecimalMin(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</span><br><span class=\"line\"><span class=\"meta\">@DecimalMax(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class=\"line\"><span class=\"meta\">@Size(max,min)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚</span><br><span class=\"line\"><span class=\"meta\">@Digits(integer,fraction)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…</span><br><span class=\"line\"><span class=\"meta\">@Past</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ</span><br><span class=\"line\"><span class=\"meta\">@Future</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ</span><br><span class=\"line\"><span class=\"meta\">@Pattern(value)</span> è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><br><span class=\"line\"><span class=\"meta\">@Email</span> è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ä»¶åœ°å€</span><br><span class=\"line\"><span class=\"meta\">@Length</span> è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…</span><br><span class=\"line\"><span class=\"meta\">@NotEmpty</span>  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²å¿…é¡»éç©º</span><br><span class=\"line\"><span class=\"meta\">@Range</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</span><br></pre></td></tr></table></figure>\n<h1 id=\"ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š-Validæ³¨è§£\"><a href=\"#ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š-Validæ³¨è§£\" class=\"headerlink\" title=\"ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£\"></a>ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PostMapping(&quot;/testPost&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object <span class=\"title function_\">testPost</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> <span class=\"meta\">@Valid</span> UserModel userModel, BindingResult result)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(result.hasErrors())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(ObjectError error:result.getAllErrors())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> error.getDefaultMessage();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> userModel;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>controllerå±‚è¿™é‡Œåªéœ€è¦åœ¨å®ä½“ç±»çš„å‰é¢åŠ ä¸Š@Validæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å®ç°æ•°æ®çš„éªŒè¯ã€‚è¿™é‡ŒBindingResultæ˜¯å­˜å‚¨äº†æ ¡éªŒæ—¶çš„é”™è¯¯ä¿¡æ¯ï¼ŒéªŒè¯æœ‰è¯¯æ—¶å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‰ç«¯ã€‚è¿™é‡Œä¸ä½¿ç”¨BindingResultçš„æ—¶å€™ï¼Œæ§åˆ¶å°ä¼šæŠ¥MethodArgumentNotValidExceptionï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰å¼‚å¸¸ç±»æ¥æ•æ‰å®ƒï¼Œç„¶åå»æ‰BindingResultï¼Œä»¥åŠéš¾çœ‹çš„ifåˆ¤æ–­ã€‚</p>\n<h1 id=\"å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\"><a href=\"#å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\" class=\"headerlink\" title=\"å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\"></a>å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GlobalExceptionAdvice</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler(value = MethodArgumentNotValidException.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> JsonData <span class=\"title function_\">validException</span><span class=\"params\">(MethodArgumentNotValidException e)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//éªŒè¯postè¯·æ±‚çš„å‚æ•°åˆæ³•æ€§</span></span><br><span class=\"line\">        <span class=\"type\">MethodArgumentNotValidException</span> <span class=\"variable\">notValidException</span> <span class=\"operator\">=</span> e;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">msg</span> <span class=\"operator\">=</span> notValidException.getBindingResult().getFieldError().getDefaultMessage();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonData.buildError(msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½¿ç”¨PostMançš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0e7da5f5ea00deaf1e69196d09085f49.png\" alt=\"image.png\"></p>\n<p>å…·ä½“çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„githubä¸Šé¢æŸ¥çœ‹ï¼Œ<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n","excerpt":"","more":"<p>ã€€ã€€åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œåç«¯å¯¹å‰ç«¯ä¼ å…¥çš„å‚æ•°çš„æ ¡éªŒæˆäº†å¿…ä¸å¯å°‘çš„ä¸€ä¸ªç¯èŠ‚ã€‚ä½†æ˜¯åœ¨å¤šå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåœ¨controllerå±‚åŠ ä¸Šå‚æ•°éªŒè¯ï¼Œä¼šæ˜¾å¾—ç‰¹åˆ«è‡ƒè‚¿ï¼Œå¹¶ä¸”ä¼šæœ‰è®¸å¤šçš„é‡å¤ä»£ç ã€‚è¿™é‡Œå¯ä»¥å¼•ç”¨Hibernate Validatoræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒï¼ŒéªŒè¯å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ï¼Œå‡å°‘controllerå±‚çš„ä»£ç é‡ã€‚</p>\n<h1 id=\"ä¸€ã€pomå¼•å…¥Hibernate-Validator\"><a href=\"#ä¸€ã€pomå¼•å…¥Hibernate-Validator\" class=\"headerlink\" title=\"ä¸€ã€pomå¼•å…¥Hibernate Validator\"></a>ä¸€ã€pomå¼•å…¥Hibernate Validator</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- éªŒè¯å™¨ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.hibernate.validator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>hibernate-validator<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>6.1.5.Final<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\"><a href=\"#äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\" class=\"headerlink\" title=\"äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ\"></a>äºŒã€é€šè¿‡æ³¨è§£åœ¨å®ä½“ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserModel</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;ç”¨æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String userName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;ageä¸èƒ½ä¸ºnull!&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Range(min = 1, max = 888, message = &quot;èŒƒå›´ä¸º1è‡³888&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ—¥æœŸæ ¼å¼åŒ–è½¬æ¢</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@NotNull(message = &quot;æ—¥æœŸä¸èƒ½ä¸ºnull!&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date date;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œç”¨åˆ°çš„å‚æ•°æ ¡éªŒçš„æ³¨è§£æœ‰@NotNullå’Œ@Rangeï¼Œmessageæ˜¯åˆ°æ—¶å€™æˆ‘ä»¬è¿”å›ç»™å‰ç«¯çš„ä¿¡æ¯ï¼Œæ³¨è§£çš„å…·ä½“æ„æ€å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Null</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">null</span></span><br><span class=\"line\"><span class=\"meta\">@NotNull</span>  è¢«æ³¨é‡Šçš„å…ƒç´ ä¸èƒ½ä¸º<span class=\"literal\">null</span></span><br><span class=\"line\"><span class=\"meta\">@AssertTrue</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"meta\">@AssertFalse</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º<span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"meta\">@Min(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</span><br><span class=\"line\"><span class=\"meta\">@Max(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class=\"line\"><span class=\"meta\">@DecimalMin(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</span><br><span class=\"line\"><span class=\"meta\">@DecimalMax(value)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</span><br><span class=\"line\"><span class=\"meta\">@Size(max,min)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚</span><br><span class=\"line\"><span class=\"meta\">@Digits(integer,fraction)</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…</span><br><span class=\"line\"><span class=\"meta\">@Past</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ</span><br><span class=\"line\"><span class=\"meta\">@Future</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ</span><br><span class=\"line\"><span class=\"meta\">@Pattern(value)</span> è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><br><span class=\"line\"><span class=\"meta\">@Email</span> è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ä»¶åœ°å€</span><br><span class=\"line\"><span class=\"meta\">@Length</span> è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…</span><br><span class=\"line\"><span class=\"meta\">@NotEmpty</span>  è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²å¿…é¡»éç©º</span><br><span class=\"line\"><span class=\"meta\">@Range</span>  è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</span><br></pre></td></tr></table></figure>\n<h1 id=\"ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š-Validæ³¨è§£\"><a href=\"#ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š-Validæ³¨è§£\" class=\"headerlink\" title=\"ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£\"></a>ä¸‰ã€controllerå±‚çš„æ–¹æ³•åŠ ä¸Š@Validæ³¨è§£</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PostMapping(&quot;/testPost&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Object <span class=\"title function_\">testPost</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> <span class=\"meta\">@Valid</span> UserModel userModel, BindingResult result)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(result.hasErrors())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(ObjectError error:result.getAllErrors())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> error.getDefaultMessage();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> userModel;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>controllerå±‚è¿™é‡Œåªéœ€è¦åœ¨å®ä½“ç±»çš„å‰é¢åŠ ä¸Š@Validæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å®ç°æ•°æ®çš„éªŒè¯ã€‚è¿™é‡ŒBindingResultæ˜¯å­˜å‚¨äº†æ ¡éªŒæ—¶çš„é”™è¯¯ä¿¡æ¯ï¼ŒéªŒè¯æœ‰è¯¯æ—¶å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™å‰ç«¯ã€‚è¿™é‡Œä¸ä½¿ç”¨BindingResultçš„æ—¶å€™ï¼Œæ§åˆ¶å°ä¼šæŠ¥MethodArgumentNotValidExceptionï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰å¼‚å¸¸ç±»æ¥æ•æ‰å®ƒï¼Œç„¶åå»æ‰BindingResultï¼Œä»¥åŠéš¾çœ‹çš„ifåˆ¤æ–­ã€‚</p>\n<h1 id=\"å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\"><a href=\"#å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\" class=\"headerlink\" title=\"å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException\"></a>å››ã€è‡ªå®šä¹‰å¼‚å¸¸ç±»æ•æ‰MethodArgumentNotValidException</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">GlobalExceptionAdvice</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler(value = MethodArgumentNotValidException.class)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> JsonData <span class=\"title function_\">validException</span><span class=\"params\">(MethodArgumentNotValidException e)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//éªŒè¯postè¯·æ±‚çš„å‚æ•°åˆæ³•æ€§</span></span><br><span class=\"line\">        <span class=\"type\">MethodArgumentNotValidException</span> <span class=\"variable\">notValidException</span> <span class=\"operator\">=</span> e;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">msg</span> <span class=\"operator\">=</span> notValidException.getBindingResult().getFieldError().getDefaultMessage();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JsonData.buildError(msg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½¿ç”¨PostMançš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/0e7da5f5ea00deaf1e69196d09085f49.png\" alt=\"image.png\"></p>\n<p>å…·ä½“çš„ä»£ç å¯ä»¥åœ¨æˆ‘çš„githubä¸Šé¢æŸ¥çœ‹ï¼Œ<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n"},{"title":"SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º","date":"2022-02-12T09:28:11.000Z","_content":"\nå…¬å¸é¡¹ç›®éœ€è¦ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå°±å›¾ç‰‡èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå…¬å¸ç”¨çš„windowsæœåŠ¡å™¨ï¼‰ï¼Œç„¶ånginxèƒ½è¿›è¡Œä»£ç†è®¿é—®åˆ°å°±è¡Œäº†ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹nginxï¼Œç„¶åå†æ¥å®ç°åŠŸèƒ½ã€‚\n\n# ä¸€ã€nginxç®€ä»‹\n\n> Nginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼Œç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ã€‚\nNginxä¸“é—¨ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œå¼€å‘ï¼Œæ€§èƒ½æ˜¯å…¶æœ€é‡è¦çš„è€ƒé‡ï¼Œå®é™…ä¸Šéå¸¸æ³¨é‡æ•ˆç‡ï¼Œèƒ½ç»èµ·é«˜è´Ÿè½½çš„è€ƒéªŒï¼Œæœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾50000ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚\n\n# äºŒã€åå‘ä»£ç†\n\n1.æ­£å‘ä»£ç†\nåœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œäº’è”ç½‘è®¿é—®ã€‚\n2.åå‘ä»£ç†\næˆ‘ä»¬åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨IPåœ°å€ã€‚\n\n# ä¸‰ã€è´Ÿè½½å‡è¡¡\n\nå¢åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºåˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡ã€‚\n\n# å››ã€åŠ¨é™åˆ†ç¦»\n\n\nä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚å‡ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚\n\n# äº”ã€nginxå¸¸ç”¨å‘½ä»¤\n\n1.ä½¿ç”¨nginxæ“ä½œå‘½ä»¤å‰ææ¡ä»¶ï¼šå¿…é¡»è¿›è¡Œnginxçš„ç›®å½•\n\n2.æŸ¥çœ‹nginxçš„ç‰ˆæœ¬å·\nnginx -v\n\n3.å¯åŠ¨nginx\nnginx\n\n4.å…³é—­nginx\nnginx -s stop\n\n5.é‡æ–°åŠ è½½nginx\nnginx -s reload\n\n# å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰\n\nnginxé…ç½®æ–‡ä»¶æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ\n1.å…¨å±€å—\nä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventså—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginxæœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ã€‚\næ¯”å¦‚ï¼šworker_processes 1; worker_processeså€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šã€‚\n\n2.eventså—\n\neventså—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚\næ¯”å¦‚ï¼šworker_connection 1024; æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ã€‚\n\n3.httpå—\nnginxæœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œhttpå—ä¹Ÿå¯ä»¥åŒ…æ‹¬httpå…¨å±€å—ã€serverå—ã€‚\n\n# ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\n\nå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨D:/imagesä¸­ï¼Œç„¶åé€šè¿‡IPåœ°å€/upload/åŠ å›¾ç‰‡åç§°è¿›è¡Œè®¿é—®ã€‚\n\n```xml\n#user  nobody;\nworker_processes  1;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        #è®¿é—®è·¯å¾„æ‹¼æ¥ upload è®¿é—®æœ¬åœ°ç»å¯¹è·¯å¾„ä¸‹çš„æŸå›¾ç‰‡ \n        location /upload/ {\n        alias D:/images/;\n        autoindex on;\n        }\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #\n        #location ~ \\.php$ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        #\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n```\né…ç½®å¥½nginx.confè®°å¾—é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ã€‚æ•ˆæœå¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/83f770e8dad9c1ca09033b2e9ce6037f.png)\n\n# å…«ã€javaåå°ä»£ç \n\n```java\n/**\n * æ–‡ä»¶ä¸Šä¼ \n */\n@RestController\npublic class FileController {\n\n    @PostMapping(value = \"/fileUpload\")\n    public String fileUpload(@RequestParam(value = \"file\") MultipartFile file) {\n        if (file.isEmpty()) {\n            System.out.println(\"è¯·é€‰æ‹©å›¾ç‰‡\");\n        }\n        String fileName = file.getOriginalFilename();  // æ–‡ä»¶å\n        String suffixName = fileName.substring(fileName.lastIndexOf(\".\"));  // åç¼€å\n        String filePath = \"D:/images/\"; // ä¸Šä¼ åçš„è·¯å¾„\n        fileName = UUID.randomUUID() + suffixName; // æ–°æ–‡ä»¶å\n        File dest = new File(filePath + fileName);\n        if (!dest.getParentFile().exists()) {\n            dest.getParentFile().mkdirs();\n        }\n        try {\n            file.transferTo(dest);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        //è¿”å›å›¾ç‰‡åç§°\n        return fileName;\n    }\n}\n```\nè¿™é‡Œå°†å›¾ç‰‡ä¸Šä¼ è‡³D:/imagesæ–‡ä»¶å¤¹ä¸­ï¼Œå› ä¸ºå‰é¢é…ç½®äº†nginxçš„ç¼˜æ•…ï¼Œæˆ‘è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æµ‹è¯•çš„ï¼Œç›´æ¥ä½¿ç”¨localhost/upload/+è¿”å›çš„å›¾ç‰‡åç§°å°±å¯ä»¥è®¿é—®åˆ°äº†ã€‚\n\nå¦‚æœæƒ³è¦é€šè¿‡é¡¹ç›®çš„åœ°å€å¤–åŠ ç«¯å£å·è¿›è¡Œè®¿é—®çš„è¯ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªèµ„æºæ˜ å°„è·¯å¾„ã€‚\n\n```java\n/**\n * èµ„æºæ˜ å°„è·¯å¾„\n */\n@Configuration\npublic class MyWebMvcConfig implements WebMvcConfigurer {\n    @Override\n    public void addResourceHandlers(ResourceHandlerRegistry registry) {\n        registry.addResourceHandler(\"/upload/**\").addResourceLocations(\"file:D:/images/\");\n    }\n}\n```\nlike this!\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ef6fa062cb4f717a5d1287f49357592f.png)\n\né¡¹ç›®ä»£ç å¯åœ¨[github](github)è¿›è¡ŒæŸ¥çœ‹\n","source":"_posts/SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º.md","raw":"---\ntitle: SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º\ndate: 2022-02-12 17:28:11\ntags:\n---\n\nå…¬å¸é¡¹ç›®éœ€è¦ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå°±å›¾ç‰‡èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå…¬å¸ç”¨çš„windowsæœåŠ¡å™¨ï¼‰ï¼Œç„¶ånginxèƒ½è¿›è¡Œä»£ç†è®¿é—®åˆ°å°±è¡Œäº†ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹nginxï¼Œç„¶åå†æ¥å®ç°åŠŸèƒ½ã€‚\n\n# ä¸€ã€nginxç®€ä»‹\n\n> Nginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼Œç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ã€‚\nNginxä¸“é—¨ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œå¼€å‘ï¼Œæ€§èƒ½æ˜¯å…¶æœ€é‡è¦çš„è€ƒé‡ï¼Œå®é™…ä¸Šéå¸¸æ³¨é‡æ•ˆç‡ï¼Œèƒ½ç»èµ·é«˜è´Ÿè½½çš„è€ƒéªŒï¼Œæœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾50000ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚\n\n# äºŒã€åå‘ä»£ç†\n\n1.æ­£å‘ä»£ç†\nåœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œäº’è”ç½‘è®¿é—®ã€‚\n2.åå‘ä»£ç†\næˆ‘ä»¬åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨IPåœ°å€ã€‚\n\n# ä¸‰ã€è´Ÿè½½å‡è¡¡\n\nå¢åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºåˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡ã€‚\n\n# å››ã€åŠ¨é™åˆ†ç¦»\n\n\nä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚å‡ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚\n\n# äº”ã€nginxå¸¸ç”¨å‘½ä»¤\n\n1.ä½¿ç”¨nginxæ“ä½œå‘½ä»¤å‰ææ¡ä»¶ï¼šå¿…é¡»è¿›è¡Œnginxçš„ç›®å½•\n\n2.æŸ¥çœ‹nginxçš„ç‰ˆæœ¬å·\nnginx -v\n\n3.å¯åŠ¨nginx\nnginx\n\n4.å…³é—­nginx\nnginx -s stop\n\n5.é‡æ–°åŠ è½½nginx\nnginx -s reload\n\n# å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰\n\nnginxé…ç½®æ–‡ä»¶æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ\n1.å…¨å±€å—\nä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventså—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginxæœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ã€‚\næ¯”å¦‚ï¼šworker_processes 1; worker_processeså€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šã€‚\n\n2.eventså—\n\neventså—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚\næ¯”å¦‚ï¼šworker_connection 1024; æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ã€‚\n\n3.httpå—\nnginxæœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œhttpå—ä¹Ÿå¯ä»¥åŒ…æ‹¬httpå…¨å±€å—ã€serverå—ã€‚\n\n# ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\n\nå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨D:/imagesä¸­ï¼Œç„¶åé€šè¿‡IPåœ°å€/upload/åŠ å›¾ç‰‡åç§°è¿›è¡Œè®¿é—®ã€‚\n\n```xml\n#user  nobody;\nworker_processes  1;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       80;\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n        #è®¿é—®è·¯å¾„æ‹¼æ¥ upload è®¿é—®æœ¬åœ°ç»å¯¹è·¯å¾„ä¸‹çš„æŸå›¾ç‰‡ \n        location /upload/ {\n        alias D:/images/;\n        autoindex on;\n        }\n\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #\n        #location ~ \\.php$ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        #\n        #location ~ \\.php$ {\n        #    root           html;\n        #    fastcgi_pass   127.0.0.1:9000;\n        #    fastcgi_index  index.php;\n        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n        #    include        fastcgi_params;\n        #}\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n```\né…ç½®å¥½nginx.confè®°å¾—é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ã€‚æ•ˆæœå¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/83f770e8dad9c1ca09033b2e9ce6037f.png)\n\n# å…«ã€javaåå°ä»£ç \n\n```java\n/**\n * æ–‡ä»¶ä¸Šä¼ \n */\n@RestController\npublic class FileController {\n\n    @PostMapping(value = \"/fileUpload\")\n    public String fileUpload(@RequestParam(value = \"file\") MultipartFile file) {\n        if (file.isEmpty()) {\n            System.out.println(\"è¯·é€‰æ‹©å›¾ç‰‡\");\n        }\n        String fileName = file.getOriginalFilename();  // æ–‡ä»¶å\n        String suffixName = fileName.substring(fileName.lastIndexOf(\".\"));  // åç¼€å\n        String filePath = \"D:/images/\"; // ä¸Šä¼ åçš„è·¯å¾„\n        fileName = UUID.randomUUID() + suffixName; // æ–°æ–‡ä»¶å\n        File dest = new File(filePath + fileName);\n        if (!dest.getParentFile().exists()) {\n            dest.getParentFile().mkdirs();\n        }\n        try {\n            file.transferTo(dest);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        //è¿”å›å›¾ç‰‡åç§°\n        return fileName;\n    }\n}\n```\nè¿™é‡Œå°†å›¾ç‰‡ä¸Šä¼ è‡³D:/imagesæ–‡ä»¶å¤¹ä¸­ï¼Œå› ä¸ºå‰é¢é…ç½®äº†nginxçš„ç¼˜æ•…ï¼Œæˆ‘è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æµ‹è¯•çš„ï¼Œç›´æ¥ä½¿ç”¨localhost/upload/+è¿”å›çš„å›¾ç‰‡åç§°å°±å¯ä»¥è®¿é—®åˆ°äº†ã€‚\n\nå¦‚æœæƒ³è¦é€šè¿‡é¡¹ç›®çš„åœ°å€å¤–åŠ ç«¯å£å·è¿›è¡Œè®¿é—®çš„è¯ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªèµ„æºæ˜ å°„è·¯å¾„ã€‚\n\n```java\n/**\n * èµ„æºæ˜ å°„è·¯å¾„\n */\n@Configuration\npublic class MyWebMvcConfig implements WebMvcConfigurer {\n    @Override\n    public void addResourceHandlers(ResourceHandlerRegistry registry) {\n        registry.addResourceHandler(\"/upload/**\").addResourceLocations(\"file:D:/images/\");\n    }\n}\n```\nlike this!\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ef6fa062cb4f717a5d1287f49357592f.png)\n\né¡¹ç›®ä»£ç å¯åœ¨[github](github)è¿›è¡ŒæŸ¥çœ‹\n","slug":"SpringBootå®ç°å›¾ç‰‡ä¸Šä¼ demoä»¥åŠNginxè¿›è¡Œä»£ç†æ˜¾ç¤º","published":1,"updated":"2024-02-07T07:27:45.072Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dn000swen18x1619qn","content":"<p>å…¬å¸é¡¹ç›®éœ€è¦ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå°±å›¾ç‰‡èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå…¬å¸ç”¨çš„windowsæœåŠ¡å™¨ï¼‰ï¼Œç„¶ånginxèƒ½è¿›è¡Œä»£ç†è®¿é—®åˆ°å°±è¡Œäº†ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹nginxï¼Œç„¶åå†æ¥å®ç°åŠŸèƒ½ã€‚</p>\n<h1 id=\"ä¸€ã€nginxç®€ä»‹\"><a href=\"#ä¸€ã€nginxç®€ä»‹\" class=\"headerlink\" title=\"ä¸€ã€nginxç®€ä»‹\"></a>ä¸€ã€nginxç®€ä»‹</h1><blockquote>\n<p>Nginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼Œç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ã€‚<br>Nginxä¸“é—¨ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œå¼€å‘ï¼Œæ€§èƒ½æ˜¯å…¶æœ€é‡è¦çš„è€ƒé‡ï¼Œå®é™…ä¸Šéå¸¸æ³¨é‡æ•ˆç‡ï¼Œèƒ½ç»èµ·é«˜è´Ÿè½½çš„è€ƒéªŒï¼Œæœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾50000ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚</p>\n</blockquote>\n<h1 id=\"äºŒã€åå‘ä»£ç†\"><a href=\"#äºŒã€åå‘ä»£ç†\" class=\"headerlink\" title=\"äºŒã€åå‘ä»£ç†\"></a>äºŒã€åå‘ä»£ç†</h1><p>1.æ­£å‘ä»£ç†<br>åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œäº’è”ç½‘è®¿é—®ã€‚<br>2.åå‘ä»£ç†<br>æˆ‘ä»¬åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨IPåœ°å€ã€‚</p>\n<h1 id=\"ä¸‰ã€è´Ÿè½½å‡è¡¡\"><a href=\"#ä¸‰ã€è´Ÿè½½å‡è¡¡\" class=\"headerlink\" title=\"ä¸‰ã€è´Ÿè½½å‡è¡¡\"></a>ä¸‰ã€è´Ÿè½½å‡è¡¡</h1><p>å¢åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºåˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡ã€‚</p>\n<h1 id=\"å››ã€åŠ¨é™åˆ†ç¦»\"><a href=\"#å››ã€åŠ¨é™åˆ†ç¦»\" class=\"headerlink\" title=\"å››ã€åŠ¨é™åˆ†ç¦»\"></a>å››ã€åŠ¨é™åˆ†ç¦»</h1><p>ä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚å‡ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚</p>\n<h1 id=\"äº”ã€nginxå¸¸ç”¨å‘½ä»¤\"><a href=\"#äº”ã€nginxå¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"äº”ã€nginxå¸¸ç”¨å‘½ä»¤\"></a>äº”ã€nginxå¸¸ç”¨å‘½ä»¤</h1><p>1.ä½¿ç”¨nginxæ“ä½œå‘½ä»¤å‰ææ¡ä»¶ï¼šå¿…é¡»è¿›è¡Œnginxçš„ç›®å½•</p>\n<p>2.æŸ¥çœ‹nginxçš„ç‰ˆæœ¬å·<br>nginx -v</p>\n<p>3.å¯åŠ¨nginx<br>nginx</p>\n<p>4.å…³é—­nginx<br>nginx -s stop</p>\n<p>5.é‡æ–°åŠ è½½nginx<br>nginx -s reload</p>\n<h1 id=\"å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx-confï¼‰\"><a href=\"#å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx-confï¼‰\" class=\"headerlink\" title=\"å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰\"></a>å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰</h1><p>nginxé…ç½®æ–‡ä»¶æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ<br>1.å…¨å±€å—<br>ä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventså—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginxæœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ã€‚<br>æ¯”å¦‚ï¼šworker_processes 1; worker_processeså€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šã€‚</p>\n<p>2.eventså—</p>\n<p>eventså—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚<br>æ¯”å¦‚ï¼šworker_connection 1024; æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ã€‚</p>\n<p>3.httpå—<br>nginxæœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œhttpå—ä¹Ÿå¯ä»¥åŒ…æ‹¬httpå…¨å±€å—ã€serverå—ã€‚</p>\n<h1 id=\"ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\"><a href=\"#ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\" class=\"headerlink\" title=\"ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\"></a>ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„</h1><p>å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨D:&#x2F;imagesä¸­ï¼Œç„¶åé€šè¿‡IPåœ°å€&#x2F;upload&#x2F;åŠ å›¾ç‰‡åç§°è¿›è¡Œè®¿é—®ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#user  nobody;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">#error_log  logs/error.log;</span><br><span class=\"line\">#error_log  logs/error.log  notice;</span><br><span class=\"line\">#error_log  logs/error.log  info;</span><br><span class=\"line\"></span><br><span class=\"line\">#pid        logs/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class=\"line\">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class=\"line\">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">    #access_log  logs/access.log  main;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    #tcp_nopush     on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #keepalive_timeout  0;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">        #charset koi8-r;</span><br><span class=\"line\"></span><br><span class=\"line\">        #access_log  logs/host.access.log  main;</span><br><span class=\"line\"></span><br><span class=\"line\">        #è®¿é—®è·¯å¾„æ‹¼æ¥ upload è®¿é—®æœ¬åœ°ç»å¯¹è·¯å¾„ä¸‹çš„æŸå›¾ç‰‡ </span><br><span class=\"line\">        location /upload/ &#123;</span><br><span class=\"line\">        alias D:/images/;</span><br><span class=\"line\">        autoindex on;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">            index  index.html index.htm;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        #error_page  404              /404.html;</span><br><span class=\"line\"></span><br><span class=\"line\">        # redirect server error pages to the static page /50x.html</span><br><span class=\"line\">        #</span><br><span class=\"line\">        error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">        location = /50x.html &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ \\.php$ &#123;</span><br><span class=\"line\">        #    proxy_pass   http://127.0.0.1;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ \\.php$ &#123;</span><br><span class=\"line\">        #    root           html;</span><br><span class=\"line\">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">        #    fastcgi_index  index.php;</span><br><span class=\"line\">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">        #    include        fastcgi_params;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class=\"line\">        # concurs with nginx&#x27;s one</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ /\\.ht &#123;</span><br><span class=\"line\">        #    deny  all;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class=\"line\">    #</span><br><span class=\"line\">    #server &#123;</span><br><span class=\"line\">    #    listen       8000;</span><br><span class=\"line\">    #    listen       somename:8080;</span><br><span class=\"line\">    #    server_name  somename  alias  another.alias;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    location / &#123;</span><br><span class=\"line\">    #        root   html;</span><br><span class=\"line\">    #        index  index.html index.htm;</span><br><span class=\"line\">    #    &#125;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTPS server</span><br><span class=\"line\">    #</span><br><span class=\"line\">    #server &#123;</span><br><span class=\"line\">    #    listen       443 ssl;</span><br><span class=\"line\">    #    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_certificate      cert.pem;</span><br><span class=\"line\">    #    ssl_certificate_key  cert.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">    #    ssl_session_timeout  5m;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">    #    ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    location / &#123;</span><br><span class=\"line\">    #        root   html;</span><br><span class=\"line\">    #        index  index.html index.htm;</span><br><span class=\"line\">    #    &#125;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é…ç½®å¥½nginx.confè®°å¾—é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ã€‚æ•ˆæœå¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/83f770e8dad9c1ca09033b2e9ce6037f.png\" alt=\"image.png\"></p>\n<h1 id=\"å…«ã€javaåå°ä»£ç \"><a href=\"#å…«ã€javaåå°ä»£ç \" class=\"headerlink\" title=\"å…«ã€javaåå°ä»£ç \"></a>å…«ã€javaåå°ä»£ç </h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(value = &quot;/fileUpload&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">fileUpload</span><span class=\"params\">(<span class=\"meta\">@RequestParam(value = &quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (file.isEmpty()) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;è¯·é€‰æ‹©å›¾ç‰‡&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> file.getOriginalFilename();  <span class=\"comment\">// æ–‡ä»¶å</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">suffixName</span> <span class=\"operator\">=</span> fileName.substring(fileName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>));  <span class=\"comment\">// åç¼€å</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">filePath</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;D:/images/&quot;</span>; <span class=\"comment\">// ä¸Šä¼ åçš„è·¯å¾„</span></span><br><span class=\"line\">        fileName = UUID.randomUUID() + suffixName; <span class=\"comment\">// æ–°æ–‡ä»¶å</span></span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">dest</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath + fileName);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dest.getParentFile().exists()) &#123;</span><br><span class=\"line\">            dest.getParentFile().mkdirs();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            file.transferTo(dest);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//è¿”å›å›¾ç‰‡åç§°</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå°†å›¾ç‰‡ä¸Šä¼ è‡³D:&#x2F;imagesæ–‡ä»¶å¤¹ä¸­ï¼Œå› ä¸ºå‰é¢é…ç½®äº†nginxçš„ç¼˜æ•…ï¼Œæˆ‘è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æµ‹è¯•çš„ï¼Œç›´æ¥ä½¿ç”¨localhost&#x2F;upload&#x2F;+è¿”å›çš„å›¾ç‰‡åç§°å°±å¯ä»¥è®¿é—®åˆ°äº†ã€‚</p>\n<p>å¦‚æœæƒ³è¦é€šè¿‡é¡¹ç›®çš„åœ°å€å¤–åŠ ç«¯å£å·è¿›è¡Œè®¿é—®çš„è¯ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªèµ„æºæ˜ å°„è·¯å¾„ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * èµ„æºæ˜ å°„è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyWebMvcConfig</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">WebMvcConfigurer</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addResourceHandlers</span><span class=\"params\">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class=\"line\">        registry.addResourceHandler(<span class=\"string\">&quot;/upload/**&quot;</span>).addResourceLocations(<span class=\"string\">&quot;file:D:/images/&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>like this!<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ef6fa062cb4f717a5d1287f49357592f.png\" alt=\"image.png\"></p>\n<p>é¡¹ç›®ä»£ç å¯åœ¨<a href=\"github\">github</a>è¿›è¡ŒæŸ¥çœ‹</p>\n","excerpt":"","more":"<p>å…¬å¸é¡¹ç›®éœ€è¦ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå°±å›¾ç‰‡èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆå…¬å¸ç”¨çš„windowsæœåŠ¡å™¨ï¼‰ï¼Œç„¶ånginxèƒ½è¿›è¡Œä»£ç†è®¿é—®åˆ°å°±è¡Œäº†ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹nginxï¼Œç„¶åå†æ¥å®ç°åŠŸèƒ½ã€‚</p>\n<h1 id=\"ä¸€ã€nginxç®€ä»‹\"><a href=\"#ä¸€ã€nginxç®€ä»‹\" class=\"headerlink\" title=\"ä¸€ã€nginxç®€ä»‹\"></a>ä¸€ã€nginxç®€ä»‹</h1><blockquote>\n<p>Nginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼Œç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ã€‚<br>Nginxä¸“é—¨ä¸ºæ€§èƒ½ä¼˜åŒ–è€Œå¼€å‘ï¼Œæ€§èƒ½æ˜¯å…¶æœ€é‡è¦çš„è€ƒé‡ï¼Œå®é™…ä¸Šéå¸¸æ³¨é‡æ•ˆç‡ï¼Œèƒ½ç»èµ·é«˜è´Ÿè½½çš„è€ƒéªŒï¼Œæœ‰æŠ¥å‘Šè¡¨æ˜èƒ½æ”¯æŒé«˜è¾¾50000ä¸ªå¹¶å‘è¿æ¥æ•°ã€‚</p>\n</blockquote>\n<h1 id=\"äºŒã€åå‘ä»£ç†\"><a href=\"#äºŒã€åå‘ä»£ç†\" class=\"headerlink\" title=\"äºŒã€åå‘ä»£ç†\"></a>äºŒã€åå‘ä»£ç†</h1><p>1.æ­£å‘ä»£ç†<br>åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œäº’è”ç½‘è®¿é—®ã€‚<br>2.åå‘ä»£ç†<br>æˆ‘ä»¬åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”±åå‘ä»£ç†æœåŠ¡å™¨å»é€‰æ‹©ç›®æ ‡æœåŠ¡å™¨è·å–æ•°æ®åï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶åå‘ä»£ç†æœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡å™¨å¯¹å¤–å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæš´éœ²çš„æ˜¯ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œéšè—äº†çœŸå®æœåŠ¡å™¨IPåœ°å€ã€‚</p>\n<h1 id=\"ä¸‰ã€è´Ÿè½½å‡è¡¡\"><a href=\"#ä¸‰ã€è´Ÿè½½å‡è¡¡\" class=\"headerlink\" title=\"ä¸‰ã€è´Ÿè½½å‡è¡¡\"></a>ä¸‰ã€è´Ÿè½½å‡è¡¡</h1><p>å¢åŠ æœåŠ¡å™¨çš„æ•°é‡ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†åŸå…ˆè¯·æ±‚é›†ä¸­åˆ°å•ä¸ªæœåŠ¡å™¨ä¸Šçš„æƒ…å†µæ”¹ä¸ºåˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è´Ÿè½½å‡è¡¡ã€‚</p>\n<h1 id=\"å››ã€åŠ¨é™åˆ†ç¦»\"><a href=\"#å››ã€åŠ¨é™åˆ†ç¦»\" class=\"headerlink\" title=\"å››ã€åŠ¨é™åˆ†ç¦»\"></a>å››ã€åŠ¨é™åˆ†ç¦»</h1><p>ä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚å‡ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›ã€‚</p>\n<h1 id=\"äº”ã€nginxå¸¸ç”¨å‘½ä»¤\"><a href=\"#äº”ã€nginxå¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"äº”ã€nginxå¸¸ç”¨å‘½ä»¤\"></a>äº”ã€nginxå¸¸ç”¨å‘½ä»¤</h1><p>1.ä½¿ç”¨nginxæ“ä½œå‘½ä»¤å‰ææ¡ä»¶ï¼šå¿…é¡»è¿›è¡Œnginxçš„ç›®å½•</p>\n<p>2.æŸ¥çœ‹nginxçš„ç‰ˆæœ¬å·<br>nginx -v</p>\n<p>3.å¯åŠ¨nginx<br>nginx</p>\n<p>4.å…³é—­nginx<br>nginx -s stop</p>\n<p>5.é‡æ–°åŠ è½½nginx<br>nginx -s reload</p>\n<h1 id=\"å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx-confï¼‰\"><a href=\"#å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx-confï¼‰\" class=\"headerlink\" title=\"å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰\"></a>å…­ã€nginxçš„é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰</h1><p>nginxé…ç½®æ–‡ä»¶æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ<br>1.å…¨å±€å—<br>ä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventså—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦ä¼šè®¾ç½®ä¸€äº›å½±å“nginxæœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤ã€‚<br>æ¯”å¦‚ï¼šworker_processes 1; worker_processeså€¼è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒçš„å¹¶å‘å¤„ç†é‡ä¹Ÿè¶Šå¤šã€‚</p>\n<p>2.eventså—</p>\n<p>eventså—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ã€‚<br>æ¯”å¦‚ï¼šworker_connection 1024; æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ã€‚</p>\n<p>3.httpå—<br>nginxæœåŠ¡å™¨é…ç½®ä¸­æœ€é¢‘ç¹çš„éƒ¨åˆ†ï¼Œhttpå—ä¹Ÿå¯ä»¥åŒ…æ‹¬httpå…¨å±€å—ã€serverå—ã€‚</p>\n<h1 id=\"ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\"><a href=\"#ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\" class=\"headerlink\" title=\"ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„\"></a>ä¸ƒã€nginxé…ç½®å›¾ç‰‡çš„è®¿é—®è·¯å¾„</h1><p>å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨D:&#x2F;imagesä¸­ï¼Œç„¶åé€šè¿‡IPåœ°å€&#x2F;upload&#x2F;åŠ å›¾ç‰‡åç§°è¿›è¡Œè®¿é—®ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#user  nobody;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">#error_log  logs/error.log;</span><br><span class=\"line\">#error_log  logs/error.log  notice;</span><br><span class=\"line\">#error_log  logs/error.log  info;</span><br><span class=\"line\"></span><br><span class=\"line\">#pid        logs/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class=\"line\">    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class=\"line\">    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">    #access_log  logs/access.log  main;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    #tcp_nopush     on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #keepalive_timeout  0;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen       80;</span><br><span class=\"line\">        server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">        #charset koi8-r;</span><br><span class=\"line\"></span><br><span class=\"line\">        #access_log  logs/host.access.log  main;</span><br><span class=\"line\"></span><br><span class=\"line\">        #è®¿é—®è·¯å¾„æ‹¼æ¥ upload è®¿é—®æœ¬åœ°ç»å¯¹è·¯å¾„ä¸‹çš„æŸå›¾ç‰‡ </span><br><span class=\"line\">        location /upload/ &#123;</span><br><span class=\"line\">        alias D:/images/;</span><br><span class=\"line\">        autoindex on;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">            index  index.html index.htm;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        #error_page  404              /404.html;</span><br><span class=\"line\"></span><br><span class=\"line\">        # redirect server error pages to the static page /50x.html</span><br><span class=\"line\">        #</span><br><span class=\"line\">        error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">        location = /50x.html &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ \\.php$ &#123;</span><br><span class=\"line\">        #    proxy_pass   http://127.0.0.1;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ \\.php$ &#123;</span><br><span class=\"line\">        #    root           html;</span><br><span class=\"line\">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class=\"line\">        #    fastcgi_index  index.php;</span><br><span class=\"line\">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class=\"line\">        #    include        fastcgi_params;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        # deny access to .htaccess files, if Apache&#x27;s document root</span><br><span class=\"line\">        # concurs with nginx&#x27;s one</span><br><span class=\"line\">        #</span><br><span class=\"line\">        #location ~ /\\.ht &#123;</span><br><span class=\"line\">        #    deny  all;</span><br><span class=\"line\">        #&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class=\"line\">    #</span><br><span class=\"line\">    #server &#123;</span><br><span class=\"line\">    #    listen       8000;</span><br><span class=\"line\">    #    listen       somename:8080;</span><br><span class=\"line\">    #    server_name  somename  alias  another.alias;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    location / &#123;</span><br><span class=\"line\">    #        root   html;</span><br><span class=\"line\">    #        index  index.html index.htm;</span><br><span class=\"line\">    #    &#125;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    # HTTPS server</span><br><span class=\"line\">    #</span><br><span class=\"line\">    #server &#123;</span><br><span class=\"line\">    #    listen       443 ssl;</span><br><span class=\"line\">    #    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_certificate      cert.pem;</span><br><span class=\"line\">    #    ssl_certificate_key  cert.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">    #    ssl_session_timeout  5m;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">    #    ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #    location / &#123;</span><br><span class=\"line\">    #        root   html;</span><br><span class=\"line\">    #        index  index.html index.htm;</span><br><span class=\"line\">    #    &#125;</span><br><span class=\"line\">    #&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>é…ç½®å¥½nginx.confè®°å¾—é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ã€‚æ•ˆæœå¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/83f770e8dad9c1ca09033b2e9ce6037f.png\" alt=\"image.png\"></p>\n<h1 id=\"å…«ã€javaåå°ä»£ç \"><a href=\"#å…«ã€javaåå°ä»£ç \" class=\"headerlink\" title=\"å…«ã€javaåå°ä»£ç \"></a>å…«ã€javaåå°ä»£ç </h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FileController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(value = &quot;/fileUpload&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">fileUpload</span><span class=\"params\">(<span class=\"meta\">@RequestParam(value = &quot;file&quot;)</span> MultipartFile file)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (file.isEmpty()) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;è¯·é€‰æ‹©å›¾ç‰‡&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> file.getOriginalFilename();  <span class=\"comment\">// æ–‡ä»¶å</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">suffixName</span> <span class=\"operator\">=</span> fileName.substring(fileName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>));  <span class=\"comment\">// åç¼€å</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">filePath</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;D:/images/&quot;</span>; <span class=\"comment\">// ä¸Šä¼ åçš„è·¯å¾„</span></span><br><span class=\"line\">        fileName = UUID.randomUUID() + suffixName; <span class=\"comment\">// æ–°æ–‡ä»¶å</span></span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">dest</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath + fileName);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dest.getParentFile().exists()) &#123;</span><br><span class=\"line\">            dest.getParentFile().mkdirs();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            file.transferTo(dest);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//è¿”å›å›¾ç‰‡åç§°</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå°†å›¾ç‰‡ä¸Šä¼ è‡³D:&#x2F;imagesæ–‡ä»¶å¤¹ä¸­ï¼Œå› ä¸ºå‰é¢é…ç½®äº†nginxçš„ç¼˜æ•…ï¼Œæˆ‘è¿™é‡Œæ˜¯åœ¨æœ¬åœ°æµ‹è¯•çš„ï¼Œç›´æ¥ä½¿ç”¨localhost&#x2F;upload&#x2F;+è¿”å›çš„å›¾ç‰‡åç§°å°±å¯ä»¥è®¿é—®åˆ°äº†ã€‚</p>\n<p>å¦‚æœæƒ³è¦é€šè¿‡é¡¹ç›®çš„åœ°å€å¤–åŠ ç«¯å£å·è¿›è¡Œè®¿é—®çš„è¯ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªèµ„æºæ˜ å°„è·¯å¾„ã€‚</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * èµ„æºæ˜ å°„è·¯å¾„</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyWebMvcConfig</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">WebMvcConfigurer</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addResourceHandlers</span><span class=\"params\">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class=\"line\">        registry.addResourceHandler(<span class=\"string\">&quot;/upload/**&quot;</span>).addResourceLocations(<span class=\"string\">&quot;file:D:/images/&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>like this!<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ef6fa062cb4f717a5d1287f49357592f.png\" alt=\"image.png\"></p>\n<p>é¡¹ç›®ä»£ç å¯åœ¨<a href=\"github\">github</a>è¿›è¡ŒæŸ¥çœ‹</p>\n"},{"title":"SpringBootæ•´åˆMailå‘é€é‚®ä»¶&å‘é€æ¨¡æ¿é‚®ä»¶","date":"2022-06-01T01:38:58.000Z","_content":"\nã€€ã€€æ•´åˆmailå‘é€é‚®ä»¶ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä»£ç æ¥æ“ä½œå‘é€é‚®ä»¶çš„æ­¥éª¤ï¼Œç¼–è¾‘æ”¶ä»¶äººã€é‚®ä»¶å†…å®¹ã€é‚®ä»¶é™„ä»¶ç­‰ç­‰ã€‚é€šè¿‡é‚®ä»¶å¯ä»¥æ‹“å±•å‡ºçŸ­ä¿¡éªŒè¯ç ã€æ¶ˆæ¯é€šçŸ¥ç­‰ä¸šåŠ¡ã€‚\n\n# ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\n\n```xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-mail</artifactId>\n</dependency>\n<!--freemarkeræ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†åé¢å‘é€æ¨¡æ¿é‚®ä»¶ ä¸éœ€è¦çš„å¯ä»¥ä¸å¼•å…¥-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-freemarker</artifactId>\n</dependency>\n```\n# äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®\n\n```xml\nspring:\n  mail:\n    host: smtp.qq.xyz #è¿™é‡Œæ¢æˆè‡ªå·±çš„é‚®ç®±ç±»å‹ ä¾‹å¦‚qqé‚®ç®±å°±å†™smtp.qq.com\n    username: xx@qq.com #QQé‚®ç®±\n    password: xxxxxxxxxxx #é‚®ç®±å¯†ç æˆ–è€…æˆæƒç \n    protocol: smtp #å‘é€é‚®ä»¶åè®®\n    properties.mail.smtp.auth: true\n    properties.mail.smtp.port: 465 #ç«¯å£å·465æˆ–587\n    properties.mail.smtp.starttls.enable: true\n    properties.mail.smtp.starttls.required: true\n    properties.mail.smtp.ssl.enable: true #å¼€å¯SSL\n    default-encoding: utf-8\nfreemarker:\n  cache: false # ç¼“å­˜é…ç½® å¼€å‘é˜¶æ®µåº”è¯¥é…ç½®ä¸ºfalse å› ä¸ºç»å¸¸ä¼šæ”¹\n  suffix: .html # æ¨¡ç‰ˆåç¼€å é»˜è®¤ä¸ºftl\n  charset: UTF-8 # æ–‡ä»¶ç¼–ç \n  template-loader-path: classpath:/templates/  # å­˜æ”¾æ¨¡æ¿çš„æ–‡ä»¶å¤¹ï¼Œä»¥resourceæ–‡ä»¶å¤¹ä¸ºç›¸å¯¹è·¯å¾„\n```\né‚®ç®±å¯†ç æš´éœ²åœ¨é…ç½®æ–‡ä»¶å¾ˆä¸å®‰å…¨ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡å–æˆæƒç çš„å½¢å¼ã€‚ç‚¹å¼€é‚®ç®±ï¼Œç„¶ååœ¨è´¦æˆ·æ é‡Œé¢ç‚¹å‡»ç”Ÿæˆæˆæƒç ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c2d0d1f35a98ed2c68a4fdc2e120dbc6.png)\n\n# ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\n\n```java\n@Component\n@Slf4j\npublic class MailUtils{\n\n    /**\n     * Springå®˜æ–¹æä¾›çš„é›†æˆé‚®ä»¶æœåŠ¡çš„å®ç°ç±»ï¼Œç›®å‰æ˜¯Javaåç«¯å‘é€é‚®ä»¶å’Œé›†æˆé‚®ä»¶æœåŠ¡çš„ä¸»æµå·¥å…·ã€‚\n     */\n    @Resource\n    private JavaMailSender mailSender;\n\n    /**\n     * ä»é…ç½®æ–‡ä»¶ä¸­æ³¨å…¥å‘ä»¶äººçš„å§“å\n     */\n    @Value(\"${spring.mail.username}\")\n    private String fromEmail;\n\n    @Autowired\n    private FreeMarkerConfigurer freeMarkerConfigurer;\n\n    /**\n     * å‘é€æ–‡æœ¬é‚®ä»¶\n     * @param to      æ”¶ä»¶äºº\n     * @param subject æ ‡é¢˜\n     * @param content æ­£æ–‡\n     */\n    public void sendSimpleMail(String to, String subject, String content) {\n        SimpleMailMessage message = new SimpleMailMessage();\n        //å‘ä»¶äºº\n        message.setFrom(fromEmail);\n        message.setTo(to);\n        message.setSubject(subject);\n        message.setText(content);\n        mailSender.send(message);\n    }\n\n    /**\n     * å‘é€htmlé‚®ä»¶\n     */\n    public void sendHtmlMail(String to, String subject, String content) {\n        try {\n            //æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯MimeMessage\n            MimeMessage message = mailSender.createMimeMessage();\n            MimeMessageHelper helper = new MimeMessageHelper(message, true);\n            helper.setFrom(fromEmail);\n            helper.setTo(to);\n            helper.setSubject(subject);\n            //ç¬¬äºŒä¸ªå‚æ•°ï¼šæ ¼å¼æ˜¯å¦ä¸ºhtml\n            helper.setText(content, true);\n            mailSender.send(message);\n        }catch (MessagingException e){\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n    }\n\n    /**\n     * å‘é€æ¨¡æ¿é‚®ä»¶\n     * @param to\n     * @param subject\n     * @param template\n     */\n    public void sendTemplateMail(String to, String subject, String template){\n        try {\n            // è·å¾—æ¨¡æ¿\n            Template template1 = freeMarkerConfigurer.getConfiguration().getTemplate(template);\n            // ä½¿ç”¨Mapä½œä¸ºæ•°æ®æ¨¡å‹ï¼Œå®šä¹‰å±æ€§å’Œå€¼\n            Map<String,Object> model = new HashMap<>();\n            model.put(\"myname\",\"Rayã€‚\");\n            // ä¼ å…¥æ•°æ®æ¨¡å‹åˆ°æ¨¡æ¿ï¼Œæ›¿ä»£æ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œå¹¶å°†æ¨¡æ¿è½¬åŒ–ä¸ºhtmlå­—ç¬¦ä¸²\n            String templateHtml = FreeMarkerTemplateUtils.processTemplateIntoString(template1,model);\n            // è¯¥æ–¹æ³•æœ¬è´¨ä¸Šè¿˜æ˜¯å‘é€htmlé‚®ä»¶ï¼Œè°ƒç”¨ä¹‹å‰å‘é€htmlé‚®ä»¶çš„æ–¹æ³•\n            this.sendHtmlMail(to, subject, templateHtml);\n        } catch (TemplateException e) {\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        } catch (IOException e) {\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n    }\n\n    /**\n     * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶\n     * @param to\n     * @param subject\n     * @param content\n     * @param filePath\n     */\n    public void sendAttachmentsMail(String to, String subject, String content, String filePath) {\n        try {\n            MimeMessage message = mailSender.createMimeMessage();\n            //è¦å¸¦é™„ä»¶ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrue\n            MimeMessageHelper helper = new MimeMessageHelper(message, true);\n            helper.setFrom(fromEmail);\n            helper.setTo(to);\n            helper.setSubject(subject);\n            helper.setText(content, true);\n\n            FileSystemResource file = new FileSystemResource(new File(filePath));\n            String fileName = filePath.substring(filePath.lastIndexOf(File.separator));\n            helper.addAttachment(fileName, file);\n            mailSender.send(message);\n        }catch (MessagingException e){\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n\n    }\n}\n```\nMailUtilså…¶å®å°±æ˜¯è¿›ä¸€æ­¥å°è£…Mailæä¾›çš„JavaMailSenderç±»ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å¯ä»¥åœ¨å·¥å…·ç±»é‡Œé¢æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™é‡Œæä¾›äº†å‘é€æ–‡æœ¬é‚®ä»¶ã€htmlé‚®ä»¶ã€æ¨¡æ¿é‚®ä»¶ã€é™„ä»¶é‚®ä»¶çš„æ–¹æ³•ã€‚\n\n# å››ã€Controllerå±‚çš„å®ç°\n```java\n@Api(tags = \"é‚®ä»¶ç®¡ç†\")\n@RestController\n@RequestMapping(\"/mail\")\npublic class MailController {\n\n    @Autowired\n    private MailUtils mailUtils;\n\n    /**\n     * å‘é€æ³¨å†ŒéªŒè¯ç \n     * @return éªŒè¯ç \n     * @throws Exception\n     */\n    @ApiOperation(\"å‘é€æ³¨å†ŒéªŒè¯ç \")\n    @GetMapping(\"/test\")\n    public String send(){\n        mailUtils.sendSimpleMail(\"ruiyeclub@foxmail.com\",\"æ™®é€šæ–‡æœ¬é‚®ä»¶\",\"æ™®é€šæ–‡æœ¬é‚®ä»¶å†…å®¹\");\n        return \"OK\";\n    }\n\n    /**\n     * å‘é€æ³¨å†ŒéªŒè¯ç \n     * @return éªŒè¯ç \n     * @throws Exception\n     */\n    @ApiOperation(\"å‘é€æ³¨å†ŒéªŒè¯ç \")\n    @PostMapping(\"/sendHtml\")\n    public String sendTemplateMail(){\n        mailUtils.sendHtmlMail(\"ruiyeclub@foxmail.com\",\"ä¸€å°htmlæµ‹è¯•é‚®ä»¶\",\n                \"<div style=\\\"text-align: center;position: absolute;\\\" >\\n\"\n                        +\"<h3>\\\"ä¸€å°htmlæµ‹è¯•é‚®ä»¶\\\"</h3>\\n\"\n                        + \"<div>ä¸€å°htmlæµ‹è¯•é‚®ä»¶</div>\\n\"\n                        + \"</div>\");\n        return \"OK\";\n    }\n\n    @ApiOperation(\"å‘é€htmlæ¨¡æ¿é‚®ä»¶\")\n    @PostMapping(\"/sendTemplate\")\n    public String sendTemplate(){\n        mailUtils.sendTemplateMail(\"ruiyeclub@foxmail.com\", \"åŸºäºæ¨¡æ¿çš„htmlé‚®ä»¶\", \"hello.html\");\n        return \"OK\";\n    }\n\n    @ApiOperation(\"å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶\")\n    @GetMapping(\"sendAttachmentsMail\")\n    public String sendAttachmentsMail(){\n        String filePath = \"D:\\\\projects\\\\springboot\\\\template.png\";\n        mailUtils.sendAttachmentsMail(\"xxxx@xx.com\", \"å¸¦é™„ä»¶çš„é‚®ä»¶\", \"é‚®ä»¶ä¸­æœ‰é™„ä»¶\", filePath);\n        return \"OK\";\n    }\n}\n```\nä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œè¿™é‡Œä½¿ç”¨äº†swagger3ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹[SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£](SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£)ã€‚\n\nå‘é€æ¨¡æ¿é‚®ä»¶è¿™é‡Œï¼Œä¼šè¯»å–resourcesä¸‹é¢çš„templatesæ–‡ä»¶å¤¹ï¼Œæµ‹è¯•ä¸­è¯»å–çš„æ˜¯hello.htmlï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n\n```html\n<!DOCTYPE html>\n<html>\n<head lang=\"en\">\n    <meta charset=\"UTF-8\" />\n    <title>freemarkerç®€å•ç¤ºä¾‹</title>\n</head>\n<body>\n<h1>Hello Freemarker</h1>\n<div>My name is ${myname}</div>\n</body>\n</html>\n```\n\n# äº”ã€æµ‹è¯•ç»“æœ\n\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ce977f2c1c55d0f5c49f0d863f0eda89.png)\nå¦‚æœéœ€è¦è¾¾åˆ°é€šè¿‡é‚®ä»¶å‘é€éªŒè¯ç çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨redisã€‚åå°éšæœºç”ŸæˆéªŒè¯ç ï¼Œç„¶åæŠŠç”¨æˆ·çš„ä¸»é”®è®¾ä¸ºkeyï¼ŒéªŒè¯ç çš„å†…å®¹è®¾ä¸ºvalueï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ª60sè¿‡æœŸå­˜å‚¨ï¼Œå‘é€æˆåŠŸåï¼Œç”¨æˆ·ç™»å½•é€šè¿‡ä¸»é”®ä»redisæ‹¿åˆ°å¯¹åº”çš„éªŒè¯ç ï¼Œç„¶åå†è¿›è¡Œç™»å½•éªŒè¯å°±å¥½äº†ã€‚\n\n> å‚è€ƒé“¾æ¥ï¼š[Spring Bootæ•´åˆé‚®ä»¶é…ç½®](Spring Bootæ•´åˆé‚®ä»¶é…ç½®)\n\nGitHubåœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)","source":"_posts/SpringBootæ•´åˆMailå‘é€é‚®ä»¶-å‘é€æ¨¡æ¿é‚®ä»¶.md","raw":"---\ntitle: SpringBootæ•´åˆMailå‘é€é‚®ä»¶&å‘é€æ¨¡æ¿é‚®ä»¶\ndate: 2022-06-01 09:38:58\ntags:\n---\n\nã€€ã€€æ•´åˆmailå‘é€é‚®ä»¶ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä»£ç æ¥æ“ä½œå‘é€é‚®ä»¶çš„æ­¥éª¤ï¼Œç¼–è¾‘æ”¶ä»¶äººã€é‚®ä»¶å†…å®¹ã€é‚®ä»¶é™„ä»¶ç­‰ç­‰ã€‚é€šè¿‡é‚®ä»¶å¯ä»¥æ‹“å±•å‡ºçŸ­ä¿¡éªŒè¯ç ã€æ¶ˆæ¯é€šçŸ¥ç­‰ä¸šåŠ¡ã€‚\n\n# ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\n\n```xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-mail</artifactId>\n</dependency>\n<!--freemarkeræ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†åé¢å‘é€æ¨¡æ¿é‚®ä»¶ ä¸éœ€è¦çš„å¯ä»¥ä¸å¼•å…¥-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-freemarker</artifactId>\n</dependency>\n```\n# äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®\n\n```xml\nspring:\n  mail:\n    host: smtp.qq.xyz #è¿™é‡Œæ¢æˆè‡ªå·±çš„é‚®ç®±ç±»å‹ ä¾‹å¦‚qqé‚®ç®±å°±å†™smtp.qq.com\n    username: xx@qq.com #QQé‚®ç®±\n    password: xxxxxxxxxxx #é‚®ç®±å¯†ç æˆ–è€…æˆæƒç \n    protocol: smtp #å‘é€é‚®ä»¶åè®®\n    properties.mail.smtp.auth: true\n    properties.mail.smtp.port: 465 #ç«¯å£å·465æˆ–587\n    properties.mail.smtp.starttls.enable: true\n    properties.mail.smtp.starttls.required: true\n    properties.mail.smtp.ssl.enable: true #å¼€å¯SSL\n    default-encoding: utf-8\nfreemarker:\n  cache: false # ç¼“å­˜é…ç½® å¼€å‘é˜¶æ®µåº”è¯¥é…ç½®ä¸ºfalse å› ä¸ºç»å¸¸ä¼šæ”¹\n  suffix: .html # æ¨¡ç‰ˆåç¼€å é»˜è®¤ä¸ºftl\n  charset: UTF-8 # æ–‡ä»¶ç¼–ç \n  template-loader-path: classpath:/templates/  # å­˜æ”¾æ¨¡æ¿çš„æ–‡ä»¶å¤¹ï¼Œä»¥resourceæ–‡ä»¶å¤¹ä¸ºç›¸å¯¹è·¯å¾„\n```\né‚®ç®±å¯†ç æš´éœ²åœ¨é…ç½®æ–‡ä»¶å¾ˆä¸å®‰å…¨ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡å–æˆæƒç çš„å½¢å¼ã€‚ç‚¹å¼€é‚®ç®±ï¼Œç„¶ååœ¨è´¦æˆ·æ é‡Œé¢ç‚¹å‡»ç”Ÿæˆæˆæƒç ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c2d0d1f35a98ed2c68a4fdc2e120dbc6.png)\n\n# ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\n\n```java\n@Component\n@Slf4j\npublic class MailUtils{\n\n    /**\n     * Springå®˜æ–¹æä¾›çš„é›†æˆé‚®ä»¶æœåŠ¡çš„å®ç°ç±»ï¼Œç›®å‰æ˜¯Javaåç«¯å‘é€é‚®ä»¶å’Œé›†æˆé‚®ä»¶æœåŠ¡çš„ä¸»æµå·¥å…·ã€‚\n     */\n    @Resource\n    private JavaMailSender mailSender;\n\n    /**\n     * ä»é…ç½®æ–‡ä»¶ä¸­æ³¨å…¥å‘ä»¶äººçš„å§“å\n     */\n    @Value(\"${spring.mail.username}\")\n    private String fromEmail;\n\n    @Autowired\n    private FreeMarkerConfigurer freeMarkerConfigurer;\n\n    /**\n     * å‘é€æ–‡æœ¬é‚®ä»¶\n     * @param to      æ”¶ä»¶äºº\n     * @param subject æ ‡é¢˜\n     * @param content æ­£æ–‡\n     */\n    public void sendSimpleMail(String to, String subject, String content) {\n        SimpleMailMessage message = new SimpleMailMessage();\n        //å‘ä»¶äºº\n        message.setFrom(fromEmail);\n        message.setTo(to);\n        message.setSubject(subject);\n        message.setText(content);\n        mailSender.send(message);\n    }\n\n    /**\n     * å‘é€htmlé‚®ä»¶\n     */\n    public void sendHtmlMail(String to, String subject, String content) {\n        try {\n            //æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯MimeMessage\n            MimeMessage message = mailSender.createMimeMessage();\n            MimeMessageHelper helper = new MimeMessageHelper(message, true);\n            helper.setFrom(fromEmail);\n            helper.setTo(to);\n            helper.setSubject(subject);\n            //ç¬¬äºŒä¸ªå‚æ•°ï¼šæ ¼å¼æ˜¯å¦ä¸ºhtml\n            helper.setText(content, true);\n            mailSender.send(message);\n        }catch (MessagingException e){\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n    }\n\n    /**\n     * å‘é€æ¨¡æ¿é‚®ä»¶\n     * @param to\n     * @param subject\n     * @param template\n     */\n    public void sendTemplateMail(String to, String subject, String template){\n        try {\n            // è·å¾—æ¨¡æ¿\n            Template template1 = freeMarkerConfigurer.getConfiguration().getTemplate(template);\n            // ä½¿ç”¨Mapä½œä¸ºæ•°æ®æ¨¡å‹ï¼Œå®šä¹‰å±æ€§å’Œå€¼\n            Map<String,Object> model = new HashMap<>();\n            model.put(\"myname\",\"Rayã€‚\");\n            // ä¼ å…¥æ•°æ®æ¨¡å‹åˆ°æ¨¡æ¿ï¼Œæ›¿ä»£æ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œå¹¶å°†æ¨¡æ¿è½¬åŒ–ä¸ºhtmlå­—ç¬¦ä¸²\n            String templateHtml = FreeMarkerTemplateUtils.processTemplateIntoString(template1,model);\n            // è¯¥æ–¹æ³•æœ¬è´¨ä¸Šè¿˜æ˜¯å‘é€htmlé‚®ä»¶ï¼Œè°ƒç”¨ä¹‹å‰å‘é€htmlé‚®ä»¶çš„æ–¹æ³•\n            this.sendHtmlMail(to, subject, templateHtml);\n        } catch (TemplateException e) {\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        } catch (IOException e) {\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n    }\n\n    /**\n     * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶\n     * @param to\n     * @param subject\n     * @param content\n     * @param filePath\n     */\n    public void sendAttachmentsMail(String to, String subject, String content, String filePath) {\n        try {\n            MimeMessage message = mailSender.createMimeMessage();\n            //è¦å¸¦é™„ä»¶ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrue\n            MimeMessageHelper helper = new MimeMessageHelper(message, true);\n            helper.setFrom(fromEmail);\n            helper.setTo(to);\n            helper.setSubject(subject);\n            helper.setText(content, true);\n\n            FileSystemResource file = new FileSystemResource(new File(filePath));\n            String fileName = filePath.substring(filePath.lastIndexOf(File.separator));\n            helper.addAttachment(fileName, file);\n            mailSender.send(message);\n        }catch (MessagingException e){\n            log.error(\"å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼\", e);\n        }\n\n    }\n}\n```\nMailUtilså…¶å®å°±æ˜¯è¿›ä¸€æ­¥å°è£…Mailæä¾›çš„JavaMailSenderç±»ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å¯ä»¥åœ¨å·¥å…·ç±»é‡Œé¢æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™é‡Œæä¾›äº†å‘é€æ–‡æœ¬é‚®ä»¶ã€htmlé‚®ä»¶ã€æ¨¡æ¿é‚®ä»¶ã€é™„ä»¶é‚®ä»¶çš„æ–¹æ³•ã€‚\n\n# å››ã€Controllerå±‚çš„å®ç°\n```java\n@Api(tags = \"é‚®ä»¶ç®¡ç†\")\n@RestController\n@RequestMapping(\"/mail\")\npublic class MailController {\n\n    @Autowired\n    private MailUtils mailUtils;\n\n    /**\n     * å‘é€æ³¨å†ŒéªŒè¯ç \n     * @return éªŒè¯ç \n     * @throws Exception\n     */\n    @ApiOperation(\"å‘é€æ³¨å†ŒéªŒè¯ç \")\n    @GetMapping(\"/test\")\n    public String send(){\n        mailUtils.sendSimpleMail(\"ruiyeclub@foxmail.com\",\"æ™®é€šæ–‡æœ¬é‚®ä»¶\",\"æ™®é€šæ–‡æœ¬é‚®ä»¶å†…å®¹\");\n        return \"OK\";\n    }\n\n    /**\n     * å‘é€æ³¨å†ŒéªŒè¯ç \n     * @return éªŒè¯ç \n     * @throws Exception\n     */\n    @ApiOperation(\"å‘é€æ³¨å†ŒéªŒè¯ç \")\n    @PostMapping(\"/sendHtml\")\n    public String sendTemplateMail(){\n        mailUtils.sendHtmlMail(\"ruiyeclub@foxmail.com\",\"ä¸€å°htmlæµ‹è¯•é‚®ä»¶\",\n                \"<div style=\\\"text-align: center;position: absolute;\\\" >\\n\"\n                        +\"<h3>\\\"ä¸€å°htmlæµ‹è¯•é‚®ä»¶\\\"</h3>\\n\"\n                        + \"<div>ä¸€å°htmlæµ‹è¯•é‚®ä»¶</div>\\n\"\n                        + \"</div>\");\n        return \"OK\";\n    }\n\n    @ApiOperation(\"å‘é€htmlæ¨¡æ¿é‚®ä»¶\")\n    @PostMapping(\"/sendTemplate\")\n    public String sendTemplate(){\n        mailUtils.sendTemplateMail(\"ruiyeclub@foxmail.com\", \"åŸºäºæ¨¡æ¿çš„htmlé‚®ä»¶\", \"hello.html\");\n        return \"OK\";\n    }\n\n    @ApiOperation(\"å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶\")\n    @GetMapping(\"sendAttachmentsMail\")\n    public String sendAttachmentsMail(){\n        String filePath = \"D:\\\\projects\\\\springboot\\\\template.png\";\n        mailUtils.sendAttachmentsMail(\"xxxx@xx.com\", \"å¸¦é™„ä»¶çš„é‚®ä»¶\", \"é‚®ä»¶ä¸­æœ‰é™„ä»¶\", filePath);\n        return \"OK\";\n    }\n}\n```\nä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œè¿™é‡Œä½¿ç”¨äº†swagger3ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹[SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£](SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£)ã€‚\n\nå‘é€æ¨¡æ¿é‚®ä»¶è¿™é‡Œï¼Œä¼šè¯»å–resourcesä¸‹é¢çš„templatesæ–‡ä»¶å¤¹ï¼Œæµ‹è¯•ä¸­è¯»å–çš„æ˜¯hello.htmlï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n\n```html\n<!DOCTYPE html>\n<html>\n<head lang=\"en\">\n    <meta charset=\"UTF-8\" />\n    <title>freemarkerç®€å•ç¤ºä¾‹</title>\n</head>\n<body>\n<h1>Hello Freemarker</h1>\n<div>My name is ${myname}</div>\n</body>\n</html>\n```\n\n# äº”ã€æµ‹è¯•ç»“æœ\n\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ce977f2c1c55d0f5c49f0d863f0eda89.png)\nå¦‚æœéœ€è¦è¾¾åˆ°é€šè¿‡é‚®ä»¶å‘é€éªŒè¯ç çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨redisã€‚åå°éšæœºç”ŸæˆéªŒè¯ç ï¼Œç„¶åæŠŠç”¨æˆ·çš„ä¸»é”®è®¾ä¸ºkeyï¼ŒéªŒè¯ç çš„å†…å®¹è®¾ä¸ºvalueï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ª60sè¿‡æœŸå­˜å‚¨ï¼Œå‘é€æˆåŠŸåï¼Œç”¨æˆ·ç™»å½•é€šè¿‡ä¸»é”®ä»redisæ‹¿åˆ°å¯¹åº”çš„éªŒè¯ç ï¼Œç„¶åå†è¿›è¡Œç™»å½•éªŒè¯å°±å¥½äº†ã€‚\n\n> å‚è€ƒé“¾æ¥ï¼š[Spring Bootæ•´åˆé‚®ä»¶é…ç½®](Spring Bootæ•´åˆé‚®ä»¶é…ç½®)\n\nGitHubåœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)","slug":"SpringBootæ•´åˆMailå‘é€é‚®ä»¶-å‘é€æ¨¡æ¿é‚®ä»¶","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dn000twen185ebhdjm","content":"<p>ã€€ã€€æ•´åˆmailå‘é€é‚®ä»¶ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä»£ç æ¥æ“ä½œå‘é€é‚®ä»¶çš„æ­¥éª¤ï¼Œç¼–è¾‘æ”¶ä»¶äººã€é‚®ä»¶å†…å®¹ã€é‚®ä»¶é™„ä»¶ç­‰ç­‰ã€‚é€šè¿‡é‚®ä»¶å¯ä»¥æ‹“å±•å‡ºçŸ­ä¿¡éªŒè¯ç ã€æ¶ˆæ¯é€šçŸ¥ç­‰ä¸šåŠ¡ã€‚</p>\n<h1 id=\"ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\"><a href=\"#ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\" class=\"headerlink\" title=\"ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\"></a>ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-mail<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--freemarkeræ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†åé¢å‘é€æ¨¡æ¿é‚®ä»¶ ä¸éœ€è¦çš„å¯ä»¥ä¸å¼•å…¥--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"äºŒã€application-ymlæ–‡ä»¶ä¸­é…ç½®\"><a href=\"#äºŒã€application-ymlæ–‡ä»¶ä¸­é…ç½®\" class=\"headerlink\" title=\"äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®\"></a>äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  mail:</span><br><span class=\"line\">    host: smtp.qq.xyz #è¿™é‡Œæ¢æˆè‡ªå·±çš„é‚®ç®±ç±»å‹ ä¾‹å¦‚qqé‚®ç®±å°±å†™smtp.qq.com</span><br><span class=\"line\">    username: xx@qq.com #QQé‚®ç®±</span><br><span class=\"line\">    password: xxxxxxxxxxx #é‚®ç®±å¯†ç æˆ–è€…æˆæƒç </span><br><span class=\"line\">    protocol: smtp #å‘é€é‚®ä»¶åè®®</span><br><span class=\"line\">    properties.mail.smtp.auth: true</span><br><span class=\"line\">    properties.mail.smtp.port: 465 #ç«¯å£å·465æˆ–587</span><br><span class=\"line\">    properties.mail.smtp.starttls.enable: true</span><br><span class=\"line\">    properties.mail.smtp.starttls.required: true</span><br><span class=\"line\">    properties.mail.smtp.ssl.enable: true #å¼€å¯SSL</span><br><span class=\"line\">    default-encoding: utf-8</span><br><span class=\"line\">freemarker:</span><br><span class=\"line\">  cache: false # ç¼“å­˜é…ç½® å¼€å‘é˜¶æ®µåº”è¯¥é…ç½®ä¸ºfalse å› ä¸ºç»å¸¸ä¼šæ”¹</span><br><span class=\"line\">  suffix: .html # æ¨¡ç‰ˆåç¼€å é»˜è®¤ä¸ºftl</span><br><span class=\"line\">  charset: UTF-8 # æ–‡ä»¶ç¼–ç </span><br><span class=\"line\">  template-loader-path: classpath:/templates/  # å­˜æ”¾æ¨¡æ¿çš„æ–‡ä»¶å¤¹ï¼Œä»¥resourceæ–‡ä»¶å¤¹ä¸ºç›¸å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure>\n<p>é‚®ç®±å¯†ç æš´éœ²åœ¨é…ç½®æ–‡ä»¶å¾ˆä¸å®‰å…¨ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡å–æˆæƒç çš„å½¢å¼ã€‚ç‚¹å¼€é‚®ç®±ï¼Œç„¶ååœ¨è´¦æˆ·æ é‡Œé¢ç‚¹å‡»ç”Ÿæˆæˆæƒç ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c2d0d1f35a98ed2c68a4fdc2e120dbc6.png\" alt=\"image.png\"></p>\n<h1 id=\"ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\"><a href=\"#ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\" class=\"headerlink\" title=\"ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\"></a>ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MailUtils</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Springå®˜æ–¹æä¾›çš„é›†æˆé‚®ä»¶æœåŠ¡çš„å®ç°ç±»ï¼Œç›®å‰æ˜¯Javaåç«¯å‘é€é‚®ä»¶å’Œé›†æˆé‚®ä»¶æœåŠ¡çš„ä¸»æµå·¥å…·ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Resource</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JavaMailSender mailSender;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä»é…ç½®æ–‡ä»¶ä¸­æ³¨å…¥å‘ä»¶äººçš„å§“å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;spring.mail.username&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fromEmail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> FreeMarkerConfigurer freeMarkerConfigurer;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ–‡æœ¬é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to      æ”¶ä»¶äºº</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject æ ‡é¢˜</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> content æ­£æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendSimpleMail</span><span class=\"params\">(String to, String subject, String content)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SimpleMailMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleMailMessage</span>();</span><br><span class=\"line\">        <span class=\"comment\">//å‘ä»¶äºº</span></span><br><span class=\"line\">        message.setFrom(fromEmail);</span><br><span class=\"line\">        message.setTo(to);</span><br><span class=\"line\">        message.setSubject(subject);</span><br><span class=\"line\">        message.setText(content);</span><br><span class=\"line\">        mailSender.send(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€htmlé‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendHtmlMail</span><span class=\"params\">(String to, String subject, String content)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯MimeMessage</span></span><br><span class=\"line\">            <span class=\"type\">MimeMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> mailSender.createMimeMessage();</span><br><span class=\"line\">            <span class=\"type\">MimeMessageHelper</span> <span class=\"variable\">helper</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MimeMessageHelper</span>(message, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            helper.setFrom(fromEmail);</span><br><span class=\"line\">            helper.setTo(to);</span><br><span class=\"line\">            helper.setSubject(subject);</span><br><span class=\"line\">            <span class=\"comment\">//ç¬¬äºŒä¸ªå‚æ•°ï¼šæ ¼å¼æ˜¯å¦ä¸ºhtml</span></span><br><span class=\"line\">            helper.setText(content, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            mailSender.send(message);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (MessagingException e)&#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ¨¡æ¿é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> template</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendTemplateMail</span><span class=\"params\">(String to, String subject, String template)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// è·å¾—æ¨¡æ¿</span></span><br><span class=\"line\">            <span class=\"type\">Template</span> <span class=\"variable\">template1</span> <span class=\"operator\">=</span> freeMarkerConfigurer.getConfiguration().getTemplate(template);</span><br><span class=\"line\">            <span class=\"comment\">// ä½¿ç”¨Mapä½œä¸ºæ•°æ®æ¨¡å‹ï¼Œå®šä¹‰å±æ€§å’Œå€¼</span></span><br><span class=\"line\">            Map&lt;String,Object&gt; model = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">            model.put(<span class=\"string\">&quot;myname&quot;</span>,<span class=\"string\">&quot;Rayã€‚&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// ä¼ å…¥æ•°æ®æ¨¡å‹åˆ°æ¨¡æ¿ï¼Œæ›¿ä»£æ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œå¹¶å°†æ¨¡æ¿è½¬åŒ–ä¸ºhtmlå­—ç¬¦ä¸²</span></span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">templateHtml</span> <span class=\"operator\">=</span> FreeMarkerTemplateUtils.processTemplateIntoString(template1,model);</span><br><span class=\"line\">            <span class=\"comment\">// è¯¥æ–¹æ³•æœ¬è´¨ä¸Šè¿˜æ˜¯å‘é€htmlé‚®ä»¶ï¼Œè°ƒç”¨ä¹‹å‰å‘é€htmlé‚®ä»¶çš„æ–¹æ³•</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.sendHtmlMail(to, subject, templateHtml);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (TemplateException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> content</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> filePath</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendAttachmentsMail</span><span class=\"params\">(String to, String subject, String content, String filePath)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MimeMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> mailSender.createMimeMessage();</span><br><span class=\"line\">            <span class=\"comment\">//è¦å¸¦é™„ä»¶ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrue</span></span><br><span class=\"line\">            <span class=\"type\">MimeMessageHelper</span> <span class=\"variable\">helper</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MimeMessageHelper</span>(message, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            helper.setFrom(fromEmail);</span><br><span class=\"line\">            helper.setTo(to);</span><br><span class=\"line\">            helper.setSubject(subject);</span><br><span class=\"line\">            helper.setText(content, <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"type\">FileSystemResource</span> <span class=\"variable\">file</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileSystemResource</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath));</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> filePath.substring(filePath.lastIndexOf(File.separator));</span><br><span class=\"line\">            helper.addAttachment(fileName, file);</span><br><span class=\"line\">            mailSender.send(message);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (MessagingException e)&#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>MailUtilså…¶å®å°±æ˜¯è¿›ä¸€æ­¥å°è£…Mailæä¾›çš„JavaMailSenderç±»ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å¯ä»¥åœ¨å·¥å…·ç±»é‡Œé¢æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™é‡Œæä¾›äº†å‘é€æ–‡æœ¬é‚®ä»¶ã€htmlé‚®ä»¶ã€æ¨¡æ¿é‚®ä»¶ã€é™„ä»¶é‚®ä»¶çš„æ–¹æ³•ã€‚</p>\n<h1 id=\"å››ã€Controllerå±‚çš„å®ç°\"><a href=\"#å››ã€Controllerå±‚çš„å®ç°\" class=\"headerlink\" title=\"å››ã€Controllerå±‚çš„å®ç°\"></a>å››ã€Controllerå±‚çš„å®ç°</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(tags = &quot;é‚®ä»¶ç®¡ç†&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/mail&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MailController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> MailUtils mailUtils;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ³¨å†ŒéªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> éªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€æ³¨å†ŒéªŒè¯ç &quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/test&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">send</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendSimpleMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>,<span class=\"string\">&quot;æ™®é€šæ–‡æœ¬é‚®ä»¶&quot;</span>,<span class=\"string\">&quot;æ™®é€šæ–‡æœ¬é‚®ä»¶å†…å®¹&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ³¨å†ŒéªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> éªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€æ³¨å†ŒéªŒè¯ç &quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/sendHtml&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendTemplateMail</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendHtmlMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>,<span class=\"string\">&quot;ä¸€å°htmlæµ‹è¯•é‚®ä»¶&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;&lt;div style=\\&quot;text-align: center;position: absolute;\\&quot; &gt;\\n&quot;</span></span><br><span class=\"line\">                        +<span class=\"string\">&quot;&lt;h3&gt;\\&quot;ä¸€å°htmlæµ‹è¯•é‚®ä»¶\\&quot;&lt;/h3&gt;\\n&quot;</span></span><br><span class=\"line\">                        + <span class=\"string\">&quot;&lt;div&gt;ä¸€å°htmlæµ‹è¯•é‚®ä»¶&lt;/div&gt;\\n&quot;</span></span><br><span class=\"line\">                        + <span class=\"string\">&quot;&lt;/div&gt;&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€htmlæ¨¡æ¿é‚®ä»¶&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/sendTemplate&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendTemplate</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendTemplateMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>, <span class=\"string\">&quot;åŸºäºæ¨¡æ¿çš„htmlé‚®ä»¶&quot;</span>, <span class=\"string\">&quot;hello.html&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;sendAttachmentsMail&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendAttachmentsMail</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">filePath</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;D:\\\\projects\\\\springboot\\\\template.png&quot;</span>;</span><br><span class=\"line\">        mailUtils.sendAttachmentsMail(<span class=\"string\">&quot;xxxx@xx.com&quot;</span>, <span class=\"string\">&quot;å¸¦é™„ä»¶çš„é‚®ä»¶&quot;</span>, <span class=\"string\">&quot;é‚®ä»¶ä¸­æœ‰é™„ä»¶&quot;</span>, filePath);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œè¿™é‡Œä½¿ç”¨äº†swagger3ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹<a href=\"SpringBoot%E6%95%B4%E5%90%88Swagger3%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3\">SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£</a>ã€‚</p>\n<p>å‘é€æ¨¡æ¿é‚®ä»¶è¿™é‡Œï¼Œä¼šè¯»å–resourcesä¸‹é¢çš„templatesæ–‡ä»¶å¤¹ï¼Œæµ‹è¯•ä¸­è¯»å–çš„æ˜¯hello.htmlï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>freemarkerç®€å•ç¤ºä¾‹<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Hello Freemarker<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>My name is $&#123;myname&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äº”ã€æµ‹è¯•ç»“æœ\"><a href=\"#äº”ã€æµ‹è¯•ç»“æœ\" class=\"headerlink\" title=\"äº”ã€æµ‹è¯•ç»“æœ\"></a>äº”ã€æµ‹è¯•ç»“æœ</h1><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ce977f2c1c55d0f5c49f0d863f0eda89.png\" alt=\"image.png\"><br>å¦‚æœéœ€è¦è¾¾åˆ°é€šè¿‡é‚®ä»¶å‘é€éªŒè¯ç çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨redisã€‚åå°éšæœºç”ŸæˆéªŒè¯ç ï¼Œç„¶åæŠŠç”¨æˆ·çš„ä¸»é”®è®¾ä¸ºkeyï¼ŒéªŒè¯ç çš„å†…å®¹è®¾ä¸ºvalueï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ª60sè¿‡æœŸå­˜å‚¨ï¼Œå‘é€æˆåŠŸåï¼Œç”¨æˆ·ç™»å½•é€šè¿‡ä¸»é”®ä»redisæ‹¿åˆ°å¯¹åº”çš„éªŒè¯ç ï¼Œç„¶åå†è¿›è¡Œç™»å½•éªŒè¯å°±å¥½äº†ã€‚</p>\n<blockquote>\n<p>å‚è€ƒé“¾æ¥ï¼š[Spring Bootæ•´åˆé‚®ä»¶é…ç½®](Spring Bootæ•´åˆé‚®ä»¶é…ç½®)</p>\n</blockquote>\n<p>GitHubåœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n","excerpt":"","more":"<p>ã€€ã€€æ•´åˆmailå‘é€é‚®ä»¶ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä»£ç æ¥æ“ä½œå‘é€é‚®ä»¶çš„æ­¥éª¤ï¼Œç¼–è¾‘æ”¶ä»¶äººã€é‚®ä»¶å†…å®¹ã€é‚®ä»¶é™„ä»¶ç­‰ç­‰ã€‚é€šè¿‡é‚®ä»¶å¯ä»¥æ‹“å±•å‡ºçŸ­ä¿¡éªŒè¯ç ã€æ¶ˆæ¯é€šçŸ¥ç­‰ä¸šåŠ¡ã€‚</p>\n<h1 id=\"ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\"><a href=\"#ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\" class=\"headerlink\" title=\"ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–\"></a>ä¸€ã€pomæ–‡ä»¶å¼•å…¥ä¾èµ–</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-mail<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--freemarkeræ¨¡æ¿å¼•æ“æ˜¯ä¸ºäº†åé¢å‘é€æ¨¡æ¿é‚®ä»¶ ä¸éœ€è¦çš„å¯ä»¥ä¸å¼•å…¥--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"äºŒã€application-ymlæ–‡ä»¶ä¸­é…ç½®\"><a href=\"#äºŒã€application-ymlæ–‡ä»¶ä¸­é…ç½®\" class=\"headerlink\" title=\"äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®\"></a>äºŒã€application.ymlæ–‡ä»¶ä¸­é…ç½®</h1><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">  mail:</span><br><span class=\"line\">    host: smtp.qq.xyz #è¿™é‡Œæ¢æˆè‡ªå·±çš„é‚®ç®±ç±»å‹ ä¾‹å¦‚qqé‚®ç®±å°±å†™smtp.qq.com</span><br><span class=\"line\">    username: xx@qq.com #QQé‚®ç®±</span><br><span class=\"line\">    password: xxxxxxxxxxx #é‚®ç®±å¯†ç æˆ–è€…æˆæƒç </span><br><span class=\"line\">    protocol: smtp #å‘é€é‚®ä»¶åè®®</span><br><span class=\"line\">    properties.mail.smtp.auth: true</span><br><span class=\"line\">    properties.mail.smtp.port: 465 #ç«¯å£å·465æˆ–587</span><br><span class=\"line\">    properties.mail.smtp.starttls.enable: true</span><br><span class=\"line\">    properties.mail.smtp.starttls.required: true</span><br><span class=\"line\">    properties.mail.smtp.ssl.enable: true #å¼€å¯SSL</span><br><span class=\"line\">    default-encoding: utf-8</span><br><span class=\"line\">freemarker:</span><br><span class=\"line\">  cache: false # ç¼“å­˜é…ç½® å¼€å‘é˜¶æ®µåº”è¯¥é…ç½®ä¸ºfalse å› ä¸ºç»å¸¸ä¼šæ”¹</span><br><span class=\"line\">  suffix: .html # æ¨¡ç‰ˆåç¼€å é»˜è®¤ä¸ºftl</span><br><span class=\"line\">  charset: UTF-8 # æ–‡ä»¶ç¼–ç </span><br><span class=\"line\">  template-loader-path: classpath:/templates/  # å­˜æ”¾æ¨¡æ¿çš„æ–‡ä»¶å¤¹ï¼Œä»¥resourceæ–‡ä»¶å¤¹ä¸ºç›¸å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure>\n<p>é‚®ç®±å¯†ç æš´éœ²åœ¨é…ç½®æ–‡ä»¶å¾ˆä¸å®‰å…¨ï¼Œä¸€èˆ¬éƒ½æ˜¯é‡‡å–æˆæƒç çš„å½¢å¼ã€‚ç‚¹å¼€é‚®ç®±ï¼Œç„¶ååœ¨è´¦æˆ·æ é‡Œé¢ç‚¹å‡»ç”Ÿæˆæˆæƒç ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/c2d0d1f35a98ed2c68a4fdc2e120dbc6.png\" alt=\"image.png\"></p>\n<h1 id=\"ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\"><a href=\"#ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\" class=\"headerlink\" title=\"ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»\"></a>ä¸‰ã€ç¼–å†™MailUtilså·¥å…·ç±»</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MailUtils</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Springå®˜æ–¹æä¾›çš„é›†æˆé‚®ä»¶æœåŠ¡çš„å®ç°ç±»ï¼Œç›®å‰æ˜¯Javaåç«¯å‘é€é‚®ä»¶å’Œé›†æˆé‚®ä»¶æœåŠ¡çš„ä¸»æµå·¥å…·ã€‚</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Resource</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JavaMailSender mailSender;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä»é…ç½®æ–‡ä»¶ä¸­æ³¨å…¥å‘ä»¶äººçš„å§“å</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Value(&quot;$&#123;spring.mail.username&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String fromEmail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> FreeMarkerConfigurer freeMarkerConfigurer;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ–‡æœ¬é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to      æ”¶ä»¶äºº</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject æ ‡é¢˜</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> content æ­£æ–‡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendSimpleMail</span><span class=\"params\">(String to, String subject, String content)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SimpleMailMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleMailMessage</span>();</span><br><span class=\"line\">        <span class=\"comment\">//å‘ä»¶äºº</span></span><br><span class=\"line\">        message.setFrom(fromEmail);</span><br><span class=\"line\">        message.setTo(to);</span><br><span class=\"line\">        message.setSubject(subject);</span><br><span class=\"line\">        message.setText(content);</span><br><span class=\"line\">        mailSender.send(message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€htmlé‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendHtmlMail</span><span class=\"params\">(String to, String subject, String content)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯MimeMessage</span></span><br><span class=\"line\">            <span class=\"type\">MimeMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> mailSender.createMimeMessage();</span><br><span class=\"line\">            <span class=\"type\">MimeMessageHelper</span> <span class=\"variable\">helper</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MimeMessageHelper</span>(message, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            helper.setFrom(fromEmail);</span><br><span class=\"line\">            helper.setTo(to);</span><br><span class=\"line\">            helper.setSubject(subject);</span><br><span class=\"line\">            <span class=\"comment\">//ç¬¬äºŒä¸ªå‚æ•°ï¼šæ ¼å¼æ˜¯å¦ä¸ºhtml</span></span><br><span class=\"line\">            helper.setText(content, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            mailSender.send(message);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (MessagingException e)&#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ¨¡æ¿é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> template</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendTemplateMail</span><span class=\"params\">(String to, String subject, String template)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// è·å¾—æ¨¡æ¿</span></span><br><span class=\"line\">            <span class=\"type\">Template</span> <span class=\"variable\">template1</span> <span class=\"operator\">=</span> freeMarkerConfigurer.getConfiguration().getTemplate(template);</span><br><span class=\"line\">            <span class=\"comment\">// ä½¿ç”¨Mapä½œä¸ºæ•°æ®æ¨¡å‹ï¼Œå®šä¹‰å±æ€§å’Œå€¼</span></span><br><span class=\"line\">            Map&lt;String,Object&gt; model = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">            model.put(<span class=\"string\">&quot;myname&quot;</span>,<span class=\"string\">&quot;Rayã€‚&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// ä¼ å…¥æ•°æ®æ¨¡å‹åˆ°æ¨¡æ¿ï¼Œæ›¿ä»£æ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œå¹¶å°†æ¨¡æ¿è½¬åŒ–ä¸ºhtmlå­—ç¬¦ä¸²</span></span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">templateHtml</span> <span class=\"operator\">=</span> FreeMarkerTemplateUtils.processTemplateIntoString(template1,model);</span><br><span class=\"line\">            <span class=\"comment\">// è¯¥æ–¹æ³•æœ¬è´¨ä¸Šè¿˜æ˜¯å‘é€htmlé‚®ä»¶ï¼Œè°ƒç”¨ä¹‹å‰å‘é€htmlé‚®ä»¶çš„æ–¹æ³•</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.sendHtmlMail(to, subject, templateHtml);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (TemplateException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> to</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> content</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> filePath</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendAttachmentsMail</span><span class=\"params\">(String to, String subject, String content, String filePath)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">MimeMessage</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> mailSender.createMimeMessage();</span><br><span class=\"line\">            <span class=\"comment\">//è¦å¸¦é™„ä»¶ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrue</span></span><br><span class=\"line\">            <span class=\"type\">MimeMessageHelper</span> <span class=\"variable\">helper</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MimeMessageHelper</span>(message, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            helper.setFrom(fromEmail);</span><br><span class=\"line\">            helper.setTo(to);</span><br><span class=\"line\">            helper.setSubject(subject);</span><br><span class=\"line\">            helper.setText(content, <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"type\">FileSystemResource</span> <span class=\"variable\">file</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileSystemResource</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath));</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> filePath.substring(filePath.lastIndexOf(File.separator));</span><br><span class=\"line\">            helper.addAttachment(fileName, file);</span><br><span class=\"line\">            mailSender.send(message);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (MessagingException e)&#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;å‘é€é‚®ä»¶æ—¶å‘ç”Ÿå¼‚å¸¸ï¼&quot;</span>, e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>MailUtilså…¶å®å°±æ˜¯è¿›ä¸€æ­¥å°è£…Mailæä¾›çš„JavaMailSenderç±»ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯å¯ä»¥åœ¨å·¥å…·ç±»é‡Œé¢æ·»åŠ å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™é‡Œæä¾›äº†å‘é€æ–‡æœ¬é‚®ä»¶ã€htmlé‚®ä»¶ã€æ¨¡æ¿é‚®ä»¶ã€é™„ä»¶é‚®ä»¶çš„æ–¹æ³•ã€‚</p>\n<h1 id=\"å››ã€Controllerå±‚çš„å®ç°\"><a href=\"#å››ã€Controllerå±‚çš„å®ç°\" class=\"headerlink\" title=\"å››ã€Controllerå±‚çš„å®ç°\"></a>å››ã€Controllerå±‚çš„å®ç°</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(tags = &quot;é‚®ä»¶ç®¡ç†&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/mail&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MailController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> MailUtils mailUtils;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ³¨å†ŒéªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> éªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€æ³¨å†ŒéªŒè¯ç &quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/test&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">send</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendSimpleMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>,<span class=\"string\">&quot;æ™®é€šæ–‡æœ¬é‚®ä»¶&quot;</span>,<span class=\"string\">&quot;æ™®é€šæ–‡æœ¬é‚®ä»¶å†…å®¹&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å‘é€æ³¨å†ŒéªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> éªŒè¯ç </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€æ³¨å†ŒéªŒè¯ç &quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/sendHtml&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendTemplateMail</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendHtmlMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>,<span class=\"string\">&quot;ä¸€å°htmlæµ‹è¯•é‚®ä»¶&quot;</span>,</span><br><span class=\"line\">                <span class=\"string\">&quot;&lt;div style=\\&quot;text-align: center;position: absolute;\\&quot; &gt;\\n&quot;</span></span><br><span class=\"line\">                        +<span class=\"string\">&quot;&lt;h3&gt;\\&quot;ä¸€å°htmlæµ‹è¯•é‚®ä»¶\\&quot;&lt;/h3&gt;\\n&quot;</span></span><br><span class=\"line\">                        + <span class=\"string\">&quot;&lt;div&gt;ä¸€å°htmlæµ‹è¯•é‚®ä»¶&lt;/div&gt;\\n&quot;</span></span><br><span class=\"line\">                        + <span class=\"string\">&quot;&lt;/div&gt;&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€htmlæ¨¡æ¿é‚®ä»¶&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;/sendTemplate&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendTemplate</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        mailUtils.sendTemplateMail(<span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>, <span class=\"string\">&quot;åŸºäºæ¨¡æ¿çš„htmlé‚®ä»¶&quot;</span>, <span class=\"string\">&quot;hello.html&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;sendAttachmentsMail&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">sendAttachmentsMail</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">filePath</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;D:\\\\projects\\\\springboot\\\\template.png&quot;</span>;</span><br><span class=\"line\">        mailUtils.sendAttachmentsMail(<span class=\"string\">&quot;xxxx@xx.com&quot;</span>, <span class=\"string\">&quot;å¸¦é™„ä»¶çš„é‚®ä»¶&quot;</span>, <span class=\"string\">&quot;é‚®ä»¶ä¸­æœ‰é™„ä»¶&quot;</span>, filePath);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;OK&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œè¿™é‡Œä½¿ç”¨äº†swagger3ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹<a href=\"SpringBoot%E6%95%B4%E5%90%88Swagger3%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3\">SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£</a>ã€‚</p>\n<p>å‘é€æ¨¡æ¿é‚®ä»¶è¿™é‡Œï¼Œä¼šè¯»å–resourcesä¸‹é¢çš„templatesæ–‡ä»¶å¤¹ï¼Œæµ‹è¯•ä¸­è¯»å–çš„æ˜¯hello.htmlï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>freemarkerç®€å•ç¤ºä¾‹<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Hello Freemarker<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span>My name is $&#123;myname&#125;<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äº”ã€æµ‹è¯•ç»“æœ\"><a href=\"#äº”ã€æµ‹è¯•ç»“æœ\" class=\"headerlink\" title=\"äº”ã€æµ‹è¯•ç»“æœ\"></a>äº”ã€æµ‹è¯•ç»“æœ</h1><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/ce977f2c1c55d0f5c49f0d863f0eda89.png\" alt=\"image.png\"><br>å¦‚æœéœ€è¦è¾¾åˆ°é€šè¿‡é‚®ä»¶å‘é€éªŒè¯ç çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨redisã€‚åå°éšæœºç”ŸæˆéªŒè¯ç ï¼Œç„¶åæŠŠç”¨æˆ·çš„ä¸»é”®è®¾ä¸ºkeyï¼ŒéªŒè¯ç çš„å†…å®¹è®¾ä¸ºvalueï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ª60sè¿‡æœŸå­˜å‚¨ï¼Œå‘é€æˆåŠŸåï¼Œç”¨æˆ·ç™»å½•é€šè¿‡ä¸»é”®ä»redisæ‹¿åˆ°å¯¹åº”çš„éªŒè¯ç ï¼Œç„¶åå†è¿›è¡Œç™»å½•éªŒè¯å°±å¥½äº†ã€‚</p>\n<blockquote>\n<p>å‚è€ƒé“¾æ¥ï¼š[Spring Bootæ•´åˆé‚®ä»¶é…ç½®](Spring Bootæ•´åˆé‚®ä»¶é…ç½®)</p>\n</blockquote>\n<p>GitHubåœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n"},{"title":"SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½","date":"2022-02-11T09:28:11.000Z","_content":"\n## ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\n\nApache Shiroæ˜¯ä¸€ä¸ªJavaå®‰å…¨æƒé™æ¡†æ¡†æ¶ã€‚\n\nShiroå¯ä»¥éå¸¸å®¹æ˜“çš„å¼€å‘å‡ºè¶³å¤Ÿå¥½çš„åº”ç”¨ï¼Œå…¶ä¸ä»…å¯ä»¥åœ¨javaEEç¯å¢ƒã€‚\n\nShiroå¯ä»¥å®Œæˆï¼Œè®¤è¯ï¼Œæˆæƒï¼ŒåŠ å¯†ï¼Œä¼šè¯ç®¡ç†ï¼ŒWebé›†æˆï¼Œç¼“å­˜ç­‰ã€‚\n\n## äºŒã€Shiroå·¥ä½œåŸç†\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb29de36230aeb29dcc9257948081472.png)\nåº”ç”¨ä»£ç çš„äº¤äº’å¯¹è±¡æ˜¯ â€œSubjectâ€ï¼Œè¯¥å¯¹è±¡ä»£è¡¨äº†**å½“å‰ â€œç”¨æˆ·â€**ï¼Œè€Œæ‰€æœ‰ç”¨æˆ·çš„å®‰å…¨æ“ä½œéƒ½ä¼šäº¤ç»™ SecurityManager æ¥ç®¡ç†ï¼Œè€Œç®¡ç†è¿‡ç¨‹ä¸­ä¼šä» Realm ä¸­è·å–ç”¨æˆ·å¯¹åº”çš„è§’è‰²å’Œæƒé™ï¼Œå¯ä»¥æŠŠ Realm å ªç§°æ˜¯å®‰å…¨æ•°æ®æºã€‚\n \nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æœ€ç®€å•çš„ Shiro åº”ç”¨ï¼š\n- é€šè¿‡ Subject æ¥è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œè€Œ Subject åˆå§”æ‰˜ç»™äº† SecurityManager è¿›è¡Œç®¡ç†\n- æˆ‘ä»¬éœ€è¦ç»™ SecurityManager æ³¨å…¥ Realm ä»¥ä¾¿å…¶è·å–ç”¨æˆ·å’Œæƒé™è¿›è¡Œåˆ¤æ–­\n- ä¹Ÿå³ï¼ŒShiro ä¸æä¾›ç”¨æˆ·å’Œæƒé™çš„ç»´æŠ¤ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œé€šè¿‡ Realm æ³¨å…¥\n\n## ä¸‰ã€SpringBootæ•´åˆShiro\n\n1.xmlå¯¼å…¥jaråŒ…\n```xml\n        <dependency>\n            <groupId>org.apache.shiro</groupId>\n            <artifactId>shiro-spring</artifactId>\n            <version>1.4.1</version>\n        </dependency>\n```\n2.configç›®å½•ä¸‹åˆ›å»ºShiroConfig.javaï¼Œæ‹¦æˆªä»¥åŠæˆæƒç­‰åŠŸèƒ½éƒ½åœ¨è¿™é‡Œé…ç½®\n```java\n@Configuration\npublic class ShiroConfig {\n    //1.åˆ›å»ºrealmå¯¹è±¡ éœ€è¦è‡ªå®šä¹‰\n    @Bean\n    public UserRealm userRealm(){\n        return new UserRealm();\n    }\n\n    //2.DefaultWebSecurityManager\n    @Bean(name = \"securityManager\")\n    public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(\"userRealm\") UserRealm userRealm){\n        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();\n        //å…³è”UserRealm\n        securityManager.setRealm(userRealm);\n        return securityManager;\n    }\n\n    //3.ShiroFilterFactoryBean\n    @Bean\n    public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(\"securityManager\")DefaultWebSecurityManager defaultWebSecurityManager){\n        ShiroFilterFactoryBean bean = new ShiroFilterFactoryBean();\n        //è®¾ç½®å®‰å…¨ç®¡ç†å™¨\n        bean.setSecurityManager(defaultWebSecurityManager);\n\n        //æ·»åŠ shiroçš„å†…ç½®è¿‡æ»¤å™¨\n        /**\n         * anonï¼šæ— éœ€è®¤è¯å°±å¯ä»¥è®¿é—®\n         * authcï¼šå¿…é¡»è®¤è¯äº†æ‰èƒ½è®¿é—®\n         * userï¼šå¿…é¡»æ‹¥æœ‰ è®°ä½æˆ‘ åŠŸèƒ½æ‰èƒ½ç”¨\n         * permsï¼šæ‹¥æœ‰å¯¹æŸä¸ªèµ„æºçš„æƒé™æ‰èƒ½è®¿é—®\n         * roleï¼šæ‹¥æœ‰æŸä¸ªè§’è‰²æƒé™æ‰èƒ½è®¿é—®\n         */\n        Map<String, String> filterMap = new LinkedHashMap<>();\n        //æˆæƒ\n        filterMap.put(\"/user/add\",\"perms[user:add]\"); //è¿›å…¥éœ€è¦æˆæƒï¼ˆæˆæƒè§„åˆ™ç”¨æˆ·åé¢æ¥ï¼šaddï¼‰æ‰å¯ä»¥è¿›å…¥add\n        filterMap.put(\"/user/update\",\"perms[user:update]\");\n\n        //æ‹¦æˆªåŠŸèƒ½\n        filterMap.put(\"/user/*\",\"authc\"); //è¡¨ç¤ºè®¿é—®useræ¥å£çš„èµ„æºéƒ½è¦è®¤è¯\n        bean.setFilterChainDefinitionMap(filterMap);\n\n        //******å¤„ç†æƒé™ä¸å¤Ÿæˆ–è€…éœ€è¦æˆæƒçš„ä¸šåŠ¡********\n        //å¦‚æœæ²¡æœ‰æƒé™authc è®¾ç½®ç™»å½•çš„è¯·æ±‚\n        bean.setLoginUrl(\"/toLogin\");\n        //æœªæˆæƒé¡µé¢\n        bean.setUnauthorizedUrl(\"/noauth\");\n        return bean;\n    }\n}\n```\n3.è‡ªå®šä¹‰UserRealmç±»ï¼Œç»§æ‰¿AuthorizingRealmé‡å†™ç”¨æˆ·æˆæƒå’Œç”¨æˆ·è®¤è¯çš„æ–¹æ³•\n```java\npublic class UserRealm extends AuthorizingRealm {//ç”¨æˆ·æˆæƒ\n    @Override\n    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) {\n\n        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();\n//        info.addStringPermission(\"user:add\"); æ‰‹åŠ¨æ·»åŠ äº†æƒé™\n\n        //æ‹¿åˆ°å½“å‰ç™»å½•çš„è¿™ä¸ªå¯¹è±¡\n        Subject subject= SecurityUtils.getSubject();\n        User currentUser = (User) subject.getPrincipal(); //æ‹¿åˆ°userå¯¹è±¡ å¯ä»¥è®¾ç½®ç”¨æˆ·æƒé™\n        //è®¾ç½®å½“å‰ç”¨æˆ·çš„æƒé™ ä»æ•°æ®åº“ä¸Šé¢æ‹¿\n        info.addStringPermission(currentUser.getPerms());\n        System.out.println(currentUser.getPerms());\n        return info;\n    }\n\n    //ç”¨æˆ·è®¤è¯\n    @Override\n    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {\n\n        UsernamePasswordToken userToken = (UsernamePasswordToken) token;\n        //è®¤è¯ç”¨æˆ·ï¼ˆè¿æ¥æ•°æ®åº“ï¼‰\n        User user = userService.queryUserByName(userToken.getUsername());\n        if(user==null){\n            return null; //UnknownAccountException\n        }\n\n        //åˆ¤æ–­sessionæ˜¯å¦æœ‰å€¼ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®\n        Subject currentSubject = SecurityUtils.getSubject();\n        Session session = currentSubject.getSession();\n        session.setAttribute(\"loginUser\",user);\n\n        //å¯ä»¥åŠ å¯†ï¼šMD5 MD5ç›å€¼åŠ å¯†ï¼ˆæ›´é«˜çº§ï¼‰\n        //å¯†ç è®¤è¯ï¼ˆshiroå®Œæˆï¼‰\n        return new SimpleAuthenticationInfo(user,user.getPassword(),\"\");\n    }\n}\n```\nShiroå¤§è‡´çš„é…ç½®å°±åœ¨è¿™é‡Œäº†ï¼Œå…·ä½“åŠŸèƒ½å¦‚æ‹¦æˆªåŠŸèƒ½ã€æˆæƒè®¤è¯åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æˆ‘çš„\ngithub [https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)ï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚\n\nShiroæ ¸å¿ƒæ¦‚è¿°å¯å‚è€ƒæ–‡ç« ï¼š[https://www.cnblogs.com/deng-cc/p/9401900.html](https://www.cnblogs.com/deng-cc/p/9401900.html)","source":"_posts/SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½.md","raw":"---\ntitle: SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½\ndate: 2022-02-11 17:28:11\ntags:\n---\n\n## ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\n\nApache Shiroæ˜¯ä¸€ä¸ªJavaå®‰å…¨æƒé™æ¡†æ¡†æ¶ã€‚\n\nShiroå¯ä»¥éå¸¸å®¹æ˜“çš„å¼€å‘å‡ºè¶³å¤Ÿå¥½çš„åº”ç”¨ï¼Œå…¶ä¸ä»…å¯ä»¥åœ¨javaEEç¯å¢ƒã€‚\n\nShiroå¯ä»¥å®Œæˆï¼Œè®¤è¯ï¼Œæˆæƒï¼ŒåŠ å¯†ï¼Œä¼šè¯ç®¡ç†ï¼ŒWebé›†æˆï¼Œç¼“å­˜ç­‰ã€‚\n\n## äºŒã€Shiroå·¥ä½œåŸç†\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb29de36230aeb29dcc9257948081472.png)\nåº”ç”¨ä»£ç çš„äº¤äº’å¯¹è±¡æ˜¯ â€œSubjectâ€ï¼Œè¯¥å¯¹è±¡ä»£è¡¨äº†**å½“å‰ â€œç”¨æˆ·â€**ï¼Œè€Œæ‰€æœ‰ç”¨æˆ·çš„å®‰å…¨æ“ä½œéƒ½ä¼šäº¤ç»™ SecurityManager æ¥ç®¡ç†ï¼Œè€Œç®¡ç†è¿‡ç¨‹ä¸­ä¼šä» Realm ä¸­è·å–ç”¨æˆ·å¯¹åº”çš„è§’è‰²å’Œæƒé™ï¼Œå¯ä»¥æŠŠ Realm å ªç§°æ˜¯å®‰å…¨æ•°æ®æºã€‚\n \nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æœ€ç®€å•çš„ Shiro åº”ç”¨ï¼š\n- é€šè¿‡ Subject æ¥è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œè€Œ Subject åˆå§”æ‰˜ç»™äº† SecurityManager è¿›è¡Œç®¡ç†\n- æˆ‘ä»¬éœ€è¦ç»™ SecurityManager æ³¨å…¥ Realm ä»¥ä¾¿å…¶è·å–ç”¨æˆ·å’Œæƒé™è¿›è¡Œåˆ¤æ–­\n- ä¹Ÿå³ï¼ŒShiro ä¸æä¾›ç”¨æˆ·å’Œæƒé™çš„ç»´æŠ¤ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œé€šè¿‡ Realm æ³¨å…¥\n\n## ä¸‰ã€SpringBootæ•´åˆShiro\n\n1.xmlå¯¼å…¥jaråŒ…\n```xml\n        <dependency>\n            <groupId>org.apache.shiro</groupId>\n            <artifactId>shiro-spring</artifactId>\n            <version>1.4.1</version>\n        </dependency>\n```\n2.configç›®å½•ä¸‹åˆ›å»ºShiroConfig.javaï¼Œæ‹¦æˆªä»¥åŠæˆæƒç­‰åŠŸèƒ½éƒ½åœ¨è¿™é‡Œé…ç½®\n```java\n@Configuration\npublic class ShiroConfig {\n    //1.åˆ›å»ºrealmå¯¹è±¡ éœ€è¦è‡ªå®šä¹‰\n    @Bean\n    public UserRealm userRealm(){\n        return new UserRealm();\n    }\n\n    //2.DefaultWebSecurityManager\n    @Bean(name = \"securityManager\")\n    public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(\"userRealm\") UserRealm userRealm){\n        DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager();\n        //å…³è”UserRealm\n        securityManager.setRealm(userRealm);\n        return securityManager;\n    }\n\n    //3.ShiroFilterFactoryBean\n    @Bean\n    public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(\"securityManager\")DefaultWebSecurityManager defaultWebSecurityManager){\n        ShiroFilterFactoryBean bean = new ShiroFilterFactoryBean();\n        //è®¾ç½®å®‰å…¨ç®¡ç†å™¨\n        bean.setSecurityManager(defaultWebSecurityManager);\n\n        //æ·»åŠ shiroçš„å†…ç½®è¿‡æ»¤å™¨\n        /**\n         * anonï¼šæ— éœ€è®¤è¯å°±å¯ä»¥è®¿é—®\n         * authcï¼šå¿…é¡»è®¤è¯äº†æ‰èƒ½è®¿é—®\n         * userï¼šå¿…é¡»æ‹¥æœ‰ è®°ä½æˆ‘ åŠŸèƒ½æ‰èƒ½ç”¨\n         * permsï¼šæ‹¥æœ‰å¯¹æŸä¸ªèµ„æºçš„æƒé™æ‰èƒ½è®¿é—®\n         * roleï¼šæ‹¥æœ‰æŸä¸ªè§’è‰²æƒé™æ‰èƒ½è®¿é—®\n         */\n        Map<String, String> filterMap = new LinkedHashMap<>();\n        //æˆæƒ\n        filterMap.put(\"/user/add\",\"perms[user:add]\"); //è¿›å…¥éœ€è¦æˆæƒï¼ˆæˆæƒè§„åˆ™ç”¨æˆ·åé¢æ¥ï¼šaddï¼‰æ‰å¯ä»¥è¿›å…¥add\n        filterMap.put(\"/user/update\",\"perms[user:update]\");\n\n        //æ‹¦æˆªåŠŸèƒ½\n        filterMap.put(\"/user/*\",\"authc\"); //è¡¨ç¤ºè®¿é—®useræ¥å£çš„èµ„æºéƒ½è¦è®¤è¯\n        bean.setFilterChainDefinitionMap(filterMap);\n\n        //******å¤„ç†æƒé™ä¸å¤Ÿæˆ–è€…éœ€è¦æˆæƒçš„ä¸šåŠ¡********\n        //å¦‚æœæ²¡æœ‰æƒé™authc è®¾ç½®ç™»å½•çš„è¯·æ±‚\n        bean.setLoginUrl(\"/toLogin\");\n        //æœªæˆæƒé¡µé¢\n        bean.setUnauthorizedUrl(\"/noauth\");\n        return bean;\n    }\n}\n```\n3.è‡ªå®šä¹‰UserRealmç±»ï¼Œç»§æ‰¿AuthorizingRealmé‡å†™ç”¨æˆ·æˆæƒå’Œç”¨æˆ·è®¤è¯çš„æ–¹æ³•\n```java\npublic class UserRealm extends AuthorizingRealm {//ç”¨æˆ·æˆæƒ\n    @Override\n    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) {\n\n        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();\n//        info.addStringPermission(\"user:add\"); æ‰‹åŠ¨æ·»åŠ äº†æƒé™\n\n        //æ‹¿åˆ°å½“å‰ç™»å½•çš„è¿™ä¸ªå¯¹è±¡\n        Subject subject= SecurityUtils.getSubject();\n        User currentUser = (User) subject.getPrincipal(); //æ‹¿åˆ°userå¯¹è±¡ å¯ä»¥è®¾ç½®ç”¨æˆ·æƒé™\n        //è®¾ç½®å½“å‰ç”¨æˆ·çš„æƒé™ ä»æ•°æ®åº“ä¸Šé¢æ‹¿\n        info.addStringPermission(currentUser.getPerms());\n        System.out.println(currentUser.getPerms());\n        return info;\n    }\n\n    //ç”¨æˆ·è®¤è¯\n    @Override\n    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {\n\n        UsernamePasswordToken userToken = (UsernamePasswordToken) token;\n        //è®¤è¯ç”¨æˆ·ï¼ˆè¿æ¥æ•°æ®åº“ï¼‰\n        User user = userService.queryUserByName(userToken.getUsername());\n        if(user==null){\n            return null; //UnknownAccountException\n        }\n\n        //åˆ¤æ–­sessionæ˜¯å¦æœ‰å€¼ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®\n        Subject currentSubject = SecurityUtils.getSubject();\n        Session session = currentSubject.getSession();\n        session.setAttribute(\"loginUser\",user);\n\n        //å¯ä»¥åŠ å¯†ï¼šMD5 MD5ç›å€¼åŠ å¯†ï¼ˆæ›´é«˜çº§ï¼‰\n        //å¯†ç è®¤è¯ï¼ˆshiroå®Œæˆï¼‰\n        return new SimpleAuthenticationInfo(user,user.getPassword(),\"\");\n    }\n}\n```\nShiroå¤§è‡´çš„é…ç½®å°±åœ¨è¿™é‡Œäº†ï¼Œå…·ä½“åŠŸèƒ½å¦‚æ‹¦æˆªåŠŸèƒ½ã€æˆæƒè®¤è¯åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æˆ‘çš„\ngithub [https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)ï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚\n\nShiroæ ¸å¿ƒæ¦‚è¿°å¯å‚è€ƒæ–‡ç« ï¼š[https://www.cnblogs.com/deng-cc/p/9401900.html](https://www.cnblogs.com/deng-cc/p/9401900.html)","slug":"SpringBootæ•´åˆShiroå®ç°ç™»å½•æ‹¦æˆªä»¥åŠè®¤è¯æˆæƒåŠŸèƒ½","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dn000uwen146kd8c4a","content":"<h2 id=\"ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Apache Shiroæ˜¯ä¸€ä¸ªJavaå®‰å…¨æƒé™æ¡†æ¡†æ¶ã€‚</p>\n<p>Shiroå¯ä»¥éå¸¸å®¹æ˜“çš„å¼€å‘å‡ºè¶³å¤Ÿå¥½çš„åº”ç”¨ï¼Œå…¶ä¸ä»…å¯ä»¥åœ¨javaEEç¯å¢ƒã€‚</p>\n<p>Shiroå¯ä»¥å®Œæˆï¼Œè®¤è¯ï¼Œæˆæƒï¼ŒåŠ å¯†ï¼Œä¼šè¯ç®¡ç†ï¼ŒWebé›†æˆï¼Œç¼“å­˜ç­‰ã€‚</p>\n<h2 id=\"äºŒã€Shiroå·¥ä½œåŸç†\"><a href=\"#äºŒã€Shiroå·¥ä½œåŸç†\" class=\"headerlink\" title=\"äºŒã€Shiroå·¥ä½œåŸç†\"></a>äºŒã€Shiroå·¥ä½œåŸç†</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb29de36230aeb29dcc9257948081472.png\" alt=\"image.png\"><br>åº”ç”¨ä»£ç çš„äº¤äº’å¯¹è±¡æ˜¯ â€œSubjectâ€ï¼Œè¯¥å¯¹è±¡ä»£è¡¨äº†<strong>å½“å‰ â€œç”¨æˆ·â€</strong>ï¼Œè€Œæ‰€æœ‰ç”¨æˆ·çš„å®‰å…¨æ“ä½œéƒ½ä¼šäº¤ç»™ SecurityManager æ¥ç®¡ç†ï¼Œè€Œç®¡ç†è¿‡ç¨‹ä¸­ä¼šä» Realm ä¸­è·å–ç”¨æˆ·å¯¹åº”çš„è§’è‰²å’Œæƒé™ï¼Œå¯ä»¥æŠŠ Realm å ªç§°æ˜¯å®‰å…¨æ•°æ®æºã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æœ€ç®€å•çš„ Shiro åº”ç”¨ï¼š</p>\n<ul>\n<li>é€šè¿‡ Subject æ¥è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œè€Œ Subject åˆå§”æ‰˜ç»™äº† SecurityManager è¿›è¡Œç®¡ç†</li>\n<li>æˆ‘ä»¬éœ€è¦ç»™ SecurityManager æ³¨å…¥ Realm ä»¥ä¾¿å…¶è·å–ç”¨æˆ·å’Œæƒé™è¿›è¡Œåˆ¤æ–­</li>\n<li>ä¹Ÿå³ï¼ŒShiro ä¸æä¾›ç”¨æˆ·å’Œæƒé™çš„ç»´æŠ¤ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œé€šè¿‡ Realm æ³¨å…¥</li>\n</ul>\n<h2 id=\"ä¸‰ã€SpringBootæ•´åˆShiro\"><a href=\"#ä¸‰ã€SpringBootæ•´åˆShiro\" class=\"headerlink\" title=\"ä¸‰ã€SpringBootæ•´åˆShiro\"></a>ä¸‰ã€SpringBootæ•´åˆShiro</h2><p>1.xmlå¯¼å…¥jaråŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.shiro<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>shiro-spring<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2.configç›®å½•ä¸‹åˆ›å»ºShiroConfig.javaï¼Œæ‹¦æˆªä»¥åŠæˆæƒç­‰åŠŸèƒ½éƒ½åœ¨è¿™é‡Œé…ç½®</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ShiroConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.åˆ›å»ºrealmå¯¹è±¡ éœ€è¦è‡ªå®šä¹‰</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> UserRealm <span class=\"title function_\">userRealm</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UserRealm</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//2.DefaultWebSecurityManager</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean(name = &quot;securityManager&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DefaultWebSecurityManager <span class=\"title function_\">getDefaultWebSecurityManager</span><span class=\"params\">(<span class=\"meta\">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">DefaultWebSecurityManager</span> <span class=\"variable\">securityManager</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultWebSecurityManager</span>();</span><br><span class=\"line\">        <span class=\"comment\">//å…³è”UserRealm</span></span><br><span class=\"line\">        securityManager.setRealm(userRealm);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> securityManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//3.ShiroFilterFactoryBean</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ShiroFilterFactoryBean <span class=\"title function_\">getShiroFilterFactoryBean</span><span class=\"params\">(<span class=\"meta\">@Qualifier(&quot;securityManager&quot;)</span>DefaultWebSecurityManager defaultWebSecurityManager)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">ShiroFilterFactoryBean</span> <span class=\"variable\">bean</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ShiroFilterFactoryBean</span>();</span><br><span class=\"line\">        <span class=\"comment\">//è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class=\"line\">        bean.setSecurityManager(defaultWebSecurityManager);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ·»åŠ shiroçš„å†…ç½®è¿‡æ»¤å™¨</span></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * anonï¼šæ— éœ€è®¤è¯å°±å¯ä»¥è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * authcï¼šå¿…é¡»è®¤è¯äº†æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * userï¼šå¿…é¡»æ‹¥æœ‰ è®°ä½æˆ‘ åŠŸèƒ½æ‰èƒ½ç”¨</span></span><br><span class=\"line\"><span class=\"comment\">         * permsï¼šæ‹¥æœ‰å¯¹æŸä¸ªèµ„æºçš„æƒé™æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * roleï¼šæ‹¥æœ‰æŸä¸ªè§’è‰²æƒé™æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        Map&lt;String, String&gt; filterMap = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedHashMap</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"comment\">//æˆæƒ</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/add&quot;</span>,<span class=\"string\">&quot;perms[user:add]&quot;</span>); <span class=\"comment\">//è¿›å…¥éœ€è¦æˆæƒï¼ˆæˆæƒè§„åˆ™ç”¨æˆ·åé¢æ¥ï¼šaddï¼‰æ‰å¯ä»¥è¿›å…¥add</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/update&quot;</span>,<span class=\"string\">&quot;perms[user:update]&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ‹¦æˆªåŠŸèƒ½</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/*&quot;</span>,<span class=\"string\">&quot;authc&quot;</span>); <span class=\"comment\">//è¡¨ç¤ºè®¿é—®useræ¥å£çš„èµ„æºéƒ½è¦è®¤è¯</span></span><br><span class=\"line\">        bean.setFilterChainDefinitionMap(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//******å¤„ç†æƒé™ä¸å¤Ÿæˆ–è€…éœ€è¦æˆæƒçš„ä¸šåŠ¡********</span></span><br><span class=\"line\">        <span class=\"comment\">//å¦‚æœæ²¡æœ‰æƒé™authc è®¾ç½®ç™»å½•çš„è¯·æ±‚</span></span><br><span class=\"line\">        bean.setLoginUrl(<span class=\"string\">&quot;/toLogin&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//æœªæˆæƒé¡µé¢</span></span><br><span class=\"line\">        bean.setUnauthorizedUrl(<span class=\"string\">&quot;/noauth&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3.è‡ªå®šä¹‰UserRealmç±»ï¼Œç»§æ‰¿AuthorizingRealmé‡å†™ç”¨æˆ·æˆæƒå’Œç”¨æˆ·è®¤è¯çš„æ–¹æ³•</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserRealm</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AuthorizingRealm</span> &#123;<span class=\"comment\">//ç”¨æˆ·æˆæƒ</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> AuthorizationInfo <span class=\"title function_\">doGetAuthorizationInfo</span><span class=\"params\">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">SimpleAuthorizationInfo</span> <span class=\"variable\">info</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleAuthorizationInfo</span>();</span><br><span class=\"line\"><span class=\"comment\">//        info.addStringPermission(&quot;user:add&quot;); æ‰‹åŠ¨æ·»åŠ äº†æƒé™</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ‹¿åˆ°å½“å‰ç™»å½•çš„è¿™ä¸ªå¯¹è±¡</span></span><br><span class=\"line\">        Subject subject= SecurityUtils.getSubject();</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">currentUser</span> <span class=\"operator\">=</span> (User) subject.getPrincipal(); <span class=\"comment\">//æ‹¿åˆ°userå¯¹è±¡ å¯ä»¥è®¾ç½®ç”¨æˆ·æƒé™</span></span><br><span class=\"line\">        <span class=\"comment\">//è®¾ç½®å½“å‰ç”¨æˆ·çš„æƒé™ ä»æ•°æ®åº“ä¸Šé¢æ‹¿</span></span><br><span class=\"line\">        info.addStringPermission(currentUser.getPerms());</span><br><span class=\"line\">        System.out.println(currentUser.getPerms());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ç”¨æˆ·è®¤è¯</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> AuthenticationInfo <span class=\"title function_\">doGetAuthenticationInfo</span><span class=\"params\">(AuthenticationToken token)</span> <span class=\"keyword\">throws</span> AuthenticationException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">UsernamePasswordToken</span> <span class=\"variable\">userToken</span> <span class=\"operator\">=</span> (UsernamePasswordToken) token;</span><br><span class=\"line\">        <span class=\"comment\">//è®¤è¯ç”¨æˆ·ï¼ˆè¿æ¥æ•°æ®åº“ï¼‰</span></span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.queryUserByName(userToken.getUsername());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(user==<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">//UnknownAccountException</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//åˆ¤æ–­sessionæ˜¯å¦æœ‰å€¼ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®</span></span><br><span class=\"line\">        <span class=\"type\">Subject</span> <span class=\"variable\">currentSubject</span> <span class=\"operator\">=</span> SecurityUtils.getSubject();</span><br><span class=\"line\">        <span class=\"type\">Session</span> <span class=\"variable\">session</span> <span class=\"operator\">=</span> currentSubject.getSession();</span><br><span class=\"line\">        session.setAttribute(<span class=\"string\">&quot;loginUser&quot;</span>,user);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//å¯ä»¥åŠ å¯†ï¼šMD5 MD5ç›å€¼åŠ å¯†ï¼ˆæ›´é«˜çº§ï¼‰</span></span><br><span class=\"line\">        <span class=\"comment\">//å¯†ç è®¤è¯ï¼ˆshiroå®Œæˆï¼‰</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleAuthenticationInfo</span>(user,user.getPassword(),<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Shiroå¤§è‡´çš„é…ç½®å°±åœ¨è¿™é‡Œäº†ï¼Œå…·ä½“åŠŸèƒ½å¦‚æ‹¦æˆªåŠŸèƒ½ã€æˆæƒè®¤è¯åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æˆ‘çš„<br>github <a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a>ï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚</p>\n<p>Shiroæ ¸å¿ƒæ¦‚è¿°å¯å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/deng-cc/p/9401900.html\">https://www.cnblogs.com/deng-cc/p/9401900.html</a></p>\n","excerpt":"","more":"<h2 id=\"ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>ä¸€ã€Shiroæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Apache Shiroæ˜¯ä¸€ä¸ªJavaå®‰å…¨æƒé™æ¡†æ¡†æ¶ã€‚</p>\n<p>Shiroå¯ä»¥éå¸¸å®¹æ˜“çš„å¼€å‘å‡ºè¶³å¤Ÿå¥½çš„åº”ç”¨ï¼Œå…¶ä¸ä»…å¯ä»¥åœ¨javaEEç¯å¢ƒã€‚</p>\n<p>Shiroå¯ä»¥å®Œæˆï¼Œè®¤è¯ï¼Œæˆæƒï¼ŒåŠ å¯†ï¼Œä¼šè¯ç®¡ç†ï¼ŒWebé›†æˆï¼Œç¼“å­˜ç­‰ã€‚</p>\n<h2 id=\"äºŒã€Shiroå·¥ä½œåŸç†\"><a href=\"#äºŒã€Shiroå·¥ä½œåŸç†\" class=\"headerlink\" title=\"äºŒã€Shiroå·¥ä½œåŸç†\"></a>äºŒã€Shiroå·¥ä½œåŸç†</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/eb29de36230aeb29dcc9257948081472.png\" alt=\"image.png\"><br>åº”ç”¨ä»£ç çš„äº¤äº’å¯¹è±¡æ˜¯ â€œSubjectâ€ï¼Œè¯¥å¯¹è±¡ä»£è¡¨äº†<strong>å½“å‰ â€œç”¨æˆ·â€</strong>ï¼Œè€Œæ‰€æœ‰ç”¨æˆ·çš„å®‰å…¨æ“ä½œéƒ½ä¼šäº¤ç»™ SecurityManager æ¥ç®¡ç†ï¼Œè€Œç®¡ç†è¿‡ç¨‹ä¸­ä¼šä» Realm ä¸­è·å–ç”¨æˆ·å¯¹åº”çš„è§’è‰²å’Œæƒé™ï¼Œå¯ä»¥æŠŠ Realm å ªç§°æ˜¯å®‰å…¨æ•°æ®æºã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æœ€ç®€å•çš„ Shiro åº”ç”¨ï¼š</p>\n<ul>\n<li>é€šè¿‡ Subject æ¥è¿›è¡Œè®¤è¯å’Œæˆæƒï¼Œè€Œ Subject åˆå§”æ‰˜ç»™äº† SecurityManager è¿›è¡Œç®¡ç†</li>\n<li>æˆ‘ä»¬éœ€è¦ç»™ SecurityManager æ³¨å…¥ Realm ä»¥ä¾¿å…¶è·å–ç”¨æˆ·å’Œæƒé™è¿›è¡Œåˆ¤æ–­</li>\n<li>ä¹Ÿå³ï¼ŒShiro ä¸æä¾›ç”¨æˆ·å’Œæƒé™çš„ç»´æŠ¤ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œé€šè¿‡ Realm æ³¨å…¥</li>\n</ul>\n<h2 id=\"ä¸‰ã€SpringBootæ•´åˆShiro\"><a href=\"#ä¸‰ã€SpringBootæ•´åˆShiro\" class=\"headerlink\" title=\"ä¸‰ã€SpringBootæ•´åˆShiro\"></a>ä¸‰ã€SpringBootæ•´åˆShiro</h2><p>1.xmlå¯¼å…¥jaråŒ…</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.shiro<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>shiro-spring<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>2.configç›®å½•ä¸‹åˆ›å»ºShiroConfig.javaï¼Œæ‹¦æˆªä»¥åŠæˆæƒç­‰åŠŸèƒ½éƒ½åœ¨è¿™é‡Œé…ç½®</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ShiroConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//1.åˆ›å»ºrealmå¯¹è±¡ éœ€è¦è‡ªå®šä¹‰</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> UserRealm <span class=\"title function_\">userRealm</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UserRealm</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//2.DefaultWebSecurityManager</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean(name = &quot;securityManager&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DefaultWebSecurityManager <span class=\"title function_\">getDefaultWebSecurityManager</span><span class=\"params\">(<span class=\"meta\">@Qualifier(&quot;userRealm&quot;)</span> UserRealm userRealm)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">DefaultWebSecurityManager</span> <span class=\"variable\">securityManager</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultWebSecurityManager</span>();</span><br><span class=\"line\">        <span class=\"comment\">//å…³è”UserRealm</span></span><br><span class=\"line\">        securityManager.setRealm(userRealm);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> securityManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//3.ShiroFilterFactoryBean</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ShiroFilterFactoryBean <span class=\"title function_\">getShiroFilterFactoryBean</span><span class=\"params\">(<span class=\"meta\">@Qualifier(&quot;securityManager&quot;)</span>DefaultWebSecurityManager defaultWebSecurityManager)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">ShiroFilterFactoryBean</span> <span class=\"variable\">bean</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ShiroFilterFactoryBean</span>();</span><br><span class=\"line\">        <span class=\"comment\">//è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class=\"line\">        bean.setSecurityManager(defaultWebSecurityManager);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ·»åŠ shiroçš„å†…ç½®è¿‡æ»¤å™¨</span></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * anonï¼šæ— éœ€è®¤è¯å°±å¯ä»¥è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * authcï¼šå¿…é¡»è®¤è¯äº†æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * userï¼šå¿…é¡»æ‹¥æœ‰ è®°ä½æˆ‘ åŠŸèƒ½æ‰èƒ½ç”¨</span></span><br><span class=\"line\"><span class=\"comment\">         * permsï¼šæ‹¥æœ‰å¯¹æŸä¸ªèµ„æºçš„æƒé™æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         * roleï¼šæ‹¥æœ‰æŸä¸ªè§’è‰²æƒé™æ‰èƒ½è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        Map&lt;String, String&gt; filterMap = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedHashMap</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"comment\">//æˆæƒ</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/add&quot;</span>,<span class=\"string\">&quot;perms[user:add]&quot;</span>); <span class=\"comment\">//è¿›å…¥éœ€è¦æˆæƒï¼ˆæˆæƒè§„åˆ™ç”¨æˆ·åé¢æ¥ï¼šaddï¼‰æ‰å¯ä»¥è¿›å…¥add</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/update&quot;</span>,<span class=\"string\">&quot;perms[user:update]&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ‹¦æˆªåŠŸèƒ½</span></span><br><span class=\"line\">        filterMap.put(<span class=\"string\">&quot;/user/*&quot;</span>,<span class=\"string\">&quot;authc&quot;</span>); <span class=\"comment\">//è¡¨ç¤ºè®¿é—®useræ¥å£çš„èµ„æºéƒ½è¦è®¤è¯</span></span><br><span class=\"line\">        bean.setFilterChainDefinitionMap(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//******å¤„ç†æƒé™ä¸å¤Ÿæˆ–è€…éœ€è¦æˆæƒçš„ä¸šåŠ¡********</span></span><br><span class=\"line\">        <span class=\"comment\">//å¦‚æœæ²¡æœ‰æƒé™authc è®¾ç½®ç™»å½•çš„è¯·æ±‚</span></span><br><span class=\"line\">        bean.setLoginUrl(<span class=\"string\">&quot;/toLogin&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//æœªæˆæƒé¡µé¢</span></span><br><span class=\"line\">        bean.setUnauthorizedUrl(<span class=\"string\">&quot;/noauth&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> bean;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3.è‡ªå®šä¹‰UserRealmç±»ï¼Œç»§æ‰¿AuthorizingRealmé‡å†™ç”¨æˆ·æˆæƒå’Œç”¨æˆ·è®¤è¯çš„æ–¹æ³•</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserRealm</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AuthorizingRealm</span> &#123;<span class=\"comment\">//ç”¨æˆ·æˆæƒ</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> AuthorizationInfo <span class=\"title function_\">doGetAuthorizationInfo</span><span class=\"params\">(PrincipalCollection principalCollection)</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">SimpleAuthorizationInfo</span> <span class=\"variable\">info</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleAuthorizationInfo</span>();</span><br><span class=\"line\"><span class=\"comment\">//        info.addStringPermission(&quot;user:add&quot;); æ‰‹åŠ¨æ·»åŠ äº†æƒé™</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//æ‹¿åˆ°å½“å‰ç™»å½•çš„è¿™ä¸ªå¯¹è±¡</span></span><br><span class=\"line\">        Subject subject= SecurityUtils.getSubject();</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">currentUser</span> <span class=\"operator\">=</span> (User) subject.getPrincipal(); <span class=\"comment\">//æ‹¿åˆ°userå¯¹è±¡ å¯ä»¥è®¾ç½®ç”¨æˆ·æƒé™</span></span><br><span class=\"line\">        <span class=\"comment\">//è®¾ç½®å½“å‰ç”¨æˆ·çš„æƒé™ ä»æ•°æ®åº“ä¸Šé¢æ‹¿</span></span><br><span class=\"line\">        info.addStringPermission(currentUser.getPerms());</span><br><span class=\"line\">        System.out.println(currentUser.getPerms());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ç”¨æˆ·è®¤è¯</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> AuthenticationInfo <span class=\"title function_\">doGetAuthenticationInfo</span><span class=\"params\">(AuthenticationToken token)</span> <span class=\"keyword\">throws</span> AuthenticationException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">UsernamePasswordToken</span> <span class=\"variable\">userToken</span> <span class=\"operator\">=</span> (UsernamePasswordToken) token;</span><br><span class=\"line\">        <span class=\"comment\">//è®¤è¯ç”¨æˆ·ï¼ˆè¿æ¥æ•°æ®åº“ï¼‰</span></span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userService.queryUserByName(userToken.getUsername());</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(user==<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>; <span class=\"comment\">//UnknownAccountException</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//åˆ¤æ–­sessionæ˜¯å¦æœ‰å€¼ï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®</span></span><br><span class=\"line\">        <span class=\"type\">Subject</span> <span class=\"variable\">currentSubject</span> <span class=\"operator\">=</span> SecurityUtils.getSubject();</span><br><span class=\"line\">        <span class=\"type\">Session</span> <span class=\"variable\">session</span> <span class=\"operator\">=</span> currentSubject.getSession();</span><br><span class=\"line\">        session.setAttribute(<span class=\"string\">&quot;loginUser&quot;</span>,user);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//å¯ä»¥åŠ å¯†ï¼šMD5 MD5ç›å€¼åŠ å¯†ï¼ˆæ›´é«˜çº§ï¼‰</span></span><br><span class=\"line\">        <span class=\"comment\">//å¯†ç è®¤è¯ï¼ˆshiroå®Œæˆï¼‰</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleAuthenticationInfo</span>(user,user.getPassword(),<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>Shiroå¤§è‡´çš„é…ç½®å°±åœ¨è¿™é‡Œäº†ï¼Œå…·ä½“åŠŸèƒ½å¦‚æ‹¦æˆªåŠŸèƒ½ã€æˆæƒè®¤è¯åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æˆ‘çš„<br>github <a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a>ï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚</p>\n<p>Shiroæ ¸å¿ƒæ¦‚è¿°å¯å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/deng-cc/p/9401900.html\">https://www.cnblogs.com/deng-cc/p/9401900.html</a></p>\n"},{"title":"SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£","date":"2022-06-01T01:38:35.000Z","_content":"\nã€€ã€€å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œæ¥å£æ–‡æ¡£çš„å­˜åœ¨ååˆ†é‡è¦ã€‚ä¸æ‰‹åŠ¨ç¼–å†™æ¥å£æ–‡æ¡£ä¸åŒï¼Œswaggeræ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£çš„å·¥å…·ï¼Œåœ¨éœ€æ±‚ä¸æ–­å˜æ›´çš„å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰‹åŠ¨ç¼–å†™æ–‡æ¡£çš„æ•ˆç‡å®åœ¨å¤ªä½ã€‚ä¸æ–°ç‰ˆçš„swagger3ç›¸æ¯”swagger2é…ç½®æ›´å°‘ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚\n\n# ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\n```java\n<dependency>\n     <groupId>io.springfox</groupId>\n      <artifactId>springfox-boot-starter</artifactId>\n      <version>3.0.0</version>\n</dependency>\n```\n\n# äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£\n```java\n@EnableOpenApi\n@SpringBootApplication\n@MapperScan(basePackages = {\"cn.ruiyeclub.dao\"})\npublic class Swagger3Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Swagger3Application.class, args);\n    }\n}\n```\n\n# ä¸‰ã€Swagger3Configçš„é…ç½®\n```java\n@Configuration\npublic class Swagger3Config {\n    @Bean\n    public Docket createRestApi() {\n        return new Docket(DocumentationType.OAS_30)\n                .apiInfo(apiInfo())\n                .select()\n                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))\n                .paths(PathSelectors.any())\n                .build();\n    }\n\n    private ApiInfo apiInfo() {\n        return new ApiInfoBuilder()\n                .title(\"Swagger3æ¥å£æ–‡æ¡£\")\n                .description(\"æ›´å¤šè¯·å’¨è¯¢æœåŠ¡å¼€å‘è€…Rayã€‚\")\n                .contact(new Contact(\"Rayã€‚\", \"http://www.ruiyeclub.cn\", \"ruiyeclub@foxmail.com\"))\n                .version(\"1.0\")\n                .build();\n    }\n}\n```\n\n# å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\n```java\n@Apiï¼šç”¨åœ¨è¯·æ±‚çš„ç±»ä¸Šï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜\n    tags=\"è¯´æ˜è¯¥ç±»çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨UIç•Œé¢ä¸Šçœ‹åˆ°çš„æ³¨è§£\"\n    value=\"è¯¥å‚æ•°æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåœ¨UIç•Œé¢ä¸Šä¹Ÿçœ‹åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦é…ç½®\"\n\n@ApiOperationï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨\n    value=\"è¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨\"\n    notes=\"æ–¹æ³•çš„å¤‡æ³¨è¯´æ˜\"\n\n@ApiImplicitParamsï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å‚æ•°è¯´æ˜\n    @ApiImplicitParamï¼šç”¨åœ¨@ApiImplicitParamsæ³¨è§£ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªè¯·æ±‚å‚æ•°çš„å„ä¸ªæ–¹é¢\n        nameï¼šå‚æ•°å\n        valueï¼šå‚æ•°çš„æ±‰å­—è¯´æ˜ã€è§£é‡Š\n        requiredï¼šå‚æ•°æ˜¯å¦å¿…é¡»ä¼ \n        paramTypeï¼šå‚æ•°æ”¾åœ¨å“ªä¸ªåœ°æ–¹\n            Â· header --> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@RequestHeader\n            Â· query --> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@RequestParam\n            Â· pathï¼ˆç”¨äºrestfulæ¥å£ï¼‰--> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@PathVariable\n            Â· bodyï¼ˆä¸å¸¸ç”¨ï¼‰\n            Â· formï¼ˆä¸å¸¸ç”¨ï¼‰    \n        dataTypeï¼šå‚æ•°ç±»å‹ï¼Œé»˜è®¤Stringï¼Œå…¶å®ƒå€¼dataType=\"Integer\"       \n        defaultValueï¼šå‚æ•°çš„é»˜è®¤å€¼\n\n@ApiResponsesï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å“åº”\n    @ApiResponseï¼šç”¨åœ¨@ApiResponsesä¸­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾ä¸€ä¸ªé”™è¯¯çš„å“åº”ä¿¡æ¯\n        codeï¼šæ•°å­—ï¼Œä¾‹å¦‚400\n        messageï¼šä¿¡æ¯ï¼Œä¾‹å¦‚\"è¯·æ±‚å‚æ•°æ²¡å¡«å¥½\"\n        responseï¼šæŠ›å‡ºå¼‚å¸¸çš„ç±»\n\n@ApiModelï¼šç”¨äºå“åº”ç±»ä¸Šï¼Œè¡¨ç¤ºä¸€ä¸ªè¿”å›å“åº”æ•°æ®çš„ä¿¡æ¯\n            ï¼ˆè¿™ç§ä¸€èˆ¬ç”¨åœ¨poståˆ›å»ºçš„æ—¶å€™ï¼Œä½¿ç”¨@RequestBodyè¿™æ ·çš„åœºæ™¯ï¼Œ\n            è¯·æ±‚å‚æ•°æ— æ³•ä½¿ç”¨@ApiImplicitParamæ³¨è§£è¿›è¡Œæè¿°çš„æ—¶å€™ï¼‰\n    @ApiModelPropertyï¼šç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å“åº”ç±»çš„å±æ€§\n```\nControllerå±‚çš„é…ç½®ï¼š\n```java\n@Api(tags = \"ç”¨æˆ·ä¿¡æ¯ç®¡ç†\")\n@RestController\n@RequestMapping(\"userRecord\")\npublic class UserRecordController extends ApiController {\n    /**\n     * æœåŠ¡å¯¹è±¡\n     */\n    @Resource\n    private UserRecordService userRecordService;\n\n    /**\n     * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®\n     * @param page       åˆ†é¡µå¯¹è±¡\n     * @param userRecord æŸ¥è¯¢å®ä½“\n     * @return æ‰€æœ‰æ•°æ®\n     */\n    @ApiOperation(\"åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®\")\n    @GetMapping(\"page\")\n    public R selectAll(Page<UserRecord> page, UserRecord userRecord) {\n        return success(this.userRecordService.page(page, new QueryWrapper<>(userRecord)));\n    }\n\n    /**\n     * é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®\n     * @param id ä¸»é”®\n     * @return å•æ¡æ•°æ®\n     */\n    @ApiOperation(\"é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®\")\n    @GetMapping(\"{id}\")\n    public R selectOne(@PathVariable Serializable id) {\n        return success(this.userRecordService.getById(id));\n    }\n\n    /**\n     * æ–°å¢æ•°æ®\n     * @param userRecord å®ä½“å¯¹è±¡\n     * @return æ–°å¢ç»“æœ\n     */\n    @ApiOperation(\"æ–°å¢æ•°æ®\")\n    @PostMapping(\"insert\")\n    public R insert(@RequestBody UserRecord userRecord) {\n        return success(this.userRecordService.save(userRecord));\n    }\n\n    /**\n     * ä¿®æ”¹æ•°æ®\n     * @param userRecord å®ä½“å¯¹è±¡\n     * @return ä¿®æ”¹ç»“æœ\n     */\n    @ApiOperation(\"ä¿®æ”¹æ•°æ®\")\n    @PutMapping(\"update\")\n    public R update(@RequestBody UserRecord userRecord) {\n        return success(this.userRecordService.updateById(userRecord));\n    }\n\n    /**\n     * åˆ é™¤æ•°æ®\n     * @param idList ä¸»é”®ç»“åˆ\n     * @return åˆ é™¤ç»“æœ\n     */\n    @ApiOperation(\"åˆ é™¤æ•°æ®\")\n    @DeleteMapping(\"delete\")\n    public R delete(@RequestParam(\"idList\") List<Long> idList) {\n        return success(this.userRecordService.removeByIds(idList));\n    }\n}\n```\n\n# äº”ã€Swaggerç•Œé¢æ•ˆæœ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2954ce2fd4c4dca470dc4cafd38e2fc3.png)\n\n Swaggerçš„è®¿é—®è·¯å¾„ç”±port/swagger-ui.htmlæ”¹æˆäº†port/swagger-ui/ æˆ–port/swagger-ui/index.html\n\n> GitHubåœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)\n","source":"_posts/SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£.md","raw":"---\ntitle: SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£\ndate: 2022-06-01 09:38:35\ntags:\n---\n\nã€€ã€€å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œæ¥å£æ–‡æ¡£çš„å­˜åœ¨ååˆ†é‡è¦ã€‚ä¸æ‰‹åŠ¨ç¼–å†™æ¥å£æ–‡æ¡£ä¸åŒï¼Œswaggeræ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£çš„å·¥å…·ï¼Œåœ¨éœ€æ±‚ä¸æ–­å˜æ›´çš„å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰‹åŠ¨ç¼–å†™æ–‡æ¡£çš„æ•ˆç‡å®åœ¨å¤ªä½ã€‚ä¸æ–°ç‰ˆçš„swagger3ç›¸æ¯”swagger2é…ç½®æ›´å°‘ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚\n\n# ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\n```java\n<dependency>\n     <groupId>io.springfox</groupId>\n      <artifactId>springfox-boot-starter</artifactId>\n      <version>3.0.0</version>\n</dependency>\n```\n\n# äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£\n```java\n@EnableOpenApi\n@SpringBootApplication\n@MapperScan(basePackages = {\"cn.ruiyeclub.dao\"})\npublic class Swagger3Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Swagger3Application.class, args);\n    }\n}\n```\n\n# ä¸‰ã€Swagger3Configçš„é…ç½®\n```java\n@Configuration\npublic class Swagger3Config {\n    @Bean\n    public Docket createRestApi() {\n        return new Docket(DocumentationType.OAS_30)\n                .apiInfo(apiInfo())\n                .select()\n                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))\n                .paths(PathSelectors.any())\n                .build();\n    }\n\n    private ApiInfo apiInfo() {\n        return new ApiInfoBuilder()\n                .title(\"Swagger3æ¥å£æ–‡æ¡£\")\n                .description(\"æ›´å¤šè¯·å’¨è¯¢æœåŠ¡å¼€å‘è€…Rayã€‚\")\n                .contact(new Contact(\"Rayã€‚\", \"http://www.ruiyeclub.cn\", \"ruiyeclub@foxmail.com\"))\n                .version(\"1.0\")\n                .build();\n    }\n}\n```\n\n# å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\n```java\n@Apiï¼šç”¨åœ¨è¯·æ±‚çš„ç±»ä¸Šï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜\n    tags=\"è¯´æ˜è¯¥ç±»çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨UIç•Œé¢ä¸Šçœ‹åˆ°çš„æ³¨è§£\"\n    value=\"è¯¥å‚æ•°æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåœ¨UIç•Œé¢ä¸Šä¹Ÿçœ‹åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦é…ç½®\"\n\n@ApiOperationï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨\n    value=\"è¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨\"\n    notes=\"æ–¹æ³•çš„å¤‡æ³¨è¯´æ˜\"\n\n@ApiImplicitParamsï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å‚æ•°è¯´æ˜\n    @ApiImplicitParamï¼šç”¨åœ¨@ApiImplicitParamsæ³¨è§£ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªè¯·æ±‚å‚æ•°çš„å„ä¸ªæ–¹é¢\n        nameï¼šå‚æ•°å\n        valueï¼šå‚æ•°çš„æ±‰å­—è¯´æ˜ã€è§£é‡Š\n        requiredï¼šå‚æ•°æ˜¯å¦å¿…é¡»ä¼ \n        paramTypeï¼šå‚æ•°æ”¾åœ¨å“ªä¸ªåœ°æ–¹\n            Â· header --> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@RequestHeader\n            Â· query --> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@RequestParam\n            Â· pathï¼ˆç”¨äºrestfulæ¥å£ï¼‰--> è¯·æ±‚å‚æ•°çš„è·å–ï¼š@PathVariable\n            Â· bodyï¼ˆä¸å¸¸ç”¨ï¼‰\n            Â· formï¼ˆä¸å¸¸ç”¨ï¼‰    \n        dataTypeï¼šå‚æ•°ç±»å‹ï¼Œé»˜è®¤Stringï¼Œå…¶å®ƒå€¼dataType=\"Integer\"       \n        defaultValueï¼šå‚æ•°çš„é»˜è®¤å€¼\n\n@ApiResponsesï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å“åº”\n    @ApiResponseï¼šç”¨åœ¨@ApiResponsesä¸­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾ä¸€ä¸ªé”™è¯¯çš„å“åº”ä¿¡æ¯\n        codeï¼šæ•°å­—ï¼Œä¾‹å¦‚400\n        messageï¼šä¿¡æ¯ï¼Œä¾‹å¦‚\"è¯·æ±‚å‚æ•°æ²¡å¡«å¥½\"\n        responseï¼šæŠ›å‡ºå¼‚å¸¸çš„ç±»\n\n@ApiModelï¼šç”¨äºå“åº”ç±»ä¸Šï¼Œè¡¨ç¤ºä¸€ä¸ªè¿”å›å“åº”æ•°æ®çš„ä¿¡æ¯\n            ï¼ˆè¿™ç§ä¸€èˆ¬ç”¨åœ¨poståˆ›å»ºçš„æ—¶å€™ï¼Œä½¿ç”¨@RequestBodyè¿™æ ·çš„åœºæ™¯ï¼Œ\n            è¯·æ±‚å‚æ•°æ— æ³•ä½¿ç”¨@ApiImplicitParamæ³¨è§£è¿›è¡Œæè¿°çš„æ—¶å€™ï¼‰\n    @ApiModelPropertyï¼šç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å“åº”ç±»çš„å±æ€§\n```\nControllerå±‚çš„é…ç½®ï¼š\n```java\n@Api(tags = \"ç”¨æˆ·ä¿¡æ¯ç®¡ç†\")\n@RestController\n@RequestMapping(\"userRecord\")\npublic class UserRecordController extends ApiController {\n    /**\n     * æœåŠ¡å¯¹è±¡\n     */\n    @Resource\n    private UserRecordService userRecordService;\n\n    /**\n     * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®\n     * @param page       åˆ†é¡µå¯¹è±¡\n     * @param userRecord æŸ¥è¯¢å®ä½“\n     * @return æ‰€æœ‰æ•°æ®\n     */\n    @ApiOperation(\"åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®\")\n    @GetMapping(\"page\")\n    public R selectAll(Page<UserRecord> page, UserRecord userRecord) {\n        return success(this.userRecordService.page(page, new QueryWrapper<>(userRecord)));\n    }\n\n    /**\n     * é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®\n     * @param id ä¸»é”®\n     * @return å•æ¡æ•°æ®\n     */\n    @ApiOperation(\"é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®\")\n    @GetMapping(\"{id}\")\n    public R selectOne(@PathVariable Serializable id) {\n        return success(this.userRecordService.getById(id));\n    }\n\n    /**\n     * æ–°å¢æ•°æ®\n     * @param userRecord å®ä½“å¯¹è±¡\n     * @return æ–°å¢ç»“æœ\n     */\n    @ApiOperation(\"æ–°å¢æ•°æ®\")\n    @PostMapping(\"insert\")\n    public R insert(@RequestBody UserRecord userRecord) {\n        return success(this.userRecordService.save(userRecord));\n    }\n\n    /**\n     * ä¿®æ”¹æ•°æ®\n     * @param userRecord å®ä½“å¯¹è±¡\n     * @return ä¿®æ”¹ç»“æœ\n     */\n    @ApiOperation(\"ä¿®æ”¹æ•°æ®\")\n    @PutMapping(\"update\")\n    public R update(@RequestBody UserRecord userRecord) {\n        return success(this.userRecordService.updateById(userRecord));\n    }\n\n    /**\n     * åˆ é™¤æ•°æ®\n     * @param idList ä¸»é”®ç»“åˆ\n     * @return åˆ é™¤ç»“æœ\n     */\n    @ApiOperation(\"åˆ é™¤æ•°æ®\")\n    @DeleteMapping(\"delete\")\n    public R delete(@RequestParam(\"idList\") List<Long> idList) {\n        return success(this.userRecordService.removeByIds(idList));\n    }\n}\n```\n\n# äº”ã€Swaggerç•Œé¢æ•ˆæœ\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2954ce2fd4c4dca470dc4cafd38e2fc3.png)\n\n Swaggerçš„è®¿é—®è·¯å¾„ç”±port/swagger-ui.htmlæ”¹æˆäº†port/swagger-ui/ æˆ–port/swagger-ui/index.html\n\n> GitHubåœ°å€ï¼š[https://github.com/ruiyeclub/SpringBoot-Hello](https://github.com/ruiyeclub/SpringBoot-Hello)\n","slug":"SpringBootæ•´åˆSwagger3ç”Ÿæˆæ¥å£æ–‡æ¡£","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83do000vwen1fkuobs2w","content":"<p>ã€€ã€€å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œæ¥å£æ–‡æ¡£çš„å­˜åœ¨ååˆ†é‡è¦ã€‚ä¸æ‰‹åŠ¨ç¼–å†™æ¥å£æ–‡æ¡£ä¸åŒï¼Œswaggeræ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£çš„å·¥å…·ï¼Œåœ¨éœ€æ±‚ä¸æ–­å˜æ›´çš„å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰‹åŠ¨ç¼–å†™æ–‡æ¡£çš„æ•ˆç‡å®åœ¨å¤ªä½ã€‚ä¸æ–°ç‰ˆçš„swagger3ç›¸æ¯”swagger2é…ç½®æ›´å°‘ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚</p>\n<h1 id=\"ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\"><a href=\"#ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\" class=\"headerlink\" title=\"ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\"></a>ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">     &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class=\"line\">      &lt;artifactId&gt;springfox-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">      &lt;version&gt;<span class=\"number\">3.0</span><span class=\"number\">.0</span>&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äºŒã€Applicationä¸Šé¢åŠ å…¥-EnableOpenApiæ³¨è§£\"><a href=\"#äºŒã€Applicationä¸Šé¢åŠ å…¥-EnableOpenApiæ³¨è§£\" class=\"headerlink\" title=\"äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£\"></a>äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableOpenApi</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@MapperScan(basePackages = &#123;&quot;cn.ruiyeclub.dao&quot;&#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Swagger3Application</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(Swagger3Application.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"ä¸‰ã€Swagger3Configçš„é…ç½®\"><a href=\"#ä¸‰ã€Swagger3Configçš„é…ç½®\" class=\"headerlink\" title=\"ä¸‰ã€Swagger3Configçš„é…ç½®\"></a>ä¸‰ã€Swagger3Configçš„é…ç½®</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Swagger3Config</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Docket <span class=\"title function_\">createRestApi</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Docket</span>(DocumentationType.OAS_30)</span><br><span class=\"line\">                .apiInfo(apiInfo())</span><br><span class=\"line\">                .select()</span><br><span class=\"line\">                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))</span><br><span class=\"line\">                .paths(PathSelectors.any())</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ApiInfo <span class=\"title function_\">apiInfo</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ApiInfoBuilder</span>()</span><br><span class=\"line\">                .title(<span class=\"string\">&quot;Swagger3æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class=\"line\">                .description(<span class=\"string\">&quot;æ›´å¤šè¯·å’¨è¯¢æœåŠ¡å¼€å‘è€…Rayã€‚&quot;</span>)</span><br><span class=\"line\">                .contact(<span class=\"keyword\">new</span> <span class=\"title class_\">Contact</span>(<span class=\"string\">&quot;Rayã€‚&quot;</span>, <span class=\"string\">&quot;http://www.ruiyeclub.cn&quot;</span>, <span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>))</span><br><span class=\"line\">                .version(<span class=\"string\">&quot;1.0&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\"><a href=\"#å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\" class=\"headerlink\" title=\"å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\"></a>å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api</span>ï¼šç”¨åœ¨è¯·æ±‚çš„ç±»ä¸Šï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜</span><br><span class=\"line\">    tags=<span class=\"string\">&quot;è¯´æ˜è¯¥ç±»çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨UIç•Œé¢ä¸Šçœ‹åˆ°çš„æ³¨è§£&quot;</span></span><br><span class=\"line\">    value=<span class=\"string\">&quot;è¯¥å‚æ•°æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåœ¨UIç•Œé¢ä¸Šä¹Ÿçœ‹åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦é…ç½®&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiOperation</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨</span><br><span class=\"line\">    value=<span class=\"string\">&quot;è¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨&quot;</span></span><br><span class=\"line\">    notes=<span class=\"string\">&quot;æ–¹æ³•çš„å¤‡æ³¨è¯´æ˜&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiImplicitParams</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å‚æ•°è¯´æ˜</span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParam</span>ï¼šç”¨åœ¨<span class=\"meta\">@ApiImplicitParams</span>æ³¨è§£ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªè¯·æ±‚å‚æ•°çš„å„ä¸ªæ–¹é¢</span><br><span class=\"line\">        nameï¼šå‚æ•°å</span><br><span class=\"line\">        valueï¼šå‚æ•°çš„æ±‰å­—è¯´æ˜ã€è§£é‡Š</span><br><span class=\"line\">        requiredï¼šå‚æ•°æ˜¯å¦å¿…é¡»ä¼ </span><br><span class=\"line\">        paramTypeï¼šå‚æ•°æ”¾åœ¨å“ªä¸ªåœ°æ–¹</span><br><span class=\"line\">            Â· header --&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@RequestHeader</span></span><br><span class=\"line\">            Â· query --&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@RequestParam</span></span><br><span class=\"line\">            Â· pathï¼ˆç”¨äºrestfulæ¥å£ï¼‰--&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@PathVariable</span></span><br><span class=\"line\">            Â· bodyï¼ˆä¸å¸¸ç”¨ï¼‰</span><br><span class=\"line\">            Â· formï¼ˆä¸å¸¸ç”¨ï¼‰    </span><br><span class=\"line\">        dataTypeï¼šå‚æ•°ç±»å‹ï¼Œé»˜è®¤Stringï¼Œå…¶å®ƒå€¼dataType=<span class=\"string\">&quot;Integer&quot;</span>       </span><br><span class=\"line\">        defaultValueï¼šå‚æ•°çš„é»˜è®¤å€¼</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiResponses</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å“åº”</span><br><span class=\"line\">    <span class=\"meta\">@ApiResponse</span>ï¼šç”¨åœ¨<span class=\"meta\">@ApiResponses</span>ä¸­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾ä¸€ä¸ªé”™è¯¯çš„å“åº”ä¿¡æ¯</span><br><span class=\"line\">        codeï¼šæ•°å­—ï¼Œä¾‹å¦‚<span class=\"number\">400</span></span><br><span class=\"line\">        messageï¼šä¿¡æ¯ï¼Œä¾‹å¦‚<span class=\"string\">&quot;è¯·æ±‚å‚æ•°æ²¡å¡«å¥½&quot;</span></span><br><span class=\"line\">        responseï¼šæŠ›å‡ºå¼‚å¸¸çš„ç±»</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiModel</span>ï¼šç”¨äºå“åº”ç±»ä¸Šï¼Œè¡¨ç¤ºä¸€ä¸ªè¿”å›å“åº”æ•°æ®çš„ä¿¡æ¯</span><br><span class=\"line\">            ï¼ˆè¿™ç§ä¸€èˆ¬ç”¨åœ¨poståˆ›å»ºçš„æ—¶å€™ï¼Œä½¿ç”¨<span class=\"meta\">@RequestBody</span>è¿™æ ·çš„åœºæ™¯ï¼Œ</span><br><span class=\"line\">            è¯·æ±‚å‚æ•°æ— æ³•ä½¿ç”¨<span class=\"meta\">@ApiImplicitParam</span>æ³¨è§£è¿›è¡Œæè¿°çš„æ—¶å€™ï¼‰</span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty</span>ï¼šç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å“åº”ç±»çš„å±æ€§</span><br></pre></td></tr></table></figure>\n<p>Controllerå±‚çš„é…ç½®ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(tags = &quot;ç”¨æˆ·ä¿¡æ¯ç®¡ç†&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;userRecord&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserRecordController</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ApiController</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æœåŠ¡å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Resource</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserRecordService userRecordService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> page       åˆ†é¡µå¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord æŸ¥è¯¢å®ä½“</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> æ‰€æœ‰æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">selectAll</span><span class=\"params\">(Page&lt;UserRecord&gt; page, UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.page(page, <span class=\"keyword\">new</span> <span class=\"title class_\">QueryWrapper</span>&lt;&gt;(userRecord)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id ä¸»é”®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> å•æ¡æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">selectOne</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Serializable id)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.getById(id));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ–°å¢æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord å®ä½“å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> æ–°å¢ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;æ–°å¢æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;insert&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.save(userRecord));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä¿®æ”¹æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord å®ä½“å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> ä¿®æ”¹ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;ä¿®æ”¹æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping(&quot;update&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.updateById(userRecord));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ é™¤æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> idList ä¸»é”®ç»“åˆ</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> åˆ é™¤ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;åˆ é™¤æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;delete&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;idList&quot;)</span> List&lt;Long&gt; idList)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.removeByIds(idList));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äº”ã€Swaggerç•Œé¢æ•ˆæœ\"><a href=\"#äº”ã€Swaggerç•Œé¢æ•ˆæœ\" class=\"headerlink\" title=\"äº”ã€Swaggerç•Œé¢æ•ˆæœ\"></a>äº”ã€Swaggerç•Œé¢æ•ˆæœ</h1><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2954ce2fd4c4dca470dc4cafd38e2fc3.png\" alt=\"image.png\"></p>\n<p> Swaggerçš„è®¿é—®è·¯å¾„ç”±port&#x2F;swagger-ui.htmlæ”¹æˆäº†port&#x2F;swagger-ui&#x2F; æˆ–port&#x2F;swagger-ui&#x2F;index.html</p>\n<blockquote>\n<p>GitHubåœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n</blockquote>\n","excerpt":"","more":"<p>ã€€ã€€å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œæ¥å£æ–‡æ¡£çš„å­˜åœ¨ååˆ†é‡è¦ã€‚ä¸æ‰‹åŠ¨ç¼–å†™æ¥å£æ–‡æ¡£ä¸åŒï¼Œswaggeræ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£çš„å·¥å…·ï¼Œåœ¨éœ€æ±‚ä¸æ–­å˜æ›´çš„å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰‹åŠ¨ç¼–å†™æ–‡æ¡£çš„æ•ˆç‡å®åœ¨å¤ªä½ã€‚ä¸æ–°ç‰ˆçš„swagger3ç›¸æ¯”swagger2é…ç½®æ›´å°‘ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ã€‚</p>\n<h1 id=\"ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\"><a href=\"#ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\" class=\"headerlink\" title=\"ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–\"></a>ä¸€ã€pomæ–‡ä»¶ä¸­å¼•å…¥Swagger3ä¾èµ–</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">     &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class=\"line\">      &lt;artifactId&gt;springfox-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">      &lt;version&gt;<span class=\"number\">3.0</span><span class=\"number\">.0</span>&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äºŒã€Applicationä¸Šé¢åŠ å…¥-EnableOpenApiæ³¨è§£\"><a href=\"#äºŒã€Applicationä¸Šé¢åŠ å…¥-EnableOpenApiæ³¨è§£\" class=\"headerlink\" title=\"äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£\"></a>äºŒã€Applicationä¸Šé¢åŠ å…¥@EnableOpenApiæ³¨è§£</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableOpenApi</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@MapperScan(basePackages = &#123;&quot;cn.ruiyeclub.dao&quot;&#125;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Swagger3Application</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(Swagger3Application.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"ä¸‰ã€Swagger3Configçš„é…ç½®\"><a href=\"#ä¸‰ã€Swagger3Configçš„é…ç½®\" class=\"headerlink\" title=\"ä¸‰ã€Swagger3Configçš„é…ç½®\"></a>ä¸‰ã€Swagger3Configçš„é…ç½®</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Swagger3Config</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Docket <span class=\"title function_\">createRestApi</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Docket</span>(DocumentationType.OAS_30)</span><br><span class=\"line\">                .apiInfo(apiInfo())</span><br><span class=\"line\">                .select()</span><br><span class=\"line\">                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))</span><br><span class=\"line\">                .paths(PathSelectors.any())</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ApiInfo <span class=\"title function_\">apiInfo</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ApiInfoBuilder</span>()</span><br><span class=\"line\">                .title(<span class=\"string\">&quot;Swagger3æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class=\"line\">                .description(<span class=\"string\">&quot;æ›´å¤šè¯·å’¨è¯¢æœåŠ¡å¼€å‘è€…Rayã€‚&quot;</span>)</span><br><span class=\"line\">                .contact(<span class=\"keyword\">new</span> <span class=\"title class_\">Contact</span>(<span class=\"string\">&quot;Rayã€‚&quot;</span>, <span class=\"string\">&quot;http://www.ruiyeclub.cn&quot;</span>, <span class=\"string\">&quot;ruiyeclub@foxmail.com&quot;</span>))</span><br><span class=\"line\">                .version(<span class=\"string\">&quot;1.0&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\"><a href=\"#å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\" class=\"headerlink\" title=\"å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜\"></a>å››ã€Swaggeræ³¨è§£çš„ä½¿ç”¨è¯´æ˜</h1><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api</span>ï¼šç”¨åœ¨è¯·æ±‚çš„ç±»ä¸Šï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜</span><br><span class=\"line\">    tags=<span class=\"string\">&quot;è¯´æ˜è¯¥ç±»çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨UIç•Œé¢ä¸Šçœ‹åˆ°çš„æ³¨è§£&quot;</span></span><br><span class=\"line\">    value=<span class=\"string\">&quot;è¯¥å‚æ•°æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåœ¨UIç•Œé¢ä¸Šä¹Ÿçœ‹åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦é…ç½®&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiOperation</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨</span><br><span class=\"line\">    value=<span class=\"string\">&quot;è¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨&quot;</span></span><br><span class=\"line\">    notes=<span class=\"string\">&quot;æ–¹æ³•çš„å¤‡æ³¨è¯´æ˜&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiImplicitParams</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å‚æ•°è¯´æ˜</span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParam</span>ï¼šç”¨åœ¨<span class=\"meta\">@ApiImplicitParams</span>æ³¨è§£ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªè¯·æ±‚å‚æ•°çš„å„ä¸ªæ–¹é¢</span><br><span class=\"line\">        nameï¼šå‚æ•°å</span><br><span class=\"line\">        valueï¼šå‚æ•°çš„æ±‰å­—è¯´æ˜ã€è§£é‡Š</span><br><span class=\"line\">        requiredï¼šå‚æ•°æ˜¯å¦å¿…é¡»ä¼ </span><br><span class=\"line\">        paramTypeï¼šå‚æ•°æ”¾åœ¨å“ªä¸ªåœ°æ–¹</span><br><span class=\"line\">            Â· header --&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@RequestHeader</span></span><br><span class=\"line\">            Â· query --&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@RequestParam</span></span><br><span class=\"line\">            Â· pathï¼ˆç”¨äºrestfulæ¥å£ï¼‰--&gt; è¯·æ±‚å‚æ•°çš„è·å–ï¼š<span class=\"meta\">@PathVariable</span></span><br><span class=\"line\">            Â· bodyï¼ˆä¸å¸¸ç”¨ï¼‰</span><br><span class=\"line\">            Â· formï¼ˆä¸å¸¸ç”¨ï¼‰    </span><br><span class=\"line\">        dataTypeï¼šå‚æ•°ç±»å‹ï¼Œé»˜è®¤Stringï¼Œå…¶å®ƒå€¼dataType=<span class=\"string\">&quot;Integer&quot;</span>       </span><br><span class=\"line\">        defaultValueï¼šå‚æ•°çš„é»˜è®¤å€¼</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiResponses</span>ï¼šç”¨åœ¨è¯·æ±‚çš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºä¸€ç»„å“åº”</span><br><span class=\"line\">    <span class=\"meta\">@ApiResponse</span>ï¼šç”¨åœ¨<span class=\"meta\">@ApiResponses</span>ä¸­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾ä¸€ä¸ªé”™è¯¯çš„å“åº”ä¿¡æ¯</span><br><span class=\"line\">        codeï¼šæ•°å­—ï¼Œä¾‹å¦‚<span class=\"number\">400</span></span><br><span class=\"line\">        messageï¼šä¿¡æ¯ï¼Œä¾‹å¦‚<span class=\"string\">&quot;è¯·æ±‚å‚æ•°æ²¡å¡«å¥½&quot;</span></span><br><span class=\"line\">        responseï¼šæŠ›å‡ºå¼‚å¸¸çš„ç±»</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@ApiModel</span>ï¼šç”¨äºå“åº”ç±»ä¸Šï¼Œè¡¨ç¤ºä¸€ä¸ªè¿”å›å“åº”æ•°æ®çš„ä¿¡æ¯</span><br><span class=\"line\">            ï¼ˆè¿™ç§ä¸€èˆ¬ç”¨åœ¨poståˆ›å»ºçš„æ—¶å€™ï¼Œä½¿ç”¨<span class=\"meta\">@RequestBody</span>è¿™æ ·çš„åœºæ™¯ï¼Œ</span><br><span class=\"line\">            è¯·æ±‚å‚æ•°æ— æ³•ä½¿ç”¨<span class=\"meta\">@ApiImplicitParam</span>æ³¨è§£è¿›è¡Œæè¿°çš„æ—¶å€™ï¼‰</span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty</span>ï¼šç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å“åº”ç±»çš„å±æ€§</span><br></pre></td></tr></table></figure>\n<p>Controllerå±‚çš„é…ç½®ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(tags = &quot;ç”¨æˆ·ä¿¡æ¯ç®¡ç†&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;userRecord&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserRecordController</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ApiController</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æœåŠ¡å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Resource</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserRecordService userRecordService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> page       åˆ†é¡µå¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord æŸ¥è¯¢å®ä½“</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> æ‰€æœ‰æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;åˆ†é¡µæŸ¥è¯¢æ‰€æœ‰æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">selectAll</span><span class=\"params\">(Page&lt;UserRecord&gt; page, UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.page(page, <span class=\"keyword\">new</span> <span class=\"title class_\">QueryWrapper</span>&lt;&gt;(userRecord)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id ä¸»é”®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> å•æ¡æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;é€šè¿‡ä¸»é”®æŸ¥è¯¢å•æ¡æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">selectOne</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Serializable id)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.getById(id));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æ–°å¢æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord å®ä½“å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> æ–°å¢ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;æ–°å¢æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;insert&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.save(userRecord));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä¿®æ”¹æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userRecord å®ä½“å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> ä¿®æ”¹ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;ä¿®æ”¹æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping(&quot;update&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> UserRecord userRecord)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.updateById(userRecord));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ é™¤æ•°æ®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> idList ä¸»é”®ç»“åˆ</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> åˆ é™¤ç»“æœ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(&quot;åˆ é™¤æ•°æ®&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;delete&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> R <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;idList&quot;)</span> List&lt;Long&gt; idList)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> success(<span class=\"built_in\">this</span>.userRecordService.removeByIds(idList));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"äº”ã€Swaggerç•Œé¢æ•ˆæœ\"><a href=\"#äº”ã€Swaggerç•Œé¢æ•ˆæœ\" class=\"headerlink\" title=\"äº”ã€Swaggerç•Œé¢æ•ˆæœ\"></a>äº”ã€Swaggerç•Œé¢æ•ˆæœ</h1><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/2954ce2fd4c4dca470dc4cafd38e2fc3.png\" alt=\"image.png\"></p>\n<p> Swaggerçš„è®¿é—®è·¯å¾„ç”±port&#x2F;swagger-ui.htmlæ”¹æˆäº†port&#x2F;swagger-ui&#x2F; æˆ–port&#x2F;swagger-ui&#x2F;index.html</p>\n<blockquote>\n<p>GitHubåœ°å€ï¼š<a href=\"https://github.com/ruiyeclub/SpringBoot-Hello\">https://github.com/ruiyeclub/SpringBoot-Hello</a></p>\n</blockquote>\n"},{"title":"SpringBootç›‘å¬Redisè¿‡æœŸkey","date":"2024-07-25T11:22:22.000Z","_content":"\n> åœ¨SpringBooté¡¹ç›®ä¸­é…ç½®Redisçš„è¿‡æœŸæé†’ï¼Œé€šè¿‡ä¿®æ”¹`redis.conf`æˆ–å‘½ä»¤è¡Œè®¾ç½®`notify-keyspace-events`ï¼Œå¹¶åˆ›å»ºè‡ªå®šä¹‰çš„Redisæ¶ˆæ¯ç›‘å¬å™¨æ¥å¤„ç†è¿‡æœŸäº‹ä»¶ã€‚\n\n\n\n### ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’\n\n- æ–¹å¼ä¸€ï¼šä¿®æ”¹redis.confé…ç½®æ–‡ä»¶\n\n```shell\n# é»˜è®¤ notify-keyspace-events \"\"\nnotify-keyspace-events Ex\n```\n\n- æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œå¼€å¯\n\n```shell\nCONFIG SET notify-keyspace-events Ex\nCONFIG GET notify-keyspace-events\n```\n\n\n\n### äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\n\n```shell\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-data-redis</artifactId>\n </dependency>\n```\n\n\n\n### ä¸‰ã€é…ç½®configé…ç½®ç±»\n\n```java\n@Configuration\npublic class RedisListenerConfig {\n\n\t@Bean\n\tRedisMessageListenerContainer container(RedisConnectionFactory connectionFactory) {\n\t\tRedisMessageListenerContainer container = new RedisMessageListenerContainer();\n\t\tcontainer.setConnectionFactory(connectionFactory);\n\t\treturn container;\n\t}\n}\n```\n\n\n\n### å››ã€é…ç½®ç›‘å¬ä»£ç \n\n```java\n@Slf4j\n@Component\npublic class KeyExpiredListener extends KeyExpirationEventMessageListener {\n\n    public KeyExpiredListener(RedisMessageListenerContainer listenerContainer) {\n        super(listenerContainer);\n    }\n\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        String channel = new String(message.getChannel(), StandardCharsets.UTF_8);\n        // è¿‡æœŸçš„key\n        String key = new String(message.getBody(), StandardCharsets.UTF_8);\n        log.info(\"redis key è¿‡æœŸï¼špattern={},channel={},key={}\", new String(pattern), channel, key);\n        if (key.equals(INVEST_WS_EXPIRED_KEY)) {\n            // å¤„ç†ä¸šåŠ¡é€»è¾‘...\n        }\n    }\n}\n```","source":"_posts/SpringBootç›‘å¬Redisè¿‡æœŸkey.md","raw":"---\ntitle: SpringBootç›‘å¬Redisè¿‡æœŸkey\ndate: 2024-07-25 19:22:22\ntags:\n---\n\n> åœ¨SpringBooté¡¹ç›®ä¸­é…ç½®Redisçš„è¿‡æœŸæé†’ï¼Œé€šè¿‡ä¿®æ”¹`redis.conf`æˆ–å‘½ä»¤è¡Œè®¾ç½®`notify-keyspace-events`ï¼Œå¹¶åˆ›å»ºè‡ªå®šä¹‰çš„Redisæ¶ˆæ¯ç›‘å¬å™¨æ¥å¤„ç†è¿‡æœŸäº‹ä»¶ã€‚\n\n\n\n### ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’\n\n- æ–¹å¼ä¸€ï¼šä¿®æ”¹redis.confé…ç½®æ–‡ä»¶\n\n```shell\n# é»˜è®¤ notify-keyspace-events \"\"\nnotify-keyspace-events Ex\n```\n\n- æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œå¼€å¯\n\n```shell\nCONFIG SET notify-keyspace-events Ex\nCONFIG GET notify-keyspace-events\n```\n\n\n\n### äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\n\n```shell\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-data-redis</artifactId>\n </dependency>\n```\n\n\n\n### ä¸‰ã€é…ç½®configé…ç½®ç±»\n\n```java\n@Configuration\npublic class RedisListenerConfig {\n\n\t@Bean\n\tRedisMessageListenerContainer container(RedisConnectionFactory connectionFactory) {\n\t\tRedisMessageListenerContainer container = new RedisMessageListenerContainer();\n\t\tcontainer.setConnectionFactory(connectionFactory);\n\t\treturn container;\n\t}\n}\n```\n\n\n\n### å››ã€é…ç½®ç›‘å¬ä»£ç \n\n```java\n@Slf4j\n@Component\npublic class KeyExpiredListener extends KeyExpirationEventMessageListener {\n\n    public KeyExpiredListener(RedisMessageListenerContainer listenerContainer) {\n        super(listenerContainer);\n    }\n\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        String channel = new String(message.getChannel(), StandardCharsets.UTF_8);\n        // è¿‡æœŸçš„key\n        String key = new String(message.getBody(), StandardCharsets.UTF_8);\n        log.info(\"redis key è¿‡æœŸï¼špattern={},channel={},key={}\", new String(pattern), channel, key);\n        if (key.equals(INVEST_WS_EXPIRED_KEY)) {\n            // å¤„ç†ä¸šåŠ¡é€»è¾‘...\n        }\n    }\n}\n```","slug":"SpringBootç›‘å¬Redisè¿‡æœŸkey","published":1,"updated":"2024-07-25T11:22:37.727Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83do000wwen12kmlhsjj","content":"<blockquote>\n<p>åœ¨SpringBooté¡¹ç›®ä¸­é…ç½®Redisçš„è¿‡æœŸæé†’ï¼Œé€šè¿‡ä¿®æ”¹<code>redis.conf</code>æˆ–å‘½ä»¤è¡Œè®¾ç½®<code>notify-keyspace-events</code>ï¼Œå¹¶åˆ›å»ºè‡ªå®šä¹‰çš„Redisæ¶ˆæ¯ç›‘å¬å™¨æ¥å¤„ç†è¿‡æœŸäº‹ä»¶ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€å¼€å¯Redis-keyè¿‡æœŸæé†’\"><a href=\"#ä¸€ã€å¼€å¯Redis-keyè¿‡æœŸæé†’\" class=\"headerlink\" title=\"ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’\"></a>ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’</h3><ul>\n<li>æ–¹å¼ä¸€ï¼šä¿®æ”¹redis.confé…ç½®æ–‡ä»¶</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">é»˜è®¤ notify-keyspace-events <span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\">notify-keyspace-events Ex</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œå¼€å¯</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CONFIG SET notify-keyspace-events Ex</span><br><span class=\"line\">CONFIG GET notify-keyspace-events</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\"><a href=\"#äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\" class=\"headerlink\" title=\"äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\"></a>äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"ä¸‰ã€é…ç½®configé…ç½®ç±»\"><a href=\"#ä¸‰ã€é…ç½®configé…ç½®ç±»\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®configé…ç½®ç±»\"></a>ä¸‰ã€é…ç½®configé…ç½®ç±»</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisListenerConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Bean</span></span><br><span class=\"line\">\tRedisMessageListenerContainer <span class=\"title function_\">container</span><span class=\"params\">(RedisConnectionFactory connectionFactory)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">RedisMessageListenerContainer</span> <span class=\"variable\">container</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RedisMessageListenerContainer</span>();</span><br><span class=\"line\">\t\tcontainer.setConnectionFactory(connectionFactory);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> container;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"å››ã€é…ç½®ç›‘å¬ä»£ç \"><a href=\"#å››ã€é…ç½®ç›‘å¬ä»£ç \" class=\"headerlink\" title=\"å››ã€é…ç½®ç›‘å¬ä»£ç \"></a>å››ã€é…ç½®ç›‘å¬ä»£ç </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">KeyExpiredListener</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">KeyExpirationEventMessageListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">KeyExpiredListener</span><span class=\"params\">(RedisMessageListenerContainer listenerContainer)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(listenerContainer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onMessage</span><span class=\"params\">(Message message, <span class=\"type\">byte</span>[] pattern)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(message.getChannel(), StandardCharsets.UTF_8);</span><br><span class=\"line\">        <span class=\"comment\">// è¿‡æœŸçš„key</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(message.getBody(), StandardCharsets.UTF_8);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;redis key è¿‡æœŸï¼špattern=&#123;&#125;,channel=&#123;&#125;,key=&#123;&#125;&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(pattern), channel, key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (key.equals(INVEST_WS_EXPIRED_KEY)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<blockquote>\n<p>åœ¨SpringBooté¡¹ç›®ä¸­é…ç½®Redisçš„è¿‡æœŸæé†’ï¼Œé€šè¿‡ä¿®æ”¹<code>redis.conf</code>æˆ–å‘½ä»¤è¡Œè®¾ç½®<code>notify-keyspace-events</code>ï¼Œå¹¶åˆ›å»ºè‡ªå®šä¹‰çš„Redisæ¶ˆæ¯ç›‘å¬å™¨æ¥å¤„ç†è¿‡æœŸäº‹ä»¶ã€‚</p>\n</blockquote>\n<h3 id=\"ä¸€ã€å¼€å¯Redis-keyè¿‡æœŸæé†’\"><a href=\"#ä¸€ã€å¼€å¯Redis-keyè¿‡æœŸæé†’\" class=\"headerlink\" title=\"ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’\"></a>ä¸€ã€å¼€å¯Redis keyè¿‡æœŸæé†’</h3><ul>\n<li>æ–¹å¼ä¸€ï¼šä¿®æ”¹redis.confé…ç½®æ–‡ä»¶</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">é»˜è®¤ notify-keyspace-events <span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\">notify-keyspace-events Ex</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œå¼€å¯</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CONFIG SET notify-keyspace-events Ex</span><br><span class=\"line\">CONFIG GET notify-keyspace-events</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\"><a href=\"#äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\" class=\"headerlink\" title=\"äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–\"></a>äºŒã€é¡¹ç›®å¯¼å…¥redisä¾èµ–</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"ä¸‰ã€é…ç½®configé…ç½®ç±»\"><a href=\"#ä¸‰ã€é…ç½®configé…ç½®ç±»\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®configé…ç½®ç±»\"></a>ä¸‰ã€é…ç½®configé…ç½®ç±»</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisListenerConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Bean</span></span><br><span class=\"line\">\tRedisMessageListenerContainer <span class=\"title function_\">container</span><span class=\"params\">(RedisConnectionFactory connectionFactory)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">RedisMessageListenerContainer</span> <span class=\"variable\">container</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RedisMessageListenerContainer</span>();</span><br><span class=\"line\">\t\tcontainer.setConnectionFactory(connectionFactory);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> container;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"å››ã€é…ç½®ç›‘å¬ä»£ç \"><a href=\"#å››ã€é…ç½®ç›‘å¬ä»£ç \" class=\"headerlink\" title=\"å››ã€é…ç½®ç›‘å¬ä»£ç \"></a>å››ã€é…ç½®ç›‘å¬ä»£ç </h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">KeyExpiredListener</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">KeyExpirationEventMessageListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">KeyExpiredListener</span><span class=\"params\">(RedisMessageListenerContainer listenerContainer)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(listenerContainer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onMessage</span><span class=\"params\">(Message message, <span class=\"type\">byte</span>[] pattern)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(message.getChannel(), StandardCharsets.UTF_8);</span><br><span class=\"line\">        <span class=\"comment\">// è¿‡æœŸçš„key</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(message.getBody(), StandardCharsets.UTF_8);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;redis key è¿‡æœŸï¼špattern=&#123;&#125;,channel=&#123;&#125;,key=&#123;&#125;&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(pattern), channel, key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (key.equals(INVEST_WS_EXPIRED_KEY)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘","date":"2022-06-01T01:39:35.000Z","_content":"\nã€€ã€€**fallbackç†”æ–­å™¨å®ç°äº†Feignå®¢æˆ·ç«¯çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“ç½‘ç»œä¸é€šæˆ–è€…è®¿é—®å¤±è´¥æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨fallbackæœåŠ¡é™çº§ç±»ä¸­çš„æ–¹æ³•ã€‚**\n\nå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ï¼Œå…·ä½“çš„æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```java\nCaused by: java.lang.IllegalStateException: No fallback instance of type class com.xxx.xxx.feign.fallback.RemoteUserFallback found for feign client xxx\n```\n\næŠ¥é”™å†…å®¹æ˜æ˜¾æ˜¯æ²¡æ‰¾åˆ°RemoteUserFallBackè¿™ä¸ªç±»\n\n1ã€æ£€æŸ¥é…ç½®æ–‡ä»¶\n\n```xml\nfeign:\n  hystrix:\n    enabled: true # å¼€å¯Feignçš„ç†”æ–­åŠŸèƒ½ é»˜è®¤æ˜¯å…³é—­çš„\n```\n2ã€å¯åŠ¨ç±»ä¸Šéœ€è¦@EnableFeignClientsæ³¨è§£\n\n```java\n@EnableFeignClients(basePackages = {\"com.xxx.åŒ…å\"}) //å¼€å¯Feignå¹¶æ‰«æFeignå®¢æˆ·ç«¯\n```\n\n3ã€Feignå®¢æˆ·ç«¯ç±»ä¸Šä½¿ç”¨@FeignClientï¼Œé€šè¿‡fallbackå±æ€§æ¥æŒ‡æ˜å¯¹åº”ç†”æ–­å™¨çš„ç±»å\n\n```java\n@FeignClient(value = \"æœåŠ¡å\", fallback = RemoteUserFallback.class,) //å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªFeignå®¢æˆ·ç«¯ï¼Œå¹¶æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å\n```\n**4ã€fallbackç†”æ–­å™¨ç±»ä¸Šéœ€è¦åŠ æ³¨è§£@Componentï¼Œç¡®ä¿å¯ä»¥è¢«springæ‰«æ**\n\næˆ‘æŠ¥é”™çš„åŸå› å°±æ˜¯å‡ºç°åœ¨ç¬¬å››æ­¥è¿™é‡Œï¼Œå°½ç®¡æˆ‘åŠ äº†@componentæ³¨è§£ã€‚SpringBootåœ¨å¯åŠ¨çš„æ—¶å€™ ä¼šæ‰«æmainç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…è¿›è¡ŒBeançš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯fallbackç†”æ–­å™¨ç±»å¹¶ä¸åœ¨æˆ‘å¯åŠ¨ç±»çš„å­ç±»ä¸‹é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯é€šè¿‡å¼•å…¥å…¶æ¨¡å—æ¥è°ƒç”¨è¿™é‡Œé¢çš„æ–¹æ³•ã€‚\n\næ‰€ä»¥æœ€åæˆ‘åœ¨å¯åŠ¨ç±»ä¸ŠåŠ äº†@ComponentScanæ³¨è§£ï¼š\n\n```java\n@ComponentScan(basePackages = {\"com.xxx\"})\n```\nOKï¼ŒæˆåŠŸå¯åŠ¨å¹¶è®¿é—®æˆåŠŸã€‚","source":"_posts/SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘.md","raw":"---\ntitle: SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘\ndate: 2022-06-01 09:39:35\ntags:\n---\n\nã€€ã€€**fallbackç†”æ–­å™¨å®ç°äº†Feignå®¢æˆ·ç«¯çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“ç½‘ç»œä¸é€šæˆ–è€…è®¿é—®å¤±è´¥æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨fallbackæœåŠ¡é™çº§ç±»ä¸­çš„æ–¹æ³•ã€‚**\n\nå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ï¼Œå…·ä½“çš„æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š\n\n```java\nCaused by: java.lang.IllegalStateException: No fallback instance of type class com.xxx.xxx.feign.fallback.RemoteUserFallback found for feign client xxx\n```\n\næŠ¥é”™å†…å®¹æ˜æ˜¾æ˜¯æ²¡æ‰¾åˆ°RemoteUserFallBackè¿™ä¸ªç±»\n\n1ã€æ£€æŸ¥é…ç½®æ–‡ä»¶\n\n```xml\nfeign:\n  hystrix:\n    enabled: true # å¼€å¯Feignçš„ç†”æ–­åŠŸèƒ½ é»˜è®¤æ˜¯å…³é—­çš„\n```\n2ã€å¯åŠ¨ç±»ä¸Šéœ€è¦@EnableFeignClientsæ³¨è§£\n\n```java\n@EnableFeignClients(basePackages = {\"com.xxx.åŒ…å\"}) //å¼€å¯Feignå¹¶æ‰«æFeignå®¢æˆ·ç«¯\n```\n\n3ã€Feignå®¢æˆ·ç«¯ç±»ä¸Šä½¿ç”¨@FeignClientï¼Œé€šè¿‡fallbackå±æ€§æ¥æŒ‡æ˜å¯¹åº”ç†”æ–­å™¨çš„ç±»å\n\n```java\n@FeignClient(value = \"æœåŠ¡å\", fallback = RemoteUserFallback.class,) //å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªFeignå®¢æˆ·ç«¯ï¼Œå¹¶æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å\n```\n**4ã€fallbackç†”æ–­å™¨ç±»ä¸Šéœ€è¦åŠ æ³¨è§£@Componentï¼Œç¡®ä¿å¯ä»¥è¢«springæ‰«æ**\n\næˆ‘æŠ¥é”™çš„åŸå› å°±æ˜¯å‡ºç°åœ¨ç¬¬å››æ­¥è¿™é‡Œï¼Œå°½ç®¡æˆ‘åŠ äº†@componentæ³¨è§£ã€‚SpringBootåœ¨å¯åŠ¨çš„æ—¶å€™ ä¼šæ‰«æmainç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…è¿›è¡ŒBeançš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯fallbackç†”æ–­å™¨ç±»å¹¶ä¸åœ¨æˆ‘å¯åŠ¨ç±»çš„å­ç±»ä¸‹é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯é€šè¿‡å¼•å…¥å…¶æ¨¡å—æ¥è°ƒç”¨è¿™é‡Œé¢çš„æ–¹æ³•ã€‚\n\næ‰€ä»¥æœ€åæˆ‘åœ¨å¯åŠ¨ç±»ä¸ŠåŠ äº†@ComponentScanæ³¨è§£ï¼š\n\n```java\n@ComponentScan(basePackages = {\"com.xxx\"})\n```\nOKï¼ŒæˆåŠŸå¯åŠ¨å¹¶è®¿é—®æˆåŠŸã€‚","slug":"SpringCloudä½¿ç”¨FeignæœåŠ¡é€šä¿¡è¸©çš„å‘","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83do000xwen1d9d3356p","content":"<p>ã€€ã€€<strong>fallbackç†”æ–­å™¨å®ç°äº†Feignå®¢æˆ·ç«¯çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“ç½‘ç»œä¸é€šæˆ–è€…è®¿é—®å¤±è´¥æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨fallbackæœåŠ¡é™çº§ç±»ä¸­çš„æ–¹æ³•ã€‚</strong></p>\n<p>å¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ï¼Œå…·ä½“çš„æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caused by: java.lang.IllegalStateException: No fallback instance of type <span class=\"keyword\">class</span> <span class=\"title class_\">com</span>.xxx.xxx.feign.fallback.RemoteUserFallback found <span class=\"keyword\">for</span> feign client xxx</span><br></pre></td></tr></table></figure>\n\n<p>æŠ¥é”™å†…å®¹æ˜æ˜¾æ˜¯æ²¡æ‰¾åˆ°RemoteUserFallBackè¿™ä¸ªç±»</p>\n<p>1ã€æ£€æŸ¥é…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">feign:</span><br><span class=\"line\">  hystrix:</span><br><span class=\"line\">    enabled: true # å¼€å¯Feignçš„ç†”æ–­åŠŸèƒ½ é»˜è®¤æ˜¯å…³é—­çš„</span><br></pre></td></tr></table></figure>\n<p>2ã€å¯åŠ¨ç±»ä¸Šéœ€è¦@EnableFeignClientsæ³¨è§£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableFeignClients(basePackages = &#123;&quot;com.xxx.åŒ…å&quot;&#125;)</span> <span class=\"comment\">//å¼€å¯Feignå¹¶æ‰«æFeignå®¢æˆ·ç«¯</span></span><br></pre></td></tr></table></figure>\n\n<p>3ã€Feignå®¢æˆ·ç«¯ç±»ä¸Šä½¿ç”¨@FeignClientï¼Œé€šè¿‡fallbackå±æ€§æ¥æŒ‡æ˜å¯¹åº”ç†”æ–­å™¨çš„ç±»å</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FeignClient(value = &quot;æœåŠ¡å&quot;, fallback = RemoteUserFallback.class,)</span> <span class=\"comment\">//å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªFeignå®¢æˆ·ç«¯ï¼Œå¹¶æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å</span></span><br></pre></td></tr></table></figure>\n<p><strong>4ã€fallbackç†”æ–­å™¨ç±»ä¸Šéœ€è¦åŠ æ³¨è§£@Componentï¼Œç¡®ä¿å¯ä»¥è¢«springæ‰«æ</strong></p>\n<p>æˆ‘æŠ¥é”™çš„åŸå› å°±æ˜¯å‡ºç°åœ¨ç¬¬å››æ­¥è¿™é‡Œï¼Œå°½ç®¡æˆ‘åŠ äº†@componentæ³¨è§£ã€‚SpringBootåœ¨å¯åŠ¨çš„æ—¶å€™ ä¼šæ‰«æmainç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…è¿›è¡ŒBeançš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯fallbackç†”æ–­å™¨ç±»å¹¶ä¸åœ¨æˆ‘å¯åŠ¨ç±»çš„å­ç±»ä¸‹é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯é€šè¿‡å¼•å…¥å…¶æ¨¡å—æ¥è°ƒç”¨è¿™é‡Œé¢çš„æ–¹æ³•ã€‚</p>\n<p>æ‰€ä»¥æœ€åæˆ‘åœ¨å¯åŠ¨ç±»ä¸ŠåŠ äº†@ComponentScanæ³¨è§£ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ComponentScan(basePackages = &#123;&quot;com.xxx&quot;&#125;)</span></span><br></pre></td></tr></table></figure>\n<p>OKï¼ŒæˆåŠŸå¯åŠ¨å¹¶è®¿é—®æˆåŠŸã€‚</p>\n","excerpt":"","more":"<p>ã€€ã€€<strong>fallbackç†”æ–­å™¨å®ç°äº†Feignå®¢æˆ·ç«¯çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“ç½‘ç»œä¸é€šæˆ–è€…è®¿é—®å¤±è´¥æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨fallbackæœåŠ¡é™çº§ç±»ä¸­çš„æ–¹æ³•ã€‚</strong></p>\n<p>å¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ï¼Œå…·ä½“çš„æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Caused by: java.lang.IllegalStateException: No fallback instance of type <span class=\"keyword\">class</span> <span class=\"title class_\">com</span>.xxx.xxx.feign.fallback.RemoteUserFallback found <span class=\"keyword\">for</span> feign client xxx</span><br></pre></td></tr></table></figure>\n\n<p>æŠ¥é”™å†…å®¹æ˜æ˜¾æ˜¯æ²¡æ‰¾åˆ°RemoteUserFallBackè¿™ä¸ªç±»</p>\n<p>1ã€æ£€æŸ¥é…ç½®æ–‡ä»¶</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">feign:</span><br><span class=\"line\">  hystrix:</span><br><span class=\"line\">    enabled: true # å¼€å¯Feignçš„ç†”æ–­åŠŸèƒ½ é»˜è®¤æ˜¯å…³é—­çš„</span><br></pre></td></tr></table></figure>\n<p>2ã€å¯åŠ¨ç±»ä¸Šéœ€è¦@EnableFeignClientsæ³¨è§£</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableFeignClients(basePackages = &#123;&quot;com.xxx.åŒ…å&quot;&#125;)</span> <span class=\"comment\">//å¼€å¯Feignå¹¶æ‰«æFeignå®¢æˆ·ç«¯</span></span><br></pre></td></tr></table></figure>\n\n<p>3ã€Feignå®¢æˆ·ç«¯ç±»ä¸Šä½¿ç”¨@FeignClientï¼Œé€šè¿‡fallbackå±æ€§æ¥æŒ‡æ˜å¯¹åº”ç†”æ–­å™¨çš„ç±»å</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FeignClient(value = &quot;æœåŠ¡å&quot;, fallback = RemoteUserFallback.class,)</span> <span class=\"comment\">//å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªFeignå®¢æˆ·ç«¯ï¼Œå¹¶æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å</span></span><br></pre></td></tr></table></figure>\n<p><strong>4ã€fallbackç†”æ–­å™¨ç±»ä¸Šéœ€è¦åŠ æ³¨è§£@Componentï¼Œç¡®ä¿å¯ä»¥è¢«springæ‰«æ</strong></p>\n<p>æˆ‘æŠ¥é”™çš„åŸå› å°±æ˜¯å‡ºç°åœ¨ç¬¬å››æ­¥è¿™é‡Œï¼Œå°½ç®¡æˆ‘åŠ äº†@componentæ³¨è§£ã€‚SpringBootåœ¨å¯åŠ¨çš„æ—¶å€™ ä¼šæ‰«æmainç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…è¿›è¡ŒBeançš„å®ä¾‹åŒ–ï¼Œä½†æ˜¯fallbackç†”æ–­å™¨ç±»å¹¶ä¸åœ¨æˆ‘å¯åŠ¨ç±»çš„å­ç±»ä¸‹é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯é€šè¿‡å¼•å…¥å…¶æ¨¡å—æ¥è°ƒç”¨è¿™é‡Œé¢çš„æ–¹æ³•ã€‚</p>\n<p>æ‰€ä»¥æœ€åæˆ‘åœ¨å¯åŠ¨ç±»ä¸ŠåŠ äº†@ComponentScanæ³¨è§£ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ComponentScan(basePackages = &#123;&quot;com.xxx&quot;&#125;)</span></span><br></pre></td></tr></table></figure>\n<p>OKï¼ŒæˆåŠŸå¯åŠ¨å¹¶è®¿é—®æˆåŠŸã€‚</p>\n"},{"title":"ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿","date":"2025-01-15T06:22:14.000Z","_content":"\n> ğŸ“è®°å½•ä¸€ä¸‹ä½¿ç”¨1panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿ï¼Œä¹‹å‰åŸºæœ¬æ˜¯ä½¿ç”¨æ‰‹æ“å‘½ä»¤æ„å»ºæœåŠ¡ï¼Œäº†è§£è¿‡å®å¡”é¢æ¿ï¼Œæ„Ÿè§‰å¤ªè¿‡è‡ƒè‚¿ä¸”éœ€è¦æ³¨å†Œè´¦æˆ·ï¼Œåç»­è€ƒè™‘æœåŠ¡éƒ¨ç½²éƒ½æ˜¯ç”¨1panelé¢æ¿è¿›è¡Œæ“ä½œã€‚\n\nå®˜æ–¹æ–‡æ¡£ï¼šhttps://1panel.cn/docs/\n\n## ä¸€ã€äº§å“ä»‹ç»\n\n1Panel æ˜¯ä¸€ä¸ªç°ä»£åŒ–ã€å¼€æºçš„ Linux æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ã€‚\n![UIå±•ç¤º](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/overview.png)\n\n## äºŒã€å®‰è£…éƒ¨ç½²\n\n1. Ubuntuå®‰è£…ï¼š\n\n```\ncurl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh && sudo bash quick_start.sh\n```\n\n![image-20250115134821023](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115134821023.png)\n\n2. é€šè¿‡è®¿é—®åœ°å€å’Œé¢æ¿ç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•\n\n## ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\n\n1. å‰ç«¯é¡µé¢åˆ›å»ºç½‘å€åé€‰æ‹©é™æ€ç½‘å€è¿›è¡Œé…ç½®ï¼Œåå°é€‰æ‹©åå‘ä»£ç†\n\n![image-20250115140517787](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115140517787.png)\n\n2. é€šè¿‡ç½‘å€è®¾ç½®é…ç½®HTTPSå’Œè®¾ç½®NGINX\n\n![å›¾åƒ_å‰¯æœ¬](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E5%9B%BE%E5%83%8F_%E5%89%AF%E6%9C%AC.png)\n\n## å››ã€è®¡åˆ’ä»»åŠ¡\n\nå¯ä»¥é€šè¿‡linuxå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œshellç­‰è„šæœ¬å‘½ä»¤\n\n![æˆªå±2025-01-15 14.16.51](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%88%AA%E5%B1%8F2025-01-15%2014.16.51.png)\n","source":"_posts/ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿.md","raw":"---\ntitle: ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿\ndate: 2025-01-15 14:22:14\ntags:\n---\n\n> ğŸ“è®°å½•ä¸€ä¸‹ä½¿ç”¨1panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿ï¼Œä¹‹å‰åŸºæœ¬æ˜¯ä½¿ç”¨æ‰‹æ“å‘½ä»¤æ„å»ºæœåŠ¡ï¼Œäº†è§£è¿‡å®å¡”é¢æ¿ï¼Œæ„Ÿè§‰å¤ªè¿‡è‡ƒè‚¿ä¸”éœ€è¦æ³¨å†Œè´¦æˆ·ï¼Œåç»­è€ƒè™‘æœåŠ¡éƒ¨ç½²éƒ½æ˜¯ç”¨1panelé¢æ¿è¿›è¡Œæ“ä½œã€‚\n\nå®˜æ–¹æ–‡æ¡£ï¼šhttps://1panel.cn/docs/\n\n## ä¸€ã€äº§å“ä»‹ç»\n\n1Panel æ˜¯ä¸€ä¸ªç°ä»£åŒ–ã€å¼€æºçš„ Linux æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ã€‚\n![UIå±•ç¤º](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/overview.png)\n\n## äºŒã€å®‰è£…éƒ¨ç½²\n\n1. Ubuntuå®‰è£…ï¼š\n\n```\ncurl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh && sudo bash quick_start.sh\n```\n\n![image-20250115134821023](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115134821023.png)\n\n2. é€šè¿‡è®¿é—®åœ°å€å’Œé¢æ¿ç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•\n\n## ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\n\n1. å‰ç«¯é¡µé¢åˆ›å»ºç½‘å€åé€‰æ‹©é™æ€ç½‘å€è¿›è¡Œé…ç½®ï¼Œåå°é€‰æ‹©åå‘ä»£ç†\n\n![image-20250115140517787](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115140517787.png)\n\n2. é€šè¿‡ç½‘å€è®¾ç½®é…ç½®HTTPSå’Œè®¾ç½®NGINX\n\n![å›¾åƒ_å‰¯æœ¬](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E5%9B%BE%E5%83%8F_%E5%89%AF%E6%9C%AC.png)\n\n## å››ã€è®¡åˆ’ä»»åŠ¡\n\nå¯ä»¥é€šè¿‡linuxå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œshellç­‰è„šæœ¬å‘½ä»¤\n\n![æˆªå±2025-01-15 14.16.51](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%88%AA%E5%B1%8F2025-01-15%2014.16.51.png)\n","slug":"ä½¿ç”¨1Panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿","published":1,"updated":"2025-01-15T06:22:53.369Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83do000ywen182vg2eg4","content":"<blockquote>\n<p>ğŸ“è®°å½•ä¸€ä¸‹ä½¿ç”¨1panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿ï¼Œä¹‹å‰åŸºæœ¬æ˜¯ä½¿ç”¨æ‰‹æ“å‘½ä»¤æ„å»ºæœåŠ¡ï¼Œäº†è§£è¿‡å®å¡”é¢æ¿ï¼Œæ„Ÿè§‰å¤ªè¿‡è‡ƒè‚¿ä¸”éœ€è¦æ³¨å†Œè´¦æˆ·ï¼Œåç»­è€ƒè™‘æœåŠ¡éƒ¨ç½²éƒ½æ˜¯ç”¨1panelé¢æ¿è¿›è¡Œæ“ä½œã€‚</p>\n</blockquote>\n<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://1panel.cn/docs/\">https://1panel.cn/docs/</a></p>\n<h2 id=\"ä¸€ã€äº§å“ä»‹ç»\"><a href=\"#ä¸€ã€äº§å“ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€äº§å“ä»‹ç»\"></a>ä¸€ã€äº§å“ä»‹ç»</h2><p>1Panel æ˜¯ä¸€ä¸ªç°ä»£åŒ–ã€å¼€æºçš„ Linux æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/overview.png\" alt=\"UIå±•ç¤º\"></p>\n<h2 id=\"äºŒã€å®‰è£…éƒ¨ç½²\"><a href=\"#äºŒã€å®‰è£…éƒ¨ç½²\" class=\"headerlink\" title=\"äºŒã€å®‰è£…éƒ¨ç½²\"></a>äºŒã€å®‰è£…éƒ¨ç½²</h2><ol>\n<li>Ubuntuå®‰è£…ï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh &amp;&amp; sudo bash quick_start.sh</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115134821023.png\" alt=\"image-20250115134821023\"></p>\n<ol start=\"2\">\n<li>é€šè¿‡è®¿é—®åœ°å€å’Œé¢æ¿ç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•</li>\n</ol>\n<h2 id=\"ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\"><a href=\"#ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\" class=\"headerlink\" title=\"ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\"></a>ä¸‰ã€åŠŸèƒ½ä½¿ç”¨</h2><ol>\n<li>å‰ç«¯é¡µé¢åˆ›å»ºç½‘å€åé€‰æ‹©é™æ€ç½‘å€è¿›è¡Œé…ç½®ï¼Œåå°é€‰æ‹©åå‘ä»£ç†</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115140517787.png\" alt=\"image-20250115140517787\"></p>\n<ol start=\"2\">\n<li>é€šè¿‡ç½‘å€è®¾ç½®é…ç½®HTTPSå’Œè®¾ç½®NGINX</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E5%9B%BE%E5%83%8F_%E5%89%AF%E6%9C%AC.png\" alt=\"å›¾åƒ_å‰¯æœ¬\"></p>\n<h2 id=\"å››ã€è®¡åˆ’ä»»åŠ¡\"><a href=\"#å››ã€è®¡åˆ’ä»»åŠ¡\" class=\"headerlink\" title=\"å››ã€è®¡åˆ’ä»»åŠ¡\"></a>å››ã€è®¡åˆ’ä»»åŠ¡</h2><p>å¯ä»¥é€šè¿‡linuxå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œshellç­‰è„šæœ¬å‘½ä»¤</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%88%AA%E5%B1%8F2025-01-15%2014.16.51.png\" alt=\"æˆªå±2025-01-15 14.16.51\"></p>\n","excerpt":"","more":"<blockquote>\n<p>ğŸ“è®°å½•ä¸€ä¸‹ä½¿ç”¨1panelä½œä¸ºæœåŠ¡å™¨ç®¡ç†é¢æ¿ï¼Œä¹‹å‰åŸºæœ¬æ˜¯ä½¿ç”¨æ‰‹æ“å‘½ä»¤æ„å»ºæœåŠ¡ï¼Œäº†è§£è¿‡å®å¡”é¢æ¿ï¼Œæ„Ÿè§‰å¤ªè¿‡è‡ƒè‚¿ä¸”éœ€è¦æ³¨å†Œè´¦æˆ·ï¼Œåç»­è€ƒè™‘æœåŠ¡éƒ¨ç½²éƒ½æ˜¯ç”¨1panelé¢æ¿è¿›è¡Œæ“ä½œã€‚</p>\n</blockquote>\n<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href=\"https://1panel.cn/docs/\">https://1panel.cn/docs/</a></p>\n<h2 id=\"ä¸€ã€äº§å“ä»‹ç»\"><a href=\"#ä¸€ã€äº§å“ä»‹ç»\" class=\"headerlink\" title=\"ä¸€ã€äº§å“ä»‹ç»\"></a>ä¸€ã€äº§å“ä»‹ç»</h2><p>1Panel æ˜¯ä¸€ä¸ªç°ä»£åŒ–ã€å¼€æºçš„ Linux æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ã€‚<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/overview.png\" alt=\"UIå±•ç¤º\"></p>\n<h2 id=\"äºŒã€å®‰è£…éƒ¨ç½²\"><a href=\"#äºŒã€å®‰è£…éƒ¨ç½²\" class=\"headerlink\" title=\"äºŒã€å®‰è£…éƒ¨ç½²\"></a>äºŒã€å®‰è£…éƒ¨ç½²</h2><ol>\n<li>Ubuntuå®‰è£…ï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh &amp;&amp; sudo bash quick_start.sh</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115134821023.png\" alt=\"image-20250115134821023\"></p>\n<ol start=\"2\">\n<li>é€šè¿‡è®¿é—®åœ°å€å’Œé¢æ¿ç”¨æˆ·å¯†ç è¿›è¡Œç™»å½•</li>\n</ol>\n<h2 id=\"ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\"><a href=\"#ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\" class=\"headerlink\" title=\"ä¸‰ã€åŠŸèƒ½ä½¿ç”¨\"></a>ä¸‰ã€åŠŸèƒ½ä½¿ç”¨</h2><ol>\n<li>å‰ç«¯é¡µé¢åˆ›å»ºç½‘å€åé€‰æ‹©é™æ€ç½‘å€è¿›è¡Œé…ç½®ï¼Œåå°é€‰æ‹©åå‘ä»£ç†</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20250115140517787.png\" alt=\"image-20250115140517787\"></p>\n<ol start=\"2\">\n<li>é€šè¿‡ç½‘å€è®¾ç½®é…ç½®HTTPSå’Œè®¾ç½®NGINX</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E5%9B%BE%E5%83%8F_%E5%89%AF%E6%9C%AC.png\" alt=\"å›¾åƒ_å‰¯æœ¬\"></p>\n<h2 id=\"å››ã€è®¡åˆ’ä»»åŠ¡\"><a href=\"#å››ã€è®¡åˆ’ä»»åŠ¡\" class=\"headerlink\" title=\"å››ã€è®¡åˆ’ä»»åŠ¡\"></a>å››ã€è®¡åˆ’ä»»åŠ¡</h2><p>å¯ä»¥é€šè¿‡linuxå®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ‰§è¡Œshellç­‰è„šæœ¬å‘½ä»¤</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/%E6%88%AA%E5%B1%8F2025-01-15%2014.16.51.png\" alt=\"æˆªå±2025-01-15 14.16.51\"></p>\n"},{"title":"ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡","date":"2025-04-01T14:32:07.000Z","_content":"\n> åœ¨Javaä¸­ä½¿ç”¨Rediså’ŒRedisTemplateæ¥ç»Ÿè®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ï¼ˆUVï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚ä¸‹é¢æˆ‘å°†æä¾›ä¸€ä¸ªå®Œæ•´çš„å®ç°æ–¹æ¡ˆã€‚\n\n## 1. è®¾è®¡æ€è·¯\n\nâ€¢ **è®¿é—®é‡(PV)**ï¼šä½¿ç”¨Redisçš„INCRå‘½ä»¤ç»Ÿè®¡æ€»è®¿é—®æ¬¡æ•°\nâ€¢ **è®¿é—®äººæ•°(UV)**ï¼šä½¿ç”¨Redisçš„HyperLogLogæ•°æ®ç»“æ„ç»Ÿè®¡ç‹¬ç«‹è®¿å®¢æ•°\nâ€¢ **è¿‡æœŸæ—¶é—´**ï¼šè®¾ç½®å½“æ—¥24ç‚¹è‡ªåŠ¨è¿‡æœŸ\n\n## 2. å®ç°ä»£ç \n\n```java\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.data.redis.core.ValueOperations;\nimport org.springframework.stereotype.Service;\n\nimport java.time.LocalDate;\nimport java.time.ZoneId;\nimport java.time.ZonedDateTime;\nimport java.util.concurrent.TimeUnit;\n\n@Service\npublic class VisitStatisticsService {\n\n    private final RedisTemplate<String, String> redisTemplate;\n\n    public VisitStatisticsService(RedisTemplate<String, String> redisTemplate) {\n        this.redisTemplate = redisTemplate;\n    }\n\n    // è·å–å½“æ—¥PVçš„key\n    private String getTodayPVKey() {\n        return \"stat:pv:\" + LocalDate.now().toString();\n    }\n\n    // è·å–å½“æ—¥UVçš„key\n    private String getTodayUVKey() {\n        return \"stat:uv:\" + LocalDate.now().toString();\n    }\n\n    // è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°ï¼ˆåˆ°24ç‚¹çš„ç§’æ•°ï¼‰\n    private long getRemainingSecondsToday() {\n        ZonedDateTime now = ZonedDateTime.now(ZoneId.systemDefault());\n        ZonedDateTime midnight = now.toLocalDate().plusDays(1).atStartOfDay(ZoneId.systemDefault());\n        return midnight.toEpochSecond() - now.toEpochSecond();\n    }\n\n    /**\n     * è®°å½•è®¿é—®\n     * @param userId ç”¨æˆ·IDï¼ˆå¯ä»¥ä¸ºIPåœ°å€æˆ–å…¶ä»–å”¯ä¸€æ ‡è¯†ï¼‰\n     */\n    public void recordVisit(String userId) {\n        // è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°\n        long remainingSeconds = getRemainingSecondsToday();\n        \n        // è®°å½•PVï¼ˆè®¿é—®é‡ï¼‰\n        ValueOperations<String, String> valueOps = redisTemplate.opsForValue();\n        String pvKey = getTodayPVKey();\n        valueOps.increment(pvKey);\n        redisTemplate.expire(pvKey, remainingSeconds, TimeUnit.SECONDS);\n        \n        // è®°å½•UVï¼ˆç‹¬ç«‹è®¿å®¢ï¼‰\n        String uvKey = getTodayUVKey();\n        redisTemplate.opsForHyperLogLog().add(uvKey, userId);\n        redisTemplate.expire(uvKey, remainingSeconds, TimeUnit.SECONDS);\n    }\n\n    /**\n     * è·å–å½“æ—¥è®¿é—®é‡(PV)\n     */\n    public Long getTodayPV() {\n        String pvKey = getTodayPVKey();\n        String value = redisTemplate.opsForValue().get(pvKey);\n        return value == null ? 0L : Long.parseLong(value);\n    }\n\n    /**\n     * è·å–å½“æ—¥è®¿é—®äººæ•°(UV)\n     */\n    public Long getTodayUV() {\n        String uvKey = getTodayUVKey();\n        return redisTemplate.opsForHyperLogLog().size(uvKey);\n    }\n\n    /**\n     * è·å–å†å²æŸå¤©çš„è®¿é—®é‡(PV)\n     * @param date æ—¥æœŸ\n     */\n    public Long getPVByDate(LocalDate date) {\n        String pvKey = \"stat:pv:\" + date.toString();\n        String value = redisTemplate.opsForValue().get(pvKey);\n        return value == null ? 0L : Long.parseLong(value);\n    }\n\n    /**\n     * è·å–å†å²æŸå¤©çš„è®¿é—®äººæ•°(UV)\n     * @param date æ—¥æœŸ\n     */\n    public Long getUVByDate(LocalDate date) {\n        String uvKey = \"stat:uv:\" + date.toString();\n        return redisTemplate.opsForHyperLogLog().size(uvKey);\n    }\n}\n```\n\n## 3. ä½¿ç”¨ç¤ºä¾‹\n\n```java\n@RestController\n@RequestMapping(\"/api/visit\")\npublic class VisitController {\n\n    private final VisitStatisticsService visitStatisticsService;\n\n    public VisitController(VisitStatisticsService visitStatisticsService) {\n        this.visitStatisticsService = visitStatisticsService;\n    }\n\n    @GetMapping(\"/record\")\n    public String recordVisit(@RequestParam String userId) {\n        visitStatisticsService.recordVisit(userId);\n        return \"Visit recorded for user: \" + userId;\n    }\n\n    @GetMapping(\"/stats\")\n    public Map<String, Object> getStats() {\n        Map<String, Object> result = new HashMap<>();\n        result.put(\"pv\", visitStatisticsService.getTodayPV());\n        result.put(\"uv\", visitStatisticsService.getTodayUV());\n        return result;\n    }\n}\n```\n\n## 4. è®¾è®¡è¯´æ˜\n\n1. **PVç»Ÿè®¡**ï¼š\n   â€¢ ä½¿ç”¨ç®€å•çš„è®¡æ•°å™¨ï¼ˆINCRå‘½ä»¤ï¼‰\n   â€¢ æ¯ä¸ªè®¿é—®è¯·æ±‚è°ƒç”¨ä¸€æ¬¡INCR\n   â€¢ é”®æ ¼å¼ï¼š`stat:pv:yyyy-MM-dd`\n\n2. **UVç»Ÿè®¡**ï¼š\n   â€¢ ä½¿ç”¨HyperLogLogæ•°æ®ç»“æ„\n   â€¢ å†…å­˜å ç”¨å°ï¼ˆæ¯ä¸ªHyperLogLogçº¦12KBï¼‰\n   â€¢ è¯¯å·®ç‡çº¦0.81%\n   â€¢ é”®æ ¼å¼ï¼š`stat:uv:yyyy-MM-dd`\n\n3. **è¿‡æœŸæ—¶é—´**ï¼š\n   â€¢ è‡ªåŠ¨è®¡ç®—åˆ°å½“å¤©24ç‚¹çš„å‰©ä½™ç§’æ•°\n   â€¢ è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´\n   â€¢ é¿å…æ•°æ®æ— é™å¢é•¿\n\n4. **æ‰©å±•æ€§**ï¼š\n   â€¢ å¯ä»¥è½»æ¾æ‰©å±•ä¸ºæŒ‰å°æ—¶ã€å‘¨ã€æœˆç»Ÿè®¡\n   â€¢ å¯ä»¥æ·»åŠ ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆå¦‚è®¿é—®é¡µé¢ã€åœç•™æ—¶é—´ç­‰ï¼‰\n\n## 5. æ€§èƒ½ä¼˜åŒ–\n\n1. **æ‰¹é‡æ“ä½œ**ï¼šå¦‚æœæœ‰æ‰¹é‡è®°å½•éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨pipelineæé«˜æ€§èƒ½\n2. **æŒä¹…åŒ–**ï¼šå¦‚æœéœ€è¦é•¿æœŸä¿å­˜æ•°æ®ï¼Œå¯ä»¥å®šæœŸå°†Redisæ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“\n3. **åˆ†å¸ƒå¼**ï¼šæ­¤æ–¹æ¡ˆå¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼ç¯å¢ƒ\n\n## 6. æ³¨æ„äº‹é¡¹\n\n1. HyperLogLogæœ‰çº¦0.81%çš„è¯¯å·®ç‡ï¼Œå¦‚æœè¦æ±‚ç²¾ç¡®è®¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨Setæ•°æ®ç»“æ„ï¼ˆä½†å†…å­˜æ¶ˆè€—æ›´å¤§ï¼‰\n2. Redisé‡å¯å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œé‡è¦æ•°æ®åº”è€ƒè™‘æŒä¹…åŒ–æ–¹æ¡ˆ\n3. åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒINCRå‘½ä»¤æ˜¯åŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒå¹¶å‘é—®é¢˜\n\nè¿™ä¸ªå®ç°æ–¹æ¡ˆç®€å•é«˜æ•ˆï¼Œé€‚åˆå¤§å¤šæ•°Webåº”ç”¨çš„è®¿é—®ç»Ÿè®¡éœ€æ±‚ã€‚\n","source":"_posts/ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡.md","raw":"---\ntitle: ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡\ndate: 2025-04-01 22:32:07\ntags:\n---\n\n> åœ¨Javaä¸­ä½¿ç”¨Rediså’ŒRedisTemplateæ¥ç»Ÿè®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ï¼ˆUVï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚ä¸‹é¢æˆ‘å°†æä¾›ä¸€ä¸ªå®Œæ•´çš„å®ç°æ–¹æ¡ˆã€‚\n\n## 1. è®¾è®¡æ€è·¯\n\nâ€¢ **è®¿é—®é‡(PV)**ï¼šä½¿ç”¨Redisçš„INCRå‘½ä»¤ç»Ÿè®¡æ€»è®¿é—®æ¬¡æ•°\nâ€¢ **è®¿é—®äººæ•°(UV)**ï¼šä½¿ç”¨Redisçš„HyperLogLogæ•°æ®ç»“æ„ç»Ÿè®¡ç‹¬ç«‹è®¿å®¢æ•°\nâ€¢ **è¿‡æœŸæ—¶é—´**ï¼šè®¾ç½®å½“æ—¥24ç‚¹è‡ªåŠ¨è¿‡æœŸ\n\n## 2. å®ç°ä»£ç \n\n```java\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.data.redis.core.ValueOperations;\nimport org.springframework.stereotype.Service;\n\nimport java.time.LocalDate;\nimport java.time.ZoneId;\nimport java.time.ZonedDateTime;\nimport java.util.concurrent.TimeUnit;\n\n@Service\npublic class VisitStatisticsService {\n\n    private final RedisTemplate<String, String> redisTemplate;\n\n    public VisitStatisticsService(RedisTemplate<String, String> redisTemplate) {\n        this.redisTemplate = redisTemplate;\n    }\n\n    // è·å–å½“æ—¥PVçš„key\n    private String getTodayPVKey() {\n        return \"stat:pv:\" + LocalDate.now().toString();\n    }\n\n    // è·å–å½“æ—¥UVçš„key\n    private String getTodayUVKey() {\n        return \"stat:uv:\" + LocalDate.now().toString();\n    }\n\n    // è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°ï¼ˆåˆ°24ç‚¹çš„ç§’æ•°ï¼‰\n    private long getRemainingSecondsToday() {\n        ZonedDateTime now = ZonedDateTime.now(ZoneId.systemDefault());\n        ZonedDateTime midnight = now.toLocalDate().plusDays(1).atStartOfDay(ZoneId.systemDefault());\n        return midnight.toEpochSecond() - now.toEpochSecond();\n    }\n\n    /**\n     * è®°å½•è®¿é—®\n     * @param userId ç”¨æˆ·IDï¼ˆå¯ä»¥ä¸ºIPåœ°å€æˆ–å…¶ä»–å”¯ä¸€æ ‡è¯†ï¼‰\n     */\n    public void recordVisit(String userId) {\n        // è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°\n        long remainingSeconds = getRemainingSecondsToday();\n        \n        // è®°å½•PVï¼ˆè®¿é—®é‡ï¼‰\n        ValueOperations<String, String> valueOps = redisTemplate.opsForValue();\n        String pvKey = getTodayPVKey();\n        valueOps.increment(pvKey);\n        redisTemplate.expire(pvKey, remainingSeconds, TimeUnit.SECONDS);\n        \n        // è®°å½•UVï¼ˆç‹¬ç«‹è®¿å®¢ï¼‰\n        String uvKey = getTodayUVKey();\n        redisTemplate.opsForHyperLogLog().add(uvKey, userId);\n        redisTemplate.expire(uvKey, remainingSeconds, TimeUnit.SECONDS);\n    }\n\n    /**\n     * è·å–å½“æ—¥è®¿é—®é‡(PV)\n     */\n    public Long getTodayPV() {\n        String pvKey = getTodayPVKey();\n        String value = redisTemplate.opsForValue().get(pvKey);\n        return value == null ? 0L : Long.parseLong(value);\n    }\n\n    /**\n     * è·å–å½“æ—¥è®¿é—®äººæ•°(UV)\n     */\n    public Long getTodayUV() {\n        String uvKey = getTodayUVKey();\n        return redisTemplate.opsForHyperLogLog().size(uvKey);\n    }\n\n    /**\n     * è·å–å†å²æŸå¤©çš„è®¿é—®é‡(PV)\n     * @param date æ—¥æœŸ\n     */\n    public Long getPVByDate(LocalDate date) {\n        String pvKey = \"stat:pv:\" + date.toString();\n        String value = redisTemplate.opsForValue().get(pvKey);\n        return value == null ? 0L : Long.parseLong(value);\n    }\n\n    /**\n     * è·å–å†å²æŸå¤©çš„è®¿é—®äººæ•°(UV)\n     * @param date æ—¥æœŸ\n     */\n    public Long getUVByDate(LocalDate date) {\n        String uvKey = \"stat:uv:\" + date.toString();\n        return redisTemplate.opsForHyperLogLog().size(uvKey);\n    }\n}\n```\n\n## 3. ä½¿ç”¨ç¤ºä¾‹\n\n```java\n@RestController\n@RequestMapping(\"/api/visit\")\npublic class VisitController {\n\n    private final VisitStatisticsService visitStatisticsService;\n\n    public VisitController(VisitStatisticsService visitStatisticsService) {\n        this.visitStatisticsService = visitStatisticsService;\n    }\n\n    @GetMapping(\"/record\")\n    public String recordVisit(@RequestParam String userId) {\n        visitStatisticsService.recordVisit(userId);\n        return \"Visit recorded for user: \" + userId;\n    }\n\n    @GetMapping(\"/stats\")\n    public Map<String, Object> getStats() {\n        Map<String, Object> result = new HashMap<>();\n        result.put(\"pv\", visitStatisticsService.getTodayPV());\n        result.put(\"uv\", visitStatisticsService.getTodayUV());\n        return result;\n    }\n}\n```\n\n## 4. è®¾è®¡è¯´æ˜\n\n1. **PVç»Ÿè®¡**ï¼š\n   â€¢ ä½¿ç”¨ç®€å•çš„è®¡æ•°å™¨ï¼ˆINCRå‘½ä»¤ï¼‰\n   â€¢ æ¯ä¸ªè®¿é—®è¯·æ±‚è°ƒç”¨ä¸€æ¬¡INCR\n   â€¢ é”®æ ¼å¼ï¼š`stat:pv:yyyy-MM-dd`\n\n2. **UVç»Ÿè®¡**ï¼š\n   â€¢ ä½¿ç”¨HyperLogLogæ•°æ®ç»“æ„\n   â€¢ å†…å­˜å ç”¨å°ï¼ˆæ¯ä¸ªHyperLogLogçº¦12KBï¼‰\n   â€¢ è¯¯å·®ç‡çº¦0.81%\n   â€¢ é”®æ ¼å¼ï¼š`stat:uv:yyyy-MM-dd`\n\n3. **è¿‡æœŸæ—¶é—´**ï¼š\n   â€¢ è‡ªåŠ¨è®¡ç®—åˆ°å½“å¤©24ç‚¹çš„å‰©ä½™ç§’æ•°\n   â€¢ è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´\n   â€¢ é¿å…æ•°æ®æ— é™å¢é•¿\n\n4. **æ‰©å±•æ€§**ï¼š\n   â€¢ å¯ä»¥è½»æ¾æ‰©å±•ä¸ºæŒ‰å°æ—¶ã€å‘¨ã€æœˆç»Ÿè®¡\n   â€¢ å¯ä»¥æ·»åŠ ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆå¦‚è®¿é—®é¡µé¢ã€åœç•™æ—¶é—´ç­‰ï¼‰\n\n## 5. æ€§èƒ½ä¼˜åŒ–\n\n1. **æ‰¹é‡æ“ä½œ**ï¼šå¦‚æœæœ‰æ‰¹é‡è®°å½•éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨pipelineæé«˜æ€§èƒ½\n2. **æŒä¹…åŒ–**ï¼šå¦‚æœéœ€è¦é•¿æœŸä¿å­˜æ•°æ®ï¼Œå¯ä»¥å®šæœŸå°†Redisæ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“\n3. **åˆ†å¸ƒå¼**ï¼šæ­¤æ–¹æ¡ˆå¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼ç¯å¢ƒ\n\n## 6. æ³¨æ„äº‹é¡¹\n\n1. HyperLogLogæœ‰çº¦0.81%çš„è¯¯å·®ç‡ï¼Œå¦‚æœè¦æ±‚ç²¾ç¡®è®¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨Setæ•°æ®ç»“æ„ï¼ˆä½†å†…å­˜æ¶ˆè€—æ›´å¤§ï¼‰\n2. Redisé‡å¯å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œé‡è¦æ•°æ®åº”è€ƒè™‘æŒä¹…åŒ–æ–¹æ¡ˆ\n3. åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒINCRå‘½ä»¤æ˜¯åŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒå¹¶å‘é—®é¢˜\n\nè¿™ä¸ªå®ç°æ–¹æ¡ˆç®€å•é«˜æ•ˆï¼Œé€‚åˆå¤§å¤šæ•°Webåº”ç”¨çš„è®¿é—®ç»Ÿè®¡éœ€æ±‚ã€‚\n","slug":"ä½¿ç”¨Rediså’ŒRedisTemplateè®¾è®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ç»Ÿè®¡","published":1,"updated":"2025-04-01T14:32:48.261Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83do000zwen1eh042cwo","content":"<blockquote>\n<p>åœ¨Javaä¸­ä½¿ç”¨Rediså’ŒRedisTemplateæ¥ç»Ÿè®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ï¼ˆUVï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚ä¸‹é¢æˆ‘å°†æä¾›ä¸€ä¸ªå®Œæ•´çš„å®ç°æ–¹æ¡ˆã€‚</p>\n</blockquote>\n<h2 id=\"1-è®¾è®¡æ€è·¯\"><a href=\"#1-è®¾è®¡æ€è·¯\" class=\"headerlink\" title=\"1. è®¾è®¡æ€è·¯\"></a>1. è®¾è®¡æ€è·¯</h2><p>â€¢ **è®¿é—®é‡(PV)**ï¼šä½¿ç”¨Redisçš„INCRå‘½ä»¤ç»Ÿè®¡æ€»è®¿é—®æ¬¡æ•°<br>â€¢ **è®¿é—®äººæ•°(UV)**ï¼šä½¿ç”¨Redisçš„HyperLogLogæ•°æ®ç»“æ„ç»Ÿè®¡ç‹¬ç«‹è®¿å®¢æ•°<br>â€¢ <strong>è¿‡æœŸæ—¶é—´</strong>ï¼šè®¾ç½®å½“æ—¥24ç‚¹è‡ªåŠ¨è¿‡æœŸ</p>\n<h2 id=\"2-å®ç°ä»£ç \"><a href=\"#2-å®ç°ä»£ç \" class=\"headerlink\" title=\"2. å®ç°ä»£ç \"></a>2. å®ç°ä»£ç </h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.ValueOperations;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.LocalDate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.ZoneId;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.ZonedDateTime;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VisitStatisticsService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">VisitStatisticsService</span><span class=\"params\">(RedisTemplate&lt;String, String&gt; redisTemplate)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.redisTemplate = redisTemplate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“æ—¥PVçš„key</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">getTodayPVKey</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;stat:pv:&quot;</span> + LocalDate.now().toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“æ—¥UVçš„key</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">getTodayUVKey</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;stat:uv:&quot;</span> + LocalDate.now().toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°ï¼ˆåˆ°24ç‚¹çš„ç§’æ•°ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">long</span> <span class=\"title function_\">getRemainingSecondsToday</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ZonedDateTime</span> <span class=\"variable\">now</span> <span class=\"operator\">=</span> ZonedDateTime.now(ZoneId.systemDefault());</span><br><span class=\"line\">        <span class=\"type\">ZonedDateTime</span> <span class=\"variable\">midnight</span> <span class=\"operator\">=</span> now.toLocalDate().plusDays(<span class=\"number\">1</span>).atStartOfDay(ZoneId.systemDefault());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> midnight.toEpochSecond() - now.toEpochSecond();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è®°å½•è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userId ç”¨æˆ·IDï¼ˆå¯ä»¥ä¸ºIPåœ°å€æˆ–å…¶ä»–å”¯ä¸€æ ‡è¯†ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">recordVisit</span><span class=\"params\">(String userId)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">remainingSeconds</span> <span class=\"operator\">=</span> getRemainingSecondsToday();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•PVï¼ˆè®¿é—®é‡ï¼‰</span></span><br><span class=\"line\">        ValueOperations&lt;String, String&gt; valueOps = redisTemplate.opsForValue();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> getTodayPVKey();</span><br><span class=\"line\">        valueOps.increment(pvKey);</span><br><span class=\"line\">        redisTemplate.expire(pvKey, remainingSeconds, TimeUnit.SECONDS);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•UVï¼ˆç‹¬ç«‹è®¿å®¢ï¼‰</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> getTodayUVKey();</span><br><span class=\"line\">        redisTemplate.opsForHyperLogLog().add(uvKey, userId);</span><br><span class=\"line\">        redisTemplate.expire(uvKey, remainingSeconds, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å½“æ—¥è®¿é—®é‡(PV)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getTodayPV</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> getTodayPVKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> redisTemplate.opsForValue().get(pvKey);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value == <span class=\"literal\">null</span> ? <span class=\"number\">0L</span> : Long.parseLong(value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å½“æ—¥è®¿é—®äººæ•°(UV)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getTodayUV</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> getTodayUVKey();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.opsForHyperLogLog().size(uvKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å†å²æŸå¤©çš„è®¿é—®é‡(PV)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> date æ—¥æœŸ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getPVByDate</span><span class=\"params\">(LocalDate date)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;stat:pv:&quot;</span> + date.toString();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> redisTemplate.opsForValue().get(pvKey);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value == <span class=\"literal\">null</span> ? <span class=\"number\">0L</span> : Long.parseLong(value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å†å²æŸå¤©çš„è®¿é—®äººæ•°(UV)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> date æ—¥æœŸ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getUVByDate</span><span class=\"params\">(LocalDate date)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;stat:uv:&quot;</span> + date.toString();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.opsForHyperLogLog().size(uvKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-ä½¿ç”¨ç¤ºä¾‹\"><a href=\"#3-ä½¿ç”¨ç¤ºä¾‹\" class=\"headerlink\" title=\"3. ä½¿ç”¨ç¤ºä¾‹\"></a>3. ä½¿ç”¨ç¤ºä¾‹</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/api/visit&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VisitController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> VisitStatisticsService visitStatisticsService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">VisitController</span><span class=\"params\">(VisitStatisticsService visitStatisticsService)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.visitStatisticsService = visitStatisticsService;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/record&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">recordVisit</span><span class=\"params\">(<span class=\"meta\">@RequestParam</span> String userId)</span> &#123;</span><br><span class=\"line\">        visitStatisticsService.recordVisit(userId);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Visit recorded for user: &quot;</span> + userId;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/stats&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Map&lt;String, Object&gt; <span class=\"title function_\">getStats</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; result = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        result.put(<span class=\"string\">&quot;pv&quot;</span>, visitStatisticsService.getTodayPV());</span><br><span class=\"line\">        result.put(<span class=\"string\">&quot;uv&quot;</span>, visitStatisticsService.getTodayUV());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-è®¾è®¡è¯´æ˜\"><a href=\"#4-è®¾è®¡è¯´æ˜\" class=\"headerlink\" title=\"4. è®¾è®¡è¯´æ˜\"></a>4. è®¾è®¡è¯´æ˜</h2><ol>\n<li><p><strong>PVç»Ÿè®¡</strong>ï¼š<br>â€¢ ä½¿ç”¨ç®€å•çš„è®¡æ•°å™¨ï¼ˆINCRå‘½ä»¤ï¼‰<br>â€¢ æ¯ä¸ªè®¿é—®è¯·æ±‚è°ƒç”¨ä¸€æ¬¡INCR<br>â€¢ é”®æ ¼å¼ï¼š<code>stat:pv:yyyy-MM-dd</code></p>\n</li>\n<li><p><strong>UVç»Ÿè®¡</strong>ï¼š<br>â€¢ ä½¿ç”¨HyperLogLogæ•°æ®ç»“æ„<br>â€¢ å†…å­˜å ç”¨å°ï¼ˆæ¯ä¸ªHyperLogLogçº¦12KBï¼‰<br>â€¢ è¯¯å·®ç‡çº¦0.81%<br>â€¢ é”®æ ¼å¼ï¼š<code>stat:uv:yyyy-MM-dd</code></p>\n</li>\n<li><p><strong>è¿‡æœŸæ—¶é—´</strong>ï¼š<br>â€¢ è‡ªåŠ¨è®¡ç®—åˆ°å½“å¤©24ç‚¹çš„å‰©ä½™ç§’æ•°<br>â€¢ è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´<br>â€¢ é¿å…æ•°æ®æ— é™å¢é•¿</p>\n</li>\n<li><p><strong>æ‰©å±•æ€§</strong>ï¼š<br>â€¢ å¯ä»¥è½»æ¾æ‰©å±•ä¸ºæŒ‰å°æ—¶ã€å‘¨ã€æœˆç»Ÿè®¡<br>â€¢ å¯ä»¥æ·»åŠ ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆå¦‚è®¿é—®é¡µé¢ã€åœç•™æ—¶é—´ç­‰ï¼‰</p>\n</li>\n</ol>\n<h2 id=\"5-æ€§èƒ½ä¼˜åŒ–\"><a href=\"#5-æ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"5. æ€§èƒ½ä¼˜åŒ–\"></a>5. æ€§èƒ½ä¼˜åŒ–</h2><ol>\n<li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼šå¦‚æœæœ‰æ‰¹é‡è®°å½•éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨pipelineæé«˜æ€§èƒ½</li>\n<li><strong>æŒä¹…åŒ–</strong>ï¼šå¦‚æœéœ€è¦é•¿æœŸä¿å­˜æ•°æ®ï¼Œå¯ä»¥å®šæœŸå°†Redisæ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“</li>\n<li><strong>åˆ†å¸ƒå¼</strong>ï¼šæ­¤æ–¹æ¡ˆå¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼ç¯å¢ƒ</li>\n</ol>\n<h2 id=\"6-æ³¨æ„äº‹é¡¹\"><a href=\"#6-æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"6. æ³¨æ„äº‹é¡¹\"></a>6. æ³¨æ„äº‹é¡¹</h2><ol>\n<li>HyperLogLogæœ‰çº¦0.81%çš„è¯¯å·®ç‡ï¼Œå¦‚æœè¦æ±‚ç²¾ç¡®è®¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨Setæ•°æ®ç»“æ„ï¼ˆä½†å†…å­˜æ¶ˆè€—æ›´å¤§ï¼‰</li>\n<li>Redisé‡å¯å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œé‡è¦æ•°æ®åº”è€ƒè™‘æŒä¹…åŒ–æ–¹æ¡ˆ</li>\n<li>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒINCRå‘½ä»¤æ˜¯åŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒå¹¶å‘é—®é¢˜</li>\n</ol>\n<p>è¿™ä¸ªå®ç°æ–¹æ¡ˆç®€å•é«˜æ•ˆï¼Œé€‚åˆå¤§å¤šæ•°Webåº”ç”¨çš„è®¿é—®ç»Ÿè®¡éœ€æ±‚ã€‚</p>\n","excerpt":"","more":"<blockquote>\n<p>åœ¨Javaä¸­ä½¿ç”¨Rediså’ŒRedisTemplateæ¥ç»Ÿè®¡å½“æ—¥è®¿é—®é‡å’Œè®¿é—®äººæ•°ï¼ˆUVï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚ä¸‹é¢æˆ‘å°†æä¾›ä¸€ä¸ªå®Œæ•´çš„å®ç°æ–¹æ¡ˆã€‚</p>\n</blockquote>\n<h2 id=\"1-è®¾è®¡æ€è·¯\"><a href=\"#1-è®¾è®¡æ€è·¯\" class=\"headerlink\" title=\"1. è®¾è®¡æ€è·¯\"></a>1. è®¾è®¡æ€è·¯</h2><p>â€¢ **è®¿é—®é‡(PV)**ï¼šä½¿ç”¨Redisçš„INCRå‘½ä»¤ç»Ÿè®¡æ€»è®¿é—®æ¬¡æ•°<br>â€¢ **è®¿é—®äººæ•°(UV)**ï¼šä½¿ç”¨Redisçš„HyperLogLogæ•°æ®ç»“æ„ç»Ÿè®¡ç‹¬ç«‹è®¿å®¢æ•°<br>â€¢ <strong>è¿‡æœŸæ—¶é—´</strong>ï¼šè®¾ç½®å½“æ—¥24ç‚¹è‡ªåŠ¨è¿‡æœŸ</p>\n<h2 id=\"2-å®ç°ä»£ç \"><a href=\"#2-å®ç°ä»£ç \" class=\"headerlink\" title=\"2. å®ç°ä»£ç \"></a>2. å®ç°ä»£ç </h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.ValueOperations;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.LocalDate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.ZoneId;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.time.ZonedDateTime;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.TimeUnit;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VisitStatisticsService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RedisTemplate&lt;String, String&gt; redisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">VisitStatisticsService</span><span class=\"params\">(RedisTemplate&lt;String, String&gt; redisTemplate)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.redisTemplate = redisTemplate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“æ—¥PVçš„key</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">getTodayPVKey</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;stat:pv:&quot;</span> + LocalDate.now().toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“æ—¥UVçš„key</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">getTodayUVKey</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;stat:uv:&quot;</span> + LocalDate.now().toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°ï¼ˆåˆ°24ç‚¹çš„ç§’æ•°ï¼‰</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">long</span> <span class=\"title function_\">getRemainingSecondsToday</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ZonedDateTime</span> <span class=\"variable\">now</span> <span class=\"operator\">=</span> ZonedDateTime.now(ZoneId.systemDefault());</span><br><span class=\"line\">        <span class=\"type\">ZonedDateTime</span> <span class=\"variable\">midnight</span> <span class=\"operator\">=</span> now.toLocalDate().plusDays(<span class=\"number\">1</span>).atStartOfDay(ZoneId.systemDefault());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> midnight.toEpochSecond() - now.toEpochSecond();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è®°å½•è®¿é—®</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userId ç”¨æˆ·IDï¼ˆå¯ä»¥ä¸ºIPåœ°å€æˆ–å…¶ä»–å”¯ä¸€æ ‡è¯†ï¼‰</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">recordVisit</span><span class=\"params\">(String userId)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// è·å–å½“å¤©å‰©ä½™çš„ç§’æ•°</span></span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">remainingSeconds</span> <span class=\"operator\">=</span> getRemainingSecondsToday();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•PVï¼ˆè®¿é—®é‡ï¼‰</span></span><br><span class=\"line\">        ValueOperations&lt;String, String&gt; valueOps = redisTemplate.opsForValue();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> getTodayPVKey();</span><br><span class=\"line\">        valueOps.increment(pvKey);</span><br><span class=\"line\">        redisTemplate.expire(pvKey, remainingSeconds, TimeUnit.SECONDS);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// è®°å½•UVï¼ˆç‹¬ç«‹è®¿å®¢ï¼‰</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> getTodayUVKey();</span><br><span class=\"line\">        redisTemplate.opsForHyperLogLog().add(uvKey, userId);</span><br><span class=\"line\">        redisTemplate.expire(uvKey, remainingSeconds, TimeUnit.SECONDS);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å½“æ—¥è®¿é—®é‡(PV)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getTodayPV</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> getTodayPVKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> redisTemplate.opsForValue().get(pvKey);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value == <span class=\"literal\">null</span> ? <span class=\"number\">0L</span> : Long.parseLong(value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å½“æ—¥è®¿é—®äººæ•°(UV)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getTodayUV</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> getTodayUVKey();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.opsForHyperLogLog().size(uvKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å†å²æŸå¤©çš„è®¿é—®é‡(PV)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> date æ—¥æœŸ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getPVByDate</span><span class=\"params\">(LocalDate date)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pvKey</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;stat:pv:&quot;</span> + date.toString();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> redisTemplate.opsForValue().get(pvKey);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value == <span class=\"literal\">null</span> ? <span class=\"number\">0L</span> : Long.parseLong(value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è·å–å†å²æŸå¤©çš„è®¿é—®äººæ•°(UV)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> date æ—¥æœŸ</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Long <span class=\"title function_\">getUVByDate</span><span class=\"params\">(LocalDate date)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">uvKey</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;stat:uv:&quot;</span> + date.toString();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.opsForHyperLogLog().size(uvKey);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-ä½¿ç”¨ç¤ºä¾‹\"><a href=\"#3-ä½¿ç”¨ç¤ºä¾‹\" class=\"headerlink\" title=\"3. ä½¿ç”¨ç¤ºä¾‹\"></a>3. ä½¿ç”¨ç¤ºä¾‹</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/api/visit&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">VisitController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> VisitStatisticsService visitStatisticsService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">VisitController</span><span class=\"params\">(VisitStatisticsService visitStatisticsService)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.visitStatisticsService = visitStatisticsService;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/record&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">recordVisit</span><span class=\"params\">(<span class=\"meta\">@RequestParam</span> String userId)</span> &#123;</span><br><span class=\"line\">        visitStatisticsService.recordVisit(userId);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Visit recorded for user: &quot;</span> + userId;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;/stats&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Map&lt;String, Object&gt; <span class=\"title function_\">getStats</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; result = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        result.put(<span class=\"string\">&quot;pv&quot;</span>, visitStatisticsService.getTodayPV());</span><br><span class=\"line\">        result.put(<span class=\"string\">&quot;uv&quot;</span>, visitStatisticsService.getTodayUV());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-è®¾è®¡è¯´æ˜\"><a href=\"#4-è®¾è®¡è¯´æ˜\" class=\"headerlink\" title=\"4. è®¾è®¡è¯´æ˜\"></a>4. è®¾è®¡è¯´æ˜</h2><ol>\n<li><p><strong>PVç»Ÿè®¡</strong>ï¼š<br>â€¢ ä½¿ç”¨ç®€å•çš„è®¡æ•°å™¨ï¼ˆINCRå‘½ä»¤ï¼‰<br>â€¢ æ¯ä¸ªè®¿é—®è¯·æ±‚è°ƒç”¨ä¸€æ¬¡INCR<br>â€¢ é”®æ ¼å¼ï¼š<code>stat:pv:yyyy-MM-dd</code></p>\n</li>\n<li><p><strong>UVç»Ÿè®¡</strong>ï¼š<br>â€¢ ä½¿ç”¨HyperLogLogæ•°æ®ç»“æ„<br>â€¢ å†…å­˜å ç”¨å°ï¼ˆæ¯ä¸ªHyperLogLogçº¦12KBï¼‰<br>â€¢ è¯¯å·®ç‡çº¦0.81%<br>â€¢ é”®æ ¼å¼ï¼š<code>stat:uv:yyyy-MM-dd</code></p>\n</li>\n<li><p><strong>è¿‡æœŸæ—¶é—´</strong>ï¼š<br>â€¢ è‡ªåŠ¨è®¡ç®—åˆ°å½“å¤©24ç‚¹çš„å‰©ä½™ç§’æ•°<br>â€¢ è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´<br>â€¢ é¿å…æ•°æ®æ— é™å¢é•¿</p>\n</li>\n<li><p><strong>æ‰©å±•æ€§</strong>ï¼š<br>â€¢ å¯ä»¥è½»æ¾æ‰©å±•ä¸ºæŒ‰å°æ—¶ã€å‘¨ã€æœˆç»Ÿè®¡<br>â€¢ å¯ä»¥æ·»åŠ ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆå¦‚è®¿é—®é¡µé¢ã€åœç•™æ—¶é—´ç­‰ï¼‰</p>\n</li>\n</ol>\n<h2 id=\"5-æ€§èƒ½ä¼˜åŒ–\"><a href=\"#5-æ€§èƒ½ä¼˜åŒ–\" class=\"headerlink\" title=\"5. æ€§èƒ½ä¼˜åŒ–\"></a>5. æ€§èƒ½ä¼˜åŒ–</h2><ol>\n<li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼šå¦‚æœæœ‰æ‰¹é‡è®°å½•éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨pipelineæé«˜æ€§èƒ½</li>\n<li><strong>æŒä¹…åŒ–</strong>ï¼šå¦‚æœéœ€è¦é•¿æœŸä¿å­˜æ•°æ®ï¼Œå¯ä»¥å®šæœŸå°†Redisæ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“</li>\n<li><strong>åˆ†å¸ƒå¼</strong>ï¼šæ­¤æ–¹æ¡ˆå¤©ç„¶æ”¯æŒåˆ†å¸ƒå¼ç¯å¢ƒ</li>\n</ol>\n<h2 id=\"6-æ³¨æ„äº‹é¡¹\"><a href=\"#6-æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"6. æ³¨æ„äº‹é¡¹\"></a>6. æ³¨æ„äº‹é¡¹</h2><ol>\n<li>HyperLogLogæœ‰çº¦0.81%çš„è¯¯å·®ç‡ï¼Œå¦‚æœè¦æ±‚ç²¾ç¡®è®¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨Setæ•°æ®ç»“æ„ï¼ˆä½†å†…å­˜æ¶ˆè€—æ›´å¤§ï¼‰</li>\n<li>Redisé‡å¯å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œé‡è¦æ•°æ®åº”è€ƒè™‘æŒä¹…åŒ–æ–¹æ¡ˆ</li>\n<li>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒINCRå‘½ä»¤æ˜¯åŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒå¹¶å‘é—®é¢˜</li>\n</ol>\n<p>è¿™ä¸ªå®ç°æ–¹æ¡ˆç®€å•é«˜æ•ˆï¼Œé€‚åˆå¤§å¤šæ•°Webåº”ç”¨çš„è®¿é—®ç»Ÿè®¡éœ€æ±‚ã€‚</p>\n"},{"title":"ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦","date":"2024-08-12T05:03:01.000Z","_content":"\n> åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰˜ç®¡ç½‘ç«™åšä¸ªäººç½‘ç«™ï¼Œä¾‹å¦‚ï¼šGithub Pagesï¼Œæƒ³è¦ç»™ç½‘ç«™åŠ ä¸Šhttpsï¼Œå¯ä»¥é€šè¿‡ohttpsæ¥åˆ›å»ºLet's Encryptçš„httpsè¯ä¹¦ï¼Œå•çº¯æƒ³ç»™ç½‘ç«™åŠ ä¸Šhttpsä¹Ÿå¯ä»¥ã€‚\n\n\n### å®‰è£…Nginx\n\nå…ˆç¡®ä¿æœåŠ¡å™¨(æˆ‘è¿™é‡Œæ˜¯winæœåŠ¡å™¨)å·²ç»å®‰è£…äº†[nginx](https://nginx.org/en/download.html)ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼Œç„¶åä¸‹è½½è§£å‹åˆ°æœåŠ¡å™¨ä¸Šï¼ŒåŒå‡»è¿è¡Œnginx.exeï¼Œè®¿é—®æœåŠ¡å™¨ipåœ°å€ï¼Œå‡ºç°Welcome to Nginx!åˆ™è¡¨ç¤ºå®‰è£…å¯åŠ¨æˆåŠŸã€‚\n\n\n\n### ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\n\n1. åˆ›å»ºè¯ä¹¦\n\n![image-20240812124550577](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124550577.png)\n\n2. éœ€è¦åœ¨è‡ªå·±åŸŸåç®¡ç†è§£æä¸­åŠ å…¥ohttpsçš„è®°å½•\n\n![image-20240812124657919](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124657919.png)\n\n3. åœ¨nginxé…ç½®ä¸­éœ€è¦ssl_certificate_keyå’Œssl_certificate\n\n**ssl_certificate_key**: ç§é’¥æ–‡ä»¶é€šå¸¸åŒ…å«ä¸SSLè¯ä¹¦é…å¯¹çš„ç§é’¥ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†é€šä¿¡ä¸­çš„æ•°æ®ï¼Œæ–‡ä»¶åç¼€.keyï¼Œå†…å®¹å¼€å¤´-----BEGIN RSA PRIVATE KEY-----\n\n**ssl_certificate**: SSLè¯ä¹¦æ–‡ä»¶åŒ…å«ç”¨äºéªŒè¯æœåŠ¡å™¨èº«ä»½çš„å…¬é’¥ä»¥åŠç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœåŠ¡å™¨çš„åŸŸåå’Œè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„ç­¾åï¼Œæ–‡ä»¶åç¼€ä¸º.crtæˆ–è€…æ˜¯.pemï¼Œå†…å®¹å¼€å¤´-----BEGIN CERTIFICATE-----\n\n![image-20240812125505357](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812125505357.png)\n\nä¸‹è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åå­˜æ”¾åˆ°æœåŠ¡å™¨ä¸Š\n\n### é…ç½®Nginx.conf\n\n```\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    server_names_hash_bucket_size 64;\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen 443 ssl;\n        server_name wechat.ruiyeclub.cn;\n\n        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;\n        ssl_certificate_key  è·¯å¾„/key/cert.key;\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n            proxy_pass http://localhost:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n\n    server {\n        listen 80;\n        server_name wechat.ruiyeclub.cn;\n\n        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;\n        ssl_certificate_key  è·¯å¾„/key/cert.key;\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n            proxy_pass http://localhost:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n}\n```\n\n### Nginxå¸¸ç”¨å‘½ä»¤\n\n- **å¯åŠ¨NginxæœåŠ¡** nginx\n\n- **åœæ­¢NginxæœåŠ¡** nginx -s stop\n- **æ£€æµ‹é…ç½®æ–‡ä»¶çš„æ­£ç¡®æ€§** nginx -t\n- **é‡æ–°åŠ è½½Nginxé…ç½®æ–‡ä»¶** nginx -s reload\n- **æŸ¥çœ‹Nginxç‰ˆæœ¬ä¿¡æ¯** nginx -v\n- **å¹³æ»‘åœæ­¢NginxæœåŠ¡** nginx -s quit","source":"_posts/ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦.md","raw":"---\ntitle: ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦\ndate: 2024-08-12 13:03:01\ntags:\n---\n\n> åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰˜ç®¡ç½‘ç«™åšä¸ªäººç½‘ç«™ï¼Œä¾‹å¦‚ï¼šGithub Pagesï¼Œæƒ³è¦ç»™ç½‘ç«™åŠ ä¸Šhttpsï¼Œå¯ä»¥é€šè¿‡ohttpsæ¥åˆ›å»ºLet's Encryptçš„httpsè¯ä¹¦ï¼Œå•çº¯æƒ³ç»™ç½‘ç«™åŠ ä¸Šhttpsä¹Ÿå¯ä»¥ã€‚\n\n\n### å®‰è£…Nginx\n\nå…ˆç¡®ä¿æœåŠ¡å™¨(æˆ‘è¿™é‡Œæ˜¯winæœåŠ¡å™¨)å·²ç»å®‰è£…äº†[nginx](https://nginx.org/en/download.html)ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼Œç„¶åä¸‹è½½è§£å‹åˆ°æœåŠ¡å™¨ä¸Šï¼ŒåŒå‡»è¿è¡Œnginx.exeï¼Œè®¿é—®æœåŠ¡å™¨ipåœ°å€ï¼Œå‡ºç°Welcome to Nginx!åˆ™è¡¨ç¤ºå®‰è£…å¯åŠ¨æˆåŠŸã€‚\n\n\n\n### ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\n\n1. åˆ›å»ºè¯ä¹¦\n\n![image-20240812124550577](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124550577.png)\n\n2. éœ€è¦åœ¨è‡ªå·±åŸŸåç®¡ç†è§£æä¸­åŠ å…¥ohttpsçš„è®°å½•\n\n![image-20240812124657919](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124657919.png)\n\n3. åœ¨nginxé…ç½®ä¸­éœ€è¦ssl_certificate_keyå’Œssl_certificate\n\n**ssl_certificate_key**: ç§é’¥æ–‡ä»¶é€šå¸¸åŒ…å«ä¸SSLè¯ä¹¦é…å¯¹çš„ç§é’¥ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†é€šä¿¡ä¸­çš„æ•°æ®ï¼Œæ–‡ä»¶åç¼€.keyï¼Œå†…å®¹å¼€å¤´-----BEGIN RSA PRIVATE KEY-----\n\n**ssl_certificate**: SSLè¯ä¹¦æ–‡ä»¶åŒ…å«ç”¨äºéªŒè¯æœåŠ¡å™¨èº«ä»½çš„å…¬é’¥ä»¥åŠç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœåŠ¡å™¨çš„åŸŸåå’Œè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„ç­¾åï¼Œæ–‡ä»¶åç¼€ä¸º.crtæˆ–è€…æ˜¯.pemï¼Œå†…å®¹å¼€å¤´-----BEGIN CERTIFICATE-----\n\n![image-20240812125505357](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812125505357.png)\n\nä¸‹è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åå­˜æ”¾åˆ°æœåŠ¡å™¨ä¸Š\n\n### é…ç½®Nginx.conf\n\n```\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    server_names_hash_bucket_size 64;\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen 443 ssl;\n        server_name wechat.ruiyeclub.cn;\n\n        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;\n        ssl_certificate_key  è·¯å¾„/key/cert.key;\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n            proxy_pass http://localhost:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n\n    server {\n        listen 80;\n        server_name wechat.ruiyeclub.cn;\n\n        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;\n        ssl_certificate_key  è·¯å¾„/key/cert.key;\n        ssl_session_cache    shared:SSL:1m;\n        ssl_session_timeout  5m;\n        ssl_ciphers  HIGH:!aNULL:!MD5;\n        ssl_prefer_server_ciphers  on;\n\n        location / {\n            proxy_pass http://localhost:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n    }\n}\n```\n\n### Nginxå¸¸ç”¨å‘½ä»¤\n\n- **å¯åŠ¨NginxæœåŠ¡** nginx\n\n- **åœæ­¢NginxæœåŠ¡** nginx -s stop\n- **æ£€æµ‹é…ç½®æ–‡ä»¶çš„æ­£ç¡®æ€§** nginx -t\n- **é‡æ–°åŠ è½½Nginxé…ç½®æ–‡ä»¶** nginx -s reload\n- **æŸ¥çœ‹Nginxç‰ˆæœ¬ä¿¡æ¯** nginx -v\n- **å¹³æ»‘åœæ­¢NginxæœåŠ¡** nginx -s quit","slug":"ä½¿ç”¨ohttpsè‡ªåŠ¨éƒ¨ç½²httpsè¯ä¹¦","published":1,"updated":"2024-08-12T05:04:49.244Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dp0010wen1erln8gy3","content":"<blockquote>\n<p>åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰˜ç®¡ç½‘ç«™åšä¸ªäººç½‘ç«™ï¼Œä¾‹å¦‚ï¼šGithub Pagesï¼Œæƒ³è¦ç»™ç½‘ç«™åŠ ä¸Šhttpsï¼Œå¯ä»¥é€šè¿‡ohttpsæ¥åˆ›å»ºLetâ€™s Encryptçš„httpsè¯ä¹¦ï¼Œå•çº¯æƒ³ç»™ç½‘ç«™åŠ ä¸Šhttpsä¹Ÿå¯ä»¥ã€‚</p>\n</blockquote>\n<h3 id=\"å®‰è£…Nginx\"><a href=\"#å®‰è£…Nginx\" class=\"headerlink\" title=\"å®‰è£…Nginx\"></a>å®‰è£…Nginx</h3><p>å…ˆç¡®ä¿æœåŠ¡å™¨(æˆ‘è¿™é‡Œæ˜¯winæœåŠ¡å™¨)å·²ç»å®‰è£…äº†<a href=\"https://nginx.org/en/download.html\">nginx</a>ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼Œç„¶åä¸‹è½½è§£å‹åˆ°æœåŠ¡å™¨ä¸Šï¼ŒåŒå‡»è¿è¡Œnginx.exeï¼Œè®¿é—®æœåŠ¡å™¨ipåœ°å€ï¼Œå‡ºç°Welcome to Nginx!åˆ™è¡¨ç¤ºå®‰è£…å¯åŠ¨æˆåŠŸã€‚</p>\n<h3 id=\"ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\"><a href=\"#ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\" class=\"headerlink\" title=\"ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\"></a>ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦</h3><ol>\n<li>åˆ›å»ºè¯ä¹¦</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124550577.png\" alt=\"image-20240812124550577\"></p>\n<ol start=\"2\">\n<li>éœ€è¦åœ¨è‡ªå·±åŸŸåç®¡ç†è§£æä¸­åŠ å…¥ohttpsçš„è®°å½•</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124657919.png\" alt=\"image-20240812124657919\"></p>\n<ol start=\"3\">\n<li>åœ¨nginxé…ç½®ä¸­éœ€è¦ssl_certificate_keyå’Œssl_certificate</li>\n</ol>\n<p><strong>ssl_certificate_key</strong>: ç§é’¥æ–‡ä»¶é€šå¸¸åŒ…å«ä¸SSLè¯ä¹¦é…å¯¹çš„ç§é’¥ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†é€šä¿¡ä¸­çš„æ•°æ®ï¼Œæ–‡ä»¶åç¼€.keyï¼Œå†…å®¹å¼€å¤´â€”â€“BEGIN RSA PRIVATE KEYâ€”â€“</p>\n<p><strong>ssl_certificate</strong>: SSLè¯ä¹¦æ–‡ä»¶åŒ…å«ç”¨äºéªŒè¯æœåŠ¡å™¨èº«ä»½çš„å…¬é’¥ä»¥åŠç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœåŠ¡å™¨çš„åŸŸåå’Œè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„ç­¾åï¼Œæ–‡ä»¶åç¼€ä¸º.crtæˆ–è€…æ˜¯.pemï¼Œå†…å®¹å¼€å¤´â€”â€“BEGIN CERTIFICATEâ€”â€“</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812125505357.png\" alt=\"image-20240812125505357\"></p>\n<p>ä¸‹è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åå­˜æ”¾åˆ°æœåŠ¡å™¨ä¸Š</p>\n<h3 id=\"é…ç½®Nginx-conf\"><a href=\"#é…ç½®Nginx-conf\" class=\"headerlink\" title=\"é…ç½®Nginx.conf\"></a>é…ç½®Nginx.conf</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server_names_hash_bucket_size 64;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\"></span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl;</span><br><span class=\"line\">        server_name wechat.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;</span><br><span class=\"line\">        ssl_certificate_key  è·¯å¾„/key/cert.key;</span><br><span class=\"line\">        ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">        ssl_session_timeout  5m;</span><br><span class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">        ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            proxy_pass http://localhost:8080;</span><br><span class=\"line\">            proxy_set_header Host $host;</span><br><span class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name wechat.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;</span><br><span class=\"line\">        ssl_certificate_key  è·¯å¾„/key/cert.key;</span><br><span class=\"line\">        ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">        ssl_session_timeout  5m;</span><br><span class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">        ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            proxy_pass http://localhost:8080;</span><br><span class=\"line\">            proxy_set_header Host $host;</span><br><span class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Nginxå¸¸ç”¨å‘½ä»¤\"><a href=\"#Nginxå¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"Nginxå¸¸ç”¨å‘½ä»¤\"></a>Nginxå¸¸ç”¨å‘½ä»¤</h3><ul>\n<li><p><strong>å¯åŠ¨NginxæœåŠ¡</strong> nginx</p>\n</li>\n<li><p><strong>åœæ­¢NginxæœåŠ¡</strong> nginx -s stop</p>\n</li>\n<li><p><strong>æ£€æµ‹é…ç½®æ–‡ä»¶çš„æ­£ç¡®æ€§</strong> nginx -t</p>\n</li>\n<li><p><strong>é‡æ–°åŠ è½½Nginxé…ç½®æ–‡ä»¶</strong> nginx -s reload</p>\n</li>\n<li><p><strong>æŸ¥çœ‹Nginxç‰ˆæœ¬ä¿¡æ¯</strong> nginx -v</p>\n</li>\n<li><p><strong>å¹³æ»‘åœæ­¢NginxæœåŠ¡</strong> nginx -s quit</p>\n</li>\n</ul>\n","excerpt":"","more":"<blockquote>\n<p>åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰˜ç®¡ç½‘ç«™åšä¸ªäººç½‘ç«™ï¼Œä¾‹å¦‚ï¼šGithub Pagesï¼Œæƒ³è¦ç»™ç½‘ç«™åŠ ä¸Šhttpsï¼Œå¯ä»¥é€šè¿‡ohttpsæ¥åˆ›å»ºLetâ€™s Encryptçš„httpsè¯ä¹¦ï¼Œå•çº¯æƒ³ç»™ç½‘ç«™åŠ ä¸Šhttpsä¹Ÿå¯ä»¥ã€‚</p>\n</blockquote>\n<h3 id=\"å®‰è£…Nginx\"><a href=\"#å®‰è£…Nginx\" class=\"headerlink\" title=\"å®‰è£…Nginx\"></a>å®‰è£…Nginx</h3><p>å…ˆç¡®ä¿æœåŠ¡å™¨(æˆ‘è¿™é‡Œæ˜¯winæœåŠ¡å™¨)å·²ç»å®‰è£…äº†<a href=\"https://nginx.org/en/download.html\">nginx</a>ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼Œç„¶åä¸‹è½½è§£å‹åˆ°æœåŠ¡å™¨ä¸Šï¼ŒåŒå‡»è¿è¡Œnginx.exeï¼Œè®¿é—®æœåŠ¡å™¨ipåœ°å€ï¼Œå‡ºç°Welcome to Nginx!åˆ™è¡¨ç¤ºå®‰è£…å¯åŠ¨æˆåŠŸã€‚</p>\n<h3 id=\"ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\"><a href=\"#ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\" class=\"headerlink\" title=\"ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦\"></a>ä½¿ç”¨ohttpséƒ¨ç½²sslè¯ä¹¦</h3><ol>\n<li>åˆ›å»ºè¯ä¹¦</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124550577.png\" alt=\"image-20240812124550577\"></p>\n<ol start=\"2\">\n<li>éœ€è¦åœ¨è‡ªå·±åŸŸåç®¡ç†è§£æä¸­åŠ å…¥ohttpsçš„è®°å½•</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812124657919.png\" alt=\"image-20240812124657919\"></p>\n<ol start=\"3\">\n<li>åœ¨nginxé…ç½®ä¸­éœ€è¦ssl_certificate_keyå’Œssl_certificate</li>\n</ol>\n<p><strong>ssl_certificate_key</strong>: ç§é’¥æ–‡ä»¶é€šå¸¸åŒ…å«ä¸SSLè¯ä¹¦é…å¯¹çš„ç§é’¥ï¼Œç”¨äºåŠ å¯†å’Œè§£å¯†é€šä¿¡ä¸­çš„æ•°æ®ï¼Œæ–‡ä»¶åç¼€.keyï¼Œå†…å®¹å¼€å¤´â€”â€“BEGIN RSA PRIVATE KEYâ€”â€“</p>\n<p><strong>ssl_certificate</strong>: SSLè¯ä¹¦æ–‡ä»¶åŒ…å«ç”¨äºéªŒè¯æœåŠ¡å™¨èº«ä»½çš„å…¬é’¥ä»¥åŠç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœåŠ¡å™¨çš„åŸŸåå’Œè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰çš„ç­¾åï¼Œæ–‡ä»¶åç¼€ä¸º.crtæˆ–è€…æ˜¯.pemï¼Œå†…å®¹å¼€å¤´â€”â€“BEGIN CERTIFICATEâ€”â€“</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240812125505357.png\" alt=\"image-20240812125505357\"></p>\n<p>ä¸‹è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œç„¶åå­˜æ”¾åˆ°æœåŠ¡å™¨ä¸Š</p>\n<h3 id=\"é…ç½®Nginx-conf\"><a href=\"#é…ç½®Nginx-conf\" class=\"headerlink\" title=\"é…ç½®Nginx.conf\"></a>é…ç½®Nginx.conf</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server_names_hash_bucket_size 64;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\"></span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443 ssl;</span><br><span class=\"line\">        server_name wechat.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;</span><br><span class=\"line\">        ssl_certificate_key  è·¯å¾„/key/cert.key;</span><br><span class=\"line\">        ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">        ssl_session_timeout  5m;</span><br><span class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">        ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            proxy_pass http://localhost:8080;</span><br><span class=\"line\">            proxy_set_header Host $host;</span><br><span class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name wechat.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">        ssl_certificate      ç»å¯¹è·¯å¾„/key/fullchain.pem;</span><br><span class=\"line\">        ssl_certificate_key  è·¯å¾„/key/cert.key;</span><br><span class=\"line\">        ssl_session_cache    shared:SSL:1m;</span><br><span class=\"line\">        ssl_session_timeout  5m;</span><br><span class=\"line\">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class=\"line\">        ssl_prefer_server_ciphers  on;</span><br><span class=\"line\"></span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            proxy_pass http://localhost:8080;</span><br><span class=\"line\">            proxy_set_header Host $host;</span><br><span class=\"line\">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Nginxå¸¸ç”¨å‘½ä»¤\"><a href=\"#Nginxå¸¸ç”¨å‘½ä»¤\" class=\"headerlink\" title=\"Nginxå¸¸ç”¨å‘½ä»¤\"></a>Nginxå¸¸ç”¨å‘½ä»¤</h3><ul>\n<li><p><strong>å¯åŠ¨NginxæœåŠ¡</strong> nginx</p>\n</li>\n<li><p><strong>åœæ­¢NginxæœåŠ¡</strong> nginx -s stop</p>\n</li>\n<li><p><strong>æ£€æµ‹é…ç½®æ–‡ä»¶çš„æ­£ç¡®æ€§</strong> nginx -t</p>\n</li>\n<li><p><strong>é‡æ–°åŠ è½½Nginxé…ç½®æ–‡ä»¶</strong> nginx -s reload</p>\n</li>\n<li><p><strong>æŸ¥çœ‹Nginxç‰ˆæœ¬ä¿¡æ¯</strong> nginx -v</p>\n</li>\n<li><p><strong>å¹³æ»‘åœæ­¢NginxæœåŠ¡</strong> nginx -s quit</p>\n</li>\n</ul>\n"},{"title":"å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜","date":"2024-01-31T07:16:55.000Z","_content":"\n> **EIP-1559**æ˜¯ä¸€é¡¹ä»¥å¤ªåŠæ”¹è¿›ææ¡ˆï¼Œæ—¨åœ¨ä¼˜åŒ–ä»¥å¤ªåŠåŒºå—é“¾çš„è´¹ç”¨å¸‚åœºç³»ç»Ÿã€‚ EIP-1559 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ”¶è´¹ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå…³é”®è¦ç´ ï¼š**åŸºæœ¬è´¹ç”¨(base fee)**ã€**ä¼˜å…ˆå°è´¹(priority fee)**å’Œ**è´¹ç”¨ä¸Šé™(max fee)**ã€‚\n\n\n\n## ä¸€ã€EIP-1559ç‰¹ç‚¹\n\n- åŸºç¡€è´¹ç”¨:eip1559å¼•å…¥äº†ä¸€ç§æ–°çš„æ”¶è´¹æœºåˆ¶ï¼Œå³æ¯ä¸ªåŒºå—éƒ½æœ‰ä¸€ä¸ªç”±åè®®æ ¹æ®åŒºå—éœ€æ±‚åŠ¨æ€è°ƒæ•´çš„åŸºç¡€è´¹ç”¨(base fee)ï¼Œè¡¨ç¤ºåœ¨è¯¥åŒºå—ä¸­è¿›è¡Œäº¤æ˜“æ—¶éœ€è¦æ”¯ä»˜çš„æœ€ä½æ‰‹ç»­è´¹ã€‚åŸºç¡€è´¹ç”¨çš„ç›®æ ‡æ˜¯è®©æ¯ä¸ªåŒºå—çš„ä½¿ç”¨ç‡ç»´æŒåœ¨50%ï¼Œä»è€Œé¿å…è¿‡åº¦æ‹¥å µæˆ–æµªè´¹ã€‚åŸºç¡€è´¹ç”¨ä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«é”€æ¯(burn)ï¼Œä»è€Œå‡å°‘ETHçš„æµé€šä¾›åº”ã€‚\n- ä¼˜å…ˆè´¹ç”¨:é™¤äº†åŸºç¡€è´¹ç”¨å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªä¼˜å…ˆè´¹ç”¨(priority fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„é¢å¤–æ”¯ä»˜ç»™çŸ¿å·¥/éªŒè¯è€…çš„æ¿€åŠ±ï¼Œä»¥ä¾¿è®©è‡ªå·±çš„äº¤æ˜“æ›´å¿«è¢«ç¡®è®¤ã€‚ä¼˜å…ˆè´¹ç”¨ä¹Ÿä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«çŸ¿å·¥/éªŒè¯è€…ä¿ç•™ã€‚\n- è´¹ç”¨ä¸Šé™:ç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªè´¹ç”¨ä¸Šé™(max fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„ä¸ºä¸€ç¬”äº¤æ˜“æ”¯ä»˜çš„æœ€é«˜æ‰‹ç»­è´¹ã€‚è´¹ç”¨ä¸Šé™åŒ…æ‹¬åŸºç¡€è´¹ç”¨å’Œä¼˜å…ˆè´¹ç”¨ï¼Œå½“äº¤æ˜“è¢«ç¡®è®¤æ—¶ï¼Œç”¨æˆ·ä¼šæ”¶åˆ°ä¸€ç¬”é€€æ¬¾ï¼Œç”±å®é™…æ”¯ä»˜é‡‘é¢å’Œè´¹ç”¨ä¸Šé™ä¹‹é—´çš„å·®é¢ç»„æˆã€‚è¿™ä¸ªæœºåˆ¶ç¡®ä¿äº†ç”¨æˆ·æ°¸è¿œä¸ä¼šè¶…å‡ºä»–ä»¬æ‰€è®¾å®šçš„é¢„ç®—ã€‚\n- åŒé‡äº¤æ˜“ç±»å‹:eip1559å…¼å®¹ä¸¤ç§äº¤æ˜“ç±»å‹ï¼Œå³æ–°å‹äº¤æ˜“ç±»å‹å’Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ã€‚æ–°å‹äº¤æ˜“ç±»å‹éµå¾ªeip1559çš„è§„åˆ™ï¼Œå³æŒ‡å®šåŸºç¡€è´¹ç”¨ã€ä¼˜å…ˆè´¹ç”¨å’Œè´¹ç”¨ä¸Šé™ã€‚ä¼ ç»Ÿäº¤æ˜“ç±»å‹éµå¾ªåŸæœ‰çš„è§„åˆ™ï¼Œå³æŒ‡å®šä¸€ä¸ªå›ºå®šçš„å‡ºä»·(gasprice)ã€‚ä¸ºäº†è®©ä¸¤ç§äº¤æ˜“ç±»å‹èƒ½å¤Ÿå…±å­˜ï¼Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ä¼šè¢«è½¬æ¢æˆæ–°å‹äº¤æ˜“ç±»å‹ï¼Œå³å°†å‡ºä»·ä½œä¸ºè´¹ç”¨ä¸Šé™ï¼Œå¹¶å°†å‡ºä»·å‡å»åŸºç¡€è´¹ç”¨ä½œä¸ºä¼˜å…ˆè´¹ç”¨ã€‚ \n\n\n\n## äºŒã€æ­£ç¡®è®¾ç½®GAS\n\n**GAS fee** = **Base fee**(å®Œæˆæ“ä½œéœ€è¦ä»˜çš„åŸºæœ¬è´¹ç”¨) + **Priority fee**(å°è´¹ï¼šå°è´¹è¶Šé«˜ï¼Œè¶Šå®¹æ˜“æŠ¢åˆ°)\n\næ€»è´¹ç”¨ = (åŒºå—åŸºç¡€è´¹ + å®é™…ä¼˜å…ˆè´¹) * Gasä½¿ç”¨æ•°é‡\n\nä¹Ÿå°±æ˜¯æ€»è´¹ç”¨ = (base fee + priority fee) * gas limit(ç”¨æˆ·å…è®¸è¿™ç¬”äº¤æ˜“æœ€å¤§å¯æ¶ˆè€—çš„ Gas æ•°é‡)\n\n![image-20240131135302973](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131135302973.png)\n\nå¾…è®¾ç½®ï¼š\n\n**Max Priority Fee**ï¼šä½ æœ€å¤šæ„¿æ„ä»˜ç»™çŸ¿å·¥çš„ä¼˜å…ˆè´¹(å°è´¹)ï¼Œå•ä½ä¸ºGWEI\n**Max Fee**ï¼šåŸºæœ¬è´¹ç”¨ + ä¼˜å…ˆè´¹\n\nå®é™…ï¼š**Priority Fee = Minï¼ˆMax Priority Fee, Max Fee - Base Feeï¼‰**\n\n\n\n## ä¸‰ã€è®¾ç½®æŠ€å·§ \n\nå¦‚æœæˆ‘ä»¬è¦ç»™100GWEIçš„å°è´¹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ï¼š\n\n1.Max Priority Fee(GWEI) = 100\n\n2.Max Fee(GWEI) = (Base Fee * 2)  + Max Priority Fee(100)\n\næ³¨æ„ï¼šbase feeä»£è¡¨åŸºç¡€è´¹ç”¨ä¼šæœ‰æ³¢åŠ¨ï¼Œä¸”å¤šä½™base feeä¼šè¿”è¿˜æ‰€ä»¥*2\n\nGASå‚è€ƒç½‘ç«™ï¼šhttps://www.blocknative.com/gas-estimator\n\n![image-20240131130128416](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131130128416.png)\n\nå‡å¦‚æˆ‘ä»¬æƒ³è¦99%çš„æ‰“åŒ…æˆåŠŸç‡ï¼Œå¯ä»¥è®¾ç½®Max Priority Feeä¸º0.1ï¼Œè®¾ç½®max feeä¸º26ã€‚\n\n\n\nå‚è€ƒæ–‡ç« ï¼š[MetaMaské’±åŒ…å·²æ”¯æŒEIP-1559ï¼Œä¸€æ¬¡äº†è§£è°ƒæ•´ä¼˜å…ˆè´¹ã€è¿›é˜¶è®¾ç½®](https://www.wwsww.cn/qianbao/9482.html)\nå‚è€ƒæ–‡ç« ï¼š[Web3.0å­¦ä¹ æ ‘|3.åŒºå—é“¾é€šè¯† â…¢](https://mirror.xyz/looplove.eth/SOhMBCF_Z4vIWFHu4r8fpdBaLMhRTBCvNj6i5d4pNMU)\n\nå†…å®¹æ¥æºï¼š[æ²¹ç®¡](https://www.youtube.com/watch?v=Qpq00RGT5Bc)\n","source":"_posts/å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜.md","raw":"---\ntitle: å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜\ndate: 2024-01-31 15:16:55\ntags:\n---\n\n> **EIP-1559**æ˜¯ä¸€é¡¹ä»¥å¤ªåŠæ”¹è¿›ææ¡ˆï¼Œæ—¨åœ¨ä¼˜åŒ–ä»¥å¤ªåŠåŒºå—é“¾çš„è´¹ç”¨å¸‚åœºç³»ç»Ÿã€‚ EIP-1559 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ”¶è´¹ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå…³é”®è¦ç´ ï¼š**åŸºæœ¬è´¹ç”¨(base fee)**ã€**ä¼˜å…ˆå°è´¹(priority fee)**å’Œ**è´¹ç”¨ä¸Šé™(max fee)**ã€‚\n\n\n\n## ä¸€ã€EIP-1559ç‰¹ç‚¹\n\n- åŸºç¡€è´¹ç”¨:eip1559å¼•å…¥äº†ä¸€ç§æ–°çš„æ”¶è´¹æœºåˆ¶ï¼Œå³æ¯ä¸ªåŒºå—éƒ½æœ‰ä¸€ä¸ªç”±åè®®æ ¹æ®åŒºå—éœ€æ±‚åŠ¨æ€è°ƒæ•´çš„åŸºç¡€è´¹ç”¨(base fee)ï¼Œè¡¨ç¤ºåœ¨è¯¥åŒºå—ä¸­è¿›è¡Œäº¤æ˜“æ—¶éœ€è¦æ”¯ä»˜çš„æœ€ä½æ‰‹ç»­è´¹ã€‚åŸºç¡€è´¹ç”¨çš„ç›®æ ‡æ˜¯è®©æ¯ä¸ªåŒºå—çš„ä½¿ç”¨ç‡ç»´æŒåœ¨50%ï¼Œä»è€Œé¿å…è¿‡åº¦æ‹¥å µæˆ–æµªè´¹ã€‚åŸºç¡€è´¹ç”¨ä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«é”€æ¯(burn)ï¼Œä»è€Œå‡å°‘ETHçš„æµé€šä¾›åº”ã€‚\n- ä¼˜å…ˆè´¹ç”¨:é™¤äº†åŸºç¡€è´¹ç”¨å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªä¼˜å…ˆè´¹ç”¨(priority fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„é¢å¤–æ”¯ä»˜ç»™çŸ¿å·¥/éªŒè¯è€…çš„æ¿€åŠ±ï¼Œä»¥ä¾¿è®©è‡ªå·±çš„äº¤æ˜“æ›´å¿«è¢«ç¡®è®¤ã€‚ä¼˜å…ˆè´¹ç”¨ä¹Ÿä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«çŸ¿å·¥/éªŒè¯è€…ä¿ç•™ã€‚\n- è´¹ç”¨ä¸Šé™:ç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªè´¹ç”¨ä¸Šé™(max fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„ä¸ºä¸€ç¬”äº¤æ˜“æ”¯ä»˜çš„æœ€é«˜æ‰‹ç»­è´¹ã€‚è´¹ç”¨ä¸Šé™åŒ…æ‹¬åŸºç¡€è´¹ç”¨å’Œä¼˜å…ˆè´¹ç”¨ï¼Œå½“äº¤æ˜“è¢«ç¡®è®¤æ—¶ï¼Œç”¨æˆ·ä¼šæ”¶åˆ°ä¸€ç¬”é€€æ¬¾ï¼Œç”±å®é™…æ”¯ä»˜é‡‘é¢å’Œè´¹ç”¨ä¸Šé™ä¹‹é—´çš„å·®é¢ç»„æˆã€‚è¿™ä¸ªæœºåˆ¶ç¡®ä¿äº†ç”¨æˆ·æ°¸è¿œä¸ä¼šè¶…å‡ºä»–ä»¬æ‰€è®¾å®šçš„é¢„ç®—ã€‚\n- åŒé‡äº¤æ˜“ç±»å‹:eip1559å…¼å®¹ä¸¤ç§äº¤æ˜“ç±»å‹ï¼Œå³æ–°å‹äº¤æ˜“ç±»å‹å’Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ã€‚æ–°å‹äº¤æ˜“ç±»å‹éµå¾ªeip1559çš„è§„åˆ™ï¼Œå³æŒ‡å®šåŸºç¡€è´¹ç”¨ã€ä¼˜å…ˆè´¹ç”¨å’Œè´¹ç”¨ä¸Šé™ã€‚ä¼ ç»Ÿäº¤æ˜“ç±»å‹éµå¾ªåŸæœ‰çš„è§„åˆ™ï¼Œå³æŒ‡å®šä¸€ä¸ªå›ºå®šçš„å‡ºä»·(gasprice)ã€‚ä¸ºäº†è®©ä¸¤ç§äº¤æ˜“ç±»å‹èƒ½å¤Ÿå…±å­˜ï¼Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ä¼šè¢«è½¬æ¢æˆæ–°å‹äº¤æ˜“ç±»å‹ï¼Œå³å°†å‡ºä»·ä½œä¸ºè´¹ç”¨ä¸Šé™ï¼Œå¹¶å°†å‡ºä»·å‡å»åŸºç¡€è´¹ç”¨ä½œä¸ºä¼˜å…ˆè´¹ç”¨ã€‚ \n\n\n\n## äºŒã€æ­£ç¡®è®¾ç½®GAS\n\n**GAS fee** = **Base fee**(å®Œæˆæ“ä½œéœ€è¦ä»˜çš„åŸºæœ¬è´¹ç”¨) + **Priority fee**(å°è´¹ï¼šå°è´¹è¶Šé«˜ï¼Œè¶Šå®¹æ˜“æŠ¢åˆ°)\n\næ€»è´¹ç”¨ = (åŒºå—åŸºç¡€è´¹ + å®é™…ä¼˜å…ˆè´¹) * Gasä½¿ç”¨æ•°é‡\n\nä¹Ÿå°±æ˜¯æ€»è´¹ç”¨ = (base fee + priority fee) * gas limit(ç”¨æˆ·å…è®¸è¿™ç¬”äº¤æ˜“æœ€å¤§å¯æ¶ˆè€—çš„ Gas æ•°é‡)\n\n![image-20240131135302973](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131135302973.png)\n\nå¾…è®¾ç½®ï¼š\n\n**Max Priority Fee**ï¼šä½ æœ€å¤šæ„¿æ„ä»˜ç»™çŸ¿å·¥çš„ä¼˜å…ˆè´¹(å°è´¹)ï¼Œå•ä½ä¸ºGWEI\n**Max Fee**ï¼šåŸºæœ¬è´¹ç”¨ + ä¼˜å…ˆè´¹\n\nå®é™…ï¼š**Priority Fee = Minï¼ˆMax Priority Fee, Max Fee - Base Feeï¼‰**\n\n\n\n## ä¸‰ã€è®¾ç½®æŠ€å·§ \n\nå¦‚æœæˆ‘ä»¬è¦ç»™100GWEIçš„å°è´¹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ï¼š\n\n1.Max Priority Fee(GWEI) = 100\n\n2.Max Fee(GWEI) = (Base Fee * 2)  + Max Priority Fee(100)\n\næ³¨æ„ï¼šbase feeä»£è¡¨åŸºç¡€è´¹ç”¨ä¼šæœ‰æ³¢åŠ¨ï¼Œä¸”å¤šä½™base feeä¼šè¿”è¿˜æ‰€ä»¥*2\n\nGASå‚è€ƒç½‘ç«™ï¼šhttps://www.blocknative.com/gas-estimator\n\n![image-20240131130128416](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131130128416.png)\n\nå‡å¦‚æˆ‘ä»¬æƒ³è¦99%çš„æ‰“åŒ…æˆåŠŸç‡ï¼Œå¯ä»¥è®¾ç½®Max Priority Feeä¸º0.1ï¼Œè®¾ç½®max feeä¸º26ã€‚\n\n\n\nå‚è€ƒæ–‡ç« ï¼š[MetaMaské’±åŒ…å·²æ”¯æŒEIP-1559ï¼Œä¸€æ¬¡äº†è§£è°ƒæ•´ä¼˜å…ˆè´¹ã€è¿›é˜¶è®¾ç½®](https://www.wwsww.cn/qianbao/9482.html)\nå‚è€ƒæ–‡ç« ï¼š[Web3.0å­¦ä¹ æ ‘|3.åŒºå—é“¾é€šè¯† â…¢](https://mirror.xyz/looplove.eth/SOhMBCF_Z4vIWFHu4r8fpdBaLMhRTBCvNj6i5d4pNMU)\n\nå†…å®¹æ¥æºï¼š[æ²¹ç®¡](https://www.youtube.com/watch?v=Qpq00RGT5Bc)\n","slug":"å…³äºEIP1559ä¸‹çš„GASè´¹è®¾ç½®é—®é¢˜","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dp0011wen1c2o150eq","content":"<blockquote>\n<p><strong>EIP-1559</strong>æ˜¯ä¸€é¡¹ä»¥å¤ªåŠæ”¹è¿›ææ¡ˆï¼Œæ—¨åœ¨ä¼˜åŒ–ä»¥å¤ªåŠåŒºå—é“¾çš„è´¹ç”¨å¸‚åœºç³»ç»Ÿã€‚ EIP-1559 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ”¶è´¹ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå…³é”®è¦ç´ ï¼š**åŸºæœ¬è´¹ç”¨(base fee)<strong>ã€</strong>ä¼˜å…ˆå°è´¹(priority fee)<strong>å’Œ</strong>è´¹ç”¨ä¸Šé™(max fee)**ã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€EIP-1559ç‰¹ç‚¹\"><a href=\"#ä¸€ã€EIP-1559ç‰¹ç‚¹\" class=\"headerlink\" title=\"ä¸€ã€EIP-1559ç‰¹ç‚¹\"></a>ä¸€ã€EIP-1559ç‰¹ç‚¹</h2><ul>\n<li>åŸºç¡€è´¹ç”¨:eip1559å¼•å…¥äº†ä¸€ç§æ–°çš„æ”¶è´¹æœºåˆ¶ï¼Œå³æ¯ä¸ªåŒºå—éƒ½æœ‰ä¸€ä¸ªç”±åè®®æ ¹æ®åŒºå—éœ€æ±‚åŠ¨æ€è°ƒæ•´çš„åŸºç¡€è´¹ç”¨(base fee)ï¼Œè¡¨ç¤ºåœ¨è¯¥åŒºå—ä¸­è¿›è¡Œäº¤æ˜“æ—¶éœ€è¦æ”¯ä»˜çš„æœ€ä½æ‰‹ç»­è´¹ã€‚åŸºç¡€è´¹ç”¨çš„ç›®æ ‡æ˜¯è®©æ¯ä¸ªåŒºå—çš„ä½¿ç”¨ç‡ç»´æŒåœ¨50%ï¼Œä»è€Œé¿å…è¿‡åº¦æ‹¥å µæˆ–æµªè´¹ã€‚åŸºç¡€è´¹ç”¨ä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«é”€æ¯(burn)ï¼Œä»è€Œå‡å°‘ETHçš„æµé€šä¾›åº”ã€‚</li>\n<li>ä¼˜å…ˆè´¹ç”¨:é™¤äº†åŸºç¡€è´¹ç”¨å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªä¼˜å…ˆè´¹ç”¨(priority fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„é¢å¤–æ”¯ä»˜ç»™çŸ¿å·¥&#x2F;éªŒè¯è€…çš„æ¿€åŠ±ï¼Œä»¥ä¾¿è®©è‡ªå·±çš„äº¤æ˜“æ›´å¿«è¢«ç¡®è®¤ã€‚ä¼˜å…ˆè´¹ç”¨ä¹Ÿä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«çŸ¿å·¥&#x2F;éªŒè¯è€…ä¿ç•™ã€‚</li>\n<li>è´¹ç”¨ä¸Šé™:ç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªè´¹ç”¨ä¸Šé™(max fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„ä¸ºä¸€ç¬”äº¤æ˜“æ”¯ä»˜çš„æœ€é«˜æ‰‹ç»­è´¹ã€‚è´¹ç”¨ä¸Šé™åŒ…æ‹¬åŸºç¡€è´¹ç”¨å’Œä¼˜å…ˆè´¹ç”¨ï¼Œå½“äº¤æ˜“è¢«ç¡®è®¤æ—¶ï¼Œç”¨æˆ·ä¼šæ”¶åˆ°ä¸€ç¬”é€€æ¬¾ï¼Œç”±å®é™…æ”¯ä»˜é‡‘é¢å’Œè´¹ç”¨ä¸Šé™ä¹‹é—´çš„å·®é¢ç»„æˆã€‚è¿™ä¸ªæœºåˆ¶ç¡®ä¿äº†ç”¨æˆ·æ°¸è¿œä¸ä¼šè¶…å‡ºä»–ä»¬æ‰€è®¾å®šçš„é¢„ç®—ã€‚</li>\n<li>åŒé‡äº¤æ˜“ç±»å‹:eip1559å…¼å®¹ä¸¤ç§äº¤æ˜“ç±»å‹ï¼Œå³æ–°å‹äº¤æ˜“ç±»å‹å’Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ã€‚æ–°å‹äº¤æ˜“ç±»å‹éµå¾ªeip1559çš„è§„åˆ™ï¼Œå³æŒ‡å®šåŸºç¡€è´¹ç”¨ã€ä¼˜å…ˆè´¹ç”¨å’Œè´¹ç”¨ä¸Šé™ã€‚ä¼ ç»Ÿäº¤æ˜“ç±»å‹éµå¾ªåŸæœ‰çš„è§„åˆ™ï¼Œå³æŒ‡å®šä¸€ä¸ªå›ºå®šçš„å‡ºä»·(gasprice)ã€‚ä¸ºäº†è®©ä¸¤ç§äº¤æ˜“ç±»å‹èƒ½å¤Ÿå…±å­˜ï¼Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ä¼šè¢«è½¬æ¢æˆæ–°å‹äº¤æ˜“ç±»å‹ï¼Œå³å°†å‡ºä»·ä½œä¸ºè´¹ç”¨ä¸Šé™ï¼Œå¹¶å°†å‡ºä»·å‡å»åŸºç¡€è´¹ç”¨ä½œä¸ºä¼˜å…ˆè´¹ç”¨ã€‚</li>\n</ul>\n<h2 id=\"äºŒã€æ­£ç¡®è®¾ç½®GAS\"><a href=\"#äºŒã€æ­£ç¡®è®¾ç½®GAS\" class=\"headerlink\" title=\"äºŒã€æ­£ç¡®è®¾ç½®GAS\"></a>äºŒã€æ­£ç¡®è®¾ç½®GAS</h2><p><strong>GAS fee</strong> &#x3D; <strong>Base fee</strong>(å®Œæˆæ“ä½œéœ€è¦ä»˜çš„åŸºæœ¬è´¹ç”¨) + <strong>Priority fee</strong>(å°è´¹ï¼šå°è´¹è¶Šé«˜ï¼Œè¶Šå®¹æ˜“æŠ¢åˆ°)</p>\n<p>æ€»è´¹ç”¨ &#x3D; (åŒºå—åŸºç¡€è´¹ + å®é™…ä¼˜å…ˆè´¹) * Gasä½¿ç”¨æ•°é‡</p>\n<p>ä¹Ÿå°±æ˜¯æ€»è´¹ç”¨ &#x3D; (base fee + priority fee) * gas limit(ç”¨æˆ·å…è®¸è¿™ç¬”äº¤æ˜“æœ€å¤§å¯æ¶ˆè€—çš„ Gas æ•°é‡)</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131135302973.png\" alt=\"image-20240131135302973\"></p>\n<p>å¾…è®¾ç½®ï¼š</p>\n<p><strong>Max Priority Fee</strong>ï¼šä½ æœ€å¤šæ„¿æ„ä»˜ç»™çŸ¿å·¥çš„ä¼˜å…ˆè´¹(å°è´¹)ï¼Œå•ä½ä¸ºGWEI<br><strong>Max Fee</strong>ï¼šåŸºæœ¬è´¹ç”¨ + ä¼˜å…ˆè´¹</p>\n<p>å®é™…ï¼š<strong>Priority Fee &#x3D; Minï¼ˆMax Priority Fee, Max Fee - Base Feeï¼‰</strong></p>\n<h2 id=\"ä¸‰ã€è®¾ç½®æŠ€å·§\"><a href=\"#ä¸‰ã€è®¾ç½®æŠ€å·§\" class=\"headerlink\" title=\"ä¸‰ã€è®¾ç½®æŠ€å·§\"></a>ä¸‰ã€è®¾ç½®æŠ€å·§</h2><p>å¦‚æœæˆ‘ä»¬è¦ç»™100GWEIçš„å°è´¹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ï¼š</p>\n<p>1.Max Priority Fee(GWEI) &#x3D; 100</p>\n<p>2.Max Fee(GWEI) &#x3D; (Base Fee * 2)  + Max Priority Fee(100)</p>\n<p>æ³¨æ„ï¼šbase feeä»£è¡¨åŸºç¡€è´¹ç”¨ä¼šæœ‰æ³¢åŠ¨ï¼Œä¸”å¤šä½™base feeä¼šè¿”è¿˜æ‰€ä»¥*2</p>\n<p>GASå‚è€ƒç½‘ç«™ï¼š<a href=\"https://www.blocknative.com/gas-estimator\">https://www.blocknative.com/gas-estimator</a></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131130128416.png\" alt=\"image-20240131130128416\"></p>\n<p>å‡å¦‚æˆ‘ä»¬æƒ³è¦99%çš„æ‰“åŒ…æˆåŠŸç‡ï¼Œå¯ä»¥è®¾ç½®Max Priority Feeä¸º0.1ï¼Œè®¾ç½®max feeä¸º26ã€‚</p>\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.wwsww.cn/qianbao/9482.html\">MetaMaské’±åŒ…å·²æ”¯æŒEIP-1559ï¼Œä¸€æ¬¡äº†è§£è°ƒæ•´ä¼˜å…ˆè´¹ã€è¿›é˜¶è®¾ç½®</a><br>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://mirror.xyz/looplove.eth/SOhMBCF_Z4vIWFHu4r8fpdBaLMhRTBCvNj6i5d4pNMU\">Web3.0å­¦ä¹ æ ‘|3.åŒºå—é“¾é€šè¯† â…¢</a></p>\n<p>å†…å®¹æ¥æºï¼š<a href=\"https://www.youtube.com/watch?v=Qpq00RGT5Bc\">æ²¹ç®¡</a></p>\n","excerpt":"","more":"<blockquote>\n<p><strong>EIP-1559</strong>æ˜¯ä¸€é¡¹ä»¥å¤ªåŠæ”¹è¿›ææ¡ˆï¼Œæ—¨åœ¨ä¼˜åŒ–ä»¥å¤ªåŠåŒºå—é“¾çš„è´¹ç”¨å¸‚åœºç³»ç»Ÿã€‚ EIP-1559 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ”¶è´¹ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå…³é”®è¦ç´ ï¼š**åŸºæœ¬è´¹ç”¨(base fee)<strong>ã€</strong>ä¼˜å…ˆå°è´¹(priority fee)<strong>å’Œ</strong>è´¹ç”¨ä¸Šé™(max fee)**ã€‚</p>\n</blockquote>\n<h2 id=\"ä¸€ã€EIP-1559ç‰¹ç‚¹\"><a href=\"#ä¸€ã€EIP-1559ç‰¹ç‚¹\" class=\"headerlink\" title=\"ä¸€ã€EIP-1559ç‰¹ç‚¹\"></a>ä¸€ã€EIP-1559ç‰¹ç‚¹</h2><ul>\n<li>åŸºç¡€è´¹ç”¨:eip1559å¼•å…¥äº†ä¸€ç§æ–°çš„æ”¶è´¹æœºåˆ¶ï¼Œå³æ¯ä¸ªåŒºå—éƒ½æœ‰ä¸€ä¸ªç”±åè®®æ ¹æ®åŒºå—éœ€æ±‚åŠ¨æ€è°ƒæ•´çš„åŸºç¡€è´¹ç”¨(base fee)ï¼Œè¡¨ç¤ºåœ¨è¯¥åŒºå—ä¸­è¿›è¡Œäº¤æ˜“æ—¶éœ€è¦æ”¯ä»˜çš„æœ€ä½æ‰‹ç»­è´¹ã€‚åŸºç¡€è´¹ç”¨çš„ç›®æ ‡æ˜¯è®©æ¯ä¸ªåŒºå—çš„ä½¿ç”¨ç‡ç»´æŒåœ¨50%ï¼Œä»è€Œé¿å…è¿‡åº¦æ‹¥å µæˆ–æµªè´¹ã€‚åŸºç¡€è´¹ç”¨ä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«é”€æ¯(burn)ï¼Œä»è€Œå‡å°‘ETHçš„æµé€šä¾›åº”ã€‚</li>\n<li>ä¼˜å…ˆè´¹ç”¨:é™¤äº†åŸºç¡€è´¹ç”¨å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªä¼˜å…ˆè´¹ç”¨(priority fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„é¢å¤–æ”¯ä»˜ç»™çŸ¿å·¥&#x2F;éªŒè¯è€…çš„æ¿€åŠ±ï¼Œä»¥ä¾¿è®©è‡ªå·±çš„äº¤æ˜“æ›´å¿«è¢«ç¡®è®¤ã€‚ä¼˜å…ˆè´¹ç”¨ä¹Ÿä»¥ETHä»£å¸æ”¯ä»˜ï¼Œå¹¶ä¸”è¢«çŸ¿å·¥&#x2F;éªŒè¯è€…ä¿ç•™ã€‚</li>\n<li>è´¹ç”¨ä¸Šé™:ç”¨æˆ·è¿˜å¯ä»¥ä¸ºè‡ªå·±çš„äº¤æ˜“è®¾ç½®ä¸€ä¸ªè´¹ç”¨ä¸Šé™(max fee)ï¼Œè¡¨ç¤ºä»–ä»¬æ„¿æ„ä¸ºä¸€ç¬”äº¤æ˜“æ”¯ä»˜çš„æœ€é«˜æ‰‹ç»­è´¹ã€‚è´¹ç”¨ä¸Šé™åŒ…æ‹¬åŸºç¡€è´¹ç”¨å’Œä¼˜å…ˆè´¹ç”¨ï¼Œå½“äº¤æ˜“è¢«ç¡®è®¤æ—¶ï¼Œç”¨æˆ·ä¼šæ”¶åˆ°ä¸€ç¬”é€€æ¬¾ï¼Œç”±å®é™…æ”¯ä»˜é‡‘é¢å’Œè´¹ç”¨ä¸Šé™ä¹‹é—´çš„å·®é¢ç»„æˆã€‚è¿™ä¸ªæœºåˆ¶ç¡®ä¿äº†ç”¨æˆ·æ°¸è¿œä¸ä¼šè¶…å‡ºä»–ä»¬æ‰€è®¾å®šçš„é¢„ç®—ã€‚</li>\n<li>åŒé‡äº¤æ˜“ç±»å‹:eip1559å…¼å®¹ä¸¤ç§äº¤æ˜“ç±»å‹ï¼Œå³æ–°å‹äº¤æ˜“ç±»å‹å’Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ã€‚æ–°å‹äº¤æ˜“ç±»å‹éµå¾ªeip1559çš„è§„åˆ™ï¼Œå³æŒ‡å®šåŸºç¡€è´¹ç”¨ã€ä¼˜å…ˆè´¹ç”¨å’Œè´¹ç”¨ä¸Šé™ã€‚ä¼ ç»Ÿäº¤æ˜“ç±»å‹éµå¾ªåŸæœ‰çš„è§„åˆ™ï¼Œå³æŒ‡å®šä¸€ä¸ªå›ºå®šçš„å‡ºä»·(gasprice)ã€‚ä¸ºäº†è®©ä¸¤ç§äº¤æ˜“ç±»å‹èƒ½å¤Ÿå…±å­˜ï¼Œä¼ ç»Ÿäº¤æ˜“ç±»å‹ä¼šè¢«è½¬æ¢æˆæ–°å‹äº¤æ˜“ç±»å‹ï¼Œå³å°†å‡ºä»·ä½œä¸ºè´¹ç”¨ä¸Šé™ï¼Œå¹¶å°†å‡ºä»·å‡å»åŸºç¡€è´¹ç”¨ä½œä¸ºä¼˜å…ˆè´¹ç”¨ã€‚</li>\n</ul>\n<h2 id=\"äºŒã€æ­£ç¡®è®¾ç½®GAS\"><a href=\"#äºŒã€æ­£ç¡®è®¾ç½®GAS\" class=\"headerlink\" title=\"äºŒã€æ­£ç¡®è®¾ç½®GAS\"></a>äºŒã€æ­£ç¡®è®¾ç½®GAS</h2><p><strong>GAS fee</strong> &#x3D; <strong>Base fee</strong>(å®Œæˆæ“ä½œéœ€è¦ä»˜çš„åŸºæœ¬è´¹ç”¨) + <strong>Priority fee</strong>(å°è´¹ï¼šå°è´¹è¶Šé«˜ï¼Œè¶Šå®¹æ˜“æŠ¢åˆ°)</p>\n<p>æ€»è´¹ç”¨ &#x3D; (åŒºå—åŸºç¡€è´¹ + å®é™…ä¼˜å…ˆè´¹) * Gasä½¿ç”¨æ•°é‡</p>\n<p>ä¹Ÿå°±æ˜¯æ€»è´¹ç”¨ &#x3D; (base fee + priority fee) * gas limit(ç”¨æˆ·å…è®¸è¿™ç¬”äº¤æ˜“æœ€å¤§å¯æ¶ˆè€—çš„ Gas æ•°é‡)</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131135302973.png\" alt=\"image-20240131135302973\"></p>\n<p>å¾…è®¾ç½®ï¼š</p>\n<p><strong>Max Priority Fee</strong>ï¼šä½ æœ€å¤šæ„¿æ„ä»˜ç»™çŸ¿å·¥çš„ä¼˜å…ˆè´¹(å°è´¹)ï¼Œå•ä½ä¸ºGWEI<br><strong>Max Fee</strong>ï¼šåŸºæœ¬è´¹ç”¨ + ä¼˜å…ˆè´¹</p>\n<p>å®é™…ï¼š<strong>Priority Fee &#x3D; Minï¼ˆMax Priority Fee, Max Fee - Base Feeï¼‰</strong></p>\n<h2 id=\"ä¸‰ã€è®¾ç½®æŠ€å·§\"><a href=\"#ä¸‰ã€è®¾ç½®æŠ€å·§\" class=\"headerlink\" title=\"ä¸‰ã€è®¾ç½®æŠ€å·§\"></a>ä¸‰ã€è®¾ç½®æŠ€å·§</h2><p>å¦‚æœæˆ‘ä»¬è¦ç»™100GWEIçš„å°è´¹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ï¼š</p>\n<p>1.Max Priority Fee(GWEI) &#x3D; 100</p>\n<p>2.Max Fee(GWEI) &#x3D; (Base Fee * 2)  + Max Priority Fee(100)</p>\n<p>æ³¨æ„ï¼šbase feeä»£è¡¨åŸºç¡€è´¹ç”¨ä¼šæœ‰æ³¢åŠ¨ï¼Œä¸”å¤šä½™base feeä¼šè¿”è¿˜æ‰€ä»¥*2</p>\n<p>GASå‚è€ƒç½‘ç«™ï¼š<a href=\"https://www.blocknative.com/gas-estimator\">https://www.blocknative.com/gas-estimator</a></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240131130128416.png\" alt=\"image-20240131130128416\"></p>\n<p>å‡å¦‚æˆ‘ä»¬æƒ³è¦99%çš„æ‰“åŒ…æˆåŠŸç‡ï¼Œå¯ä»¥è®¾ç½®Max Priority Feeä¸º0.1ï¼Œè®¾ç½®max feeä¸º26ã€‚</p>\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.wwsww.cn/qianbao/9482.html\">MetaMaské’±åŒ…å·²æ”¯æŒEIP-1559ï¼Œä¸€æ¬¡äº†è§£è°ƒæ•´ä¼˜å…ˆè´¹ã€è¿›é˜¶è®¾ç½®</a><br>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://mirror.xyz/looplove.eth/SOhMBCF_Z4vIWFHu4r8fpdBaLMhRTBCvNj6i5d4pNMU\">Web3.0å­¦ä¹ æ ‘|3.åŒºå—é“¾é€šè¯† â…¢</a></p>\n<p>å†…å®¹æ¥æºï¼š<a href=\"https://www.youtube.com/watch?v=Qpq00RGT5Bc\">æ²¹ç®¡</a></p>\n"},{"title":"å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜","date":"2025-08-08T07:23:49.000Z","_content":"\n> å¾®ä¿¡å°ç¨‹åºåœ¨ iOS è®¾å¤‡ä¸Šå¼•ç”¨å­—ä½“æ­£å¸¸ï¼Œä½†åœ¨ å®‰å“ è®¾å¤‡ä¸Šæ— æ³•åŠ è½½æ—¶ï¼Œé€šå¸¸ç”± Nginx é…ç½®é—®é¢˜å¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ¡ˆï¼š\n\n### Nginxé…ç½®è°ƒæ•´\n\n1. â€Œ**æ·»åŠ è·¨åŸŸæƒé™**â€Œ\n   åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­ï¼Œé’ˆå¯¹å­—ä½“æ–‡ä»¶ï¼ˆå¦‚`.woff`ã€`.ttf`ç­‰ï¼‰çš„è¯·æ±‚å¤´æ·»åŠ è·¨åŸŸæƒé™è®¾ç½®ï¼š\n\n   ```sh\n   \t\t# å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®\n       location ~* \\.(ttf|woff|woff2)$ {\n           add_header Access-Control-Allow-Origin *;\n           expires      30d;\n           error_log /dev/null;\n           access_log /dev/null;\n       }\n   ```\n\n2. â€Œ**è®¾ç½®å“åº”å¤´å‚æ•°**â€Œ\n   ç¡®ä¿å“åº”åŒ…å«ä»¥ä¸‹å¤´éƒ¨ä¿¡æ¯ï¼š\n\n    - `Access-Control-Allow-Origin: *`ï¼ˆå…è®¸æ‰€æœ‰æ¥æºè·¨åŸŸï¼‰\n    - `Cache-Control: no-cache`ï¼ˆç¦ç”¨ç¼“å­˜ï¼‰ â€Œ\n\n3. â€Œ**æ¸…ç†å°ç¨‹åºç¼“å­˜**â€Œ\n   è‹¥é…ç½®å®Œæˆåä»æ— æ³•ç”Ÿæ•ˆï¼Œéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ¸…ç†å°ç¨‹åºç¼“å­˜åé‡æ–°æµ‹è¯•ã€‚ â€Œ\n\n4. **å®Œæ•´é…ç½®**\n\n```\nserver\n{\n    listen 80;\n    listen 443 ssl http2 ;\n    server_name img.**.ruiyeclub.cn;\n    index index.html index.htm default.htm default.html;\n    root /www/wwwroot/img.**.ruiyeclub.cn;\n\n    #REWRITE-START URLé‡å†™è§„åˆ™å¼•ç”¨,ä¿®æ”¹åå°†å¯¼è‡´é¢æ¿è®¾ç½®çš„ä¼ªé™æ€è§„åˆ™å¤±æ•ˆ\n    include /www/server/panel/vhost/rewrite/html_img.**.ruiyeclub.cn.conf;\n    #REWRITE-END\n\n    #ç¦æ­¢è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•\n    location ~ ^/(\\.user.ini|\\.htaccess|\\.git|\\.env|\\.svn|\\.project|LICENSE|README.md)\n    {\n        return 404;\n    }\n\n    #ä¸€é”®ç”³è¯·SSLè¯ä¹¦éªŒè¯ç›®å½•ç›¸å…³è®¾ç½®\n    location ~ \\.well-known{\n        allow all;\n    }\n\n    #ç¦æ­¢åœ¨è¯ä¹¦éªŒè¯ç›®å½•æ”¾å…¥æ•æ„Ÿæ–‡ä»¶\n    if ( $uri ~ \"^/\\.well-known/.*\\.(php|jsp|py|js|css|lua|ts|go|zip|tar\\.gz|rar|7z|sql|bak)$\" ) {\n        return 403;\n    }\n\n    # å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®\n    location ~* \\.(ttf|woff|woff2)$ {\n        add_header Access-Control-Allow-Origin *;\n        expires      30d;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n\n    location ~ .*\\\\.(gif|jpg|jpeg|png|bmp|swf)$\n    {\n        add_header Cache-Control \"public, max-age=31536000\"; #my è®¾ç½®é™æ€èµ„æºçš„ç¼“å­˜æ—¶é—´ä¸º1å¹´ï¼ˆå•ä½ï¼šç§’ï¼‰\n\n        expires      30d;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n\n    location ~ .*\\\\.(js|css)?$\n    {\n        expires      12h;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n    access_log  /www/wwwlogs/img.**.ruiyeclub.cn.log;\n    error_log  /www/wwwlogs/img.**.ruiyeclub.cn.error.log;\n}\n```\n\n### æ³¨æ„äº‹é¡¹\n\n- å­—ä½“æ–‡ä»¶è·¯å¾„éœ€ä¸é…ç½®ä¸€è‡´ï¼Œä¾‹å¦‚å­˜æ”¾åœ¨`/www/wwwroot/***/public/static`ç›®å½•ä¸‹ã€‚ â€Œ\n- ä¸åŒå“ç‰Œå®‰å“æ‰‹æœºå¯¹è·¨åŸŸç­–ç•¥çš„å…¼å®¹æ€§å­˜åœ¨å·®å¼‚ï¼Œéƒ¨åˆ†æœºå‹éœ€é¢å¤–é…ç½®åŸŸåç™½åå•æˆ–ä¸šåŠ¡åŸŸåã€‚","source":"_posts/å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜.md","raw":"---\ntitle: å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜\ndate: 2025-08-08 15:23:49\ntags:\n---\n\n> å¾®ä¿¡å°ç¨‹åºåœ¨ iOS è®¾å¤‡ä¸Šå¼•ç”¨å­—ä½“æ­£å¸¸ï¼Œä½†åœ¨ å®‰å“ è®¾å¤‡ä¸Šæ— æ³•åŠ è½½æ—¶ï¼Œé€šå¸¸ç”± Nginx é…ç½®é—®é¢˜å¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ¡ˆï¼š\n\n### Nginxé…ç½®è°ƒæ•´\n\n1. â€Œ**æ·»åŠ è·¨åŸŸæƒé™**â€Œ\n   åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­ï¼Œé’ˆå¯¹å­—ä½“æ–‡ä»¶ï¼ˆå¦‚`.woff`ã€`.ttf`ç­‰ï¼‰çš„è¯·æ±‚å¤´æ·»åŠ è·¨åŸŸæƒé™è®¾ç½®ï¼š\n\n   ```sh\n   \t\t# å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®\n       location ~* \\.(ttf|woff|woff2)$ {\n           add_header Access-Control-Allow-Origin *;\n           expires      30d;\n           error_log /dev/null;\n           access_log /dev/null;\n       }\n   ```\n\n2. â€Œ**è®¾ç½®å“åº”å¤´å‚æ•°**â€Œ\n   ç¡®ä¿å“åº”åŒ…å«ä»¥ä¸‹å¤´éƒ¨ä¿¡æ¯ï¼š\n\n    - `Access-Control-Allow-Origin: *`ï¼ˆå…è®¸æ‰€æœ‰æ¥æºè·¨åŸŸï¼‰\n    - `Cache-Control: no-cache`ï¼ˆç¦ç”¨ç¼“å­˜ï¼‰ â€Œ\n\n3. â€Œ**æ¸…ç†å°ç¨‹åºç¼“å­˜**â€Œ\n   è‹¥é…ç½®å®Œæˆåä»æ— æ³•ç”Ÿæ•ˆï¼Œéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ¸…ç†å°ç¨‹åºç¼“å­˜åé‡æ–°æµ‹è¯•ã€‚ â€Œ\n\n4. **å®Œæ•´é…ç½®**\n\n```\nserver\n{\n    listen 80;\n    listen 443 ssl http2 ;\n    server_name img.**.ruiyeclub.cn;\n    index index.html index.htm default.htm default.html;\n    root /www/wwwroot/img.**.ruiyeclub.cn;\n\n    #REWRITE-START URLé‡å†™è§„åˆ™å¼•ç”¨,ä¿®æ”¹åå°†å¯¼è‡´é¢æ¿è®¾ç½®çš„ä¼ªé™æ€è§„åˆ™å¤±æ•ˆ\n    include /www/server/panel/vhost/rewrite/html_img.**.ruiyeclub.cn.conf;\n    #REWRITE-END\n\n    #ç¦æ­¢è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•\n    location ~ ^/(\\.user.ini|\\.htaccess|\\.git|\\.env|\\.svn|\\.project|LICENSE|README.md)\n    {\n        return 404;\n    }\n\n    #ä¸€é”®ç”³è¯·SSLè¯ä¹¦éªŒè¯ç›®å½•ç›¸å…³è®¾ç½®\n    location ~ \\.well-known{\n        allow all;\n    }\n\n    #ç¦æ­¢åœ¨è¯ä¹¦éªŒè¯ç›®å½•æ”¾å…¥æ•æ„Ÿæ–‡ä»¶\n    if ( $uri ~ \"^/\\.well-known/.*\\.(php|jsp|py|js|css|lua|ts|go|zip|tar\\.gz|rar|7z|sql|bak)$\" ) {\n        return 403;\n    }\n\n    # å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®\n    location ~* \\.(ttf|woff|woff2)$ {\n        add_header Access-Control-Allow-Origin *;\n        expires      30d;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n\n    location ~ .*\\\\.(gif|jpg|jpeg|png|bmp|swf)$\n    {\n        add_header Cache-Control \"public, max-age=31536000\"; #my è®¾ç½®é™æ€èµ„æºçš„ç¼“å­˜æ—¶é—´ä¸º1å¹´ï¼ˆå•ä½ï¼šç§’ï¼‰\n\n        expires      30d;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n\n    location ~ .*\\\\.(js|css)?$\n    {\n        expires      12h;\n        error_log /dev/null;\n        access_log /dev/null;\n    }\n    access_log  /www/wwwlogs/img.**.ruiyeclub.cn.log;\n    error_log  /www/wwwlogs/img.**.ruiyeclub.cn.error.log;\n}\n```\n\n### æ³¨æ„äº‹é¡¹\n\n- å­—ä½“æ–‡ä»¶è·¯å¾„éœ€ä¸é…ç½®ä¸€è‡´ï¼Œä¾‹å¦‚å­˜æ”¾åœ¨`/www/wwwroot/***/public/static`ç›®å½•ä¸‹ã€‚ â€Œ\n- ä¸åŒå“ç‰Œå®‰å“æ‰‹æœºå¯¹è·¨åŸŸç­–ç•¥çš„å…¼å®¹æ€§å­˜åœ¨å·®å¼‚ï¼Œéƒ¨åˆ†æœºå‹éœ€é¢å¤–é…ç½®åŸŸåç™½åå•æˆ–ä¸šåŠ¡åŸŸåã€‚","slug":"å…³äºå¾®ä¿¡å°ç¨‹åºï¼Œä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ï¼ŒIOSç”Ÿæ•ˆï¼Œå®‰å“ä¸ç”Ÿæ•ˆçš„é—®é¢˜","published":1,"updated":"2025-08-08T07:27:02.812Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dp0012wen12t179z6e","content":"<blockquote>\n<p>å¾®ä¿¡å°ç¨‹åºåœ¨ iOS è®¾å¤‡ä¸Šå¼•ç”¨å­—ä½“æ­£å¸¸ï¼Œä½†åœ¨ å®‰å“ è®¾å¤‡ä¸Šæ— æ³•åŠ è½½æ—¶ï¼Œé€šå¸¸ç”± Nginx é…ç½®é—®é¢˜å¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ¡ˆï¼š</p>\n</blockquote>\n<h3 id=\"Nginxé…ç½®è°ƒæ•´\"><a href=\"#Nginxé…ç½®è°ƒæ•´\" class=\"headerlink\" title=\"Nginxé…ç½®è°ƒæ•´\"></a>Nginxé…ç½®è°ƒæ•´</h3><ol>\n<li><p>â€Œ<strong>æ·»åŠ è·¨åŸŸæƒé™</strong>â€Œ<br>åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­ï¼Œé’ˆå¯¹å­—ä½“æ–‡ä»¶ï¼ˆå¦‚<code>.woff</code>ã€<code>.ttf</code>ç­‰ï¼‰çš„è¯·æ±‚å¤´æ·»åŠ è·¨åŸŸæƒé™è®¾ç½®ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®</span></span><br><span class=\"line\">  location ~* \\.(ttf|woff|woff2)$ &#123;</span><br><span class=\"line\">      add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">      expires      30d;</span><br><span class=\"line\">      error_log /dev/null;</span><br><span class=\"line\">      access_log /dev/null;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>â€Œ<strong>è®¾ç½®å“åº”å¤´å‚æ•°</strong>â€Œ<br>ç¡®ä¿å“åº”åŒ…å«ä»¥ä¸‹å¤´éƒ¨ä¿¡æ¯ï¼š</p>\n<ul>\n<li><code>Access-Control-Allow-Origin: *</code>ï¼ˆå…è®¸æ‰€æœ‰æ¥æºè·¨åŸŸï¼‰</li>\n<li><code>Cache-Control: no-cache</code>ï¼ˆç¦ç”¨ç¼“å­˜ï¼‰ â€Œ</li>\n</ul>\n</li>\n<li><p>â€Œ<strong>æ¸…ç†å°ç¨‹åºç¼“å­˜</strong>â€Œ<br>è‹¥é…ç½®å®Œæˆåä»æ— æ³•ç”Ÿæ•ˆï¼Œéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ¸…ç†å°ç¨‹åºç¼“å­˜åé‡æ–°æµ‹è¯•ã€‚ â€Œ</p>\n</li>\n<li><p><strong>å®Œæ•´é…ç½®</strong></p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    listen 443 ssl http2 ;</span><br><span class=\"line\">    server_name img.**.ruiyeclub.cn;</span><br><span class=\"line\">    index index.html index.htm default.htm default.html;</span><br><span class=\"line\">    root /www/wwwroot/img.**.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">    #REWRITE-START URLé‡å†™è§„åˆ™å¼•ç”¨,ä¿®æ”¹åå°†å¯¼è‡´é¢æ¿è®¾ç½®çš„ä¼ªé™æ€è§„åˆ™å¤±æ•ˆ</span><br><span class=\"line\">    include /www/server/panel/vhost/rewrite/html_img.**.ruiyeclub.cn.conf;</span><br><span class=\"line\">    #REWRITE-END</span><br><span class=\"line\"></span><br><span class=\"line\">    #ç¦æ­¢è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•</span><br><span class=\"line\">    location ~ ^/(\\.user.ini|\\.htaccess|\\.git|\\.env|\\.svn|\\.project|LICENSE|README.md)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return 404;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #ä¸€é”®ç”³è¯·SSLè¯ä¹¦éªŒè¯ç›®å½•ç›¸å…³è®¾ç½®</span><br><span class=\"line\">    location ~ \\.well-known&#123;</span><br><span class=\"line\">        allow all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #ç¦æ­¢åœ¨è¯ä¹¦éªŒè¯ç›®å½•æ”¾å…¥æ•æ„Ÿæ–‡ä»¶</span><br><span class=\"line\">    if ( $uri ~ &quot;^/\\.well-known/.*\\.(php|jsp|py|js|css|lua|ts|go|zip|tar\\.gz|rar|7z|sql|bak)$&quot; ) &#123;</span><br><span class=\"line\">        return 403;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®</span><br><span class=\"line\">    location ~* \\.(ttf|woff|woff2)$ &#123;</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">        expires      30d;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ .*\\\\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        add_header Cache-Control &quot;public, max-age=31536000&quot;; #my è®¾ç½®é™æ€èµ„æºçš„ç¼“å­˜æ—¶é—´ä¸º1å¹´ï¼ˆå•ä½ï¼šç§’ï¼‰</span><br><span class=\"line\"></span><br><span class=\"line\">        expires      30d;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ .*\\\\.(js|css)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires      12h;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    access_log  /www/wwwlogs/img.**.ruiyeclub.cn.log;</span><br><span class=\"line\">    error_log  /www/wwwlogs/img.**.ruiyeclub.cn.error.log;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ³¨æ„äº‹é¡¹\"><a href=\"#æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"æ³¨æ„äº‹é¡¹\"></a>æ³¨æ„äº‹é¡¹</h3><ul>\n<li>å­—ä½“æ–‡ä»¶è·¯å¾„éœ€ä¸é…ç½®ä¸€è‡´ï¼Œä¾‹å¦‚å­˜æ”¾åœ¨<code>/www/wwwroot/***/public/static</code>ç›®å½•ä¸‹ã€‚ â€Œ</li>\n<li>ä¸åŒå“ç‰Œå®‰å“æ‰‹æœºå¯¹è·¨åŸŸç­–ç•¥çš„å…¼å®¹æ€§å­˜åœ¨å·®å¼‚ï¼Œéƒ¨åˆ†æœºå‹éœ€é¢å¤–é…ç½®åŸŸåç™½åå•æˆ–ä¸šåŠ¡åŸŸåã€‚</li>\n</ul>\n","excerpt":"","more":"<blockquote>\n<p>å¾®ä¿¡å°ç¨‹åºåœ¨ iOS è®¾å¤‡ä¸Šå¼•ç”¨å­—ä½“æ­£å¸¸ï¼Œä½†åœ¨ å®‰å“ è®¾å¤‡ä¸Šæ— æ³•åŠ è½½æ—¶ï¼Œé€šå¸¸ç”± Nginx é…ç½®é—®é¢˜å¯¼è‡´ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ¡ˆï¼š</p>\n</blockquote>\n<h3 id=\"Nginxé…ç½®è°ƒæ•´\"><a href=\"#Nginxé…ç½®è°ƒæ•´\" class=\"headerlink\" title=\"Nginxé…ç½®è°ƒæ•´\"></a>Nginxé…ç½®è°ƒæ•´</h3><ol>\n<li><p>â€Œ<strong>æ·»åŠ è·¨åŸŸæƒé™</strong>â€Œ<br>åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­ï¼Œé’ˆå¯¹å­—ä½“æ–‡ä»¶ï¼ˆå¦‚<code>.woff</code>ã€<code>.ttf</code>ç­‰ï¼‰çš„è¯·æ±‚å¤´æ·»åŠ è·¨åŸŸæƒé™è®¾ç½®ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®</span></span><br><span class=\"line\">  location ~* \\.(ttf|woff|woff2)$ &#123;</span><br><span class=\"line\">      add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">      expires      30d;</span><br><span class=\"line\">      error_log /dev/null;</span><br><span class=\"line\">      access_log /dev/null;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>â€Œ<strong>è®¾ç½®å“åº”å¤´å‚æ•°</strong>â€Œ<br>ç¡®ä¿å“åº”åŒ…å«ä»¥ä¸‹å¤´éƒ¨ä¿¡æ¯ï¼š</p>\n<ul>\n<li><code>Access-Control-Allow-Origin: *</code>ï¼ˆå…è®¸æ‰€æœ‰æ¥æºè·¨åŸŸï¼‰</li>\n<li><code>Cache-Control: no-cache</code>ï¼ˆç¦ç”¨ç¼“å­˜ï¼‰ â€Œ</li>\n</ul>\n</li>\n<li><p>â€Œ<strong>æ¸…ç†å°ç¨‹åºç¼“å­˜</strong>â€Œ<br>è‹¥é…ç½®å®Œæˆåä»æ— æ³•ç”Ÿæ•ˆï¼Œéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ¸…ç†å°ç¨‹åºç¼“å­˜åé‡æ–°æµ‹è¯•ã€‚ â€Œ</p>\n</li>\n<li><p><strong>å®Œæ•´é…ç½®</strong></p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    listen 443 ssl http2 ;</span><br><span class=\"line\">    server_name img.**.ruiyeclub.cn;</span><br><span class=\"line\">    index index.html index.htm default.htm default.html;</span><br><span class=\"line\">    root /www/wwwroot/img.**.ruiyeclub.cn;</span><br><span class=\"line\"></span><br><span class=\"line\">    #REWRITE-START URLé‡å†™è§„åˆ™å¼•ç”¨,ä¿®æ”¹åå°†å¯¼è‡´é¢æ¿è®¾ç½®çš„ä¼ªé™æ€è§„åˆ™å¤±æ•ˆ</span><br><span class=\"line\">    include /www/server/panel/vhost/rewrite/html_img.**.ruiyeclub.cn.conf;</span><br><span class=\"line\">    #REWRITE-END</span><br><span class=\"line\"></span><br><span class=\"line\">    #ç¦æ­¢è®¿é—®çš„æ–‡ä»¶æˆ–ç›®å½•</span><br><span class=\"line\">    location ~ ^/(\\.user.ini|\\.htaccess|\\.git|\\.env|\\.svn|\\.project|LICENSE|README.md)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return 404;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #ä¸€é”®ç”³è¯·SSLè¯ä¹¦éªŒè¯ç›®å½•ç›¸å…³è®¾ç½®</span><br><span class=\"line\">    location ~ \\.well-known&#123;</span><br><span class=\"line\">        allow all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #ç¦æ­¢åœ¨è¯ä¹¦éªŒè¯ç›®å½•æ”¾å…¥æ•æ„Ÿæ–‡ä»¶</span><br><span class=\"line\">    if ( $uri ~ &quot;^/\\.well-known/.*\\.(php|jsp|py|js|css|lua|ts|go|zip|tar\\.gz|rar|7z|sql|bak)$&quot; ) &#123;</span><br><span class=\"line\">        return 403;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # å­—ä½“æ–‡ä»¶è·¨åŸŸè®¾ç½®</span><br><span class=\"line\">    location ~* \\.(ttf|woff|woff2)$ &#123;</span><br><span class=\"line\">        add_header Access-Control-Allow-Origin *;</span><br><span class=\"line\">        expires      30d;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ .*\\\\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        add_header Cache-Control &quot;public, max-age=31536000&quot;; #my è®¾ç½®é™æ€èµ„æºçš„ç¼“å­˜æ—¶é—´ä¸º1å¹´ï¼ˆå•ä½ï¼šç§’ï¼‰</span><br><span class=\"line\"></span><br><span class=\"line\">        expires      30d;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location ~ .*\\\\.(js|css)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires      12h;</span><br><span class=\"line\">        error_log /dev/null;</span><br><span class=\"line\">        access_log /dev/null;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    access_log  /www/wwwlogs/img.**.ruiyeclub.cn.log;</span><br><span class=\"line\">    error_log  /www/wwwlogs/img.**.ruiyeclub.cn.error.log;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ³¨æ„äº‹é¡¹\"><a href=\"#æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"æ³¨æ„äº‹é¡¹\"></a>æ³¨æ„äº‹é¡¹</h3><ul>\n<li>å­—ä½“æ–‡ä»¶è·¯å¾„éœ€ä¸é…ç½®ä¸€è‡´ï¼Œä¾‹å¦‚å­˜æ”¾åœ¨<code>/www/wwwroot/***/public/static</code>ç›®å½•ä¸‹ã€‚ â€Œ</li>\n<li>ä¸åŒå“ç‰Œå®‰å“æ‰‹æœºå¯¹è·¨åŸŸç­–ç•¥çš„å…¼å®¹æ€§å­˜åœ¨å·®å¼‚ï¼Œéƒ¨åˆ†æœºå‹éœ€é¢å¤–é…ç½®åŸŸåç™½åå•æˆ–ä¸šåŠ¡åŸŸåã€‚</li>\n</ul>\n"},{"title":"å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx","date":"2022-02-13T09:28:11.000Z","_content":"\né¡¹ç›®æ˜¯åŸºäºGradleæ„å»ºçš„ï¼Œåœ¨æ•´åˆswaggeråï¼Œå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ã€‚æŠ¥é”™æ—¥å¿—ï¼š\n\n```java\nDescription:\n\nAn attempt was made to call a method that does not exist. The attempt was made from the following location:\n\n    springfox.documentation.spring.web.plugins.DocumentationPluginsManager.createContextBuilder(DocumentationPluginsManager.java:152)\n\nThe following method did not exist:\n\n    'org.springframework.plugin.core.Plugin org.springframework.plugin.core.PluginRegistry.getPluginFor(java.lang.Object, org.springframework.plugin.core.Plugin)'\n\nThe method's class, org.springframework.plugin.core.PluginRegistry, is available from the following locations:\n\n    jar:file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar!/org/springframework/plugin/core/PluginRegistry.class\n\nIt was loaded from the following location:\n\n    file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar\n\n\nAction:\n\nCorrect the classpath of your application so that it contains a single, compatible version of org.springframework.plugin.core.PluginRegistry\n```\nç™¾åº¦ä¹‹åï¼Œå‘ç°æ˜¯jaråŒ…å†²çªäº†ï¼Œå¯¼å…¥äº†ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„jaråŒ…ã€‚å¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a3688f4401c04f3a53efb72e701a4457.png)\nè§£å†³åŠæ³•å¯ä»¥ç›´æ¥å°†ä¾èµ–ä¸­çš„jaråŒ…å‰”é™¤æ‰ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¯¥ä¾èµ–ä¹Ÿè¡Œã€‚\n","source":"_posts/å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx.md","raw":"---\ntitle: å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx\ndate: 2022-02-13 17:28:11\ntags:\n---\n\né¡¹ç›®æ˜¯åŸºäºGradleæ„å»ºçš„ï¼Œåœ¨æ•´åˆswaggeråï¼Œå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ã€‚æŠ¥é”™æ—¥å¿—ï¼š\n\n```java\nDescription:\n\nAn attempt was made to call a method that does not exist. The attempt was made from the following location:\n\n    springfox.documentation.spring.web.plugins.DocumentationPluginsManager.createContextBuilder(DocumentationPluginsManager.java:152)\n\nThe following method did not exist:\n\n    'org.springframework.plugin.core.Plugin org.springframework.plugin.core.PluginRegistry.getPluginFor(java.lang.Object, org.springframework.plugin.core.Plugin)'\n\nThe method's class, org.springframework.plugin.core.PluginRegistry, is available from the following locations:\n\n    jar:file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar!/org/springframework/plugin/core/PluginRegistry.class\n\nIt was loaded from the following location:\n\n    file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar\n\n\nAction:\n\nCorrect the classpath of your application so that it contains a single, compatible version of org.springframework.plugin.core.PluginRegistry\n```\nç™¾åº¦ä¹‹åï¼Œå‘ç°æ˜¯jaråŒ…å†²çªäº†ï¼Œå¯¼å…¥äº†ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„jaråŒ…ã€‚å¦‚å›¾ï¼š\n![image.png](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a3688f4401c04f3a53efb72e701a4457.png)\nè§£å†³åŠæ³•å¯ä»¥ç›´æ¥å°†ä¾èµ–ä¸­çš„jaråŒ…å‰”é™¤æ‰ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¯¥ä¾èµ–ä¹Ÿè¡Œã€‚\n","slug":"å¯åŠ¨é¡¹ç›®æŠ¥é”™Correct the classpath of your application so that it contains a single, compatible version of xxx","published":1,"updated":"2024-02-07T07:27:45.073Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dp0013wen128bg686j","content":"<p>é¡¹ç›®æ˜¯åŸºäºGradleæ„å»ºçš„ï¼Œåœ¨æ•´åˆswaggeråï¼Œå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ã€‚æŠ¥é”™æ—¥å¿—ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Description:</span><br><span class=\"line\"></span><br><span class=\"line\">An attempt was made to call a method that does not exist. The attempt was made from the following location:</span><br><span class=\"line\"></span><br><span class=\"line\">    springfox.documentation.spring.web.plugins.DocumentationPluginsManager.createContextBuilder(DocumentationPluginsManager.java:<span class=\"number\">152</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">The following method did not exist:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&#x27;org.springframework.plugin.core.Plugin org.springframework.plugin.core.PluginRegistry.getPluginFor(java.lang.Object, org.springframework.plugin.core.Plugin)&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">The method<span class=\"string\">&#x27;s class, org.springframework.plugin.core.PluginRegistry, is available from the following locations:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    jar:file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar!/org/springframework/plugin/core/PluginRegistry.class</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">It was loaded from the following location:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Action:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Correct the classpath of your application so that it contains a single, compatible version of org.springframework.plugin.core.PluginRegistry</span></span><br></pre></td></tr></table></figure>\n<p>ç™¾åº¦ä¹‹åï¼Œå‘ç°æ˜¯jaråŒ…å†²çªäº†ï¼Œå¯¼å…¥äº†ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„jaråŒ…ã€‚å¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a3688f4401c04f3a53efb72e701a4457.png\" alt=\"image.png\"><br>è§£å†³åŠæ³•å¯ä»¥ç›´æ¥å°†ä¾èµ–ä¸­çš„jaråŒ…å‰”é™¤æ‰ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¯¥ä¾èµ–ä¹Ÿè¡Œã€‚</p>\n","excerpt":"","more":"<p>é¡¹ç›®æ˜¯åŸºäºGradleæ„å»ºçš„ï¼Œåœ¨æ•´åˆswaggeråï¼Œå¯åŠ¨é¡¹ç›®æ—¶æŠ¥é”™äº†ã€‚æŠ¥é”™æ—¥å¿—ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Description:</span><br><span class=\"line\"></span><br><span class=\"line\">An attempt was made to call a method that does not exist. The attempt was made from the following location:</span><br><span class=\"line\"></span><br><span class=\"line\">    springfox.documentation.spring.web.plugins.DocumentationPluginsManager.createContextBuilder(DocumentationPluginsManager.java:<span class=\"number\">152</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">The following method did not exist:</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&#x27;org.springframework.plugin.core.Plugin org.springframework.plugin.core.PluginRegistry.getPluginFor(java.lang.Object, org.springframework.plugin.core.Plugin)&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">The method<span class=\"string\">&#x27;s class, org.springframework.plugin.core.PluginRegistry, is available from the following locations:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    jar:file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar!/org/springframework/plugin/core/PluginRegistry.class</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">It was loaded from the following location:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    file:/C:/Users/Administrator/.gradle/caches/modules-2/files-2.1/org.springframework.plugin/spring-plugin-core/2.0.0.RELEASE/95fc8c13037630f4aba9c51141f535becec00fe6/spring-plugin-core-2.0.0.RELEASE.jar</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Action:</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Correct the classpath of your application so that it contains a single, compatible version of org.springframework.plugin.core.PluginRegistry</span></span><br></pre></td></tr></table></figure>\n<p>ç™¾åº¦ä¹‹åï¼Œå‘ç°æ˜¯jaråŒ…å†²çªäº†ï¼Œå¯¼å…¥äº†ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„jaråŒ…ã€‚å¦‚å›¾ï¼š<br><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/articles/a3688f4401c04f3a53efb72e701a4457.png\" alt=\"image.png\"><br>è§£å†³åŠæ³•å¯ä»¥ç›´æ¥å°†ä¾èµ–ä¸­çš„jaråŒ…å‰”é™¤æ‰ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¯¥ä¾èµ–ä¹Ÿè¡Œã€‚</p>\n"},{"title":"åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚","date":"2024-04-17T07:14:49.000Z","_content":"## ç”³è¯·TGæœºå™¨äºº\n\n![image-20240417152031003](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417152031003.png)\n\n1. æ‰“å¼€ Telegram åº”ç”¨ç¨‹åºç„¶åæœç´¢`@BotFather`\n2. å•å‡»å¼€å§‹\n3. å•å‡»èœå• -> /newbot æˆ–è¾“å…¥`/newbot`å¹¶ç‚¹å‡»å‘é€\n4. æŒ‰ç…§è¯´æ˜è¿›è¡Œæ“ä½œï¼Œç›´åˆ°æˆ‘ä»¬æ”¶åˆ°è¿™æ ·çš„æ¶ˆæ¯\n\n```\nDone! Congratulations on your new bot. You will find it at t.me/new_bot.\nYou can now add a description.....\n\nUse this token to access the HTTP API:\n63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c\nKeep your token secure and store it safely, it can be used by anyone to control your bot.\n\nFor a description of the Bot API, see this page: https://core.telegram.org/bots/api\n```\n\n5. è¿™æ˜¯æˆ‘ä»¬çš„æœºå™¨äººä»¤ç‰Œ`63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c`ï¼ˆç¡®ä¿æˆ‘ä»¬ä¸ä¼šå°†å…¶åˆ†äº«ç»™ä»»ä½•äººï¼‰ã€‚\n\n\n\n## è·å–ç§äººèŠå¤©çš„èŠå¤©ID\n\n1. æœç´¢å¹¶æ‰“å¼€æˆ‘ä»¬æ–°çš„ Telegram æœºå™¨äºº\n\n2. å•å‡»â€œå¼€å§‹â€æˆ–å‘é€æ¶ˆæ¯\n\n3. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤ç½‘å€\n\n```\nhttps://api.telegram.org/bot{our_bot_token}/getUpdates\n```\n\n- è¯·æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¤ç‰Œå‰åŠ ä¸Š `bot`\n- ä¾‹å¦‚ï¼š`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/getUpdates`\n\næˆ–è€…é€šè¿‡@raw_info_botï¼š\n\n![image-20240417151949471](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\n\n4. æˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„ json\n\n```\n{\n  \"ok\": true,\n  \"result\": [\n    {\n      \"update_id\": 83xxxxx35,\n      \"message\": {\n        \"message_id\": 2643,\n        \"from\": {...},\n        \"chat\": {\n          \"id\": 21xxxxx38,\n          \"first_name\": \"...\",\n          \"last_name\": \"...\",\n          \"username\": \"@username\",\n          \"type\": \"private\"\n        },\n        \"date\": 1703062972,\n        \"text\": \"/start\"\n      }\n    }\n  ]\n}\n```\n\n5. æ£€æŸ¥`result.0.message.chat.id`ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š`21xxxxx38`\n\n6. è®©æˆ‘ä»¬å°è¯•postå‘é€ä¸€æ¡æ¶ˆæ¯`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=21xxxxx38&text=test123`\n\n7. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ Telegram æœºå™¨äººèŠå¤©ä¸­ã€‚\n\n\n\n## è·å–é¢‘é“çš„èŠå¤© ID\n\nè·å–ç¾¤èŠ ID çš„æœ€ç®€å•æ–¹æ³•æ˜¯é€šè¿‡ Telegram æ¡Œé¢åº”ç”¨ç¨‹åºã€‚\n\n1. åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ Telegram\n\n2. å°†æˆ‘ä»¬çš„ Telegram æœºå™¨äººæ·»åŠ åˆ°èŠå¤©ç»„ä¸­\n\n3. å‘é€æ¶ˆæ¯è‡³èŠå¤©ç»„\n\n4. å³é”®å•å‡»è¯¥æ¶ˆæ¯ï¼Œç„¶åå•å‡»\n\n```\nCopy Message Link\n```\n\n- æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåƒè¿™æ ·çš„é“¾æ¥ï¼š`https://t.me/c/194xxxx987/11/13`\n- å›¾æ¡ˆï¼š`https://t.me/c/{group_chat_id}/{group_topic_id}/{message_id}`\n- è¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š`194xxxx987`\n\n5. è¦åœ¨ API ä¸­ä½¿ç”¨ç¾¤èŠ IDï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶å‰é¢åŠ ä¸Š number å‰ç¼€`-100`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š`-100194xxxx987`\n\n6. ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘é€æ¶ˆæ¯`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=-100194xxxx987&text=test123`\n\næˆ–è€…ä½¿ç”¨pythonï¼š\n\n```python\nimport requests\n\nresponse = requests.post(\n    url='https://api.telegram.org/bot{0}/{1}'.format(token, method),\n    data={'chat_id': 12345, 'text': 'hello friend'}\n).json()\n```\n\n7. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸­ã€‚\n\n\n\n## è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID\n\nä¸ºäº†å‘ Telegram ç¾¤ç»„ä¸Šçš„ç‰¹å®šä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸»é¢˜ IDã€‚\n\n1. ä¸ä¸Šé¢çš„æ­¥éª¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ç‚¹å‡» å`Copy Message Link`ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼ï¼š çš„é“¾æ¥`https://t.me/c/194xxxx987/11/13`ï¼Œæ‰€ä»¥ç¾¤ç»„ Topic ID ä¸º`11`ã€‚\n\n2. ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼ˆå‚è§`message_thread_id`ï¼‰ï¼š`https://api.telegram.org/bot783114779:AAEuRWDTFD2UQ7agBtFSuhJf2-NmvHN3OPc/sendMessage?chat_id=-100194xxxx987&message_thread_id=11&text=test123`\n\n3. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥åˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸»é¢˜å†…ã€‚\n\n\n\nå‚è€ƒé“¾æ¥ï¼šhttps://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\n\n\n\n## æ›´æ–°å†…å®¹\n\nå°†æ¶ˆæ¯æ¨é€è‡³ç¾¤ç»„\n\n1. å°†æœºå™¨äººæ‹‰å…¥ç¾¤ç»„ï¼Œå‘é€`/{message}@bot`æ¶ˆæ¯\n2. å¯ä»¥é€šè¿‡`https://api.telegram.org/bot{token}/getUpdates`è·å–ç¾¤ç»„id\n\n![image-20240829100959057](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240829100959057.png)\n\nè¿™é‡Œç¾¤ç»„idä¸º-4583**9819","source":"_posts/åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚.md","raw":"---\ntitle: åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚\ndate: 2024-04-17 15:14:49\ntags:\n---\n## ç”³è¯·TGæœºå™¨äºº\n\n![image-20240417152031003](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417152031003.png)\n\n1. æ‰“å¼€ Telegram åº”ç”¨ç¨‹åºç„¶åæœç´¢`@BotFather`\n2. å•å‡»å¼€å§‹\n3. å•å‡»èœå• -> /newbot æˆ–è¾“å…¥`/newbot`å¹¶ç‚¹å‡»å‘é€\n4. æŒ‰ç…§è¯´æ˜è¿›è¡Œæ“ä½œï¼Œç›´åˆ°æˆ‘ä»¬æ”¶åˆ°è¿™æ ·çš„æ¶ˆæ¯\n\n```\nDone! Congratulations on your new bot. You will find it at t.me/new_bot.\nYou can now add a description.....\n\nUse this token to access the HTTP API:\n63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c\nKeep your token secure and store it safely, it can be used by anyone to control your bot.\n\nFor a description of the Bot API, see this page: https://core.telegram.org/bots/api\n```\n\n5. è¿™æ˜¯æˆ‘ä»¬çš„æœºå™¨äººä»¤ç‰Œ`63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c`ï¼ˆç¡®ä¿æˆ‘ä»¬ä¸ä¼šå°†å…¶åˆ†äº«ç»™ä»»ä½•äººï¼‰ã€‚\n\n\n\n## è·å–ç§äººèŠå¤©çš„èŠå¤©ID\n\n1. æœç´¢å¹¶æ‰“å¼€æˆ‘ä»¬æ–°çš„ Telegram æœºå™¨äºº\n\n2. å•å‡»â€œå¼€å§‹â€æˆ–å‘é€æ¶ˆæ¯\n\n3. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤ç½‘å€\n\n```\nhttps://api.telegram.org/bot{our_bot_token}/getUpdates\n```\n\n- è¯·æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¤ç‰Œå‰åŠ ä¸Š `bot`\n- ä¾‹å¦‚ï¼š`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/getUpdates`\n\næˆ–è€…é€šè¿‡@raw_info_botï¼š\n\n![image-20240417151949471](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\n\n4. æˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„ json\n\n```\n{\n  \"ok\": true,\n  \"result\": [\n    {\n      \"update_id\": 83xxxxx35,\n      \"message\": {\n        \"message_id\": 2643,\n        \"from\": {...},\n        \"chat\": {\n          \"id\": 21xxxxx38,\n          \"first_name\": \"...\",\n          \"last_name\": \"...\",\n          \"username\": \"@username\",\n          \"type\": \"private\"\n        },\n        \"date\": 1703062972,\n        \"text\": \"/start\"\n      }\n    }\n  ]\n}\n```\n\n5. æ£€æŸ¥`result.0.message.chat.id`ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š`21xxxxx38`\n\n6. è®©æˆ‘ä»¬å°è¯•postå‘é€ä¸€æ¡æ¶ˆæ¯`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=21xxxxx38&text=test123`\n\n7. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ Telegram æœºå™¨äººèŠå¤©ä¸­ã€‚\n\n\n\n## è·å–é¢‘é“çš„èŠå¤© ID\n\nè·å–ç¾¤èŠ ID çš„æœ€ç®€å•æ–¹æ³•æ˜¯é€šè¿‡ Telegram æ¡Œé¢åº”ç”¨ç¨‹åºã€‚\n\n1. åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ Telegram\n\n2. å°†æˆ‘ä»¬çš„ Telegram æœºå™¨äººæ·»åŠ åˆ°èŠå¤©ç»„ä¸­\n\n3. å‘é€æ¶ˆæ¯è‡³èŠå¤©ç»„\n\n4. å³é”®å•å‡»è¯¥æ¶ˆæ¯ï¼Œç„¶åå•å‡»\n\n```\nCopy Message Link\n```\n\n- æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåƒè¿™æ ·çš„é“¾æ¥ï¼š`https://t.me/c/194xxxx987/11/13`\n- å›¾æ¡ˆï¼š`https://t.me/c/{group_chat_id}/{group_topic_id}/{message_id}`\n- è¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š`194xxxx987`\n\n5. è¦åœ¨ API ä¸­ä½¿ç”¨ç¾¤èŠ IDï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶å‰é¢åŠ ä¸Š number å‰ç¼€`-100`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š`-100194xxxx987`\n\n6. ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘é€æ¶ˆæ¯`https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=-100194xxxx987&text=test123`\n\næˆ–è€…ä½¿ç”¨pythonï¼š\n\n```python\nimport requests\n\nresponse = requests.post(\n    url='https://api.telegram.org/bot{0}/{1}'.format(token, method),\n    data={'chat_id': 12345, 'text': 'hello friend'}\n).json()\n```\n\n7. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸­ã€‚\n\n\n\n## è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID\n\nä¸ºäº†å‘ Telegram ç¾¤ç»„ä¸Šçš„ç‰¹å®šä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸»é¢˜ IDã€‚\n\n1. ä¸ä¸Šé¢çš„æ­¥éª¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ç‚¹å‡» å`Copy Message Link`ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼ï¼š çš„é“¾æ¥`https://t.me/c/194xxxx987/11/13`ï¼Œæ‰€ä»¥ç¾¤ç»„ Topic ID ä¸º`11`ã€‚\n\n2. ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼ˆå‚è§`message_thread_id`ï¼‰ï¼š`https://api.telegram.org/bot783114779:AAEuRWDTFD2UQ7agBtFSuhJf2-NmvHN3OPc/sendMessage?chat_id=-100194xxxx987&message_thread_id=11&text=test123`\n\n3. å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯`test123`åº”è¯¥åˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸»é¢˜å†…ã€‚\n\n\n\nå‚è€ƒé“¾æ¥ï¼šhttps://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\n\n\n\n## æ›´æ–°å†…å®¹\n\nå°†æ¶ˆæ¯æ¨é€è‡³ç¾¤ç»„\n\n1. å°†æœºå™¨äººæ‹‰å…¥ç¾¤ç»„ï¼Œå‘é€`/{message}@bot`æ¶ˆæ¯\n2. å¯ä»¥é€šè¿‡`https://api.telegram.org/bot{token}/getUpdates`è·å–ç¾¤ç»„id\n\n![image-20240829100959057](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240829100959057.png)\n\nè¿™é‡Œç¾¤ç»„idä¸º-4583**9819","slug":"åˆ›å»ºTelegramæœºå™¨äººğŸ¤–APIå‘é€è¯·æ±‚","published":1,"updated":"2024-08-29T02:11:27.455Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dq0014wen1980v20uq","content":"<h2 id=\"ç”³è¯·TGæœºå™¨äºº\"><a href=\"#ç”³è¯·TGæœºå™¨äºº\" class=\"headerlink\" title=\"ç”³è¯·TGæœºå™¨äºº\"></a>ç”³è¯·TGæœºå™¨äºº</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417152031003.png\" alt=\"image-20240417152031003\"></p>\n<ol>\n<li>æ‰“å¼€ Telegram åº”ç”¨ç¨‹åºç„¶åæœç´¢<code>@BotFather</code></li>\n<li>å•å‡»å¼€å§‹</li>\n<li>å•å‡»èœå• -&gt; &#x2F;newbot æˆ–è¾“å…¥<code>/newbot</code>å¹¶ç‚¹å‡»å‘é€</li>\n<li>æŒ‰ç…§è¯´æ˜è¿›è¡Œæ“ä½œï¼Œç›´åˆ°æˆ‘ä»¬æ”¶åˆ°è¿™æ ·çš„æ¶ˆæ¯</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Done! Congratulations on your new bot. You will find it at t.me/new_bot.</span><br><span class=\"line\">You can now add a description.....</span><br><span class=\"line\"></span><br><span class=\"line\">Use this token to access the HTTP API:</span><br><span class=\"line\">63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c</span><br><span class=\"line\">Keep your token secure and store it safely, it can be used by anyone to control your bot.</span><br><span class=\"line\"></span><br><span class=\"line\">For a description of the Bot API, see this page: https://core.telegram.org/bots/api</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>è¿™æ˜¯æˆ‘ä»¬çš„æœºå™¨äººä»¤ç‰Œ<code>63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c</code>ï¼ˆç¡®ä¿æˆ‘ä»¬ä¸ä¼šå°†å…¶åˆ†äº«ç»™ä»»ä½•äººï¼‰ã€‚</li>\n</ol>\n<h2 id=\"è·å–ç§äººèŠå¤©çš„èŠå¤©ID\"><a href=\"#è·å–ç§äººèŠå¤©çš„èŠå¤©ID\" class=\"headerlink\" title=\"è·å–ç§äººèŠå¤©çš„èŠå¤©ID\"></a>è·å–ç§äººèŠå¤©çš„èŠå¤©ID</h2><ol>\n<li><p>æœç´¢å¹¶æ‰“å¼€æˆ‘ä»¬æ–°çš„ Telegram æœºå™¨äºº</p>\n</li>\n<li><p>å•å‡»â€œå¼€å§‹â€æˆ–å‘é€æ¶ˆæ¯</p>\n</li>\n<li><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤ç½‘å€</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.telegram.org/bot&#123;our_bot_token&#125;/getUpdates</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¤ç‰Œå‰åŠ ä¸Š <code>bot</code></li>\n<li>ä¾‹å¦‚ï¼š<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/getUpdates</code></li>\n</ul>\n<p>æˆ–è€…é€šè¿‡@raw_info_botï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png\" alt=\"image-20240417151949471\"></p>\n<ol start=\"4\">\n<li>æˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„ json</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;ok&quot;: true,</span><br><span class=\"line\">  &quot;result&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;update_id&quot;: 83xxxxx35,</span><br><span class=\"line\">      &quot;message&quot;: &#123;</span><br><span class=\"line\">        &quot;message_id&quot;: 2643,</span><br><span class=\"line\">        &quot;from&quot;: &#123;...&#125;,</span><br><span class=\"line\">        &quot;chat&quot;: &#123;</span><br><span class=\"line\">          &quot;id&quot;: 21xxxxx38,</span><br><span class=\"line\">          &quot;first_name&quot;: &quot;...&quot;,</span><br><span class=\"line\">          &quot;last_name&quot;: &quot;...&quot;,</span><br><span class=\"line\">          &quot;username&quot;: &quot;@username&quot;,</span><br><span class=\"line\">          &quot;type&quot;: &quot;private&quot;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;date&quot;: 1703062972,</span><br><span class=\"line\">        &quot;text&quot;: &quot;/start&quot;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li><p>æ£€æŸ¥<code>result.0.message.chat.id</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š<code>21xxxxx38</code></p>\n</li>\n<li><p>è®©æˆ‘ä»¬å°è¯•postå‘é€ä¸€æ¡æ¶ˆæ¯<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=21xxxxx38&amp;text=test123</code></p>\n</li>\n<li><p>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ Telegram æœºå™¨äººèŠå¤©ä¸­ã€‚</p>\n</li>\n</ol>\n<h2 id=\"è·å–é¢‘é“çš„èŠå¤©-ID\"><a href=\"#è·å–é¢‘é“çš„èŠå¤©-ID\" class=\"headerlink\" title=\"è·å–é¢‘é“çš„èŠå¤© ID\"></a>è·å–é¢‘é“çš„èŠå¤© ID</h2><p>è·å–ç¾¤èŠ ID çš„æœ€ç®€å•æ–¹æ³•æ˜¯é€šè¿‡ Telegram æ¡Œé¢åº”ç”¨ç¨‹åºã€‚</p>\n<ol>\n<li><p>åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ Telegram</p>\n</li>\n<li><p>å°†æˆ‘ä»¬çš„ Telegram æœºå™¨äººæ·»åŠ åˆ°èŠå¤©ç»„ä¸­</p>\n</li>\n<li><p>å‘é€æ¶ˆæ¯è‡³èŠå¤©ç»„</p>\n</li>\n<li><p>å³é”®å•å‡»è¯¥æ¶ˆæ¯ï¼Œç„¶åå•å‡»</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Copy Message Link</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåƒè¿™æ ·çš„é“¾æ¥ï¼š<code>https://t.me/c/194xxxx987/11/13</code></li>\n<li>å›¾æ¡ˆï¼š<code>https://t.me/c/&#123;group_chat_id&#125;/&#123;group_topic_id&#125;/&#123;message_id&#125;</code></li>\n<li>è¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š<code>194xxxx987</code></li>\n</ul>\n<ol start=\"5\">\n<li><p>è¦åœ¨ API ä¸­ä½¿ç”¨ç¾¤èŠ IDï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶å‰é¢åŠ ä¸Š number å‰ç¼€<code>-100</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<code>-100194xxxx987</code></p>\n</li>\n<li><p>ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘é€æ¶ˆæ¯<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=-100194xxxx987&amp;text=test123</code></p>\n</li>\n</ol>\n<p>æˆ–è€…ä½¿ç”¨pythonï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">response = requests.post(</span><br><span class=\"line\">    url=<span class=\"string\">&#x27;https://api.telegram.org/bot&#123;0&#125;/&#123;1&#125;&#x27;</span>.<span class=\"built_in\">format</span>(token, method),</span><br><span class=\"line\">    data=&#123;<span class=\"string\">&#x27;chat_id&#x27;</span>: <span class=\"number\">12345</span>, <span class=\"string\">&#x27;text&#x27;</span>: <span class=\"string\">&#x27;hello friend&#x27;</span>&#125;</span><br><span class=\"line\">).json()</span><br></pre></td></tr></table></figure>\n\n<ol start=\"7\">\n<li>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸­ã€‚</li>\n</ol>\n<h2 id=\"è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤©-ID\"><a href=\"#è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤©-ID\" class=\"headerlink\" title=\"è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID\"></a>è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID</h2><p>ä¸ºäº†å‘ Telegram ç¾¤ç»„ä¸Šçš„ç‰¹å®šä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸»é¢˜ IDã€‚</p>\n<ol>\n<li><p>ä¸ä¸Šé¢çš„æ­¥éª¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ç‚¹å‡» å<code>Copy Message Link</code>ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼ï¼š çš„é“¾æ¥<code>https://t.me/c/194xxxx987/11/13</code>ï¼Œæ‰€ä»¥ç¾¤ç»„ Topic ID ä¸º<code>11</code>ã€‚</p>\n</li>\n<li><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼ˆå‚è§<code>message_thread_id</code>ï¼‰ï¼š<code>https://api.telegram.org/bot783114779:AAEuRWDTFD2UQ7agBtFSuhJf2-NmvHN3OPc/sendMessage?chat_id=-100194xxxx987&amp;message_thread_id=11&amp;text=test123</code></p>\n</li>\n<li><p>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥åˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸»é¢˜å†…ã€‚</p>\n</li>\n</ol>\n<p>å‚è€ƒé“¾æ¥ï¼š<a href=\"https://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\">https://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)</a></p>\n<h2 id=\"æ›´æ–°å†…å®¹\"><a href=\"#æ›´æ–°å†…å®¹\" class=\"headerlink\" title=\"æ›´æ–°å†…å®¹\"></a>æ›´æ–°å†…å®¹</h2><p>å°†æ¶ˆæ¯æ¨é€è‡³ç¾¤ç»„</p>\n<ol>\n<li>å°†æœºå™¨äººæ‹‰å…¥ç¾¤ç»„ï¼Œå‘é€<code>/&#123;message&#125;@bot</code>æ¶ˆæ¯</li>\n<li>å¯ä»¥é€šè¿‡<code>https://api.telegram.org/bot&#123;token&#125;/getUpdates</code>è·å–ç¾¤ç»„id</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240829100959057.png\" alt=\"image-20240829100959057\"></p>\n<p>è¿™é‡Œç¾¤ç»„idä¸º-4583**9819</p>\n","excerpt":"","more":"<h2 id=\"ç”³è¯·TGæœºå™¨äºº\"><a href=\"#ç”³è¯·TGæœºå™¨äºº\" class=\"headerlink\" title=\"ç”³è¯·TGæœºå™¨äºº\"></a>ç”³è¯·TGæœºå™¨äºº</h2><p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417152031003.png\" alt=\"image-20240417152031003\"></p>\n<ol>\n<li>æ‰“å¼€ Telegram åº”ç”¨ç¨‹åºç„¶åæœç´¢<code>@BotFather</code></li>\n<li>å•å‡»å¼€å§‹</li>\n<li>å•å‡»èœå• -&gt; &#x2F;newbot æˆ–è¾“å…¥<code>/newbot</code>å¹¶ç‚¹å‡»å‘é€</li>\n<li>æŒ‰ç…§è¯´æ˜è¿›è¡Œæ“ä½œï¼Œç›´åˆ°æˆ‘ä»¬æ”¶åˆ°è¿™æ ·çš„æ¶ˆæ¯</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Done! Congratulations on your new bot. You will find it at t.me/new_bot.</span><br><span class=\"line\">You can now add a description.....</span><br><span class=\"line\"></span><br><span class=\"line\">Use this token to access the HTTP API:</span><br><span class=\"line\">63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c</span><br><span class=\"line\">Keep your token secure and store it safely, it can be used by anyone to control your bot.</span><br><span class=\"line\"></span><br><span class=\"line\">For a description of the Bot API, see this page: https://core.telegram.org/bots/api</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li>è¿™æ˜¯æˆ‘ä»¬çš„æœºå™¨äººä»¤ç‰Œ<code>63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c</code>ï¼ˆç¡®ä¿æˆ‘ä»¬ä¸ä¼šå°†å…¶åˆ†äº«ç»™ä»»ä½•äººï¼‰ã€‚</li>\n</ol>\n<h2 id=\"è·å–ç§äººèŠå¤©çš„èŠå¤©ID\"><a href=\"#è·å–ç§äººèŠå¤©çš„èŠå¤©ID\" class=\"headerlink\" title=\"è·å–ç§äººèŠå¤©çš„èŠå¤©ID\"></a>è·å–ç§äººèŠå¤©çš„èŠå¤©ID</h2><ol>\n<li><p>æœç´¢å¹¶æ‰“å¼€æˆ‘ä»¬æ–°çš„ Telegram æœºå™¨äºº</p>\n</li>\n<li><p>å•å‡»â€œå¼€å§‹â€æˆ–å‘é€æ¶ˆæ¯</p>\n</li>\n<li><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤ç½‘å€</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://api.telegram.org/bot&#123;our_bot_token&#125;/getUpdates</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¤ç‰Œå‰åŠ ä¸Š <code>bot</code></li>\n<li>ä¾‹å¦‚ï¼š<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/getUpdates</code></li>\n</ul>\n<p>æˆ–è€…é€šè¿‡@raw_info_botï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png\" alt=\"image-20240417151949471\"></p>\n<ol start=\"4\">\n<li>æˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„ json</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;ok&quot;: true,</span><br><span class=\"line\">  &quot;result&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;update_id&quot;: 83xxxxx35,</span><br><span class=\"line\">      &quot;message&quot;: &#123;</span><br><span class=\"line\">        &quot;message_id&quot;: 2643,</span><br><span class=\"line\">        &quot;from&quot;: &#123;...&#125;,</span><br><span class=\"line\">        &quot;chat&quot;: &#123;</span><br><span class=\"line\">          &quot;id&quot;: 21xxxxx38,</span><br><span class=\"line\">          &quot;first_name&quot;: &quot;...&quot;,</span><br><span class=\"line\">          &quot;last_name&quot;: &quot;...&quot;,</span><br><span class=\"line\">          &quot;username&quot;: &quot;@username&quot;,</span><br><span class=\"line\">          &quot;type&quot;: &quot;private&quot;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;date&quot;: 1703062972,</span><br><span class=\"line\">        &quot;text&quot;: &quot;/start&quot;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"5\">\n<li><p>æ£€æŸ¥<code>result.0.message.chat.id</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š<code>21xxxxx38</code></p>\n</li>\n<li><p>è®©æˆ‘ä»¬å°è¯•postå‘é€ä¸€æ¡æ¶ˆæ¯<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=21xxxxx38&amp;text=test123</code></p>\n</li>\n<li><p>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ Telegram æœºå™¨äººèŠå¤©ä¸­ã€‚</p>\n</li>\n</ol>\n<h2 id=\"è·å–é¢‘é“çš„èŠå¤©-ID\"><a href=\"#è·å–é¢‘é“çš„èŠå¤©-ID\" class=\"headerlink\" title=\"è·å–é¢‘é“çš„èŠå¤© ID\"></a>è·å–é¢‘é“çš„èŠå¤© ID</h2><p>è·å–ç¾¤èŠ ID çš„æœ€ç®€å•æ–¹æ³•æ˜¯é€šè¿‡ Telegram æ¡Œé¢åº”ç”¨ç¨‹åºã€‚</p>\n<ol>\n<li><p>åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ Telegram</p>\n</li>\n<li><p>å°†æˆ‘ä»¬çš„ Telegram æœºå™¨äººæ·»åŠ åˆ°èŠå¤©ç»„ä¸­</p>\n</li>\n<li><p>å‘é€æ¶ˆæ¯è‡³èŠå¤©ç»„</p>\n</li>\n<li><p>å³é”®å•å‡»è¯¥æ¶ˆæ¯ï¼Œç„¶åå•å‡»</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Copy Message Link</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåƒè¿™æ ·çš„é“¾æ¥ï¼š<code>https://t.me/c/194xxxx987/11/13</code></li>\n<li>å›¾æ¡ˆï¼š<code>https://t.me/c/&#123;group_chat_id&#125;/&#123;group_topic_id&#125;/&#123;message_id&#125;</code></li>\n<li>è¿™æ˜¯æˆ‘ä»¬çš„èŠå¤© IDï¼š<code>194xxxx987</code></li>\n</ul>\n<ol start=\"5\">\n<li><p>è¦åœ¨ API ä¸­ä½¿ç”¨ç¾¤èŠ IDï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶å‰é¢åŠ ä¸Š number å‰ç¼€<code>-100</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<code>-100194xxxx987</code></p>\n</li>\n<li><p>ç°åœ¨è®©æˆ‘ä»¬å°è¯•å‘é€æ¶ˆæ¯<code>https://api.telegram.org/bot63xxxxxx71:AAFoxxxxn0hwA-2TVSxxxNf4c/sendMessage?chat_id=-100194xxxx987&amp;text=test123</code></p>\n</li>\n</ol>\n<p>æˆ–è€…ä½¿ç”¨pythonï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">response = requests.post(</span><br><span class=\"line\">    url=<span class=\"string\">&#x27;https://api.telegram.org/bot&#123;0&#125;/&#123;1&#125;&#x27;</span>.<span class=\"built_in\">format</span>(token, method),</span><br><span class=\"line\">    data=&#123;<span class=\"string\">&#x27;chat_id&#x27;</span>: <span class=\"number\">12345</span>, <span class=\"string\">&#x27;text&#x27;</span>: <span class=\"string\">&#x27;hello friend&#x27;</span>&#125;</span><br><span class=\"line\">).json()</span><br></pre></td></tr></table></figure>\n\n<ol start=\"7\">\n<li>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥ä¼šåˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸­ã€‚</li>\n</ol>\n<h2 id=\"è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤©-ID\"><a href=\"#è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤©-ID\" class=\"headerlink\" title=\"è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID\"></a>è·å–ç¾¤èŠä¸­æŸä¸ªä¸»é¢˜çš„èŠå¤© ID</h2><p>ä¸ºäº†å‘ Telegram ç¾¤ç»„ä¸Šçš„ç‰¹å®šä¸»é¢˜å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸»é¢˜ IDã€‚</p>\n<ol>\n<li><p>ä¸ä¸Šé¢çš„æ­¥éª¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ç‚¹å‡» å<code>Copy Message Link</code>ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼ï¼š çš„é“¾æ¥<code>https://t.me/c/194xxxx987/11/13</code>ï¼Œæ‰€ä»¥ç¾¤ç»„ Topic ID ä¸º<code>11</code>ã€‚</p>\n</li>\n<li><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼ˆå‚è§<code>message_thread_id</code>ï¼‰ï¼š<code>https://api.telegram.org/bot783114779:AAEuRWDTFD2UQ7agBtFSuhJf2-NmvHN3OPc/sendMessage?chat_id=-100194xxxx987&amp;message_thread_id=11&amp;text=test123</code></p>\n</li>\n<li><p>å½“æˆ‘ä»¬æ­£ç¡®è®¾ç½®æœºå™¨äººä»¤ç‰Œå’ŒèŠå¤© ID æ—¶ï¼Œæ¶ˆæ¯<code>test123</code>åº”è¯¥åˆ°è¾¾æˆ‘ä»¬çš„ç¾¤èŠä¸»é¢˜å†…ã€‚</p>\n</li>\n</ol>\n<p>å‚è€ƒé“¾æ¥ï¼š<a href=\"https://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)\">https://stackoverflow.com/questions/31197659/how-to-send-request-to-telegram-bot-api![](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240417151949471.png)</a></p>\n<h2 id=\"æ›´æ–°å†…å®¹\"><a href=\"#æ›´æ–°å†…å®¹\" class=\"headerlink\" title=\"æ›´æ–°å†…å®¹\"></a>æ›´æ–°å†…å®¹</h2><p>å°†æ¶ˆæ¯æ¨é€è‡³ç¾¤ç»„</p>\n<ol>\n<li>å°†æœºå™¨äººæ‹‰å…¥ç¾¤ç»„ï¼Œå‘é€<code>/&#123;message&#125;@bot</code>æ¶ˆæ¯</li>\n<li>å¯ä»¥é€šè¿‡<code>https://api.telegram.org/bot&#123;token&#125;/getUpdates</code>è·å–ç¾¤ç»„id</li>\n</ol>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/image-20240829100959057.png\" alt=\"image-20240829100959057\"></p>\n<p>è¿™é‡Œç¾¤ç»„idä¸º-4583**9819</p>\n"},{"title":"å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬)","date":"2024-03-05T04:39:48.000Z","_content":"\n## å‰è¨€\n\nè¿‘æœŸåšäº†ä¸€ä¸ªå‰åç«¯åˆå¹¶çš„spring booté¡¹ç›®ï¼Œä½†æ˜¯è¦æ±‚æ‰“åŒ…åŸexeæ–‡ä»¶ï¼Œæä¾›ç»™ä¸æ‡‚ç”µè„‘çš„å°ç™½å®‰è£…ä½¿ç”¨ï¼Œå°±å»ç ”ç©¶äº†åŠå¤©ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œå†™è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯æƒ³çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„äººï¼ŒæŒ‰ç…§æˆ‘çš„æ­¥éª¤èµ°ï¼Œèƒ½å°‘è¸©å‘ã€‚\n\n## å‡†å¤‡\n\nå‡†å¤‡å·¥ä½œï¼š\n\n1. ä¸€ä¸ªjaråŒ…ï¼Œæ²¡æœ‰bugèƒ½æ­£å¸¸å¯åŠ¨çš„jaråŒ…\n2. [exe4j](https://exe4j.apponic.com/)ï¼Œä¸€ä¸ªå°†jarè½¬æ¢æˆexeçš„å·¥å…·ï¼Œé“¾æ¥ï¼š`https://pan.baidu.com/s/1J30uUMJcYnqWCJSr6gkM5w `æå–ç ï¼š6esr\n   æ³¨å†Œç ï¼šL-g782dn2d-1f1yqxx1rv1sqd\n3. [inno setup](https://jrsoftware.org/isdl.php)ï¼Œä¸€ä¸ªå°†ä¾èµ–å’Œexeä¸€èµ·æ‰“æˆä¸€ä¸ªå®‰è£…ç¨‹åºçš„å·¥å…·ï¼Œé“¾æ¥ï¼š`https://pan.baidu.com/s/1DgFo1ceM\\_8Bqx\\_b-veibbQ`æå–ç ï¼šg9jd\n\n## å¼€å§‹\n\nä»¥æˆ‘ä¸ºä¾‹å­ï¼Œæˆ‘å°†jaråŒ…æ”¾åœ¨äº†æ¡Œé¢\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111543565-1396048921.png)\n\n \n\njaråŒ…æ”¾åœ¨æ¡Œé¢æ‰“å¼€å®‰è£…å¥½çš„exe4j\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111600449-1354345087.png)\n\n \n\næ‰“å¼€exe4jç›´æ¥ä¸‹ä¸€æ­¥è¿›å…¥ç•Œé¢ï¼Œé€‰æ‹©JAVAè½¬EXE\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111610780-2132812247.png)\n\n \n\nJAVAè½¬EXEç„¶åç‚¹ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111619283-1606783867.png)\n\n \n\nè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„ç»§ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å¯åŠ¨æ¨¡å¼\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111647166-1055422528.png)\n\n \n\né€‰æ‹©å¯åŠ¨æ¨¡å¼ä¸‹æ–¹æœ‰ä¸ªé€‰é¡¹ï¼Œéœ€è¦è®¾ç½®æ‰“åŒ…åçš„ç¨‹åºå…¼å®¹32å’Œ64ä½ç³»ç»Ÿ\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111656096-898994566.png)\n\n \n\nå…¼å®¹32å’Œ64ä½ç³»ç»Ÿè¿›æ¥åå‹¾é€‰ä¸Š\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111704684-1345085588.png)\n\n \n\nå‹¾é€‰ç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œä¸€ç›´å‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œå¼€å§‹é€‰æ‹©jaråŒ…ä»¥åŠé…ç½®åœ¨VMå‚æ•°é…ç½®çš„åœ°æ–¹åŠ ä¸Šï¼š`-Dfile.encoding=utf-8`\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111739256-1971491709.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111747934-1026729198.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111755257-424525494.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111800109-1087786170.png)\n\n \n\nç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé…ç½®JRE\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111827329-840979154.png)\n\n \n\né…ç½®JREä¸‹æ‹‰æ¡†ç‚¹å‡»åè¿›å…¥å¦‚ä¸‹ç•Œé¢\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111838992-1945360511.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111848124-1110985164.png)\n\n \n\nä¸‹æ‹‰æ¡†ç‚¹å‡»\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111901893-628430600.png)\n\n \n\nç…§ç€è¿™ä¸ªæ ·å­å†™çš„ç›®çš„æ˜¯ï¼Œæœ€ç»ˆä¼šæŠŠæœ¬åœ°jreç›®å½•å’Œexeä¸€èµ·æ‰“åŒ…ï¼Œè®©exeæ–‡ä»¶è‡ªå·±å»æ ¹æ®è·¯å¾„å»æŸ¥æ‰¾ä¸€èµ·æ‰“åŒ…çš„jreï¼Œå¯ä¸ç”¨å†å®‰è£…jdk\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111937871-1409793481.png)\n\n \n\næ¥ç€ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©Client VM\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111955182-1164832840.png)\n\n \n\né€‰æ‹©Client VMç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œæœ€ç»ˆå‡ºç°å¦‚ä¸‹ç•Œé¢![å›¾ç‰‡](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112509693-1948806647.png)\n\n \n\nè¿™ä¸ªæ—¶å€™ä½ ä¼šå‘ç°æ¡Œé¢å¤šäº†ä¸€ä¸ª`demo.exe`æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å…ˆåˆ«ç€æ€¥ç‚¹å¼€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†jreå’Œexeæ–‡ä»¶å†æ‰“ä¸ªåŒ…åˆå¹¶ï¼Œè¾¾åˆ°åœ¨æ²¡æœ‰jdkç”µè„‘ç¯å¢ƒä¸‹ä¹Ÿèƒ½è¿è¡Œæ‰“å¼€inno setupï¼Œå·¦ä¸Šè§’File - New\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112041717-1500637696.png)\n\n \n\næ‰“å¼€inno setupç›´æ¥ç‚¹ä¸‹ä¸€æ­¥ï¼Œå¡«å†™é…ç½®ï¼Œåº”ç”¨åç§°ï¼Œç‰ˆæœ¬ç­‰ï¼Œéšæ„\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112057607-1301322721.png)\n\n \n\nç‰ˆæœ¬ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿™ä¸ªåœ°æ–¹é»˜è®¤å°±è¡Œï¼Œç›´æ¥ä¸‹ä¸€æ­¥\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112112186-624409517.png)\n\n \n\nç›´æ¥ä¸‹ä¸€æ­¥æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112120569-1427010105.png)\n\n \n\næ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶ç„¶åä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è¿™ä¸ªç•Œé¢ä¿æŒé»˜è®¤ï¼Œç›´æ¥ä¸‹ä¸€æ­¥\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112129814-1671272672.png)\n\n \n\nä¿æŒé»˜è®¤ä¾æ—§ä¸‹ä¸€æ­¥ï¼Œä¸ç”¨ç®¡\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112138411-293405841.png)\n\n \n\nä¸‹ä¸€æ­¥ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè¿™é‡Œæ˜¯é€‰æ‹©è¯­è¨€\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112146171-409628643.png)\n\n \n\né€‰æ‹©è¯­è¨€ç„¶åå°±æ˜¯é€‰æ‹©è¾“å‡ºè·¯å¾„å’Œå¡«å†™å®‰è£…ç¨‹åºçš„åå­—äº†\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112155246-276457879.png)\n\n \n\né€‰æ‹©è¾“å‡ºè·¯å¾„ç„¶åä¸‹ä¸€æ­¥ï¼Œç›´æ¥ç‚¹Nextï¼Œç„¶åç»“æŸé…ç½®åˆ°æœ€åä¸€æ­¥äº†ï¼Œè„šæœ¬æ–‡ä»¶ï¼Œåˆ°è¿™é‡Œä¼šå¼¹å‡ºé—®ä½ æ˜¯å¦é©¬ä¸Šç¼–è¯‘ï¼Œé€‰æ‹©å¦ï¼Œå…ˆæŠŠè„šæœ¬å†™å¥½å†è‡ªå·±ç¼–è¯‘\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112233707-1556689797.png)\n\n \n\nç¼–è¯‘ç„¶ååˆ°äº†æœ€åä¸€æ­¥äº†ï¼ŒæŠŠæœ¬åœ°çš„JREå†™è¿›è„šæœ¬\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112247175-713534534.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112313666-1584429067.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112325941-471763229.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112334907-851084806.png)\n\n \n\n``\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112343729-1930111580.png)\n\n \n\n```xml\nSource: \"è‡ªå·±æœ¬åœ°JREè·¯å¾„\\*\"; DestDir: \"{app}\\{#MyJreName}\"; Flags: ignoreversion recursesubdirs createallsubdirs\n```\n\nç„¶åç›´æ¥ç¼–è¯‘å°±å¥½äº†ï¼Œä¼šæç¤ºä¿å­˜å½“å‰è„šæœ¬ï¼Œéšä¾¿èµ·ä¸ªåå­—ï¼Œä¸‹ä¸ªè¿˜å¯ä»¥ç»§ç»­ç”¨\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112358190-36465892.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112415031-718978884.png)\n\n \n\nç„¶åç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸ\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112426523-1804405720.png)\n\n \n\nç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸå½“ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸåï¼Œæ¡Œé¢ä¼šå¤šäº†ä¸€ä¸ª`setup.exe`æ–‡ä»¶\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112437772-311845179.png)\n\n \n\nJavaæ‰“åŒ…extä¹ŸåŒæ—¶ä¼šè·³å‡ºä¸€ä¸ªå®‰è£…çš„ï¼Œå› ä¸ºç¨‹åºå¸®ä½ è‡ªåŠ¨å¯åŠ¨ç”Ÿæˆçš„å®‰è£…ç¨‹åºäº†ï¼Œå®‰è£…å°±å¯ä»¥äº†ï¼Œå®‰è£…çš„æ—¶å€™è®°å¾—å‹¾é€‰åˆ›å»ºå¿«æ·æ–¹å¼\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112448655-1218116363.png)\n\n ã€€\n\nåˆ›å»ºå¿«æ·æ–¹å¼è¿™ä¸ªå°±æ˜¯æœ€åçš„ç¨‹åºäº†ï¼ŒåŒå‡»è¿è¡Œå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ï¼ŒæŠŠ`setup.exe`æ–‡ä»¶ç»™åˆ«äººå®‰è£…ï¼Œå°±éƒ½å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç¨‹åºäº†ã€‚","source":"_posts/å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬).md","raw":"---\ntitle: å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬)\ndate: 2024-03-05 12:39:48\ntags:\n---\n\n## å‰è¨€\n\nè¿‘æœŸåšäº†ä¸€ä¸ªå‰åç«¯åˆå¹¶çš„spring booté¡¹ç›®ï¼Œä½†æ˜¯è¦æ±‚æ‰“åŒ…åŸexeæ–‡ä»¶ï¼Œæä¾›ç»™ä¸æ‡‚ç”µè„‘çš„å°ç™½å®‰è£…ä½¿ç”¨ï¼Œå°±å»ç ”ç©¶äº†åŠå¤©ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œå†™è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯æƒ³çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„äººï¼ŒæŒ‰ç…§æˆ‘çš„æ­¥éª¤èµ°ï¼Œèƒ½å°‘è¸©å‘ã€‚\n\n## å‡†å¤‡\n\nå‡†å¤‡å·¥ä½œï¼š\n\n1. ä¸€ä¸ªjaråŒ…ï¼Œæ²¡æœ‰bugèƒ½æ­£å¸¸å¯åŠ¨çš„jaråŒ…\n2. [exe4j](https://exe4j.apponic.com/)ï¼Œä¸€ä¸ªå°†jarè½¬æ¢æˆexeçš„å·¥å…·ï¼Œé“¾æ¥ï¼š`https://pan.baidu.com/s/1J30uUMJcYnqWCJSr6gkM5w `æå–ç ï¼š6esr\n   æ³¨å†Œç ï¼šL-g782dn2d-1f1yqxx1rv1sqd\n3. [inno setup](https://jrsoftware.org/isdl.php)ï¼Œä¸€ä¸ªå°†ä¾èµ–å’Œexeä¸€èµ·æ‰“æˆä¸€ä¸ªå®‰è£…ç¨‹åºçš„å·¥å…·ï¼Œé“¾æ¥ï¼š`https://pan.baidu.com/s/1DgFo1ceM\\_8Bqx\\_b-veibbQ`æå–ç ï¼šg9jd\n\n## å¼€å§‹\n\nä»¥æˆ‘ä¸ºä¾‹å­ï¼Œæˆ‘å°†jaråŒ…æ”¾åœ¨äº†æ¡Œé¢\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111543565-1396048921.png)\n\n \n\njaråŒ…æ”¾åœ¨æ¡Œé¢æ‰“å¼€å®‰è£…å¥½çš„exe4j\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111600449-1354345087.png)\n\n \n\næ‰“å¼€exe4jç›´æ¥ä¸‹ä¸€æ­¥è¿›å…¥ç•Œé¢ï¼Œé€‰æ‹©JAVAè½¬EXE\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111610780-2132812247.png)\n\n \n\nJAVAè½¬EXEç„¶åç‚¹ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111619283-1606783867.png)\n\n \n\nè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„ç»§ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å¯åŠ¨æ¨¡å¼\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111647166-1055422528.png)\n\n \n\né€‰æ‹©å¯åŠ¨æ¨¡å¼ä¸‹æ–¹æœ‰ä¸ªé€‰é¡¹ï¼Œéœ€è¦è®¾ç½®æ‰“åŒ…åçš„ç¨‹åºå…¼å®¹32å’Œ64ä½ç³»ç»Ÿ\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111656096-898994566.png)\n\n \n\nå…¼å®¹32å’Œ64ä½ç³»ç»Ÿè¿›æ¥åå‹¾é€‰ä¸Š\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111704684-1345085588.png)\n\n \n\nå‹¾é€‰ç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œä¸€ç›´å‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œå¼€å§‹é€‰æ‹©jaråŒ…ä»¥åŠé…ç½®åœ¨VMå‚æ•°é…ç½®çš„åœ°æ–¹åŠ ä¸Šï¼š`-Dfile.encoding=utf-8`\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111739256-1971491709.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111747934-1026729198.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111755257-424525494.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111800109-1087786170.png)\n\n \n\nç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé…ç½®JRE\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111827329-840979154.png)\n\n \n\né…ç½®JREä¸‹æ‹‰æ¡†ç‚¹å‡»åè¿›å…¥å¦‚ä¸‹ç•Œé¢\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111838992-1945360511.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111848124-1110985164.png)\n\n \n\nä¸‹æ‹‰æ¡†ç‚¹å‡»\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111901893-628430600.png)\n\n \n\nç…§ç€è¿™ä¸ªæ ·å­å†™çš„ç›®çš„æ˜¯ï¼Œæœ€ç»ˆä¼šæŠŠæœ¬åœ°jreç›®å½•å’Œexeä¸€èµ·æ‰“åŒ…ï¼Œè®©exeæ–‡ä»¶è‡ªå·±å»æ ¹æ®è·¯å¾„å»æŸ¥æ‰¾ä¸€èµ·æ‰“åŒ…çš„jreï¼Œå¯ä¸ç”¨å†å®‰è£…jdk\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111937871-1409793481.png)\n\n \n\næ¥ç€ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©Client VM\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111955182-1164832840.png)\n\n \n\né€‰æ‹©Client VMç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œæœ€ç»ˆå‡ºç°å¦‚ä¸‹ç•Œé¢![å›¾ç‰‡](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112509693-1948806647.png)\n\n \n\nè¿™ä¸ªæ—¶å€™ä½ ä¼šå‘ç°æ¡Œé¢å¤šäº†ä¸€ä¸ª`demo.exe`æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å…ˆåˆ«ç€æ€¥ç‚¹å¼€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†jreå’Œexeæ–‡ä»¶å†æ‰“ä¸ªåŒ…åˆå¹¶ï¼Œè¾¾åˆ°åœ¨æ²¡æœ‰jdkç”µè„‘ç¯å¢ƒä¸‹ä¹Ÿèƒ½è¿è¡Œæ‰“å¼€inno setupï¼Œå·¦ä¸Šè§’File - New\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112041717-1500637696.png)\n\n \n\næ‰“å¼€inno setupç›´æ¥ç‚¹ä¸‹ä¸€æ­¥ï¼Œå¡«å†™é…ç½®ï¼Œåº”ç”¨åç§°ï¼Œç‰ˆæœ¬ç­‰ï¼Œéšæ„\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112057607-1301322721.png)\n\n \n\nç‰ˆæœ¬ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿™ä¸ªåœ°æ–¹é»˜è®¤å°±è¡Œï¼Œç›´æ¥ä¸‹ä¸€æ­¥\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112112186-624409517.png)\n\n \n\nç›´æ¥ä¸‹ä¸€æ­¥æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112120569-1427010105.png)\n\n \n\næ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶ç„¶åä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è¿™ä¸ªç•Œé¢ä¿æŒé»˜è®¤ï¼Œç›´æ¥ä¸‹ä¸€æ­¥\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112129814-1671272672.png)\n\n \n\nä¿æŒé»˜è®¤ä¾æ—§ä¸‹ä¸€æ­¥ï¼Œä¸ç”¨ç®¡\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112138411-293405841.png)\n\n \n\nä¸‹ä¸€æ­¥ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè¿™é‡Œæ˜¯é€‰æ‹©è¯­è¨€\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112146171-409628643.png)\n\n \n\né€‰æ‹©è¯­è¨€ç„¶åå°±æ˜¯é€‰æ‹©è¾“å‡ºè·¯å¾„å’Œå¡«å†™å®‰è£…ç¨‹åºçš„åå­—äº†\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112155246-276457879.png)\n\n \n\né€‰æ‹©è¾“å‡ºè·¯å¾„ç„¶åä¸‹ä¸€æ­¥ï¼Œç›´æ¥ç‚¹Nextï¼Œç„¶åç»“æŸé…ç½®åˆ°æœ€åä¸€æ­¥äº†ï¼Œè„šæœ¬æ–‡ä»¶ï¼Œåˆ°è¿™é‡Œä¼šå¼¹å‡ºé—®ä½ æ˜¯å¦é©¬ä¸Šç¼–è¯‘ï¼Œé€‰æ‹©å¦ï¼Œå…ˆæŠŠè„šæœ¬å†™å¥½å†è‡ªå·±ç¼–è¯‘\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112233707-1556689797.png)\n\n \n\nç¼–è¯‘ç„¶ååˆ°äº†æœ€åä¸€æ­¥äº†ï¼ŒæŠŠæœ¬åœ°çš„JREå†™è¿›è„šæœ¬\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112247175-713534534.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112313666-1584429067.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112325941-471763229.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112334907-851084806.png)\n\n \n\n``\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112343729-1930111580.png)\n\n \n\n```xml\nSource: \"è‡ªå·±æœ¬åœ°JREè·¯å¾„\\*\"; DestDir: \"{app}\\{#MyJreName}\"; Flags: ignoreversion recursesubdirs createallsubdirs\n```\n\nç„¶åç›´æ¥ç¼–è¯‘å°±å¥½äº†ï¼Œä¼šæç¤ºä¿å­˜å½“å‰è„šæœ¬ï¼Œéšä¾¿èµ·ä¸ªåå­—ï¼Œä¸‹ä¸ªè¿˜å¯ä»¥ç»§ç»­ç”¨\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112358190-36465892.png)\n\n \n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112415031-718978884.png)\n\n \n\nç„¶åç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸ\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112426523-1804405720.png)\n\n \n\nç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸå½“ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸåï¼Œæ¡Œé¢ä¼šå¤šäº†ä¸€ä¸ª`setup.exe`æ–‡ä»¶\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112437772-311845179.png)\n\n \n\nJavaæ‰“åŒ…extä¹ŸåŒæ—¶ä¼šè·³å‡ºä¸€ä¸ªå®‰è£…çš„ï¼Œå› ä¸ºç¨‹åºå¸®ä½ è‡ªåŠ¨å¯åŠ¨ç”Ÿæˆçš„å®‰è£…ç¨‹åºäº†ï¼Œå®‰è£…å°±å¯ä»¥äº†ï¼Œå®‰è£…çš„æ—¶å€™è®°å¾—å‹¾é€‰åˆ›å»ºå¿«æ·æ–¹å¼\n\n![img](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112448655-1218116363.png)\n\n ã€€\n\nåˆ›å»ºå¿«æ·æ–¹å¼è¿™ä¸ªå°±æ˜¯æœ€åçš„ç¨‹åºäº†ï¼ŒåŒå‡»è¿è¡Œå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ï¼ŒæŠŠ`setup.exe`æ–‡ä»¶ç»™åˆ«äººå®‰è£…ï¼Œå°±éƒ½å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç¨‹åºäº†ã€‚","slug":"å¦‚ä½•å°†SpringBootæ‰“åŒ…æˆ.exeé¡¹ç›®å¯åŠ¨ï¼Ÿ(è½¬)","published":1,"updated":"2024-04-17T07:24:29.538Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dq0015wen1bhi2aem3","content":"<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>è¿‘æœŸåšäº†ä¸€ä¸ªå‰åç«¯åˆå¹¶çš„spring booté¡¹ç›®ï¼Œä½†æ˜¯è¦æ±‚æ‰“åŒ…åŸexeæ–‡ä»¶ï¼Œæä¾›ç»™ä¸æ‡‚ç”µè„‘çš„å°ç™½å®‰è£…ä½¿ç”¨ï¼Œå°±å»ç ”ç©¶äº†åŠå¤©ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œå†™è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯æƒ³çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„äººï¼ŒæŒ‰ç…§æˆ‘çš„æ­¥éª¤èµ°ï¼Œèƒ½å°‘è¸©å‘ã€‚</p>\n<h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>å‡†å¤‡å·¥ä½œï¼š</p>\n<ol>\n<li>ä¸€ä¸ªjaråŒ…ï¼Œæ²¡æœ‰bugèƒ½æ­£å¸¸å¯åŠ¨çš„jaråŒ…</li>\n<li><a href=\"https://exe4j.apponic.com/\">exe4j</a>ï¼Œä¸€ä¸ªå°†jarè½¬æ¢æˆexeçš„å·¥å…·ï¼Œé“¾æ¥ï¼š<code>https://pan.baidu.com/s/1J30uUMJcYnqWCJSr6gkM5w </code>æå–ç ï¼š6esr<br>æ³¨å†Œç ï¼šL-g782dn2d-1f1yqxx1rv1sqd</li>\n<li><a href=\"https://jrsoftware.org/isdl.php\">inno setup</a>ï¼Œä¸€ä¸ªå°†ä¾èµ–å’Œexeä¸€èµ·æ‰“æˆä¸€ä¸ªå®‰è£…ç¨‹åºçš„å·¥å…·ï¼Œé“¾æ¥ï¼š<code>https://pan.baidu.com/s/1DgFo1ceM\\_8Bqx\\_b-veibbQ</code>æå–ç ï¼šg9jd</li>\n</ol>\n<h2 id=\"å¼€å§‹\"><a href=\"#å¼€å§‹\" class=\"headerlink\" title=\"å¼€å§‹\"></a>å¼€å§‹</h2><p>ä»¥æˆ‘ä¸ºä¾‹å­ï¼Œæˆ‘å°†jaråŒ…æ”¾åœ¨äº†æ¡Œé¢</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111543565-1396048921.png\" alt=\"img\"></p>\n<p>jaråŒ…æ”¾åœ¨æ¡Œé¢æ‰“å¼€å®‰è£…å¥½çš„exe4j</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111600449-1354345087.png\" alt=\"img\"></p>\n<p>æ‰“å¼€exe4jç›´æ¥ä¸‹ä¸€æ­¥è¿›å…¥ç•Œé¢ï¼Œé€‰æ‹©JAVAè½¬EXE</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111610780-2132812247.png\" alt=\"img\"></p>\n<p>JAVAè½¬EXEç„¶åç‚¹ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111619283-1606783867.png\" alt=\"img\"></p>\n<p>è¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„ç»§ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å¯åŠ¨æ¨¡å¼</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111647166-1055422528.png\" alt=\"img\"></p>\n<p>é€‰æ‹©å¯åŠ¨æ¨¡å¼ä¸‹æ–¹æœ‰ä¸ªé€‰é¡¹ï¼Œéœ€è¦è®¾ç½®æ‰“åŒ…åçš„ç¨‹åºå…¼å®¹32å’Œ64ä½ç³»ç»Ÿ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111656096-898994566.png\" alt=\"img\"></p>\n<p>å…¼å®¹32å’Œ64ä½ç³»ç»Ÿè¿›æ¥åå‹¾é€‰ä¸Š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111704684-1345085588.png\" alt=\"img\"></p>\n<p>å‹¾é€‰ç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œä¸€ç›´å‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œå¼€å§‹é€‰æ‹©jaråŒ…ä»¥åŠé…ç½®åœ¨VMå‚æ•°é…ç½®çš„åœ°æ–¹åŠ ä¸Šï¼š<code>-Dfile.encoding=utf-8</code></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111739256-1971491709.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111747934-1026729198.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111755257-424525494.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111800109-1087786170.png\" alt=\"img\"></p>\n<p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé…ç½®JRE</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111827329-840979154.png\" alt=\"img\"></p>\n<p>é…ç½®JREä¸‹æ‹‰æ¡†ç‚¹å‡»åè¿›å…¥å¦‚ä¸‹ç•Œé¢</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111838992-1945360511.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111848124-1110985164.png\" alt=\"img\"></p>\n<p>ä¸‹æ‹‰æ¡†ç‚¹å‡»</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111901893-628430600.png\" alt=\"img\"></p>\n<p>ç…§ç€è¿™ä¸ªæ ·å­å†™çš„ç›®çš„æ˜¯ï¼Œæœ€ç»ˆä¼šæŠŠæœ¬åœ°jreç›®å½•å’Œexeä¸€èµ·æ‰“åŒ…ï¼Œè®©exeæ–‡ä»¶è‡ªå·±å»æ ¹æ®è·¯å¾„å»æŸ¥æ‰¾ä¸€èµ·æ‰“åŒ…çš„jreï¼Œå¯ä¸ç”¨å†å®‰è£…jdk</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111937871-1409793481.png\" alt=\"img\"></p>\n<p>æ¥ç€ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©Client VM</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111955182-1164832840.png\" alt=\"img\"></p>\n<p>é€‰æ‹©Client VMç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œæœ€ç»ˆå‡ºç°å¦‚ä¸‹ç•Œé¢<img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112509693-1948806647.png\" alt=\"å›¾ç‰‡\"></p>\n<p>è¿™ä¸ªæ—¶å€™ä½ ä¼šå‘ç°æ¡Œé¢å¤šäº†ä¸€ä¸ª<code>demo.exe</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å…ˆåˆ«ç€æ€¥ç‚¹å¼€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†jreå’Œexeæ–‡ä»¶å†æ‰“ä¸ªåŒ…åˆå¹¶ï¼Œè¾¾åˆ°åœ¨æ²¡æœ‰jdkç”µè„‘ç¯å¢ƒä¸‹ä¹Ÿèƒ½è¿è¡Œæ‰“å¼€inno setupï¼Œå·¦ä¸Šè§’File - New</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112041717-1500637696.png\" alt=\"img\"></p>\n<p>æ‰“å¼€inno setupç›´æ¥ç‚¹ä¸‹ä¸€æ­¥ï¼Œå¡«å†™é…ç½®ï¼Œåº”ç”¨åç§°ï¼Œç‰ˆæœ¬ç­‰ï¼Œéšæ„</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112057607-1301322721.png\" alt=\"img\"></p>\n<p>ç‰ˆæœ¬ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿™ä¸ªåœ°æ–¹é»˜è®¤å°±è¡Œï¼Œç›´æ¥ä¸‹ä¸€æ­¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112112186-624409517.png\" alt=\"img\"></p>\n<p>ç›´æ¥ä¸‹ä¸€æ­¥æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112120569-1427010105.png\" alt=\"img\"></p>\n<p>æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶ç„¶åä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è¿™ä¸ªç•Œé¢ä¿æŒé»˜è®¤ï¼Œç›´æ¥ä¸‹ä¸€æ­¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112129814-1671272672.png\" alt=\"img\"></p>\n<p>ä¿æŒé»˜è®¤ä¾æ—§ä¸‹ä¸€æ­¥ï¼Œä¸ç”¨ç®¡</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112138411-293405841.png\" alt=\"img\"></p>\n<p>ä¸‹ä¸€æ­¥ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè¿™é‡Œæ˜¯é€‰æ‹©è¯­è¨€</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112146171-409628643.png\" alt=\"img\"></p>\n<p>é€‰æ‹©è¯­è¨€ç„¶åå°±æ˜¯é€‰æ‹©è¾“å‡ºè·¯å¾„å’Œå¡«å†™å®‰è£…ç¨‹åºçš„åå­—äº†</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112155246-276457879.png\" alt=\"img\"></p>\n<p>é€‰æ‹©è¾“å‡ºè·¯å¾„ç„¶åä¸‹ä¸€æ­¥ï¼Œç›´æ¥ç‚¹Nextï¼Œç„¶åç»“æŸé…ç½®åˆ°æœ€åä¸€æ­¥äº†ï¼Œè„šæœ¬æ–‡ä»¶ï¼Œåˆ°è¿™é‡Œä¼šå¼¹å‡ºé—®ä½ æ˜¯å¦é©¬ä¸Šç¼–è¯‘ï¼Œé€‰æ‹©å¦ï¼Œå…ˆæŠŠè„šæœ¬å†™å¥½å†è‡ªå·±ç¼–è¯‘</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112233707-1556689797.png\" alt=\"img\"></p>\n<p>ç¼–è¯‘ç„¶ååˆ°äº†æœ€åä¸€æ­¥äº†ï¼ŒæŠŠæœ¬åœ°çš„JREå†™è¿›è„šæœ¬</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112247175-713534534.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112313666-1584429067.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112325941-471763229.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112334907-851084806.png\" alt=\"img\"></p>\n<p>&#96;&#96;</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112343729-1930111580.png\" alt=\"img\"></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Source: &quot;è‡ªå·±æœ¬åœ°JREè·¯å¾„\\*&quot;; DestDir: &quot;&#123;app&#125;\\&#123;#MyJreName&#125;&quot;; Flags: ignoreversion recursesubdirs createallsubdirs</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åç›´æ¥ç¼–è¯‘å°±å¥½äº†ï¼Œä¼šæç¤ºä¿å­˜å½“å‰è„šæœ¬ï¼Œéšä¾¿èµ·ä¸ªåå­—ï¼Œä¸‹ä¸ªè¿˜å¯ä»¥ç»§ç»­ç”¨</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112358190-36465892.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112415031-718978884.png\" alt=\"img\"></p>\n<p>ç„¶åç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112426523-1804405720.png\" alt=\"img\"></p>\n<p>ç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸå½“ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸåï¼Œæ¡Œé¢ä¼šå¤šäº†ä¸€ä¸ª<code>setup.exe</code>æ–‡ä»¶</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112437772-311845179.png\" alt=\"img\"></p>\n<p>Javaæ‰“åŒ…extä¹ŸåŒæ—¶ä¼šè·³å‡ºä¸€ä¸ªå®‰è£…çš„ï¼Œå› ä¸ºç¨‹åºå¸®ä½ è‡ªåŠ¨å¯åŠ¨ç”Ÿæˆçš„å®‰è£…ç¨‹åºäº†ï¼Œå®‰è£…å°±å¯ä»¥äº†ï¼Œå®‰è£…çš„æ—¶å€™è®°å¾—å‹¾é€‰åˆ›å»ºå¿«æ·æ–¹å¼</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112448655-1218116363.png\" alt=\"img\"></p>\n<p> ã€€</p>\n<p>åˆ›å»ºå¿«æ·æ–¹å¼è¿™ä¸ªå°±æ˜¯æœ€åçš„ç¨‹åºäº†ï¼ŒåŒå‡»è¿è¡Œå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ï¼ŒæŠŠ<code>setup.exe</code>æ–‡ä»¶ç»™åˆ«äººå®‰è£…ï¼Œå°±éƒ½å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç¨‹åºäº†ã€‚</p>\n","excerpt":"","more":"<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>è¿‘æœŸåšäº†ä¸€ä¸ªå‰åç«¯åˆå¹¶çš„spring booté¡¹ç›®ï¼Œä½†æ˜¯è¦æ±‚æ‰“åŒ…åŸexeæ–‡ä»¶ï¼Œæä¾›ç»™ä¸æ‡‚ç”µè„‘çš„å°ç™½å®‰è£…ä½¿ç”¨ï¼Œå°±å»ç ”ç©¶äº†åŠå¤©ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œå†™è¿™ç¯‡æ–‡ç« ï¼Œæ˜¯æƒ³çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„äººï¼ŒæŒ‰ç…§æˆ‘çš„æ­¥éª¤èµ°ï¼Œèƒ½å°‘è¸©å‘ã€‚</p>\n<h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>å‡†å¤‡å·¥ä½œï¼š</p>\n<ol>\n<li>ä¸€ä¸ªjaråŒ…ï¼Œæ²¡æœ‰bugèƒ½æ­£å¸¸å¯åŠ¨çš„jaråŒ…</li>\n<li><a href=\"https://exe4j.apponic.com/\">exe4j</a>ï¼Œä¸€ä¸ªå°†jarè½¬æ¢æˆexeçš„å·¥å…·ï¼Œé“¾æ¥ï¼š<code>https://pan.baidu.com/s/1J30uUMJcYnqWCJSr6gkM5w </code>æå–ç ï¼š6esr<br>æ³¨å†Œç ï¼šL-g782dn2d-1f1yqxx1rv1sqd</li>\n<li><a href=\"https://jrsoftware.org/isdl.php\">inno setup</a>ï¼Œä¸€ä¸ªå°†ä¾èµ–å’Œexeä¸€èµ·æ‰“æˆä¸€ä¸ªå®‰è£…ç¨‹åºçš„å·¥å…·ï¼Œé“¾æ¥ï¼š<code>https://pan.baidu.com/s/1DgFo1ceM\\_8Bqx\\_b-veibbQ</code>æå–ç ï¼šg9jd</li>\n</ol>\n<h2 id=\"å¼€å§‹\"><a href=\"#å¼€å§‹\" class=\"headerlink\" title=\"å¼€å§‹\"></a>å¼€å§‹</h2><p>ä»¥æˆ‘ä¸ºä¾‹å­ï¼Œæˆ‘å°†jaråŒ…æ”¾åœ¨äº†æ¡Œé¢</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111543565-1396048921.png\" alt=\"img\"></p>\n<p>jaråŒ…æ”¾åœ¨æ¡Œé¢æ‰“å¼€å®‰è£…å¥½çš„exe4j</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111600449-1354345087.png\" alt=\"img\"></p>\n<p>æ‰“å¼€exe4jç›´æ¥ä¸‹ä¸€æ­¥è¿›å…¥ç•Œé¢ï¼Œé€‰æ‹©JAVAè½¬EXE</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111610780-2132812247.png\" alt=\"img\"></p>\n<p>JAVAè½¬EXEç„¶åç‚¹ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111619283-1606783867.png\" alt=\"img\"></p>\n<p>è¾“å…¥åç§°å’Œè¾“å‡ºè·¯å¾„ç»§ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©å¯åŠ¨æ¨¡å¼</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111647166-1055422528.png\" alt=\"img\"></p>\n<p>é€‰æ‹©å¯åŠ¨æ¨¡å¼ä¸‹æ–¹æœ‰ä¸ªé€‰é¡¹ï¼Œéœ€è¦è®¾ç½®æ‰“åŒ…åçš„ç¨‹åºå…¼å®¹32å’Œ64ä½ç³»ç»Ÿ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111656096-898994566.png\" alt=\"img\"></p>\n<p>å…¼å®¹32å’Œ64ä½ç³»ç»Ÿè¿›æ¥åå‹¾é€‰ä¸Š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111704684-1345085588.png\" alt=\"img\"></p>\n<p>å‹¾é€‰ç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œä¸€ç›´å‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œå¼€å§‹é€‰æ‹©jaråŒ…ä»¥åŠé…ç½®åœ¨VMå‚æ•°é…ç½®çš„åœ°æ–¹åŠ ä¸Šï¼š<code>-Dfile.encoding=utf-8</code></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111739256-1971491709.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111747934-1026729198.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111755257-424525494.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111800109-1087786170.png\" alt=\"img\"></p>\n<p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œé…ç½®JRE</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111827329-840979154.png\" alt=\"img\"></p>\n<p>é…ç½®JREä¸‹æ‹‰æ¡†ç‚¹å‡»åè¿›å…¥å¦‚ä¸‹ç•Œé¢</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111838992-1945360511.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111848124-1110985164.png\" alt=\"img\"></p>\n<p>ä¸‹æ‹‰æ¡†ç‚¹å‡»</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111901893-628430600.png\" alt=\"img\"></p>\n<p>ç…§ç€è¿™ä¸ªæ ·å­å†™çš„ç›®çš„æ˜¯ï¼Œæœ€ç»ˆä¼šæŠŠæœ¬åœ°jreç›®å½•å’Œexeä¸€èµ·æ‰“åŒ…ï¼Œè®©exeæ–‡ä»¶è‡ªå·±å»æ ¹æ®è·¯å¾„å»æŸ¥æ‰¾ä¸€èµ·æ‰“åŒ…çš„jreï¼Œå¯ä¸ç”¨å†å®‰è£…jdk</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111937871-1409793481.png\" alt=\"img\"></p>\n<p>æ¥ç€ä¸‹ä¸€æ­¥ï¼Œé€‰æ‹©Client VM</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509111955182-1164832840.png\" alt=\"img\"></p>\n<p>é€‰æ‹©Client VMç„¶åä¸€ç›´ä¸‹ä¸€æ­¥ï¼Œæœ€ç»ˆå‡ºç°å¦‚ä¸‹ç•Œé¢<img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112509693-1948806647.png\" alt=\"å›¾ç‰‡\"></p>\n<p>è¿™ä¸ªæ—¶å€™ä½ ä¼šå‘ç°æ¡Œé¢å¤šäº†ä¸€ä¸ª<code>demo.exe</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å…ˆåˆ«ç€æ€¥ç‚¹å¼€ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†jreå’Œexeæ–‡ä»¶å†æ‰“ä¸ªåŒ…åˆå¹¶ï¼Œè¾¾åˆ°åœ¨æ²¡æœ‰jdkç”µè„‘ç¯å¢ƒä¸‹ä¹Ÿèƒ½è¿è¡Œæ‰“å¼€inno setupï¼Œå·¦ä¸Šè§’File - New</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112041717-1500637696.png\" alt=\"img\"></p>\n<p>æ‰“å¼€inno setupç›´æ¥ç‚¹ä¸‹ä¸€æ­¥ï¼Œå¡«å†™é…ç½®ï¼Œåº”ç”¨åç§°ï¼Œç‰ˆæœ¬ç­‰ï¼Œéšæ„</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112057607-1301322721.png\" alt=\"img\"></p>\n<p>ç‰ˆæœ¬ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿™ä¸ªåœ°æ–¹é»˜è®¤å°±è¡Œï¼Œç›´æ¥ä¸‹ä¸€æ­¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112112186-624409517.png\" alt=\"img\"></p>\n<p>ç›´æ¥ä¸‹ä¸€æ­¥æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112120569-1427010105.png\" alt=\"img\"></p>\n<p>æ¥ç€é€‰æ‹©ç”Ÿæˆå¥½çš„exeæ–‡ä»¶ç„¶åä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è¿™ä¸ªç•Œé¢ä¿æŒé»˜è®¤ï¼Œç›´æ¥ä¸‹ä¸€æ­¥</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112129814-1671272672.png\" alt=\"img\"></p>\n<p>ä¿æŒé»˜è®¤ä¾æ—§ä¸‹ä¸€æ­¥ï¼Œä¸ç”¨ç®¡</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112138411-293405841.png\" alt=\"img\"></p>\n<p>ä¸‹ä¸€æ­¥ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè¿™é‡Œæ˜¯é€‰æ‹©è¯­è¨€</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112146171-409628643.png\" alt=\"img\"></p>\n<p>é€‰æ‹©è¯­è¨€ç„¶åå°±æ˜¯é€‰æ‹©è¾“å‡ºè·¯å¾„å’Œå¡«å†™å®‰è£…ç¨‹åºçš„åå­—äº†</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112155246-276457879.png\" alt=\"img\"></p>\n<p>é€‰æ‹©è¾“å‡ºè·¯å¾„ç„¶åä¸‹ä¸€æ­¥ï¼Œç›´æ¥ç‚¹Nextï¼Œç„¶åç»“æŸé…ç½®åˆ°æœ€åä¸€æ­¥äº†ï¼Œè„šæœ¬æ–‡ä»¶ï¼Œåˆ°è¿™é‡Œä¼šå¼¹å‡ºé—®ä½ æ˜¯å¦é©¬ä¸Šç¼–è¯‘ï¼Œé€‰æ‹©å¦ï¼Œå…ˆæŠŠè„šæœ¬å†™å¥½å†è‡ªå·±ç¼–è¯‘</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112233707-1556689797.png\" alt=\"img\"></p>\n<p>ç¼–è¯‘ç„¶ååˆ°äº†æœ€åä¸€æ­¥äº†ï¼ŒæŠŠæœ¬åœ°çš„JREå†™è¿›è„šæœ¬</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112247175-713534534.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112313666-1584429067.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112325941-471763229.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112334907-851084806.png\" alt=\"img\"></p>\n<p>&#96;&#96;</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112343729-1930111580.png\" alt=\"img\"></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Source: &quot;è‡ªå·±æœ¬åœ°JREè·¯å¾„\\*&quot;; DestDir: &quot;&#123;app&#125;\\&#123;#MyJreName&#125;&quot;; Flags: ignoreversion recursesubdirs createallsubdirs</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åç›´æ¥ç¼–è¯‘å°±å¥½äº†ï¼Œä¼šæç¤ºä¿å­˜å½“å‰è„šæœ¬ï¼Œéšä¾¿èµ·ä¸ªåå­—ï¼Œä¸‹ä¸ªè¿˜å¯ä»¥ç»§ç»­ç”¨</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112358190-36465892.png\" alt=\"img\"></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112415031-718978884.png\" alt=\"img\"></p>\n<p>ç„¶åç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸ</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112426523-1804405720.png\" alt=\"img\"></p>\n<p>ç­‰å¾…ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸå½“ç»¿è‰²æ»šåŠ¨æ¡ç»“æŸåï¼Œæ¡Œé¢ä¼šå¤šäº†ä¸€ä¸ª<code>setup.exe</code>æ–‡ä»¶</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112437772-311845179.png\" alt=\"img\"></p>\n<p>Javaæ‰“åŒ…extä¹ŸåŒæ—¶ä¼šè·³å‡ºä¸€ä¸ªå®‰è£…çš„ï¼Œå› ä¸ºç¨‹åºå¸®ä½ è‡ªåŠ¨å¯åŠ¨ç”Ÿæˆçš„å®‰è£…ç¨‹åºäº†ï¼Œå®‰è£…å°±å¯ä»¥äº†ï¼Œå®‰è£…çš„æ—¶å€™è®°å¾—å‹¾é€‰åˆ›å»ºå¿«æ·æ–¹å¼</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/1608160-20230509112448655-1218116363.png\" alt=\"img\"></p>\n<p> ã€€</p>\n<p>åˆ›å»ºå¿«æ·æ–¹å¼è¿™ä¸ªå°±æ˜¯æœ€åçš„ç¨‹åºäº†ï¼ŒåŒå‡»è¿è¡Œå°±å¯ä»¥çœ‹åˆ°ç»“æœäº†ï¼ŒæŠŠ<code>setup.exe</code>æ–‡ä»¶ç»™åˆ«äººå®‰è£…ï¼Œå°±éƒ½å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç¨‹åºäº†ã€‚</p>\n"},{"title":"å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶","date":"2024-03-14T06:24:09.000Z","_content":"\n> å°†Pythonç¨‹åºæ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„.exeæ–‡ä»¶æœ‰å¤šç§æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸¤ç§å¸¸ç”¨çš„æ–¹å¼ã€‚\n\n\n\n## ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\n\n1. é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†PyInstalleråº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤`pip install pyinstaller`æ¥å®‰è£…ï¼‰ï¼›\n\n2. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°è¦æ‰“åŒ…çš„Pythonè„šæœ¬æ‰€åœ¨ç›®å½•ï¼›\n\n3. è¿è¡Œå‘½ä»¤ `pyinstaller --onefile your_script.py`ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸º\"dist\"çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚\n\n**æ³¨æ„ï¼šæ­¤æ–¹æ³•åªé€‚ç”¨äºå•ä¸ªPythonè„šæœ¬çš„æ‰“åŒ…ã€‚**\n\n4. åœ¨ä½¿ç”¨ PyInstaller æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°ç¼ºå°‘ Python åº“çš„é—®é¢˜ï¼Œå¯¼è‡´æ‰“åŒ…å¤±è´¥ã€‚\n```python\npyinstaller --hidden-import=some_module --onefile your_script.py\n```\n\n\n\n## ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…\n\n1. é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†cx_Freezeåº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤`pip install cx-freeze`æ¥å®‰è£…ï¼‰ï¼›\n\n2. åˆ›å»ºä¸€ä¸ªåä¸ºsetup.pyçš„æ–°æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n   ```python\n    from distutils.core import setup\n   import sys\n   \n   if len(sys.argv) == 1 or 'bdist_wininst' not in sys.argv[1]:\n       # è®¾ç½®éœ€è¦æ‰“åŒ…çš„æ¨¡å—åŠå…¥å£ç‚¹\n       modules = ['myapp']\n       \n       options = {\n           \"build_exe\": {\n               \"includes\": [\"atexit\"],\n               \"excludes\": [],\n               \"packages\": [],\n               \"path\": \"\",\n            },\n         }\n       \n       setup(name=\"YourProgram\", version=\"0.1\", description=\"Description of Your Program\", author=\"Author Name\", url=\"http://www.example.com/\", console=[\"myapp.py\"])\n   else:\n       pass\n   ```\n\n3. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°åŒ…å«ä¸Šè¿°setup.pyæ–‡ä»¶çš„ç›®å½•ï¼›\n\n4. è¿è¡Œå‘½ä»¤ `python setup.py bdist_wininst`ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸º\"dist\"çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚\n\n**æ³¨æ„ï¼šæ­¤æ–¹æ³•æ›´é€‚åˆå¯¹å¤šä¸ªPythonæ¨¡å—è¿›è¡Œæ‰“åŒ…ã€‚**\n","source":"_posts/å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶.md","raw":"---\ntitle: å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶\ndate: 2024-03-14 14:24:09\ntags:\n---\n\n> å°†Pythonç¨‹åºæ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„.exeæ–‡ä»¶æœ‰å¤šç§æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸¤ç§å¸¸ç”¨çš„æ–¹å¼ã€‚\n\n\n\n## ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\n\n1. é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†PyInstalleråº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤`pip install pyinstaller`æ¥å®‰è£…ï¼‰ï¼›\n\n2. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°è¦æ‰“åŒ…çš„Pythonè„šæœ¬æ‰€åœ¨ç›®å½•ï¼›\n\n3. è¿è¡Œå‘½ä»¤ `pyinstaller --onefile your_script.py`ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸º\"dist\"çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚\n\n**æ³¨æ„ï¼šæ­¤æ–¹æ³•åªé€‚ç”¨äºå•ä¸ªPythonè„šæœ¬çš„æ‰“åŒ…ã€‚**\n\n4. åœ¨ä½¿ç”¨ PyInstaller æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°ç¼ºå°‘ Python åº“çš„é—®é¢˜ï¼Œå¯¼è‡´æ‰“åŒ…å¤±è´¥ã€‚\n```python\npyinstaller --hidden-import=some_module --onefile your_script.py\n```\n\n\n\n## ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…\n\n1. é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†cx_Freezeåº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤`pip install cx-freeze`æ¥å®‰è£…ï¼‰ï¼›\n\n2. åˆ›å»ºä¸€ä¸ªåä¸ºsetup.pyçš„æ–°æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n   ```python\n    from distutils.core import setup\n   import sys\n   \n   if len(sys.argv) == 1 or 'bdist_wininst' not in sys.argv[1]:\n       # è®¾ç½®éœ€è¦æ‰“åŒ…çš„æ¨¡å—åŠå…¥å£ç‚¹\n       modules = ['myapp']\n       \n       options = {\n           \"build_exe\": {\n               \"includes\": [\"atexit\"],\n               \"excludes\": [],\n               \"packages\": [],\n               \"path\": \"\",\n            },\n         }\n       \n       setup(name=\"YourProgram\", version=\"0.1\", description=\"Description of Your Program\", author=\"Author Name\", url=\"http://www.example.com/\", console=[\"myapp.py\"])\n   else:\n       pass\n   ```\n\n3. åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°åŒ…å«ä¸Šè¿°setup.pyæ–‡ä»¶çš„ç›®å½•ï¼›\n\n4. è¿è¡Œå‘½ä»¤ `python setup.py bdist_wininst`ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸º\"dist\"çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚\n\n**æ³¨æ„ï¼šæ­¤æ–¹æ³•æ›´é€‚åˆå¯¹å¤šä¸ªPythonæ¨¡å—è¿›è¡Œæ‰“åŒ…ã€‚**\n","slug":"å°†Pythonè„šæœ¬æ‰“åŒ…æˆå¯æ‰§è¡Œçš„exeæ–‡ä»¶","published":1,"updated":"2024-06-20T12:50:52.123Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dq0016wen1e3ai3xqc","content":"<blockquote>\n<p>å°†Pythonç¨‹åºæ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„.exeæ–‡ä»¶æœ‰å¤šç§æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸¤ç§å¸¸ç”¨çš„æ–¹å¼ã€‚</p>\n</blockquote>\n<h2 id=\"ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\"><a href=\"#ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\" class=\"headerlink\" title=\"ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\"></a>ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…</h2><ol>\n<li><p>é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†PyInstalleråº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤<code>pip install pyinstaller</code>æ¥å®‰è£…ï¼‰ï¼›</p>\n</li>\n<li><p>åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°è¦æ‰“åŒ…çš„Pythonè„šæœ¬æ‰€åœ¨ç›®å½•ï¼›</p>\n</li>\n<li><p>è¿è¡Œå‘½ä»¤ <code>pyinstaller --onefile your_script.py</code>ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºâ€distâ€çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚</p>\n</li>\n</ol>\n<p><strong>æ³¨æ„ï¼šæ­¤æ–¹æ³•åªé€‚ç”¨äºå•ä¸ªPythonè„šæœ¬çš„æ‰“åŒ…ã€‚</strong></p>\n<ol start=\"4\">\n<li>åœ¨ä½¿ç”¨ PyInstaller æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°ç¼ºå°‘ Python åº“çš„é—®é¢˜ï¼Œå¯¼è‡´æ‰“åŒ…å¤±è´¥ã€‚<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyinstaller --hidden-<span class=\"keyword\">import</span>=some_module --onefile your_script.py</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"ä½¿ç”¨cx-Freezeåº“è¿›è¡Œæ‰“åŒ…\"><a href=\"#ä½¿ç”¨cx-Freezeåº“è¿›è¡Œæ‰“åŒ…\" class=\"headerlink\" title=\"ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…\"></a>ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…</h2><ol>\n<li><p>é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†cx_Freezeåº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤<code>pip install cx-freeze</code>æ¥å®‰è£…ï¼‰ï¼›</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªåä¸ºsetup.pyçš„æ–°æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">from</span> distutils.core <span class=\"keyword\">import</span> setup</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(sys.argv) == <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"string\">&#x27;bdist_wininst&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> sys.argv[<span class=\"number\">1</span>]:</span><br><span class=\"line\">    <span class=\"comment\"># è®¾ç½®éœ€è¦æ‰“åŒ…çš„æ¨¡å—åŠå…¥å£ç‚¹</span></span><br><span class=\"line\">    modules = [<span class=\"string\">&#x27;myapp&#x27;</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    options = &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;build_exe&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;includes&quot;</span>: [<span class=\"string\">&quot;atexit&quot;</span>],</span><br><span class=\"line\">            <span class=\"string\">&quot;excludes&quot;</span>: [],</span><br><span class=\"line\">            <span class=\"string\">&quot;packages&quot;</span>: [],</span><br><span class=\"line\">            <span class=\"string\">&quot;path&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    setup(name=<span class=\"string\">&quot;YourProgram&quot;</span>, version=<span class=\"string\">&quot;0.1&quot;</span>, description=<span class=\"string\">&quot;Description of Your Program&quot;</span>, author=<span class=\"string\">&quot;Author Name&quot;</span>, url=<span class=\"string\">&quot;http://www.example.com/&quot;</span>, console=[<span class=\"string\">&quot;myapp.py&quot;</span>])</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°åŒ…å«ä¸Šè¿°setup.pyæ–‡ä»¶çš„ç›®å½•ï¼›</p>\n</li>\n<li><p>è¿è¡Œå‘½ä»¤ <code>python setup.py bdist_wininst</code>ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºâ€distâ€çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚</p>\n</li>\n</ol>\n<p><strong>æ³¨æ„ï¼šæ­¤æ–¹æ³•æ›´é€‚åˆå¯¹å¤šä¸ªPythonæ¨¡å—è¿›è¡Œæ‰“åŒ…ã€‚</strong></p>\n","excerpt":"","more":"<blockquote>\n<p>å°†Pythonç¨‹åºæ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„.exeæ–‡ä»¶æœ‰å¤šç§æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸¤ç§å¸¸ç”¨çš„æ–¹å¼ã€‚</p>\n</blockquote>\n<h2 id=\"ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\"><a href=\"#ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\" class=\"headerlink\" title=\"ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…\"></a>ä½¿ç”¨PyInstalleråº“è¿›è¡Œæ‰“åŒ…</h2><ol>\n<li><p>é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†PyInstalleråº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤<code>pip install pyinstaller</code>æ¥å®‰è£…ï¼‰ï¼›</p>\n</li>\n<li><p>åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°è¦æ‰“åŒ…çš„Pythonè„šæœ¬æ‰€åœ¨ç›®å½•ï¼›</p>\n</li>\n<li><p>è¿è¡Œå‘½ä»¤ <code>pyinstaller --onefile your_script.py</code>ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºâ€distâ€çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚</p>\n</li>\n</ol>\n<p><strong>æ³¨æ„ï¼šæ­¤æ–¹æ³•åªé€‚ç”¨äºå•ä¸ªPythonè„šæœ¬çš„æ‰“åŒ…ã€‚</strong></p>\n<ol start=\"4\">\n<li>åœ¨ä½¿ç”¨ PyInstaller æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°ç¼ºå°‘ Python åº“çš„é—®é¢˜ï¼Œå¯¼è‡´æ‰“åŒ…å¤±è´¥ã€‚<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pyinstaller --hidden-<span class=\"keyword\">import</span>=some_module --onefile your_script.py</span><br></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"ä½¿ç”¨cx-Freezeåº“è¿›è¡Œæ‰“åŒ…\"><a href=\"#ä½¿ç”¨cx-Freezeåº“è¿›è¡Œæ‰“åŒ…\" class=\"headerlink\" title=\"ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…\"></a>ä½¿ç”¨cx_Freezeåº“è¿›è¡Œæ‰“åŒ…</h2><ol>\n<li><p>é¦–å…ˆç¡®ä¿å·²ç»å®‰è£…äº†cx_Freezeåº“ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡å‘½ä»¤<code>pip install cx-freeze</code>æ¥å®‰è£…ï¼‰ï¼›</p>\n</li>\n<li><p>åˆ›å»ºä¸€ä¸ªåä¸ºsetup.pyçš„æ–°æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">from</span> distutils.core <span class=\"keyword\">import</span> setup</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(sys.argv) == <span class=\"number\">1</span> <span class=\"keyword\">or</span> <span class=\"string\">&#x27;bdist_wininst&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> sys.argv[<span class=\"number\">1</span>]:</span><br><span class=\"line\">    <span class=\"comment\"># è®¾ç½®éœ€è¦æ‰“åŒ…çš„æ¨¡å—åŠå…¥å£ç‚¹</span></span><br><span class=\"line\">    modules = [<span class=\"string\">&#x27;myapp&#x27;</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    options = &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;build_exe&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;includes&quot;</span>: [<span class=\"string\">&quot;atexit&quot;</span>],</span><br><span class=\"line\">            <span class=\"string\">&quot;excludes&quot;</span>: [],</span><br><span class=\"line\">            <span class=\"string\">&quot;packages&quot;</span>: [],</span><br><span class=\"line\">            <span class=\"string\">&quot;path&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">         &#125;,</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    setup(name=<span class=\"string\">&quot;YourProgram&quot;</span>, version=<span class=\"string\">&quot;0.1&quot;</span>, description=<span class=\"string\">&quot;Description of Your Program&quot;</span>, author=<span class=\"string\">&quot;Author Name&quot;</span>, url=<span class=\"string\">&quot;http://www.example.com/&quot;</span>, console=[<span class=\"string\">&quot;myapp.py&quot;</span>])</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    <span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–ç»ˆç«¯ä¸­å¯¼èˆªåˆ°åŒ…å«ä¸Šè¿°setup.pyæ–‡ä»¶çš„ç›®å½•ï¼›</p>\n</li>\n<li><p>è¿è¡Œå‘½ä»¤ <code>python setup.py bdist_wininst</code>ï¼Œè¿™ä¼šç”Ÿæˆä¸€ä¸ªåä¸ºâ€distâ€çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªä¸è„šæœ¬åŒåçš„.exeæ–‡ä»¶ã€‚</p>\n</li>\n</ol>\n<p><strong>æ³¨æ„ï¼šæ­¤æ–¹æ³•æ›´é€‚åˆå¯¹å¤šä¸ªPythonæ¨¡å—è¿›è¡Œæ‰“åŒ…ã€‚</strong></p>\n"},{"title":"å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)","date":"2024-01-04T03:20:40.000Z","_content":"\n> å†™åšå®¢çš„æ—¶å€™ï¼Œåˆšå¼€å§‹ç›´æ¥åœ¨å„å¤§å¹³å°ä¸Šç›´æ¥å†™ï¼Œåæ¥è¿˜æ˜¯è§‰å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œéœ€è¦åœ¨å„å¤§å¹³å°ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚äºæ˜¯å°±æ”¹ç”¨Typoraï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯å›¾ç‰‡çš„å¤„ç†ï¼Œåªèƒ½æ”¾åœ¨æœ¬åœ°ã€‚æƒ³è¦å‘å¸ƒåˆ°å„å¤§å¹³å°ï¼Œå°±éœ€è¦å›¾åºŠã€‚æœ¬æ–‡ç»“åˆé˜¿é‡Œäº‘OSSã€PicGoå›¾åºŠé…ç½®ã€Typoraé…ç½®ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€æ¬¡æ–‡ç« ç¼–å†™ï¼Œå„å¤§å¹³å°ç»Ÿä¸€è¾“å‡ºã€‚\n\n## é˜¿é‡Œäº‘é…ç½®\n\n### **åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket**\n\nç™»å½•é˜¿é‡Œäº‘åï¼Œé€‰æ‹©å¯¹è±¡å­˜å‚¨\n\n![image-20221222125850693](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/4b40339b-f3ee-415a-8348-1a371e5c4b6d.png)\n\næ–°äººå¼€é€šè¯•ç”¨3ä¸ªæœˆå…è´¹\n\n![image-20221222130109938](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/14da8647-0f63-43ae-bcfa-69b5829db289.png)\n\nå¼€é€šåï¼Œè¿›å…¥ç®¡ç†æ§åˆ¶å°\n\nç‚¹å‡»Bucketåˆ—è¡¨ï¼Œåˆ›å»ºBucket\n\n![image-20221222130233633](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dc718170-d70f-458c-918b-67d2c495739e.png)\n\nè®¿é—®æ§åˆ¶å¼€å¯å…¬å…±è¯»\n\n![image-20221222130527365](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5154a85d-5292-49b2-bd4d-035cd8fadc36.png)\n\n### **è®¿é—®æ§åˆ¶RAMé…ç½®**\n\nç‚¹å‡»å³ä¸Šè§’AccessKeyç®¡ç†\n\n![image-20221222134259058](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/10ecacba-67dd-4bd0-b2b0-05d6bd2c8280.png)\n\n**åˆ›å»ºAccessKeyï¼Œæ³¨æ„è¿™é‡Œçš„AccessKey ID å’Œ AccessKey Secretä¿å­˜ä¸‹æ¥ï¼Œåé¢è¦ç”¨åˆ°**\n\n![image-20221222134507363](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/46ad3a39-cd1b-49b9-9d72-d4dc2e43730f.png)\n\n## PicGoä¸‹è½½å®‰è£…\n\nä¸‹è½½åœ°å€\n\nhttps://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\n\nå¯ä»¥é€‰æ‹©å±±ä¸œå¤§å­¦çš„é•œåƒç«™\n\nhttps://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo\n\n![image-20221222133605621](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/9bc5c527-4845-4ba7-b575-f6ac1c57ea3d.png)\n\n### **PicGoé…ç½®**\n\n- KeyId ã€KeySecret å°±æ˜¯ä¸Šé¢é˜¿é‡Œäº‘çš„AccessKey ID å’Œ AccessKey Secret\n- Bucket å°±æ˜¯é˜¿é‡Œäº‘çš„bucketåç§°\n\n![image-20221222134810396](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/326fb8c6-44a6-491b-96e8-c58bc4c08282.png)\n\n- å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”é˜¿é‡Œäº‘Endpointçš„å‰é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯oss-cn-hangzhou\n- å­˜å‚¨è·¯å¾„ï¼Œè‡ªå·±éšä¾¿å®šä¹‰ä¸€ä¸ªï¼Œæ¯”å¦‚ img/\n- è‡ªå®šä¹‰åŸŸåï¼Œå¯¹åº”é˜¿é‡Œäº‘ BucketåŸŸå\n\n![image-20221222135020880](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/6cf44a45-802d-4553-a499-c43726a92782.png)\n\n## Typoraä¸‹è½½åŠé…ç½®\n\nTyporaç›®å‰æ”¶è´¹ï¼Œæƒ³è¦å…è´¹å¯ä½¿ç”¨ï¼Œå¯å‚è€ƒç¬”è€…çš„è¿™ä¸ªä¸‹è½½åœ°å€\n\n> é“¾æ¥ï¼šhttps://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i æå–ç ï¼šF93i\n\n### **è®¾ç½®**\n\næ‰¾åˆ°è®¾ç½®ï¼Œç‚¹å‡»å›¾åƒè®¾ç½®\n\nä¸Šä¼ å›¾ç‰‡çš„æœåŠ¡ï¼Œé€‰æ‹©PicGo.app\n\n![image-20221222135334696](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/18f35e1f-8a91-4200-a71d-91b6d8f65ec9.png)\n\n**æ³¨æ„ï¼šPicGo.appéœ€è¦å¡«å†™è¾“å…¥æ­£ç¡®çš„å®‰è£…è·¯å¾„ï¼Œå¡«å†™åå¯é€šè¿‡æ—è¾¹çš„éªŒè¯åŠŸèƒ½æŸ¥çœ‹æ˜¯å¦å¡«å†™æˆåŠŸ**\n\n\n\n### **å®é™…æ•ˆæœ**\n\n- æˆªå›¾è½¯ä»¶ï¼Œç²˜è´´æ•ˆæœï¼Œtyporaç›´æ¥è½¬æ¢æˆäº†é˜¿é‡Œäº‘OSSçš„åœ°å€![image-20221222140236233](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/53d7a28b-96f3-4ba5-8fbc-e47b5bddae99.png)\n- å¤–ç«™ç²˜è´´è¿‡æ¥çš„ä¹Ÿæ˜¯åŒæ ·æ•ˆæœ\n","source":"_posts/å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬).md","raw":"---\ntitle: å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)\ndate: 2024-01-04 11:20:40\ntags:\n---\n\n> å†™åšå®¢çš„æ—¶å€™ï¼Œåˆšå¼€å§‹ç›´æ¥åœ¨å„å¤§å¹³å°ä¸Šç›´æ¥å†™ï¼Œåæ¥è¿˜æ˜¯è§‰å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œéœ€è¦åœ¨å„å¤§å¹³å°ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚äºæ˜¯å°±æ”¹ç”¨Typoraï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯å›¾ç‰‡çš„å¤„ç†ï¼Œåªèƒ½æ”¾åœ¨æœ¬åœ°ã€‚æƒ³è¦å‘å¸ƒåˆ°å„å¤§å¹³å°ï¼Œå°±éœ€è¦å›¾åºŠã€‚æœ¬æ–‡ç»“åˆé˜¿é‡Œäº‘OSSã€PicGoå›¾åºŠé…ç½®ã€Typoraé…ç½®ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€æ¬¡æ–‡ç« ç¼–å†™ï¼Œå„å¤§å¹³å°ç»Ÿä¸€è¾“å‡ºã€‚\n\n## é˜¿é‡Œäº‘é…ç½®\n\n### **åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket**\n\nç™»å½•é˜¿é‡Œäº‘åï¼Œé€‰æ‹©å¯¹è±¡å­˜å‚¨\n\n![image-20221222125850693](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/4b40339b-f3ee-415a-8348-1a371e5c4b6d.png)\n\næ–°äººå¼€é€šè¯•ç”¨3ä¸ªæœˆå…è´¹\n\n![image-20221222130109938](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/14da8647-0f63-43ae-bcfa-69b5829db289.png)\n\nå¼€é€šåï¼Œè¿›å…¥ç®¡ç†æ§åˆ¶å°\n\nç‚¹å‡»Bucketåˆ—è¡¨ï¼Œåˆ›å»ºBucket\n\n![image-20221222130233633](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dc718170-d70f-458c-918b-67d2c495739e.png)\n\nè®¿é—®æ§åˆ¶å¼€å¯å…¬å…±è¯»\n\n![image-20221222130527365](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5154a85d-5292-49b2-bd4d-035cd8fadc36.png)\n\n### **è®¿é—®æ§åˆ¶RAMé…ç½®**\n\nç‚¹å‡»å³ä¸Šè§’AccessKeyç®¡ç†\n\n![image-20221222134259058](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/10ecacba-67dd-4bd0-b2b0-05d6bd2c8280.png)\n\n**åˆ›å»ºAccessKeyï¼Œæ³¨æ„è¿™é‡Œçš„AccessKey ID å’Œ AccessKey Secretä¿å­˜ä¸‹æ¥ï¼Œåé¢è¦ç”¨åˆ°**\n\n![image-20221222134507363](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/46ad3a39-cd1b-49b9-9d72-d4dc2e43730f.png)\n\n## PicGoä¸‹è½½å®‰è£…\n\nä¸‹è½½åœ°å€\n\nhttps://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\n\nå¯ä»¥é€‰æ‹©å±±ä¸œå¤§å­¦çš„é•œåƒç«™\n\nhttps://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo\n\n![image-20221222133605621](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/9bc5c527-4845-4ba7-b575-f6ac1c57ea3d.png)\n\n### **PicGoé…ç½®**\n\n- KeyId ã€KeySecret å°±æ˜¯ä¸Šé¢é˜¿é‡Œäº‘çš„AccessKey ID å’Œ AccessKey Secret\n- Bucket å°±æ˜¯é˜¿é‡Œäº‘çš„bucketåç§°\n\n![image-20221222134810396](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/326fb8c6-44a6-491b-96e8-c58bc4c08282.png)\n\n- å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”é˜¿é‡Œäº‘Endpointçš„å‰é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯oss-cn-hangzhou\n- å­˜å‚¨è·¯å¾„ï¼Œè‡ªå·±éšä¾¿å®šä¹‰ä¸€ä¸ªï¼Œæ¯”å¦‚ img/\n- è‡ªå®šä¹‰åŸŸåï¼Œå¯¹åº”é˜¿é‡Œäº‘ BucketåŸŸå\n\n![image-20221222135020880](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/6cf44a45-802d-4553-a499-c43726a92782.png)\n\n## Typoraä¸‹è½½åŠé…ç½®\n\nTyporaç›®å‰æ”¶è´¹ï¼Œæƒ³è¦å…è´¹å¯ä½¿ç”¨ï¼Œå¯å‚è€ƒç¬”è€…çš„è¿™ä¸ªä¸‹è½½åœ°å€\n\n> é“¾æ¥ï¼šhttps://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i æå–ç ï¼šF93i\n\n### **è®¾ç½®**\n\næ‰¾åˆ°è®¾ç½®ï¼Œç‚¹å‡»å›¾åƒè®¾ç½®\n\nä¸Šä¼ å›¾ç‰‡çš„æœåŠ¡ï¼Œé€‰æ‹©PicGo.app\n\n![image-20221222135334696](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/18f35e1f-8a91-4200-a71d-91b6d8f65ec9.png)\n\n**æ³¨æ„ï¼šPicGo.appéœ€è¦å¡«å†™è¾“å…¥æ­£ç¡®çš„å®‰è£…è·¯å¾„ï¼Œå¡«å†™åå¯é€šè¿‡æ—è¾¹çš„éªŒè¯åŠŸèƒ½æŸ¥çœ‹æ˜¯å¦å¡«å†™æˆåŠŸ**\n\n\n\n### **å®é™…æ•ˆæœ**\n\n- æˆªå›¾è½¯ä»¶ï¼Œç²˜è´´æ•ˆæœï¼Œtyporaç›´æ¥è½¬æ¢æˆäº†é˜¿é‡Œäº‘OSSçš„åœ°å€![image-20221222140236233](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/53d7a28b-96f3-4ba5-8fbc-e47b5bddae99.png)\n- å¤–ç«™ç²˜è´´è¿‡æ¥çš„ä¹Ÿæ˜¯åŒæ ·æ•ˆæœ\n","slug":"å¼€å‘å¿…å¤‡è½¯ä»¶-Typoraé…åˆPicGoé˜¿é‡Œäº‘å›¾åºŠé…ç½®(è½¬)","published":1,"updated":"2024-02-07T07:27:45.074Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dq0017wen10fbn0qi0","content":"<blockquote>\n<p>å†™åšå®¢çš„æ—¶å€™ï¼Œåˆšå¼€å§‹ç›´æ¥åœ¨å„å¤§å¹³å°ä¸Šç›´æ¥å†™ï¼Œåæ¥è¿˜æ˜¯è§‰å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œéœ€è¦åœ¨å„å¤§å¹³å°ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚äºæ˜¯å°±æ”¹ç”¨Typoraï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯å›¾ç‰‡çš„å¤„ç†ï¼Œåªèƒ½æ”¾åœ¨æœ¬åœ°ã€‚æƒ³è¦å‘å¸ƒåˆ°å„å¤§å¹³å°ï¼Œå°±éœ€è¦å›¾åºŠã€‚æœ¬æ–‡ç»“åˆé˜¿é‡Œäº‘OSSã€PicGoå›¾åºŠé…ç½®ã€Typoraé…ç½®ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€æ¬¡æ–‡ç« ç¼–å†™ï¼Œå„å¤§å¹³å°ç»Ÿä¸€è¾“å‡ºã€‚</p>\n</blockquote>\n<h2 id=\"é˜¿é‡Œäº‘é…ç½®\"><a href=\"#é˜¿é‡Œäº‘é…ç½®\" class=\"headerlink\" title=\"é˜¿é‡Œäº‘é…ç½®\"></a>é˜¿é‡Œäº‘é…ç½®</h2><h3 id=\"åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\"><a href=\"#åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\" class=\"headerlink\" title=\"åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\"></a><strong>åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket</strong></h3><p>ç™»å½•é˜¿é‡Œäº‘åï¼Œé€‰æ‹©å¯¹è±¡å­˜å‚¨</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/4b40339b-f3ee-415a-8348-1a371e5c4b6d.png\" alt=\"image-20221222125850693\"></p>\n<p>æ–°äººå¼€é€šè¯•ç”¨3ä¸ªæœˆå…è´¹</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/14da8647-0f63-43ae-bcfa-69b5829db289.png\" alt=\"image-20221222130109938\"></p>\n<p>å¼€é€šåï¼Œè¿›å…¥ç®¡ç†æ§åˆ¶å°</p>\n<p>ç‚¹å‡»Bucketåˆ—è¡¨ï¼Œåˆ›å»ºBucket</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dc718170-d70f-458c-918b-67d2c495739e.png\" alt=\"image-20221222130233633\"></p>\n<p>è®¿é—®æ§åˆ¶å¼€å¯å…¬å…±è¯»</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5154a85d-5292-49b2-bd4d-035cd8fadc36.png\" alt=\"image-20221222130527365\"></p>\n<h3 id=\"è®¿é—®æ§åˆ¶RAMé…ç½®\"><a href=\"#è®¿é—®æ§åˆ¶RAMé…ç½®\" class=\"headerlink\" title=\"è®¿é—®æ§åˆ¶RAMé…ç½®\"></a><strong>è®¿é—®æ§åˆ¶RAMé…ç½®</strong></h3><p>ç‚¹å‡»å³ä¸Šè§’AccessKeyç®¡ç†</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/10ecacba-67dd-4bd0-b2b0-05d6bd2c8280.png\" alt=\"image-20221222134259058\"></p>\n<p><strong>åˆ›å»ºAccessKeyï¼Œæ³¨æ„è¿™é‡Œçš„AccessKey ID å’Œ AccessKey Secretä¿å­˜ä¸‹æ¥ï¼Œåé¢è¦ç”¨åˆ°</strong></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/46ad3a39-cd1b-49b9-9d72-d4dc2e43730f.png\" alt=\"image-20221222134507363\"></p>\n<h2 id=\"PicGoä¸‹è½½å®‰è£…\"><a href=\"#PicGoä¸‹è½½å®‰è£…\" class=\"headerlink\" title=\"PicGoä¸‹è½½å®‰è£…\"></a>PicGoä¸‹è½½å®‰è£…</h2><p>ä¸‹è½½åœ°å€</p>\n<p><a href=\"https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\">https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85</a></p>\n<p>å¯ä»¥é€‰æ‹©å±±ä¸œå¤§å­¦çš„é•œåƒç«™</p>\n<p><a href=\"https://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo\">https://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo</a></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/9bc5c527-4845-4ba7-b575-f6ac1c57ea3d.png\" alt=\"image-20221222133605621\"></p>\n<h3 id=\"PicGoé…ç½®\"><a href=\"#PicGoé…ç½®\" class=\"headerlink\" title=\"PicGoé…ç½®\"></a><strong>PicGoé…ç½®</strong></h3><ul>\n<li>KeyId ã€KeySecret å°±æ˜¯ä¸Šé¢é˜¿é‡Œäº‘çš„AccessKey ID å’Œ AccessKey Secret</li>\n<li>Bucket å°±æ˜¯é˜¿é‡Œäº‘çš„bucketåç§°</li>\n</ul>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/326fb8c6-44a6-491b-96e8-c58bc4c08282.png\" alt=\"image-20221222134810396\"></p>\n<ul>\n<li>å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”é˜¿é‡Œäº‘Endpointçš„å‰é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯oss-cn-hangzhou</li>\n<li>å­˜å‚¨è·¯å¾„ï¼Œè‡ªå·±éšä¾¿å®šä¹‰ä¸€ä¸ªï¼Œæ¯”å¦‚ img&#x2F;</li>\n<li>è‡ªå®šä¹‰åŸŸåï¼Œå¯¹åº”é˜¿é‡Œäº‘ BucketåŸŸå</li>\n</ul>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/6cf44a45-802d-4553-a499-c43726a92782.png\" alt=\"image-20221222135020880\"></p>\n<h2 id=\"Typoraä¸‹è½½åŠé…ç½®\"><a href=\"#Typoraä¸‹è½½åŠé…ç½®\" class=\"headerlink\" title=\"Typoraä¸‹è½½åŠé…ç½®\"></a>Typoraä¸‹è½½åŠé…ç½®</h2><p>Typoraç›®å‰æ”¶è´¹ï¼Œæƒ³è¦å…è´¹å¯ä½¿ç”¨ï¼Œå¯å‚è€ƒç¬”è€…çš„è¿™ä¸ªä¸‹è½½åœ°å€</p>\n<blockquote>\n<p>é“¾æ¥ï¼š<a href=\"https://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i\">https://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i</a> æå–ç ï¼šF93i</p>\n</blockquote>\n<h3 id=\"è®¾ç½®\"><a href=\"#è®¾ç½®\" class=\"headerlink\" title=\"è®¾ç½®\"></a><strong>è®¾ç½®</strong></h3><p>æ‰¾åˆ°è®¾ç½®ï¼Œç‚¹å‡»å›¾åƒè®¾ç½®</p>\n<p>ä¸Šä¼ å›¾ç‰‡çš„æœåŠ¡ï¼Œé€‰æ‹©PicGo.app</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/18f35e1f-8a91-4200-a71d-91b6d8f65ec9.png\" alt=\"image-20221222135334696\"></p>\n<p><strong>æ³¨æ„ï¼šPicGo.appéœ€è¦å¡«å†™è¾“å…¥æ­£ç¡®çš„å®‰è£…è·¯å¾„ï¼Œå¡«å†™åå¯é€šè¿‡æ—è¾¹çš„éªŒè¯åŠŸèƒ½æŸ¥çœ‹æ˜¯å¦å¡«å†™æˆåŠŸ</strong></p>\n<h3 id=\"å®é™…æ•ˆæœ\"><a href=\"#å®é™…æ•ˆæœ\" class=\"headerlink\" title=\"å®é™…æ•ˆæœ\"></a><strong>å®é™…æ•ˆæœ</strong></h3><ul>\n<li>æˆªå›¾è½¯ä»¶ï¼Œç²˜è´´æ•ˆæœï¼Œtyporaç›´æ¥è½¬æ¢æˆäº†é˜¿é‡Œäº‘OSSçš„åœ°å€<img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/53d7a28b-96f3-4ba5-8fbc-e47b5bddae99.png\" alt=\"image-20221222140236233\"></li>\n<li>å¤–ç«™ç²˜è´´è¿‡æ¥çš„ä¹Ÿæ˜¯åŒæ ·æ•ˆæœ</li>\n</ul>\n","excerpt":"","more":"<blockquote>\n<p>å†™åšå®¢çš„æ—¶å€™ï¼Œåˆšå¼€å§‹ç›´æ¥åœ¨å„å¤§å¹³å°ä¸Šç›´æ¥å†™ï¼Œåæ¥è¿˜æ˜¯è§‰å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œéœ€è¦åœ¨å„å¤§å¹³å°ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚äºæ˜¯å°±æ”¹ç”¨Typoraï¼Œä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯å›¾ç‰‡çš„å¤„ç†ï¼Œåªèƒ½æ”¾åœ¨æœ¬åœ°ã€‚æƒ³è¦å‘å¸ƒåˆ°å„å¤§å¹³å°ï¼Œå°±éœ€è¦å›¾åºŠã€‚æœ¬æ–‡ç»“åˆé˜¿é‡Œäº‘OSSã€PicGoå›¾åºŠé…ç½®ã€Typoraé…ç½®ï¼Œèƒ½å¤Ÿåšåˆ°ä¸€æ¬¡æ–‡ç« ç¼–å†™ï¼Œå„å¤§å¹³å°ç»Ÿä¸€è¾“å‡ºã€‚</p>\n</blockquote>\n<h2 id=\"é˜¿é‡Œäº‘é…ç½®\"><a href=\"#é˜¿é‡Œäº‘é…ç½®\" class=\"headerlink\" title=\"é˜¿é‡Œäº‘é…ç½®\"></a>é˜¿é‡Œäº‘é…ç½®</h2><h3 id=\"åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\"><a href=\"#åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\" class=\"headerlink\" title=\"åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket\"></a><strong>åˆ›å»ºå¯¹è±¡å­˜å‚¨Bucket</strong></h3><p>ç™»å½•é˜¿é‡Œäº‘åï¼Œé€‰æ‹©å¯¹è±¡å­˜å‚¨</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/4b40339b-f3ee-415a-8348-1a371e5c4b6d.png\" alt=\"image-20221222125850693\"></p>\n<p>æ–°äººå¼€é€šè¯•ç”¨3ä¸ªæœˆå…è´¹</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/14da8647-0f63-43ae-bcfa-69b5829db289.png\" alt=\"image-20221222130109938\"></p>\n<p>å¼€é€šåï¼Œè¿›å…¥ç®¡ç†æ§åˆ¶å°</p>\n<p>ç‚¹å‡»Bucketåˆ—è¡¨ï¼Œåˆ›å»ºBucket</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/dc718170-d70f-458c-918b-67d2c495739e.png\" alt=\"image-20221222130233633\"></p>\n<p>è®¿é—®æ§åˆ¶å¼€å¯å…¬å…±è¯»</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5154a85d-5292-49b2-bd4d-035cd8fadc36.png\" alt=\"image-20221222130527365\"></p>\n<h3 id=\"è®¿é—®æ§åˆ¶RAMé…ç½®\"><a href=\"#è®¿é—®æ§åˆ¶RAMé…ç½®\" class=\"headerlink\" title=\"è®¿é—®æ§åˆ¶RAMé…ç½®\"></a><strong>è®¿é—®æ§åˆ¶RAMé…ç½®</strong></h3><p>ç‚¹å‡»å³ä¸Šè§’AccessKeyç®¡ç†</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/10ecacba-67dd-4bd0-b2b0-05d6bd2c8280.png\" alt=\"image-20221222134259058\"></p>\n<p><strong>åˆ›å»ºAccessKeyï¼Œæ³¨æ„è¿™é‡Œçš„AccessKey ID å’Œ AccessKey Secretä¿å­˜ä¸‹æ¥ï¼Œåé¢è¦ç”¨åˆ°</strong></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/46ad3a39-cd1b-49b9-9d72-d4dc2e43730f.png\" alt=\"image-20221222134507363\"></p>\n<h2 id=\"PicGoä¸‹è½½å®‰è£…\"><a href=\"#PicGoä¸‹è½½å®‰è£…\" class=\"headerlink\" title=\"PicGoä¸‹è½½å®‰è£…\"></a>PicGoä¸‹è½½å®‰è£…</h2><p>ä¸‹è½½åœ°å€</p>\n<p><a href=\"https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\">https://picgo.github.io/PicGo-Doc/zh/guide/#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85</a></p>\n<p>å¯ä»¥é€‰æ‹©å±±ä¸œå¤§å­¦çš„é•œåƒç«™</p>\n<p><a href=\"https://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo\">https://mirrors.sdu.edu.cn/github-release/Molunerfinn_PicGo</a></p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/9bc5c527-4845-4ba7-b575-f6ac1c57ea3d.png\" alt=\"image-20221222133605621\"></p>\n<h3 id=\"PicGoé…ç½®\"><a href=\"#PicGoé…ç½®\" class=\"headerlink\" title=\"PicGoé…ç½®\"></a><strong>PicGoé…ç½®</strong></h3><ul>\n<li>KeyId ã€KeySecret å°±æ˜¯ä¸Šé¢é˜¿é‡Œäº‘çš„AccessKey ID å’Œ AccessKey Secret</li>\n<li>Bucket å°±æ˜¯é˜¿é‡Œäº‘çš„bucketåç§°</li>\n</ul>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/326fb8c6-44a6-491b-96e8-c58bc4c08282.png\" alt=\"image-20221222134810396\"></p>\n<ul>\n<li>å­˜å‚¨åŒºåŸŸï¼Œå¯¹åº”é˜¿é‡Œäº‘Endpointçš„å‰é¢ï¼Œæˆ‘è¿™é‡Œæ˜¯oss-cn-hangzhou</li>\n<li>å­˜å‚¨è·¯å¾„ï¼Œè‡ªå·±éšä¾¿å®šä¹‰ä¸€ä¸ªï¼Œæ¯”å¦‚ img&#x2F;</li>\n<li>è‡ªå®šä¹‰åŸŸåï¼Œå¯¹åº”é˜¿é‡Œäº‘ BucketåŸŸå</li>\n</ul>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/6cf44a45-802d-4553-a499-c43726a92782.png\" alt=\"image-20221222135020880\"></p>\n<h2 id=\"Typoraä¸‹è½½åŠé…ç½®\"><a href=\"#Typoraä¸‹è½½åŠé…ç½®\" class=\"headerlink\" title=\"Typoraä¸‹è½½åŠé…ç½®\"></a>Typoraä¸‹è½½åŠé…ç½®</h2><p>Typoraç›®å‰æ”¶è´¹ï¼Œæƒ³è¦å…è´¹å¯ä½¿ç”¨ï¼Œå¯å‚è€ƒç¬”è€…çš„è¿™ä¸ªä¸‹è½½åœ°å€</p>\n<blockquote>\n<p>é“¾æ¥ï¼š<a href=\"https://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i\">https://pan.baidu.com/s/1bCxmIPk23R0B9SVCqY37wg?pwd=F93i</a> æå–ç ï¼šF93i</p>\n</blockquote>\n<h3 id=\"è®¾ç½®\"><a href=\"#è®¾ç½®\" class=\"headerlink\" title=\"è®¾ç½®\"></a><strong>è®¾ç½®</strong></h3><p>æ‰¾åˆ°è®¾ç½®ï¼Œç‚¹å‡»å›¾åƒè®¾ç½®</p>\n<p>ä¸Šä¼ å›¾ç‰‡çš„æœåŠ¡ï¼Œé€‰æ‹©PicGo.app</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/18f35e1f-8a91-4200-a71d-91b6d8f65ec9.png\" alt=\"image-20221222135334696\"></p>\n<p><strong>æ³¨æ„ï¼šPicGo.appéœ€è¦å¡«å†™è¾“å…¥æ­£ç¡®çš„å®‰è£…è·¯å¾„ï¼Œå¡«å†™åå¯é€šè¿‡æ—è¾¹çš„éªŒè¯åŠŸèƒ½æŸ¥çœ‹æ˜¯å¦å¡«å†™æˆåŠŸ</strong></p>\n<h3 id=\"å®é™…æ•ˆæœ\"><a href=\"#å®é™…æ•ˆæœ\" class=\"headerlink\" title=\"å®é™…æ•ˆæœ\"></a><strong>å®é™…æ•ˆæœ</strong></h3><ul>\n<li>æˆªå›¾è½¯ä»¶ï¼Œç²˜è´´æ•ˆæœï¼Œtyporaç›´æ¥è½¬æ¢æˆäº†é˜¿é‡Œäº‘OSSçš„åœ°å€<img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/53d7a28b-96f3-4ba5-8fbc-e47b5bddae99.png\" alt=\"image-20221222140236233\"></li>\n<li>å¤–ç«™ç²˜è´´è¿‡æ¥çš„ä¹Ÿæ˜¯åŒæ ·æ•ˆæœ</li>\n</ul>\n"},{"title":"ç»•è¿‡cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ","date":"2025-02-18T07:03:59.000Z","_content":"\n> Cloudflare çš„ 5ç§’ç›¾ï¼ˆUnder Attack Modeï¼‰æ˜¯ç½‘ç«™é˜²æŠ¤çš„å¸¸è§æ‰‹æ®µï¼Œé€šè¿‡ JavaScript æŒ‘æˆ˜éªŒè¯è®¿å®¢çœŸå®æ€§ã€‚å¾ˆå¤šç½‘ç«™ä¼šä½¿ç”¨Cloudflareæä¾›å®‰å…¨æœåŠ¡ï¼Œå¯¼è‡´çˆ¬è™«çš„æ—¶å€™æ˜¾ç¤º403çŠ¶æ€ã€‚\n\n\n![55187d199c2a9079caff09622c6f78f9933ed773](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/55187d199c2a9079caff09622c6f78f9933ed773.png)\n\n## ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\n\n#### 1. ä½¿ç”¨ cloudscraper åº“\n\n**åŸç†**ï¼šæ¨¡æ‹Ÿ Cloudflare é¢„æœŸçš„è¯·æ±‚ç‰¹å¾\n\n```python\nimport cloudscraper\n\nscraper = cloudscraper.create_scraper()\nresponse = scraper.get(\"https://target-site.com\")\nprint(response.text)\n```\n\n#### 2. ä½¿ç”¨ curl_cffi åº“\n\n**ä¼˜åŠ¿**ï¼šæ”¯æŒå¤šæµè§ˆå™¨æŒ‡çº¹æ¨¡æ‹Ÿ\n\n```python\nfrom curl_cffi import requests\n\nresponse = requests.get(\n    \"https://target-site.com\",\n    impersonate=\"chrome110\"  # æ”¯æŒ chrome99-110 / edge99-110\n)\nprint(response.text)\n```\n\n#### 3. ç¬¬ä¸‰æ–¹ API æœåŠ¡\n\n**æ¨èæœåŠ¡**ï¼š\n\n- ScrapingBeeï¼ˆè‡ªå¸¦ä»£ç†è½®è½¬ï¼‰\n- ScraperAPI\n- ZenRows\n\n```python\nimport requests\n\nAPI_KEY = \"your_api_key\"\nresponse = requests.get(\n    f\"https://api.scrapingbee.com/v1/?api_key={API_KEY}&url=target-site.com\"\n)\n```\n\n#### 4. FlareSolverr æœåŠ¡\n\n**æ¶æ„**ï¼šåŸºäº Puppeteer çš„ä¸­é—´ä»¶æœåŠ¡\n\néƒ¨ç½²æ­¥éª¤ï¼š\n\n```bash\ndocker run -d \\\n  --name flaresolverr \\\n  -p 8191:8191 \\\n  -e LOG_LEVEL=info \\\n  --restart unless-stopped \\\n  ghcr.io/flaresolverr/flaresolverr:latest\n```\n\nè°ƒç”¨ç¤ºä¾‹ï¼š\n\n```python\nimport requests\n\npayload = {\n    \"cmd\": \"request.get\",\n    \"url\": \"https://target-site.com\",\n    \"maxTimeout\": 60000\n}\nresponse = requests.post(\"http://localhost:8191/v1\", json=payload)\n```\n\n## äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\n\n| æ–¹æ¡ˆ         | æ‰§è¡Œé€Ÿåº¦ | ç»´æŠ¤æˆæœ¬ | éšåŒ¿æ€§ | é€‚ç”¨åœºæ™¯         |\n| ------------ | -------- | -------- | ------ | ---------------- |\n| cloudscraper | â˜…â˜…â˜…â˜…     | ä½       | ä¸­     | ä¸­å°è§„æ¨¡å¸¸è§„é‡‡é›† |\n| curl_cffi    | â˜…â˜…â˜…â˜…â˜…    | ä½       | é«˜     | éœ€è¦æœ€æ–°æŒ‡çº¹åœºæ™¯ |\n| ç¬¬ä¸‰æ–¹API    | â˜…â˜…â˜…      | ä¸­       | é«˜     | ä¼ä¸šçº§é«˜é¢‘é‡‡é›†   |\n| FlareSolverr | â˜…â˜…       | é«˜       | æé«˜   | å¤æ‚JSéªŒè¯åœºæ™¯   |\n\n## ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\n\n1. **IPè½®æ¢ç­–ç•¥**ï¼šç»“åˆä½å®…ä»£ç†ä½¿ç”¨ï¼ˆæ¨è BrightDataï¼‰\n2. **æŒ‡çº¹éšæœºåŒ–**ï¼šå®šæœŸæ›´æ¢ User-Agent/TLS æŒ‡çº¹\n3. **è¯·æ±‚é™é€Ÿ**ï¼šè®¾ç½® 3-10 ç§’éšæœºå»¶è¿Ÿ\n4. **å¤´ä¿¡æ¯æ ¡éªŒ**ï¼šæºå¸¦å®Œæ•´ Accept-Encoding/Cookie ç­‰å¤´","source":"_posts/ç»•è¿‡Cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ.md","raw":"---\ntitle: ç»•è¿‡cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ\ndate: 2025-02-18 15:03:59\ntags:\n---\n\n> Cloudflare çš„ 5ç§’ç›¾ï¼ˆUnder Attack Modeï¼‰æ˜¯ç½‘ç«™é˜²æŠ¤çš„å¸¸è§æ‰‹æ®µï¼Œé€šè¿‡ JavaScript æŒ‘æˆ˜éªŒè¯è®¿å®¢çœŸå®æ€§ã€‚å¾ˆå¤šç½‘ç«™ä¼šä½¿ç”¨Cloudflareæä¾›å®‰å…¨æœåŠ¡ï¼Œå¯¼è‡´çˆ¬è™«çš„æ—¶å€™æ˜¾ç¤º403çŠ¶æ€ã€‚\n\n\n![55187d199c2a9079caff09622c6f78f9933ed773](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/55187d199c2a9079caff09622c6f78f9933ed773.png)\n\n## ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\n\n#### 1. ä½¿ç”¨ cloudscraper åº“\n\n**åŸç†**ï¼šæ¨¡æ‹Ÿ Cloudflare é¢„æœŸçš„è¯·æ±‚ç‰¹å¾\n\n```python\nimport cloudscraper\n\nscraper = cloudscraper.create_scraper()\nresponse = scraper.get(\"https://target-site.com\")\nprint(response.text)\n```\n\n#### 2. ä½¿ç”¨ curl_cffi åº“\n\n**ä¼˜åŠ¿**ï¼šæ”¯æŒå¤šæµè§ˆå™¨æŒ‡çº¹æ¨¡æ‹Ÿ\n\n```python\nfrom curl_cffi import requests\n\nresponse = requests.get(\n    \"https://target-site.com\",\n    impersonate=\"chrome110\"  # æ”¯æŒ chrome99-110 / edge99-110\n)\nprint(response.text)\n```\n\n#### 3. ç¬¬ä¸‰æ–¹ API æœåŠ¡\n\n**æ¨èæœåŠ¡**ï¼š\n\n- ScrapingBeeï¼ˆè‡ªå¸¦ä»£ç†è½®è½¬ï¼‰\n- ScraperAPI\n- ZenRows\n\n```python\nimport requests\n\nAPI_KEY = \"your_api_key\"\nresponse = requests.get(\n    f\"https://api.scrapingbee.com/v1/?api_key={API_KEY}&url=target-site.com\"\n)\n```\n\n#### 4. FlareSolverr æœåŠ¡\n\n**æ¶æ„**ï¼šåŸºäº Puppeteer çš„ä¸­é—´ä»¶æœåŠ¡\n\néƒ¨ç½²æ­¥éª¤ï¼š\n\n```bash\ndocker run -d \\\n  --name flaresolverr \\\n  -p 8191:8191 \\\n  -e LOG_LEVEL=info \\\n  --restart unless-stopped \\\n  ghcr.io/flaresolverr/flaresolverr:latest\n```\n\nè°ƒç”¨ç¤ºä¾‹ï¼š\n\n```python\nimport requests\n\npayload = {\n    \"cmd\": \"request.get\",\n    \"url\": \"https://target-site.com\",\n    \"maxTimeout\": 60000\n}\nresponse = requests.post(\"http://localhost:8191/v1\", json=payload)\n```\n\n## äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\n\n| æ–¹æ¡ˆ         | æ‰§è¡Œé€Ÿåº¦ | ç»´æŠ¤æˆæœ¬ | éšåŒ¿æ€§ | é€‚ç”¨åœºæ™¯         |\n| ------------ | -------- | -------- | ------ | ---------------- |\n| cloudscraper | â˜…â˜…â˜…â˜…     | ä½       | ä¸­     | ä¸­å°è§„æ¨¡å¸¸è§„é‡‡é›† |\n| curl_cffi    | â˜…â˜…â˜…â˜…â˜…    | ä½       | é«˜     | éœ€è¦æœ€æ–°æŒ‡çº¹åœºæ™¯ |\n| ç¬¬ä¸‰æ–¹API    | â˜…â˜…â˜…      | ä¸­       | é«˜     | ä¼ä¸šçº§é«˜é¢‘é‡‡é›†   |\n| FlareSolverr | â˜…â˜…       | é«˜       | æé«˜   | å¤æ‚JSéªŒè¯åœºæ™¯   |\n\n## ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\n\n1. **IPè½®æ¢ç­–ç•¥**ï¼šç»“åˆä½å®…ä»£ç†ä½¿ç”¨ï¼ˆæ¨è BrightDataï¼‰\n2. **æŒ‡çº¹éšæœºåŒ–**ï¼šå®šæœŸæ›´æ¢ User-Agent/TLS æŒ‡çº¹\n3. **è¯·æ±‚é™é€Ÿ**ï¼šè®¾ç½® 3-10 ç§’éšæœºå»¶è¿Ÿ\n4. **å¤´ä¿¡æ¯æ ¡éªŒ**ï¼šæºå¸¦å®Œæ•´ Accept-Encoding/Cookie ç­‰å¤´","slug":"ç»•è¿‡Cloudflare 5ç§’ç›¾çš„æŠ€æœ¯æ–¹æ¡ˆè§£æ","published":1,"updated":"2025-02-18T07:05:27.550Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dq0018wen12ksqb32b","content":"<blockquote>\n<p>Cloudflare çš„ 5ç§’ç›¾ï¼ˆUnder Attack Modeï¼‰æ˜¯ç½‘ç«™é˜²æŠ¤çš„å¸¸è§æ‰‹æ®µï¼Œé€šè¿‡ JavaScript æŒ‘æˆ˜éªŒè¯è®¿å®¢çœŸå®æ€§ã€‚å¾ˆå¤šç½‘ç«™ä¼šä½¿ç”¨Cloudflareæä¾›å®‰å…¨æœåŠ¡ï¼Œå¯¼è‡´çˆ¬è™«çš„æ—¶å€™æ˜¾ç¤º403çŠ¶æ€ã€‚</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/55187d199c2a9079caff09622c6f78f9933ed773.png\" alt=\"55187d199c2a9079caff09622c6f78f9933ed773\"></p>\n<h2 id=\"ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\"><a href=\"#ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\" class=\"headerlink\" title=\"ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\"></a>ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹</h2><h4 id=\"1-ä½¿ç”¨-cloudscraper-åº“\"><a href=\"#1-ä½¿ç”¨-cloudscraper-åº“\" class=\"headerlink\" title=\"1. ä½¿ç”¨ cloudscraper åº“\"></a>1. ä½¿ç”¨ cloudscraper åº“</h4><p><strong>åŸç†</strong>ï¼šæ¨¡æ‹Ÿ Cloudflare é¢„æœŸçš„è¯·æ±‚ç‰¹å¾</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cloudscraper</span><br><span class=\"line\"></span><br><span class=\"line\">scraper = cloudscraper.create_scraper()</span><br><span class=\"line\">response = scraper.get(<span class=\"string\">&quot;https://target-site.com&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response.text)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-ä½¿ç”¨-curl-cffi-åº“\"><a href=\"#2-ä½¿ç”¨-curl-cffi-åº“\" class=\"headerlink\" title=\"2. ä½¿ç”¨ curl_cffi åº“\"></a>2. ä½¿ç”¨ curl_cffi åº“</h4><p><strong>ä¼˜åŠ¿</strong>ï¼šæ”¯æŒå¤šæµè§ˆå™¨æŒ‡çº¹æ¨¡æ‹Ÿ</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> curl_cffi <span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">response = requests.get(</span><br><span class=\"line\">    <span class=\"string\">&quot;https://target-site.com&quot;</span>,</span><br><span class=\"line\">    impersonate=<span class=\"string\">&quot;chrome110&quot;</span>  <span class=\"comment\"># æ”¯æŒ chrome99-110 / edge99-110</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response.text)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-ç¬¬ä¸‰æ–¹-API-æœåŠ¡\"><a href=\"#3-ç¬¬ä¸‰æ–¹-API-æœåŠ¡\" class=\"headerlink\" title=\"3. ç¬¬ä¸‰æ–¹ API æœåŠ¡\"></a>3. ç¬¬ä¸‰æ–¹ API æœåŠ¡</h4><p><strong>æ¨èæœåŠ¡</strong>ï¼š</p>\n<ul>\n<li>ScrapingBeeï¼ˆè‡ªå¸¦ä»£ç†è½®è½¬ï¼‰</li>\n<li>ScraperAPI</li>\n<li>ZenRows</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">API_KEY = <span class=\"string\">&quot;your_api_key&quot;</span></span><br><span class=\"line\">response = requests.get(</span><br><span class=\"line\">    <span class=\"string\">f&quot;https://api.scrapingbee.com/v1/?api_key=<span class=\"subst\">&#123;API_KEY&#125;</span>&amp;url=target-site.com&quot;</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4-FlareSolverr-æœåŠ¡\"><a href=\"#4-FlareSolverr-æœåŠ¡\" class=\"headerlink\" title=\"4. FlareSolverr æœåŠ¡\"></a>4. FlareSolverr æœåŠ¡</h4><p><strong>æ¶æ„</strong>ï¼šåŸºäº Puppeteer çš„ä¸­é—´ä»¶æœåŠ¡</p>\n<p>éƒ¨ç½²æ­¥éª¤ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name flaresolverr \\</span><br><span class=\"line\">  -p 8191:8191 \\</span><br><span class=\"line\">  -e LOG_LEVEL=info \\</span><br><span class=\"line\">  --restart unless-stopped \\</span><br><span class=\"line\">  ghcr.io/flaresolverr/flaresolverr:latest</span><br></pre></td></tr></table></figure>\n\n<p>è°ƒç”¨ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">payload = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;cmd&quot;</span>: <span class=\"string\">&quot;request.get&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;https://target-site.com&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;maxTimeout&quot;</span>: <span class=\"number\">60000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">response = requests.post(<span class=\"string\">&quot;http://localhost:8191/v1&quot;</span>, json=payload)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\"><a href=\"#äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\" class=\"headerlink\" title=\"äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\"></a>äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ</h2><table>\n<thead>\n<tr>\n<th>æ–¹æ¡ˆ</th>\n<th>æ‰§è¡Œé€Ÿåº¦</th>\n<th>ç»´æŠ¤æˆæœ¬</th>\n<th>éšåŒ¿æ€§</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>cloudscraper</td>\n<td>â˜…â˜…â˜…â˜…</td>\n<td>ä½</td>\n<td>ä¸­</td>\n<td>ä¸­å°è§„æ¨¡å¸¸è§„é‡‡é›†</td>\n</tr>\n<tr>\n<td>curl_cffi</td>\n<td>â˜…â˜…â˜…â˜…â˜…</td>\n<td>ä½</td>\n<td>é«˜</td>\n<td>éœ€è¦æœ€æ–°æŒ‡çº¹åœºæ™¯</td>\n</tr>\n<tr>\n<td>ç¬¬ä¸‰æ–¹API</td>\n<td>â˜…â˜…â˜…</td>\n<td>ä¸­</td>\n<td>é«˜</td>\n<td>ä¼ä¸šçº§é«˜é¢‘é‡‡é›†</td>\n</tr>\n<tr>\n<td>FlareSolverr</td>\n<td>â˜…â˜…</td>\n<td>é«˜</td>\n<td>æé«˜</td>\n<td>å¤æ‚JSéªŒè¯åœºæ™¯</td>\n</tr>\n</tbody></table>\n<h2 id=\"ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\"><a href=\"#ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\" class=\"headerlink\" title=\"ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\"></a>ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®</h2><ol>\n<li><strong>IPè½®æ¢ç­–ç•¥</strong>ï¼šç»“åˆä½å®…ä»£ç†ä½¿ç”¨ï¼ˆæ¨è BrightDataï¼‰</li>\n<li><strong>æŒ‡çº¹éšæœºåŒ–</strong>ï¼šå®šæœŸæ›´æ¢ User-Agent&#x2F;TLS æŒ‡çº¹</li>\n<li><strong>è¯·æ±‚é™é€Ÿ</strong>ï¼šè®¾ç½® 3-10 ç§’éšæœºå»¶è¿Ÿ</li>\n<li><strong>å¤´ä¿¡æ¯æ ¡éªŒ</strong>ï¼šæºå¸¦å®Œæ•´ Accept-Encoding&#x2F;Cookie ç­‰å¤´</li>\n</ol>\n","excerpt":"","more":"<blockquote>\n<p>Cloudflare çš„ 5ç§’ç›¾ï¼ˆUnder Attack Modeï¼‰æ˜¯ç½‘ç«™é˜²æŠ¤çš„å¸¸è§æ‰‹æ®µï¼Œé€šè¿‡ JavaScript æŒ‘æˆ˜éªŒè¯è®¿å®¢çœŸå®æ€§ã€‚å¾ˆå¤šç½‘ç«™ä¼šä½¿ç”¨Cloudflareæä¾›å®‰å…¨æœåŠ¡ï¼Œå¯¼è‡´çˆ¬è™«çš„æ—¶å€™æ˜¾ç¤º403çŠ¶æ€ã€‚</p>\n</blockquote>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/55187d199c2a9079caff09622c6f78f9933ed773.png\" alt=\"55187d199c2a9079caff09622c6f78f9933ed773\"></p>\n<h2 id=\"ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\"><a href=\"#ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\" class=\"headerlink\" title=\"ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹\"></a>ä¸€ã€è§£å†³æ–¹æ¡ˆåŠä»£ç ç¤ºä¾‹</h2><h4 id=\"1-ä½¿ç”¨-cloudscraper-åº“\"><a href=\"#1-ä½¿ç”¨-cloudscraper-åº“\" class=\"headerlink\" title=\"1. ä½¿ç”¨ cloudscraper åº“\"></a>1. ä½¿ç”¨ cloudscraper åº“</h4><p><strong>åŸç†</strong>ï¼šæ¨¡æ‹Ÿ Cloudflare é¢„æœŸçš„è¯·æ±‚ç‰¹å¾</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> cloudscraper</span><br><span class=\"line\"></span><br><span class=\"line\">scraper = cloudscraper.create_scraper()</span><br><span class=\"line\">response = scraper.get(<span class=\"string\">&quot;https://target-site.com&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response.text)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-ä½¿ç”¨-curl-cffi-åº“\"><a href=\"#2-ä½¿ç”¨-curl-cffi-åº“\" class=\"headerlink\" title=\"2. ä½¿ç”¨ curl_cffi åº“\"></a>2. ä½¿ç”¨ curl_cffi åº“</h4><p><strong>ä¼˜åŠ¿</strong>ï¼šæ”¯æŒå¤šæµè§ˆå™¨æŒ‡çº¹æ¨¡æ‹Ÿ</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> curl_cffi <span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">response = requests.get(</span><br><span class=\"line\">    <span class=\"string\">&quot;https://target-site.com&quot;</span>,</span><br><span class=\"line\">    impersonate=<span class=\"string\">&quot;chrome110&quot;</span>  <span class=\"comment\"># æ”¯æŒ chrome99-110 / edge99-110</span></span><br><span class=\"line\">)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(response.text)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-ç¬¬ä¸‰æ–¹-API-æœåŠ¡\"><a href=\"#3-ç¬¬ä¸‰æ–¹-API-æœåŠ¡\" class=\"headerlink\" title=\"3. ç¬¬ä¸‰æ–¹ API æœåŠ¡\"></a>3. ç¬¬ä¸‰æ–¹ API æœåŠ¡</h4><p><strong>æ¨èæœåŠ¡</strong>ï¼š</p>\n<ul>\n<li>ScrapingBeeï¼ˆè‡ªå¸¦ä»£ç†è½®è½¬ï¼‰</li>\n<li>ScraperAPI</li>\n<li>ZenRows</li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">API_KEY = <span class=\"string\">&quot;your_api_key&quot;</span></span><br><span class=\"line\">response = requests.get(</span><br><span class=\"line\">    <span class=\"string\">f&quot;https://api.scrapingbee.com/v1/?api_key=<span class=\"subst\">&#123;API_KEY&#125;</span>&amp;url=target-site.com&quot;</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4-FlareSolverr-æœåŠ¡\"><a href=\"#4-FlareSolverr-æœåŠ¡\" class=\"headerlink\" title=\"4. FlareSolverr æœåŠ¡\"></a>4. FlareSolverr æœåŠ¡</h4><p><strong>æ¶æ„</strong>ï¼šåŸºäº Puppeteer çš„ä¸­é—´ä»¶æœåŠ¡</p>\n<p>éƒ¨ç½²æ­¥éª¤ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d \\</span><br><span class=\"line\">  --name flaresolverr \\</span><br><span class=\"line\">  -p 8191:8191 \\</span><br><span class=\"line\">  -e LOG_LEVEL=info \\</span><br><span class=\"line\">  --restart unless-stopped \\</span><br><span class=\"line\">  ghcr.io/flaresolverr/flaresolverr:latest</span><br></pre></td></tr></table></figure>\n\n<p>è°ƒç”¨ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">payload = &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;cmd&quot;</span>: <span class=\"string\">&quot;request.get&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;url&quot;</span>: <span class=\"string\">&quot;https://target-site.com&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;maxTimeout&quot;</span>: <span class=\"number\">60000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">response = requests.post(<span class=\"string\">&quot;http://localhost:8191/v1&quot;</span>, json=payload)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\"><a href=\"#äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\" class=\"headerlink\" title=\"äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ\"></a>äºŒã€æ–¹æ¡ˆå¯¹æ¯”åˆ†æ</h2><table>\n<thead>\n<tr>\n<th>æ–¹æ¡ˆ</th>\n<th>æ‰§è¡Œé€Ÿåº¦</th>\n<th>ç»´æŠ¤æˆæœ¬</th>\n<th>éšåŒ¿æ€§</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>cloudscraper</td>\n<td>â˜…â˜…â˜…â˜…</td>\n<td>ä½</td>\n<td>ä¸­</td>\n<td>ä¸­å°è§„æ¨¡å¸¸è§„é‡‡é›†</td>\n</tr>\n<tr>\n<td>curl_cffi</td>\n<td>â˜…â˜…â˜…â˜…â˜…</td>\n<td>ä½</td>\n<td>é«˜</td>\n<td>éœ€è¦æœ€æ–°æŒ‡çº¹åœºæ™¯</td>\n</tr>\n<tr>\n<td>ç¬¬ä¸‰æ–¹API</td>\n<td>â˜…â˜…â˜…</td>\n<td>ä¸­</td>\n<td>é«˜</td>\n<td>ä¼ä¸šçº§é«˜é¢‘é‡‡é›†</td>\n</tr>\n<tr>\n<td>FlareSolverr</td>\n<td>â˜…â˜…</td>\n<td>é«˜</td>\n<td>æé«˜</td>\n<td>å¤æ‚JSéªŒè¯åœºæ™¯</td>\n</tr>\n</tbody></table>\n<h2 id=\"ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\"><a href=\"#ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\" class=\"headerlink\" title=\"ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®\"></a>ä¸‰ã€å¯¹æŠ—å‡çº§å»ºè®®</h2><ol>\n<li><strong>IPè½®æ¢ç­–ç•¥</strong>ï¼šç»“åˆä½å®…ä»£ç†ä½¿ç”¨ï¼ˆæ¨è BrightDataï¼‰</li>\n<li><strong>æŒ‡çº¹éšæœºåŒ–</strong>ï¼šå®šæœŸæ›´æ¢ User-Agent&#x2F;TLS æŒ‡çº¹</li>\n<li><strong>è¯·æ±‚é™é€Ÿ</strong>ï¼šè®¾ç½® 3-10 ç§’éšæœºå»¶è¿Ÿ</li>\n<li><strong>å¤´ä¿¡æ¯æ ¡éªŒ</strong>ï¼šæºå¸¦å®Œæ•´ Accept-Encoding&#x2F;Cookie ç­‰å¤´</li>\n</ol>\n"},{"title":"å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜","date":"2025-06-01T15:40:59.000Z","_content":"\n> ğŸ“è®°å½•ä¸€ä¸‹ï¼Œå°½ç®¡ä½¿ç”¨äº†åŒæ­¥é”ç”šè‡³æ˜¯åˆ†å¸ƒå¼é”è¿˜æ˜¯æŸ¥è¯¢å¹¶å‘é—®é¢˜çš„æƒ…å†µã€‚\n>\n>å¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œ\"æŸ¥è¯¢çŠ¶æ€->æ›´æ–°çŠ¶æ€\"æ“ä½œæ—¶ï¼Œå‡ºç°å¤šæ¬¡æ›´æ–°çŠ¶æ€ã€‚\n\nè¿™ä¸ªæ˜¯æˆ‘ä¸šåŠ¡ä»£ç ï¼š\n\n```java\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n\nä½¿ç”¨redisåˆ†å¸ƒå¼é”çš„ä»£ç ï¼š\n\n```java\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    RLock lock = redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);\n    try {\n        if (lock.tryLock(20, 2, TimeUnit.SECONDS)) {\n            //ä¸šåŠ¡é€»è¾‘ä»£ç \n        } else {\n            log.error(\"è·å–åˆ†å¸ƒå¼é”å¤±è´¥\");\n        }\n    } catch (InterruptedException e) {\n        throw new RuntimeException(e);\n    } finally {\n        // åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”\n        if (lock.isHeldByCurrentThread()) {\n            //é‡Šæ”¾å½“å‰é”\n            lock.unlock();\n        }\n    }\n}\n```\n\n### ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \n\né—®é¢˜å°±æ˜¯ä»¥ä¸Šä¸¤ç§å†™æ³•éƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨è§£é‡Šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¼„æ¸…æ¥šä¸¤ä¸ªé—®é¢˜ï¼š\n\n1. @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ\n\n2. åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ3.1 @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ\n\nå®ƒçš„åº•å±‚å®ç°åŸç†ä¸»è¦ä¾èµ–äº Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æœºåˆ¶ã€‚ åº•å±‚å®ç°åŸç†\n\n- AOP ä»£ç†ï¼šå½“ä¸€ä¸ªç±»æˆ–æ–¹æ³•è¢« @Transactional æ³¨è§£æ ‡è®°æ—¶ï¼ŒSpring å®¹å™¨åœ¨åˆå§‹åŒ– Bean æ—¶ä¼šæ£€æµ‹åˆ°è¿™ä¸ªæ³¨è§£ã€‚å¯¹äºä½¿ç”¨ Spring\n  çš„ä»£ç†æ¨¡å¼ï¼ˆå¦‚ JDK åŠ¨æ€ä»£ç†æˆ– CGLIBï¼‰ï¼ŒSpring ä¼šä¸ºè¯¥ Bean\n  åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¼šåœ¨è°ƒç”¨å®é™…æ–¹æ³•å‰åæ’å…¥äº‹åŠ¡ç®¡ç†ç›¸å…³çš„ä»£ç ï¼Œå³åœ¨æ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚\n- è§£ææ³¨è§£ï¼šSpring é€šè¿‡æ‰«æ Bean å®šä¹‰ï¼Œè¯†åˆ«å‡ºå¸¦æœ‰ @Transactional æ³¨è§£çš„æ–¹æ³•æˆ–ç±»ï¼Œå¹¶é…ç½®ç›¸åº”çš„äº‹åŠ¡å±æ€§ï¼Œå¦‚ä¼ æ’­è¡Œä¸ºã€éš”ç¦»çº§åˆ«ã€è¶…æ—¶æ—¶é—´ã€æ˜¯å¦åªè¯»ç­‰ã€‚\n- äº‹åŠ¡æ‹¦æˆªå™¨ï¼šSpring ä½¿ç”¨ AOP æœºåˆ¶ä¸­çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–Adviceï¼ˆé€šå¸¸ä¸º TransactionInterceptor æˆ– AspectJ\n  çš„åˆ‡é¢ï¼‰ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰åç»‡å…¥äº‹åŠ¡å¤„ç†é€»è¾‘ã€‚åœ¨æ–¹æ³•è°ƒç”¨å‰ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§è®¾ç½®äº‹åŠ¡çš„å¼€å§‹ï¼›åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸæ—¶æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ï¼ˆç»§æ‰¿è‡ª\n  RuntimeException çš„å¼‚å¸¸ï¼‰æˆ–å·²æ£€æŸ¥å¼‚å¸¸ï¼ˆè¢« @Transactional çš„ rollbackFor å±æ€§æŒ‡å®šçš„å¼‚å¸¸ï¼‰åˆ™å›æ»šäº‹åŠ¡ã€‚\n\nå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœº\n\n- å¼€å¯äº‹åŠ¡ï¼š**äº‹åŠ¡é€šå¸¸åœ¨è¿›å…¥è¢« @Transactional æ³¨è§£çš„æ–¹æ³•ä¹‹å‰ç«‹å³å¼€å§‹**ã€‚è¿™æ„å‘³ç€åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼ŒSpring\n  ä¼šç¡®ä¿ä¸å½“å‰ç¯å¢ƒåŒ¹é…çš„äº‹åŠ¡ä¸Šä¸‹æ–‡å·²ç»å»ºç«‹ã€‚è¿™åŒ…æ‹¬é€‰æ‹©åˆé€‚çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§é…ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºç­‰ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­å®é™…å¼€å¯äº‹åŠ¡ã€‚\n- æäº¤äº‹åŠ¡ï¼š**å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼ŒSpring ä¼šåœ¨ç¦»å¼€è¯¥æ–¹æ³•ä¹‹å‰æäº¤äº‹åŠ¡**\n  ã€‚æäº¤äº‹åŠ¡æ„å‘³ç€å°†æ‰€æœ‰æŒ‚èµ·çš„æ›´æ”¹æ°¸ä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼Œä½¿äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œå¯¹å¤–å¯è§ã€‚\n- å›æ»šäº‹åŠ¡ï¼šå¦‚æœåœ¨è¢«æ³¨è§£çš„æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¹¶ä¸”è¯¥å¼‚å¸¸æœªè¢« @Transactional çš„ noRollbackFor å±æ€§è±å…ï¼ŒSpring\n  å°†åœ¨æ•è·åˆ°å¼‚å¸¸åç«‹å³å›æ»šäº‹åŠ¡ï¼Œæ’¤é”€æ‰€æœ‰åœ¨äº‹åŠ¡ä¸­å·²å®Œæˆä½†æœªæäº¤çš„æ“ä½œï¼Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚\n\n### äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\n\nç­”æ¡ˆæ˜¯ï¼šæœ¬åœ°é”ï¼Œå¦‚æœæ˜¯synchronizedï¼Œçœ‹ä½ åŒ…è£¹èµ·æ¥çš„èŒƒå›´ã€‚Lockçš„è¯ çœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚ åˆ†å¸ƒå¼é”ï¼šçœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚\n\né‚£ä¹ˆé€ æˆé—®é¢˜çš„åŸå› å°±å‡ºæ¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š\n\n![5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75.webp)\n\n**ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆæäº¤äº‹åŠ¡å’Œé‡Šæ”¾é”çš„é¡ºåºæœ‰é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä»£ç å†™æ³•ï¼Œå› ä¸ºå½“åªæœ‰æ–¹æ³•æ‰§è¡Œå®Œäº†ï¼ŒAOPåˆ‡é¢æ‰ä¼šæäº¤äº‹åŠ¡ï¼Œé‚£ä¹ˆå¦‚æœä½ å°†ä¸Šé”çš„ä»£ç å†™åˆ°è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•é‡Œé¢ï¼Œé‚£ä¹ˆæäº¤äº‹åŠ¡æ°¸è¿œéƒ½ä¼šå¤„äºé‡Šæ”¾é”ä¹‹åï¼Œé‚£ä¹ˆåœ¨é‡Šæ”¾é”ä¹‹åï¼Œæäº¤äº‹åŠ¡ä¹‹å‰çš„è¿™æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚**\n\n### ä¸‰ã€æ­£ç¡®çš„å†™æ³•\n\n1. æœ¬åœ°é”\n\n```java\n   public void addLock(Long modelId) throws GseException {\n    synchronized (this) {\n        update(modelId);\n    }\n}\n\n@Transactional(rollbackFor = Exception.class)\npublic void xxxCopy(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n2. åˆ†å¸ƒå¼é”\n\n```java\npublic void addLock(Long modelId) throws GseException {\n  RLock lock = redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);\n  try {\n      if (lock.tryLock(20, 2, TimeUnit.SECONDS)) {\n          update(modelId);\n      } else {\n          log.error(\"è·å–åˆ†å¸ƒå¼é”å¤±è´¥\");\n      }\n  } catch (InterruptedException e) {\n      throw new RuntimeException(e);\n  } finally {\n      // åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”\n      if (lock.isHeldByCurrentThread()) {\n          //é‡Šæ”¾å½“å‰é”\n          lock.unlock();\n      }\n  }\n}\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n\nè¿™æ ·çš„å†™æ³•ï¼ŒæˆåŠŸé¿å…äº†å¹¶å‘é—®é¢˜ï¼Œ**è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå°±ä¼šæäº¤äº‹åŠ¡ï¼Œç„¶ååˆ°äº†è°ƒç”¨æ–¹æ³•é‡Œé¢ï¼Œå†å»é‡Šæ”¾é”ã€‚**\n\n### å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\n\né—®é¢˜åˆ†æ\n\n1. è¯·æ±‚Aï¼šæŸ¥è¯¢çŠ¶æ€ â†’ ç¬¦åˆæ¡ä»¶ â†’ æ›´æ–°çŠ¶æ€ï¼ˆä½†æ•°æ®åº“å¡é¡¿ï¼Œæ›´æ–°ç¼“æ…¢ï¼‰\n2. è¯·æ±‚Bï¼šåœ¨Aå®Œæˆå‰æŸ¥è¯¢çŠ¶æ€ â†’ çœ‹åˆ°çš„çŠ¶æ€æœªè¢«ä¿®æ”¹ â†’ ä¹Ÿæ‰§è¡Œæ›´æ–°\n\nè¿™ä¼šå¯¼è‡´ï¼š\n\n- æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚é‡å¤æ‰£å‡åº“å­˜ï¼‰\n- ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚è®¢å•é‡å¤æ”¯ä»˜ï¼‰\n- èµ„æºè¶…ç”¨ï¼ˆå¦‚ä¼˜æƒ åˆ¸è¢«å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼‰\n\nè§£å†³æ–¹æ¡ˆ\n\n1. äº‹åŠ¡ + SELECT FOR UPDATEï¼ˆæ¨èï¼‰\n\nåœ¨äº‹åŠ¡ä¸­ä½¿ç”¨`SELECT FOR UPDATE`é”å®šè¡Œï¼Œç¡®ä¿æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼š\n\n```java\n\n@Transactional\npublic void updateWithLock(Long id) {\n    // ä½¿ç”¨SELECT FOR UPDATEé”å®šè¡Œ\n    MyData data = myDataMapper.selectForUpdate(id);\n\n    // æ£€æŸ¥çŠ¶æ€\n    if (data.getStatus() == TARGET_STATUS) {\n        // æ‰§è¡Œæ›´æ–°\n        data.setStatus(NEW_STATUS);\n        myDataMapper.update(data);\n    }\n}\n```\n\nSQLæ˜ å°„ï¼š\n\n```\n<!-- ä½¿ç”¨FOR UPDATEé”å®šè¡Œ -->\n<select id=\"selectForUpdate\" resultType=\"MyData\">\n    SELECT * FROM my_table WHERE id = #{id} FOR UPDATE\n</select>\n```\n\n2. ä¹è§‚é”ï¼ˆä½¿ç”¨ç‰ˆæœ¬å·ï¼‰\n\næ·»åŠ ç‰ˆæœ¬å·å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°æ£€æŸ¥ç‰ˆæœ¬å·ï¼š\n\n```java\npublic boolean updateWithVersion(Long id) {\n    MyData data = myDataMapper.findById(id);\n\n    if (data.getStatus() != TARGET_STATUS) {\n        return false;\n    }\n\n    // å¸¦ç‰ˆæœ¬å·çš„æ›´æ–°\n    int rows = myDataMapper.updateWithVersion(\n            id,\n            NEW_STATUS,\n            data.getVersion(),  // å½“å‰ç‰ˆæœ¬\n            data.getVersion() + 1 // æ–°ç‰ˆæœ¬\n    );\n\n    return rows > 0;\n}\n```\n\nSQLæ˜ å°„ï¼š\n\n```java\n<update id=\"updateWithVersion\">\nUPDATE my_table\nSET status = #{newStatus},\nversion = #{newVersion}\nWHERE id = #{id}\nAND version = #{oldVersion}\n</update>\n```\n\nå‚è€ƒæ–‡ç« ï¼š[è®°å½•ä¸€æ¬¡Redissonä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”ä¸ç”Ÿæ•ˆçš„åŸå› ](https://article.juejin.cn/post/7392104848974528552)\nå‚è€ƒæ–‡ç« ï¼š[æ‚²è§‚é”ã€ä¹è§‚é”ã€mybatis-pluså®ç°ä¹è§‚é”](https://www.cnblogs.com/dalaba/p/17879895.html)","source":"_posts/å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜.md","raw":"---\ntitle: å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜\ndate: 2025-06-01 23:40:59\ntags:\n---\n\n> ğŸ“è®°å½•ä¸€ä¸‹ï¼Œå°½ç®¡ä½¿ç”¨äº†åŒæ­¥é”ç”šè‡³æ˜¯åˆ†å¸ƒå¼é”è¿˜æ˜¯æŸ¥è¯¢å¹¶å‘é—®é¢˜çš„æƒ…å†µã€‚\n>\n>å¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œ\"æŸ¥è¯¢çŠ¶æ€->æ›´æ–°çŠ¶æ€\"æ“ä½œæ—¶ï¼Œå‡ºç°å¤šæ¬¡æ›´æ–°çŠ¶æ€ã€‚\n\nè¿™ä¸ªæ˜¯æˆ‘ä¸šåŠ¡ä»£ç ï¼š\n\n```java\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n\nä½¿ç”¨redisåˆ†å¸ƒå¼é”çš„ä»£ç ï¼š\n\n```java\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    RLock lock = redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);\n    try {\n        if (lock.tryLock(20, 2, TimeUnit.SECONDS)) {\n            //ä¸šåŠ¡é€»è¾‘ä»£ç \n        } else {\n            log.error(\"è·å–åˆ†å¸ƒå¼é”å¤±è´¥\");\n        }\n    } catch (InterruptedException e) {\n        throw new RuntimeException(e);\n    } finally {\n        // åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”\n        if (lock.isHeldByCurrentThread()) {\n            //é‡Šæ”¾å½“å‰é”\n            lock.unlock();\n        }\n    }\n}\n```\n\n### ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \n\né—®é¢˜å°±æ˜¯ä»¥ä¸Šä¸¤ç§å†™æ³•éƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨è§£é‡Šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¼„æ¸…æ¥šä¸¤ä¸ªé—®é¢˜ï¼š\n\n1. @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ\n\n2. åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ3.1 @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ\n\nå®ƒçš„åº•å±‚å®ç°åŸç†ä¸»è¦ä¾èµ–äº Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æœºåˆ¶ã€‚ åº•å±‚å®ç°åŸç†\n\n- AOP ä»£ç†ï¼šå½“ä¸€ä¸ªç±»æˆ–æ–¹æ³•è¢« @Transactional æ³¨è§£æ ‡è®°æ—¶ï¼ŒSpring å®¹å™¨åœ¨åˆå§‹åŒ– Bean æ—¶ä¼šæ£€æµ‹åˆ°è¿™ä¸ªæ³¨è§£ã€‚å¯¹äºä½¿ç”¨ Spring\n  çš„ä»£ç†æ¨¡å¼ï¼ˆå¦‚ JDK åŠ¨æ€ä»£ç†æˆ– CGLIBï¼‰ï¼ŒSpring ä¼šä¸ºè¯¥ Bean\n  åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¼šåœ¨è°ƒç”¨å®é™…æ–¹æ³•å‰åæ’å…¥äº‹åŠ¡ç®¡ç†ç›¸å…³çš„ä»£ç ï¼Œå³åœ¨æ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚\n- è§£ææ³¨è§£ï¼šSpring é€šè¿‡æ‰«æ Bean å®šä¹‰ï¼Œè¯†åˆ«å‡ºå¸¦æœ‰ @Transactional æ³¨è§£çš„æ–¹æ³•æˆ–ç±»ï¼Œå¹¶é…ç½®ç›¸åº”çš„äº‹åŠ¡å±æ€§ï¼Œå¦‚ä¼ æ’­è¡Œä¸ºã€éš”ç¦»çº§åˆ«ã€è¶…æ—¶æ—¶é—´ã€æ˜¯å¦åªè¯»ç­‰ã€‚\n- äº‹åŠ¡æ‹¦æˆªå™¨ï¼šSpring ä½¿ç”¨ AOP æœºåˆ¶ä¸­çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–Adviceï¼ˆé€šå¸¸ä¸º TransactionInterceptor æˆ– AspectJ\n  çš„åˆ‡é¢ï¼‰ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰åç»‡å…¥äº‹åŠ¡å¤„ç†é€»è¾‘ã€‚åœ¨æ–¹æ³•è°ƒç”¨å‰ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§è®¾ç½®äº‹åŠ¡çš„å¼€å§‹ï¼›åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸæ—¶æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ï¼ˆç»§æ‰¿è‡ª\n  RuntimeException çš„å¼‚å¸¸ï¼‰æˆ–å·²æ£€æŸ¥å¼‚å¸¸ï¼ˆè¢« @Transactional çš„ rollbackFor å±æ€§æŒ‡å®šçš„å¼‚å¸¸ï¼‰åˆ™å›æ»šäº‹åŠ¡ã€‚\n\nå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœº\n\n- å¼€å¯äº‹åŠ¡ï¼š**äº‹åŠ¡é€šå¸¸åœ¨è¿›å…¥è¢« @Transactional æ³¨è§£çš„æ–¹æ³•ä¹‹å‰ç«‹å³å¼€å§‹**ã€‚è¿™æ„å‘³ç€åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼ŒSpring\n  ä¼šç¡®ä¿ä¸å½“å‰ç¯å¢ƒåŒ¹é…çš„äº‹åŠ¡ä¸Šä¸‹æ–‡å·²ç»å»ºç«‹ã€‚è¿™åŒ…æ‹¬é€‰æ‹©åˆé€‚çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§é…ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºç­‰ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­å®é™…å¼€å¯äº‹åŠ¡ã€‚\n- æäº¤äº‹åŠ¡ï¼š**å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼ŒSpring ä¼šåœ¨ç¦»å¼€è¯¥æ–¹æ³•ä¹‹å‰æäº¤äº‹åŠ¡**\n  ã€‚æäº¤äº‹åŠ¡æ„å‘³ç€å°†æ‰€æœ‰æŒ‚èµ·çš„æ›´æ”¹æ°¸ä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼Œä½¿äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œå¯¹å¤–å¯è§ã€‚\n- å›æ»šäº‹åŠ¡ï¼šå¦‚æœåœ¨è¢«æ³¨è§£çš„æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¹¶ä¸”è¯¥å¼‚å¸¸æœªè¢« @Transactional çš„ noRollbackFor å±æ€§è±å…ï¼ŒSpring\n  å°†åœ¨æ•è·åˆ°å¼‚å¸¸åç«‹å³å›æ»šäº‹åŠ¡ï¼Œæ’¤é”€æ‰€æœ‰åœ¨äº‹åŠ¡ä¸­å·²å®Œæˆä½†æœªæäº¤çš„æ“ä½œï¼Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚\n\n### äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\n\nç­”æ¡ˆæ˜¯ï¼šæœ¬åœ°é”ï¼Œå¦‚æœæ˜¯synchronizedï¼Œçœ‹ä½ åŒ…è£¹èµ·æ¥çš„èŒƒå›´ã€‚Lockçš„è¯ çœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚ åˆ†å¸ƒå¼é”ï¼šçœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚\n\né‚£ä¹ˆé€ æˆé—®é¢˜çš„åŸå› å°±å‡ºæ¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š\n\n![5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75](https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75.webp)\n\n**ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆæäº¤äº‹åŠ¡å’Œé‡Šæ”¾é”çš„é¡ºåºæœ‰é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä»£ç å†™æ³•ï¼Œå› ä¸ºå½“åªæœ‰æ–¹æ³•æ‰§è¡Œå®Œäº†ï¼ŒAOPåˆ‡é¢æ‰ä¼šæäº¤äº‹åŠ¡ï¼Œé‚£ä¹ˆå¦‚æœä½ å°†ä¸Šé”çš„ä»£ç å†™åˆ°è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•é‡Œé¢ï¼Œé‚£ä¹ˆæäº¤äº‹åŠ¡æ°¸è¿œéƒ½ä¼šå¤„äºé‡Šæ”¾é”ä¹‹åï¼Œé‚£ä¹ˆåœ¨é‡Šæ”¾é”ä¹‹åï¼Œæäº¤äº‹åŠ¡ä¹‹å‰çš„è¿™æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚**\n\n### ä¸‰ã€æ­£ç¡®çš„å†™æ³•\n\n1. æœ¬åœ°é”\n\n```java\n   public void addLock(Long modelId) throws GseException {\n    synchronized (this) {\n        update(modelId);\n    }\n}\n\n@Transactional(rollbackFor = Exception.class)\npublic void xxxCopy(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n2. åˆ†å¸ƒå¼é”\n\n```java\npublic void addLock(Long modelId) throws GseException {\n  RLock lock = redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);\n  try {\n      if (lock.tryLock(20, 2, TimeUnit.SECONDS)) {\n          update(modelId);\n      } else {\n          log.error(\"è·å–åˆ†å¸ƒå¼é”å¤±è´¥\");\n      }\n  } catch (InterruptedException e) {\n      throw new RuntimeException(e);\n  } finally {\n      // åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”\n      if (lock.isHeldByCurrentThread()) {\n          //é‡Šæ”¾å½“å‰é”\n          lock.unlock();\n      }\n  }\n}\n\n@Transactional(rollbackFor = Exception.class)\npublic void update(Long modelId) throws GseException {\n    synchronized (this) {\n        //ä¸šåŠ¡é€»è¾‘ä»£ç \n    }\n}\n```\n\nè¿™æ ·çš„å†™æ³•ï¼ŒæˆåŠŸé¿å…äº†å¹¶å‘é—®é¢˜ï¼Œ**è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå°±ä¼šæäº¤äº‹åŠ¡ï¼Œç„¶ååˆ°äº†è°ƒç”¨æ–¹æ³•é‡Œé¢ï¼Œå†å»é‡Šæ”¾é”ã€‚**\n\n### å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\n\né—®é¢˜åˆ†æ\n\n1. è¯·æ±‚Aï¼šæŸ¥è¯¢çŠ¶æ€ â†’ ç¬¦åˆæ¡ä»¶ â†’ æ›´æ–°çŠ¶æ€ï¼ˆä½†æ•°æ®åº“å¡é¡¿ï¼Œæ›´æ–°ç¼“æ…¢ï¼‰\n2. è¯·æ±‚Bï¼šåœ¨Aå®Œæˆå‰æŸ¥è¯¢çŠ¶æ€ â†’ çœ‹åˆ°çš„çŠ¶æ€æœªè¢«ä¿®æ”¹ â†’ ä¹Ÿæ‰§è¡Œæ›´æ–°\n\nè¿™ä¼šå¯¼è‡´ï¼š\n\n- æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚é‡å¤æ‰£å‡åº“å­˜ï¼‰\n- ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚è®¢å•é‡å¤æ”¯ä»˜ï¼‰\n- èµ„æºè¶…ç”¨ï¼ˆå¦‚ä¼˜æƒ åˆ¸è¢«å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼‰\n\nè§£å†³æ–¹æ¡ˆ\n\n1. äº‹åŠ¡ + SELECT FOR UPDATEï¼ˆæ¨èï¼‰\n\nåœ¨äº‹åŠ¡ä¸­ä½¿ç”¨`SELECT FOR UPDATE`é”å®šè¡Œï¼Œç¡®ä¿æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼š\n\n```java\n\n@Transactional\npublic void updateWithLock(Long id) {\n    // ä½¿ç”¨SELECT FOR UPDATEé”å®šè¡Œ\n    MyData data = myDataMapper.selectForUpdate(id);\n\n    // æ£€æŸ¥çŠ¶æ€\n    if (data.getStatus() == TARGET_STATUS) {\n        // æ‰§è¡Œæ›´æ–°\n        data.setStatus(NEW_STATUS);\n        myDataMapper.update(data);\n    }\n}\n```\n\nSQLæ˜ å°„ï¼š\n\n```\n<!-- ä½¿ç”¨FOR UPDATEé”å®šè¡Œ -->\n<select id=\"selectForUpdate\" resultType=\"MyData\">\n    SELECT * FROM my_table WHERE id = #{id} FOR UPDATE\n</select>\n```\n\n2. ä¹è§‚é”ï¼ˆä½¿ç”¨ç‰ˆæœ¬å·ï¼‰\n\næ·»åŠ ç‰ˆæœ¬å·å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°æ£€æŸ¥ç‰ˆæœ¬å·ï¼š\n\n```java\npublic boolean updateWithVersion(Long id) {\n    MyData data = myDataMapper.findById(id);\n\n    if (data.getStatus() != TARGET_STATUS) {\n        return false;\n    }\n\n    // å¸¦ç‰ˆæœ¬å·çš„æ›´æ–°\n    int rows = myDataMapper.updateWithVersion(\n            id,\n            NEW_STATUS,\n            data.getVersion(),  // å½“å‰ç‰ˆæœ¬\n            data.getVersion() + 1 // æ–°ç‰ˆæœ¬\n    );\n\n    return rows > 0;\n}\n```\n\nSQLæ˜ å°„ï¼š\n\n```java\n<update id=\"updateWithVersion\">\nUPDATE my_table\nSET status = #{newStatus},\nversion = #{newVersion}\nWHERE id = #{id}\nAND version = #{oldVersion}\n</update>\n```\n\nå‚è€ƒæ–‡ç« ï¼š[è®°å½•ä¸€æ¬¡Redissonä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”ä¸ç”Ÿæ•ˆçš„åŸå› ](https://article.juejin.cn/post/7392104848974528552)\nå‚è€ƒæ–‡ç« ï¼š[æ‚²è§‚é”ã€ä¹è§‚é”ã€mybatis-pluså®ç°ä¹è§‚é”](https://www.cnblogs.com/dalaba/p/17879895.html)","slug":"å½“ä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”è¿˜æ˜¯å‡ºç°å¹¶å‘é—®é¢˜","published":1,"updated":"2025-06-01T16:08:22.454Z","comments":1,"layout":"post","photos":[],"_id":"cme2i83dr0019wen1egcfdkf3","content":"<blockquote>\n<p>ğŸ“è®°å½•ä¸€ä¸‹ï¼Œå°½ç®¡ä½¿ç”¨äº†åŒæ­¥é”ç”šè‡³æ˜¯åˆ†å¸ƒå¼é”è¿˜æ˜¯æŸ¥è¯¢å¹¶å‘é—®é¢˜çš„æƒ…å†µã€‚</p>\n<p>å¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œâ€æŸ¥è¯¢çŠ¶æ€-&gt;æ›´æ–°çŠ¶æ€â€æ“ä½œæ—¶ï¼Œå‡ºç°å¤šæ¬¡æ›´æ–°çŠ¶æ€ã€‚</p>\n</blockquote>\n<p>è¿™ä¸ªæ˜¯æˆ‘ä¸šåŠ¡ä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨redisåˆ†å¸ƒå¼é”çš„ä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (lock.tryLock(<span class=\"number\">20</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;è·å–åˆ†å¸ƒå¼é”å¤±è´¥&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RuntimeException</span>(e);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//é‡Šæ”¾å½“å‰é”</span></span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \"><a href=\"#ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \" class=\"headerlink\" title=\"ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \"></a>ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› </h3><p>é—®é¢˜å°±æ˜¯ä»¥ä¸Šä¸¤ç§å†™æ³•éƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨è§£é‡Šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¼„æ¸…æ¥šä¸¤ä¸ªé—®é¢˜ï¼š</p>\n<ol>\n<li><p>@Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n</li>\n<li><p>åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ3.1 @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n</li>\n</ol>\n<p>å®ƒçš„åº•å±‚å®ç°åŸç†ä¸»è¦ä¾èµ–äº Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æœºåˆ¶ã€‚ åº•å±‚å®ç°åŸç†</p>\n<ul>\n<li>AOP ä»£ç†ï¼šå½“ä¸€ä¸ªç±»æˆ–æ–¹æ³•è¢« @Transactional æ³¨è§£æ ‡è®°æ—¶ï¼ŒSpring å®¹å™¨åœ¨åˆå§‹åŒ– Bean æ—¶ä¼šæ£€æµ‹åˆ°è¿™ä¸ªæ³¨è§£ã€‚å¯¹äºä½¿ç”¨ Spring<br>çš„ä»£ç†æ¨¡å¼ï¼ˆå¦‚ JDK åŠ¨æ€ä»£ç†æˆ– CGLIBï¼‰ï¼ŒSpring ä¼šä¸ºè¯¥ Bean<br>åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¼šåœ¨è°ƒç”¨å®é™…æ–¹æ³•å‰åæ’å…¥äº‹åŠ¡ç®¡ç†ç›¸å…³çš„ä»£ç ï¼Œå³åœ¨æ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚</li>\n<li>è§£ææ³¨è§£ï¼šSpring é€šè¿‡æ‰«æ Bean å®šä¹‰ï¼Œè¯†åˆ«å‡ºå¸¦æœ‰ @Transactional æ³¨è§£çš„æ–¹æ³•æˆ–ç±»ï¼Œå¹¶é…ç½®ç›¸åº”çš„äº‹åŠ¡å±æ€§ï¼Œå¦‚ä¼ æ’­è¡Œä¸ºã€éš”ç¦»çº§åˆ«ã€è¶…æ—¶æ—¶é—´ã€æ˜¯å¦åªè¯»ç­‰ã€‚</li>\n<li>äº‹åŠ¡æ‹¦æˆªå™¨ï¼šSpring ä½¿ç”¨ AOP æœºåˆ¶ä¸­çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–Adviceï¼ˆé€šå¸¸ä¸º TransactionInterceptor æˆ– AspectJ<br>çš„åˆ‡é¢ï¼‰ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰åç»‡å…¥äº‹åŠ¡å¤„ç†é€»è¾‘ã€‚åœ¨æ–¹æ³•è°ƒç”¨å‰ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§è®¾ç½®äº‹åŠ¡çš„å¼€å§‹ï¼›åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸæ—¶æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ï¼ˆç»§æ‰¿è‡ª<br>RuntimeException çš„å¼‚å¸¸ï¼‰æˆ–å·²æ£€æŸ¥å¼‚å¸¸ï¼ˆè¢« @Transactional çš„ rollbackFor å±æ€§æŒ‡å®šçš„å¼‚å¸¸ï¼‰åˆ™å›æ»šäº‹åŠ¡ã€‚</li>\n</ul>\n<p>å¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœº</p>\n<ul>\n<li>å¼€å¯äº‹åŠ¡ï¼š<strong>äº‹åŠ¡é€šå¸¸åœ¨è¿›å…¥è¢« @Transactional æ³¨è§£çš„æ–¹æ³•ä¹‹å‰ç«‹å³å¼€å§‹</strong>ã€‚è¿™æ„å‘³ç€åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼ŒSpring<br>ä¼šç¡®ä¿ä¸å½“å‰ç¯å¢ƒåŒ¹é…çš„äº‹åŠ¡ä¸Šä¸‹æ–‡å·²ç»å»ºç«‹ã€‚è¿™åŒ…æ‹¬é€‰æ‹©åˆé€‚çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§é…ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºç­‰ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­å®é™…å¼€å¯äº‹åŠ¡ã€‚</li>\n<li>æäº¤äº‹åŠ¡ï¼š<strong>å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼ŒSpring ä¼šåœ¨ç¦»å¼€è¯¥æ–¹æ³•ä¹‹å‰æäº¤äº‹åŠ¡</strong><br>ã€‚æäº¤äº‹åŠ¡æ„å‘³ç€å°†æ‰€æœ‰æŒ‚èµ·çš„æ›´æ”¹æ°¸ä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼Œä½¿äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œå¯¹å¤–å¯è§ã€‚</li>\n<li>å›æ»šäº‹åŠ¡ï¼šå¦‚æœåœ¨è¢«æ³¨è§£çš„æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¹¶ä¸”è¯¥å¼‚å¸¸æœªè¢« @Transactional çš„ noRollbackFor å±æ€§è±å…ï¼ŒSpring<br>å°†åœ¨æ•è·åˆ°å¼‚å¸¸åç«‹å³å›æ»šäº‹åŠ¡ï¼Œæ’¤é”€æ‰€æœ‰åœ¨äº‹åŠ¡ä¸­å·²å®Œæˆä½†æœªæäº¤çš„æ“ä½œï¼Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚</li>\n</ul>\n<h3 id=\"äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\"><a href=\"#äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\" class=\"headerlink\" title=\"äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\"></a>äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ</h3><p>ç­”æ¡ˆæ˜¯ï¼šæœ¬åœ°é”ï¼Œå¦‚æœæ˜¯synchronizedï¼Œçœ‹ä½ åŒ…è£¹èµ·æ¥çš„èŒƒå›´ã€‚Lockçš„è¯ çœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚ åˆ†å¸ƒå¼é”ï¼šçœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚</p>\n<p>é‚£ä¹ˆé€ æˆé—®é¢˜çš„åŸå› å°±å‡ºæ¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75.webp\" alt=\"5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75\"></p>\n<p><strong>ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆæäº¤äº‹åŠ¡å’Œé‡Šæ”¾é”çš„é¡ºåºæœ‰é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä»£ç å†™æ³•ï¼Œå› ä¸ºå½“åªæœ‰æ–¹æ³•æ‰§è¡Œå®Œäº†ï¼ŒAOPåˆ‡é¢æ‰ä¼šæäº¤äº‹åŠ¡ï¼Œé‚£ä¹ˆå¦‚æœä½ å°†ä¸Šé”çš„ä»£ç å†™åˆ°è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•é‡Œé¢ï¼Œé‚£ä¹ˆæäº¤äº‹åŠ¡æ°¸è¿œéƒ½ä¼šå¤„äºé‡Šæ”¾é”ä¹‹åï¼Œé‚£ä¹ˆåœ¨é‡Šæ”¾é”ä¹‹åï¼Œæäº¤äº‹åŠ¡ä¹‹å‰çš„è¿™æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚</strong></p>\n<h3 id=\"ä¸‰ã€æ­£ç¡®çš„å†™æ³•\"><a href=\"#ä¸‰ã€æ­£ç¡®çš„å†™æ³•\" class=\"headerlink\" title=\"ä¸‰ã€æ­£ç¡®çš„å†™æ³•\"></a>ä¸‰ã€æ­£ç¡®çš„å†™æ³•</h3><ol>\n<li>æœ¬åœ°é”</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addLock</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        update(modelId);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">xxxCopy</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>åˆ†å¸ƒå¼é”</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addLock</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">  <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (lock.tryLock(<span class=\"number\">20</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS)) &#123;</span><br><span class=\"line\">          update(modelId);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          log.error(<span class=\"string\">&quot;è·å–åˆ†å¸ƒå¼é”å¤±è´¥&quot;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RuntimeException</span>(e);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class=\"line\">          <span class=\"comment\">//é‡Šæ”¾å½“å‰é”</span></span><br><span class=\"line\">          lock.unlock();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ ·çš„å†™æ³•ï¼ŒæˆåŠŸé¿å…äº†å¹¶å‘é—®é¢˜ï¼Œ<strong>è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå°±ä¼šæäº¤äº‹åŠ¡ï¼Œç„¶ååˆ°äº†è°ƒç”¨æ–¹æ³•é‡Œé¢ï¼Œå†å»é‡Šæ”¾é”ã€‚</strong></p>\n<h3 id=\"å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\"><a href=\"#å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\" class=\"headerlink\" title=\"å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\"></a>å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”</h3><p>é—®é¢˜åˆ†æ</p>\n<ol>\n<li>è¯·æ±‚Aï¼šæŸ¥è¯¢çŠ¶æ€ â†’ ç¬¦åˆæ¡ä»¶ â†’ æ›´æ–°çŠ¶æ€ï¼ˆä½†æ•°æ®åº“å¡é¡¿ï¼Œæ›´æ–°ç¼“æ…¢ï¼‰</li>\n<li>è¯·æ±‚Bï¼šåœ¨Aå®Œæˆå‰æŸ¥è¯¢çŠ¶æ€ â†’ çœ‹åˆ°çš„çŠ¶æ€æœªè¢«ä¿®æ”¹ â†’ ä¹Ÿæ‰§è¡Œæ›´æ–°</li>\n</ol>\n<p>è¿™ä¼šå¯¼è‡´ï¼š</p>\n<ul>\n<li>æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚é‡å¤æ‰£å‡åº“å­˜ï¼‰</li>\n<li>ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚è®¢å•é‡å¤æ”¯ä»˜ï¼‰</li>\n<li>èµ„æºè¶…ç”¨ï¼ˆå¦‚ä¼˜æƒ åˆ¸è¢«å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼‰</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆ</p>\n<ol>\n<li>äº‹åŠ¡ + SELECT FOR UPDATEï¼ˆæ¨èï¼‰</li>\n</ol>\n<p>åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨<code>SELECT FOR UPDATE</code>é”å®šè¡Œï¼Œç¡®ä¿æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">updateWithLock</span><span class=\"params\">(Long id)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ä½¿ç”¨SELECT FOR UPDATEé”å®šè¡Œ</span></span><br><span class=\"line\">    <span class=\"type\">MyData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> myDataMapper.selectForUpdate(id);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æ£€æŸ¥çŠ¶æ€</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data.getStatus() == TARGET_STATUS) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// æ‰§è¡Œæ›´æ–°</span></span><br><span class=\"line\">        data.setStatus(NEW_STATUS);</span><br><span class=\"line\">        myDataMapper.update(data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SQLæ˜ å°„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- ä½¿ç”¨FOR UPDATEé”å®šè¡Œ --&gt;</span><br><span class=\"line\">&lt;select id=&quot;selectForUpdate&quot; resultType=&quot;MyData&quot;&gt;</span><br><span class=\"line\">    SELECT * FROM my_table WHERE id = #&#123;id&#125; FOR UPDATE</span><br><span class=\"line\">&lt;/select&gt;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>ä¹è§‚é”ï¼ˆä½¿ç”¨ç‰ˆæœ¬å·ï¼‰</li>\n</ol>\n<p>æ·»åŠ ç‰ˆæœ¬å·å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°æ£€æŸ¥ç‰ˆæœ¬å·ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">updateWithVersion</span><span class=\"params\">(Long id)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">MyData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> myDataMapper.findById(id);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data.getStatus() != TARGET_STATUS) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¸¦ç‰ˆæœ¬å·çš„æ›´æ–°</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">rows</span> <span class=\"operator\">=</span> myDataMapper.updateWithVersion(</span><br><span class=\"line\">            id,</span><br><span class=\"line\">            NEW_STATUS,</span><br><span class=\"line\">            data.getVersion(),  <span class=\"comment\">// å½“å‰ç‰ˆæœ¬</span></span><br><span class=\"line\">            data.getVersion() + <span class=\"number\">1</span> <span class=\"comment\">// æ–°ç‰ˆæœ¬</span></span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> rows &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SQLæ˜ å°„ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;update id=<span class=\"string\">&quot;updateWithVersion&quot;</span>&gt;</span><br><span class=\"line\">UPDATE my_table</span><br><span class=\"line\"><span class=\"type\">SET</span> <span class=\"variable\">status</span> <span class=\"operator\">=</span> #&#123;newStatus&#125;,</span><br><span class=\"line\">version = #&#123;newVersion&#125;</span><br><span class=\"line\"><span class=\"type\">WHERE</span> <span class=\"variable\">id</span> <span class=\"operator\">=</span> #&#123;id&#125;</span><br><span class=\"line\"><span class=\"type\">AND</span> <span class=\"variable\">version</span> <span class=\"operator\">=</span> #&#123;oldVersion&#125;</span><br><span class=\"line\">&lt;/update&gt;</span><br></pre></td></tr></table></figure>\n\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://article.juejin.cn/post/7392104848974528552\">è®°å½•ä¸€æ¬¡Redissonä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”ä¸ç”Ÿæ•ˆçš„åŸå› </a><br>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/dalaba/p/17879895.html\">æ‚²è§‚é”ã€ä¹è§‚é”ã€mybatis-pluså®ç°ä¹è§‚é”</a></p>\n","excerpt":"","more":"<blockquote>\n<p>ğŸ“è®°å½•ä¸€ä¸‹ï¼Œå°½ç®¡ä½¿ç”¨äº†åŒæ­¥é”ç”šè‡³æ˜¯åˆ†å¸ƒå¼é”è¿˜æ˜¯æŸ¥è¯¢å¹¶å‘é—®é¢˜çš„æƒ…å†µã€‚</p>\n<p>å¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œâ€æŸ¥è¯¢çŠ¶æ€-&gt;æ›´æ–°çŠ¶æ€â€æ“ä½œæ—¶ï¼Œå‡ºç°å¤šæ¬¡æ›´æ–°çŠ¶æ€ã€‚</p>\n</blockquote>\n<p>è¿™ä¸ªæ˜¯æˆ‘ä¸šåŠ¡ä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä½¿ç”¨redisåˆ†å¸ƒå¼é”çš„ä»£ç ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (lock.tryLock(<span class=\"number\">20</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;è·å–åˆ†å¸ƒå¼é”å¤±è´¥&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RuntimeException</span>(e);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//é‡Šæ”¾å½“å‰é”</span></span><br><span class=\"line\">            lock.unlock();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \"><a href=\"#ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \" class=\"headerlink\" title=\"ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› \"></a>ä¸€ã€å­˜åœ¨çš„é—®é¢˜ä»¥åŠåŸå› </h3><p>é—®é¢˜å°±æ˜¯ä»¥ä¸Šä¸¤ç§å†™æ³•éƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åœ¨è§£é‡Šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¼„æ¸…æ¥šä¸¤ä¸ªé—®é¢˜ï¼š</p>\n<ol>\n<li><p>@Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n</li>\n<li><p>åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ3.1 @Transactionalçš„åº•å±‚å®ç°åŸç†ï¼Œå¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœºæ˜¯ä»€ä¹ˆï¼Ÿ</p>\n</li>\n</ol>\n<p>å®ƒçš„åº•å±‚å®ç°åŸç†ä¸»è¦ä¾èµ–äº Spring çš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æœºåˆ¶ã€‚ åº•å±‚å®ç°åŸç†</p>\n<ul>\n<li>AOP ä»£ç†ï¼šå½“ä¸€ä¸ªç±»æˆ–æ–¹æ³•è¢« @Transactional æ³¨è§£æ ‡è®°æ—¶ï¼ŒSpring å®¹å™¨åœ¨åˆå§‹åŒ– Bean æ—¶ä¼šæ£€æµ‹åˆ°è¿™ä¸ªæ³¨è§£ã€‚å¯¹äºä½¿ç”¨ Spring<br>çš„ä»£ç†æ¨¡å¼ï¼ˆå¦‚ JDK åŠ¨æ€ä»£ç†æˆ– CGLIBï¼‰ï¼ŒSpring ä¼šä¸ºè¯¥ Bean<br>åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚è¿™ä¸ªä»£ç†å¯¹è±¡ä¼šåœ¨è°ƒç”¨å®é™…æ–¹æ³•å‰åæ’å…¥äº‹åŠ¡ç®¡ç†ç›¸å…³çš„ä»£ç ï¼Œå³åœ¨æ–¹æ³•æ‰§è¡Œå‰å¼€å¯äº‹åŠ¡ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚</li>\n<li>è§£ææ³¨è§£ï¼šSpring é€šè¿‡æ‰«æ Bean å®šä¹‰ï¼Œè¯†åˆ«å‡ºå¸¦æœ‰ @Transactional æ³¨è§£çš„æ–¹æ³•æˆ–ç±»ï¼Œå¹¶é…ç½®ç›¸åº”çš„äº‹åŠ¡å±æ€§ï¼Œå¦‚ä¼ æ’­è¡Œä¸ºã€éš”ç¦»çº§åˆ«ã€è¶…æ—¶æ—¶é—´ã€æ˜¯å¦åªè¯»ç­‰ã€‚</li>\n<li>äº‹åŠ¡æ‹¦æˆªå™¨ï¼šSpring ä½¿ç”¨ AOP æœºåˆ¶ä¸­çš„æ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æˆ–Adviceï¼ˆé€šå¸¸ä¸º TransactionInterceptor æˆ– AspectJ<br>çš„åˆ‡é¢ï¼‰ï¼Œåœ¨æ–¹æ³•è°ƒç”¨å‰åç»‡å…¥äº‹åŠ¡å¤„ç†é€»è¾‘ã€‚åœ¨æ–¹æ³•è°ƒç”¨å‰ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§è®¾ç½®äº‹åŠ¡çš„å¼€å§‹ï¼›åœ¨æ–¹æ³•æ­£å¸¸ç»“æŸæ—¶æäº¤äº‹åŠ¡ï¼Œå¦‚æœæ–¹æ³•æŠ›å‡ºæœªæ£€æŸ¥å¼‚å¸¸ï¼ˆç»§æ‰¿è‡ª<br>RuntimeException çš„å¼‚å¸¸ï¼‰æˆ–å·²æ£€æŸ¥å¼‚å¸¸ï¼ˆè¢« @Transactional çš„ rollbackFor å±æ€§æŒ‡å®šçš„å¼‚å¸¸ï¼‰åˆ™å›æ»šäº‹åŠ¡ã€‚</li>\n</ul>\n<p>å¼€å¯äº‹åŠ¡å’Œæäº¤äº‹åŠ¡çš„æ—¶æœº</p>\n<ul>\n<li>å¼€å¯äº‹åŠ¡ï¼š<strong>äº‹åŠ¡é€šå¸¸åœ¨è¿›å…¥è¢« @Transactional æ³¨è§£çš„æ–¹æ³•ä¹‹å‰ç«‹å³å¼€å§‹</strong>ã€‚è¿™æ„å‘³ç€åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼ŒSpring<br>ä¼šç¡®ä¿ä¸å½“å‰ç¯å¢ƒåŒ¹é…çš„äº‹åŠ¡ä¸Šä¸‹æ–‡å·²ç»å»ºç«‹ã€‚è¿™åŒ…æ‹¬é€‰æ‹©åˆé€‚çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ ¹æ®äº‹åŠ¡å±æ€§é…ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºç­‰ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­å®é™…å¼€å¯äº‹åŠ¡ã€‚</li>\n<li>æäº¤äº‹åŠ¡ï¼š<strong>å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•æ­£å¸¸æ‰§è¡Œç»“æŸï¼Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼ŒSpring ä¼šåœ¨ç¦»å¼€è¯¥æ–¹æ³•ä¹‹å‰æäº¤äº‹åŠ¡</strong><br>ã€‚æäº¤äº‹åŠ¡æ„å‘³ç€å°†æ‰€æœ‰æŒ‚èµ·çš„æ›´æ”¹æ°¸ä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ï¼Œä½¿äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œå¯¹å¤–å¯è§ã€‚</li>\n<li>å›æ»šäº‹åŠ¡ï¼šå¦‚æœåœ¨è¢«æ³¨è§£çš„æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¹¶ä¸”è¯¥å¼‚å¸¸æœªè¢« @Transactional çš„ noRollbackFor å±æ€§è±å…ï¼ŒSpring<br>å°†åœ¨æ•è·åˆ°å¼‚å¸¸åç«‹å³å›æ»šäº‹åŠ¡ï¼Œæ’¤é”€æ‰€æœ‰åœ¨äº‹åŠ¡ä¸­å·²å®Œæˆä½†æœªæäº¤çš„æ“ä½œï¼Œä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚</li>\n</ul>\n<h3 id=\"äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\"><a href=\"#äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\" class=\"headerlink\" title=\"äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ\"></a>äºŒã€åˆ†å¸ƒå¼é”ï¼Œå’Œæœ¬åœ°é”æœºåˆ¶é‡Šæ”¾é”çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ</h3><p>ç­”æ¡ˆæ˜¯ï¼šæœ¬åœ°é”ï¼Œå¦‚æœæ˜¯synchronizedï¼Œçœ‹ä½ åŒ…è£¹èµ·æ¥çš„èŒƒå›´ã€‚Lockçš„è¯ çœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚ åˆ†å¸ƒå¼é”ï¼šçœ‹ä½ æ‰‹åŠ¨é‡Šæ”¾é”çš„æ—¶å€™ã€‚</p>\n<p>é‚£ä¹ˆé€ æˆé—®é¢˜çš„åŸå› å°±å‡ºæ¥äº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"https://ruiyeclub.oss-cn-shenzhen.aliyuncs.com/picgo/5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75.webp\" alt=\"5b139d52fdd74a7f81d6455270c34e5f~tplv-73owjymdk6-jj-mark-v1_0_0_0_0_5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd3Vr_q75\"></p>\n<p><strong>ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆæäº¤äº‹åŠ¡å’Œé‡Šæ”¾é”çš„é¡ºåºæœ‰é—®é¢˜ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä»£ç å†™æ³•ï¼Œå› ä¸ºå½“åªæœ‰æ–¹æ³•æ‰§è¡Œå®Œäº†ï¼ŒAOPåˆ‡é¢æ‰ä¼šæäº¤äº‹åŠ¡ï¼Œé‚£ä¹ˆå¦‚æœä½ å°†ä¸Šé”çš„ä»£ç å†™åˆ°è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•é‡Œé¢ï¼Œé‚£ä¹ˆæäº¤äº‹åŠ¡æ°¸è¿œéƒ½ä¼šå¤„äºé‡Šæ”¾é”ä¹‹åï¼Œé‚£ä¹ˆåœ¨é‡Šæ”¾é”ä¹‹åï¼Œæäº¤äº‹åŠ¡ä¹‹å‰çš„è¿™æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰å¹¶å‘é—®é¢˜ã€‚</strong></p>\n<h3 id=\"ä¸‰ã€æ­£ç¡®çš„å†™æ³•\"><a href=\"#ä¸‰ã€æ­£ç¡®çš„å†™æ³•\" class=\"headerlink\" title=\"ä¸‰ã€æ­£ç¡®çš„å†™æ³•\"></a>ä¸‰ã€æ­£ç¡®çš„å†™æ³•</h3><ol>\n<li>æœ¬åœ°é”</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addLock</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        update(modelId);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">xxxCopy</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>åˆ†å¸ƒå¼é”</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addLock</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">  <span class=\"type\">RLock</span> <span class=\"variable\">lock</span> <span class=\"operator\">=</span> redissonClient.getLock(REDIS_COST_MODEL_ID_LOCK + modelId);</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (lock.tryLock(<span class=\"number\">20</span>, <span class=\"number\">2</span>, TimeUnit.SECONDS)) &#123;</span><br><span class=\"line\">          update(modelId);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          log.error(<span class=\"string\">&quot;è·å–åˆ†å¸ƒå¼é”å¤±è´¥&quot;</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RuntimeException</span>(e);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æŒæœ‰é”</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (lock.isHeldByCurrentThread()) &#123;</span><br><span class=\"line\">          <span class=\"comment\">//é‡Šæ”¾å½“å‰é”</span></span><br><span class=\"line\">          lock.unlock();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(Long modelId)</span> <span class=\"keyword\">throws</span> GseException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">synchronized</span> (<span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>è¿™æ ·çš„å†™æ³•ï¼ŒæˆåŠŸé¿å…äº†å¹¶å‘é—®é¢˜ï¼Œ<strong>è¢«@Transactionalæ³¨è§£çš„æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå°±ä¼šæäº¤äº‹åŠ¡ï¼Œç„¶ååˆ°äº†è°ƒç”¨æ–¹æ³•é‡Œé¢ï¼Œå†å»é‡Šæ”¾é”ã€‚</strong></p>\n<h3 id=\"å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\"><a href=\"#å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\" class=\"headerlink\" title=\"å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”\"></a>å››ã€ä½¿ç”¨æ‚²è§‚é”å’Œä¹è§‚é”</h3><p>é—®é¢˜åˆ†æ</p>\n<ol>\n<li>è¯·æ±‚Aï¼šæŸ¥è¯¢çŠ¶æ€ â†’ ç¬¦åˆæ¡ä»¶ â†’ æ›´æ–°çŠ¶æ€ï¼ˆä½†æ•°æ®åº“å¡é¡¿ï¼Œæ›´æ–°ç¼“æ…¢ï¼‰</li>\n<li>è¯·æ±‚Bï¼šåœ¨Aå®Œæˆå‰æŸ¥è¯¢çŠ¶æ€ â†’ çœ‹åˆ°çš„çŠ¶æ€æœªè¢«ä¿®æ”¹ â†’ ä¹Ÿæ‰§è¡Œæ›´æ–°</li>\n</ol>\n<p>è¿™ä¼šå¯¼è‡´ï¼š</p>\n<ul>\n<li>æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚é‡å¤æ‰£å‡åº“å­˜ï¼‰</li>\n<li>ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚è®¢å•é‡å¤æ”¯ä»˜ï¼‰</li>\n<li>èµ„æºè¶…ç”¨ï¼ˆå¦‚ä¼˜æƒ åˆ¸è¢«å¤šä¸ªç”¨æˆ·åŒæ—¶ä½¿ç”¨ï¼‰</li>\n</ul>\n<p>è§£å†³æ–¹æ¡ˆ</p>\n<ol>\n<li>äº‹åŠ¡ + SELECT FOR UPDATEï¼ˆæ¨èï¼‰</li>\n</ol>\n<p>åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨<code>SELECT FOR UPDATE</code>é”å®šè¡Œï¼Œç¡®ä¿æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Transactional</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">updateWithLock</span><span class=\"params\">(Long id)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ä½¿ç”¨SELECT FOR UPDATEé”å®šè¡Œ</span></span><br><span class=\"line\">    <span class=\"type\">MyData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> myDataMapper.selectForUpdate(id);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// æ£€æŸ¥çŠ¶æ€</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data.getStatus() == TARGET_STATUS) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// æ‰§è¡Œæ›´æ–°</span></span><br><span class=\"line\">        data.setStatus(NEW_STATUS);</span><br><span class=\"line\">        myDataMapper.update(data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SQLæ˜ å°„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- ä½¿ç”¨FOR UPDATEé”å®šè¡Œ --&gt;</span><br><span class=\"line\">&lt;select id=&quot;selectForUpdate&quot; resultType=&quot;MyData&quot;&gt;</span><br><span class=\"line\">    SELECT * FROM my_table WHERE id = #&#123;id&#125; FOR UPDATE</span><br><span class=\"line\">&lt;/select&gt;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>ä¹è§‚é”ï¼ˆä½¿ç”¨ç‰ˆæœ¬å·ï¼‰</li>\n</ol>\n<p>æ·»åŠ ç‰ˆæœ¬å·å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°æ£€æŸ¥ç‰ˆæœ¬å·ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">updateWithVersion</span><span class=\"params\">(Long id)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">MyData</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> myDataMapper.findById(id);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data.getStatus() != TARGET_STATUS) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// å¸¦ç‰ˆæœ¬å·çš„æ›´æ–°</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">rows</span> <span class=\"operator\">=</span> myDataMapper.updateWithVersion(</span><br><span class=\"line\">            id,</span><br><span class=\"line\">            NEW_STATUS,</span><br><span class=\"line\">            data.getVersion(),  <span class=\"comment\">// å½“å‰ç‰ˆæœ¬</span></span><br><span class=\"line\">            data.getVersion() + <span class=\"number\">1</span> <span class=\"comment\">// æ–°ç‰ˆæœ¬</span></span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> rows &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>SQLæ˜ å°„ï¼š</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;update id=<span class=\"string\">&quot;updateWithVersion&quot;</span>&gt;</span><br><span class=\"line\">UPDATE my_table</span><br><span class=\"line\"><span class=\"type\">SET</span> <span class=\"variable\">status</span> <span class=\"operator\">=</span> #&#123;newStatus&#125;,</span><br><span class=\"line\">version = #&#123;newVersion&#125;</span><br><span class=\"line\"><span class=\"type\">WHERE</span> <span class=\"variable\">id</span> <span class=\"operator\">=</span> #&#123;id&#125;</span><br><span class=\"line\"><span class=\"type\">AND</span> <span class=\"variable\">version</span> <span class=\"operator\">=</span> #&#123;oldVersion&#125;</span><br><span class=\"line\">&lt;/update&gt;</span><br></pre></td></tr></table></figure>\n\n<p>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://article.juejin.cn/post/7392104848974528552\">è®°å½•ä¸€æ¬¡Redissonä½¿ç”¨synchronizedå’Œåˆ†å¸ƒå¼é”ä¸ç”Ÿæ•ˆçš„åŸå› </a><br>å‚è€ƒæ–‡ç« ï¼š<a href=\"https://www.cnblogs.com/dalaba/p/17879895.html\">æ‚²è§‚é”ã€ä¹è§‚é”ã€mybatis-pluså®ç°ä¹è§‚é”</a></p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}